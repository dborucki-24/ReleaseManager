(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function w1(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var s0={exports:{}},Po={},o0={exports:{}},st={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Am;function e2(){if(Am)return st;Am=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),x=Symbol.iterator;function v(H){return H===null||typeof H!="object"?null:(H=x&&H[x]||H["@@iterator"],typeof H=="function"?H:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,T={};function E(H,ue,B){this.props=H,this.context=ue,this.refs=T,this.updater=B||_}E.prototype.isReactComponent={},E.prototype.setState=function(H,ue){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,ue,"setState")},E.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function C(){}C.prototype=E.prototype;function I(H,ue,B){this.props=H,this.context=ue,this.refs=T,this.updater=B||_}var A=I.prototype=new C;A.constructor=I,S(A,E.prototype),A.isPureReactComponent=!0;var D=Array.isArray,P=Object.prototype.hasOwnProperty,L={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function J(H,ue,B){var X,q={},K=null,le=null;if(ue!=null)for(X in ue.ref!==void 0&&(le=ue.ref),ue.key!==void 0&&(K=""+ue.key),ue)P.call(ue,X)&&!R.hasOwnProperty(X)&&(q[X]=ue[X]);var xe=arguments.length-2;if(xe===1)q.children=B;else if(1<xe){for(var ve=Array(xe),we=0;we<xe;we++)ve[we]=arguments[we+2];q.children=ve}if(H&&H.defaultProps)for(X in xe=H.defaultProps,xe)q[X]===void 0&&(q[X]=xe[X]);return{$$typeof:e,type:H,key:K,ref:le,props:q,_owner:L.current}}function V(H,ue){return{$$typeof:e,type:H.type,key:ue,ref:H.ref,props:H.props,_owner:H._owner}}function ne(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function te(H){var ue={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(B){return ue[B]})}var Q=/\/+/g;function me(H,ue){return typeof H=="object"&&H!==null&&H.key!=null?te(""+H.key):ue.toString(36)}function Re(H,ue,B,X,q){var K=typeof H;(K==="undefined"||K==="boolean")&&(H=null);var le=!1;if(H===null)le=!0;else switch(K){case"string":case"number":le=!0;break;case"object":switch(H.$$typeof){case e:case t:le=!0}}if(le)return le=H,q=q(le),H=X===""?"."+me(le,0):X,D(q)?(B="",H!=null&&(B=H.replace(Q,"$&/")+"/"),Re(q,ue,B,"",function(we){return we})):q!=null&&(ne(q)&&(q=V(q,B+(!q.key||le&&le.key===q.key?"":(""+q.key).replace(Q,"$&/")+"/")+H)),ue.push(q)),1;if(le=0,X=X===""?".":X+":",D(H))for(var xe=0;xe<H.length;xe++){K=H[xe];var ve=X+me(K,xe);le+=Re(K,ue,B,ve,q)}else if(ve=v(H),typeof ve=="function")for(H=ve.call(H),xe=0;!(K=H.next()).done;)K=K.value,ve=X+me(K,xe++),le+=Re(K,ue,B,ve,q);else if(K==="object")throw ue=String(H),Error("Objects are not valid as a React child (found: "+(ue==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":ue)+"). If you meant to render a collection of children, use an array instead.");return le}function ye(H,ue,B){if(H==null)return H;var X=[],q=0;return Re(H,X,"","",function(K){return ue.call(B,K,q++)}),X}function De(H){if(H._status===-1){var ue=H._result;ue=ue(),ue.then(function(B){(H._status===0||H._status===-1)&&(H._status=1,H._result=B)},function(B){(H._status===0||H._status===-1)&&(H._status=2,H._result=B)}),H._status===-1&&(H._status=0,H._result=ue)}if(H._status===1)return H._result.default;throw H._result}var Ce={current:null},ke={transition:null},Z={ReactCurrentDispatcher:Ce,ReactCurrentBatchConfig:ke,ReactCurrentOwner:L};return st.Children={map:ye,forEach:function(H,ue,B){ye(H,function(){ue.apply(this,arguments)},B)},count:function(H){var ue=0;return ye(H,function(){ue++}),ue},toArray:function(H){return ye(H,function(ue){return ue})||[]},only:function(H){if(!ne(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},st.Component=E,st.Fragment=n,st.Profiler=i,st.PureComponent=I,st.StrictMode=r,st.Suspense=d,st.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z,st.cloneElement=function(H,ue,B){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var X=S({},H.props),q=H.key,K=H.ref,le=H._owner;if(ue!=null){if(ue.ref!==void 0&&(K=ue.ref,le=L.current),ue.key!==void 0&&(q=""+ue.key),H.type&&H.type.defaultProps)var xe=H.type.defaultProps;for(ve in ue)P.call(ue,ve)&&!R.hasOwnProperty(ve)&&(X[ve]=ue[ve]===void 0&&xe!==void 0?xe[ve]:ue[ve])}var ve=arguments.length-2;if(ve===1)X.children=B;else if(1<ve){xe=Array(ve);for(var we=0;we<ve;we++)xe[we]=arguments[we+2];X.children=xe}return{$$typeof:e,type:H.type,key:q,ref:K,props:X,_owner:le}},st.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:s,_context:H},H.Consumer=H},st.createElement=J,st.createFactory=function(H){var ue=J.bind(null,H);return ue.type=H,ue},st.createRef=function(){return{current:null}},st.forwardRef=function(H){return{$$typeof:u,render:H}},st.isValidElement=ne,st.lazy=function(H){return{$$typeof:m,_payload:{_status:-1,_result:H},_init:De}},st.memo=function(H,ue){return{$$typeof:h,type:H,compare:ue===void 0?null:ue}},st.startTransition=function(H){var ue=ke.transition;ke.transition={};try{H()}finally{ke.transition=ue}},st.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},st.useCallback=function(H,ue){return Ce.current.useCallback(H,ue)},st.useContext=function(H){return Ce.current.useContext(H)},st.useDebugValue=function(){},st.useDeferredValue=function(H){return Ce.current.useDeferredValue(H)},st.useEffect=function(H,ue){return Ce.current.useEffect(H,ue)},st.useId=function(){return Ce.current.useId()},st.useImperativeHandle=function(H,ue,B){return Ce.current.useImperativeHandle(H,ue,B)},st.useInsertionEffect=function(H,ue){return Ce.current.useInsertionEffect(H,ue)},st.useLayoutEffect=function(H,ue){return Ce.current.useLayoutEffect(H,ue)},st.useMemo=function(H,ue){return Ce.current.useMemo(H,ue)},st.useReducer=function(H,ue,B){return Ce.current.useReducer(H,ue,B)},st.useRef=function(H){return Ce.current.useRef(H)},st.useState=function(H){return Ce.current.useState(H)},st.useSyncExternalStore=function(H,ue,B){return Ce.current.useSyncExternalStore(H,ue,B)},st.useTransition=function(){return Ce.current.useTransition()},st.version="18.2.0",st}var Im;function od(){return Im||(Im=1,o0.exports=e2()),o0.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nm;function t2(){if(Nm)return Po;Nm=1;var e=od(),t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(u,d,h){var m,x={},v=null,_=null;h!==void 0&&(v=""+h),d.key!==void 0&&(v=""+d.key),d.ref!==void 0&&(_=d.ref);for(m in d)r.call(d,m)&&!s.hasOwnProperty(m)&&(x[m]=d[m]);if(u&&u.defaultProps)for(m in d=u.defaultProps,d)x[m]===void 0&&(x[m]=d[m]);return{$$typeof:t,type:u,key:v,ref:_,props:x,_owner:i.current}}return Po.Fragment=n,Po.jsx=o,Po.jsxs=o,Po}var Fm;function n2(){return Fm||(Fm=1,s0.exports=t2()),s0.exports}var y=n2(),ge=od();const R0=w1(ge);var Eu={},l0={exports:{}},Xn={},u0={exports:{}},c0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rm;function r2(){return Rm||(Rm=1,function(e){function t(ke,Z){var H=ke.length;ke.push(Z);e:for(;0<H;){var ue=H-1>>>1,B=ke[ue];if(0<i(B,Z))ke[ue]=Z,ke[H]=B,H=ue;else break e}}function n(ke){return ke.length===0?null:ke[0]}function r(ke){if(ke.length===0)return null;var Z=ke[0],H=ke.pop();if(H!==Z){ke[0]=H;e:for(var ue=0,B=ke.length,X=B>>>1;ue<X;){var q=2*(ue+1)-1,K=ke[q],le=q+1,xe=ke[le];if(0>i(K,H))le<B&&0>i(xe,K)?(ke[ue]=xe,ke[le]=H,ue=le):(ke[ue]=K,ke[q]=H,ue=q);else if(le<B&&0>i(xe,H))ke[ue]=xe,ke[le]=H,ue=le;else break e}}return Z}function i(ke,Z){var H=ke.sortIndex-Z.sortIndex;return H!==0?H:ke.id-Z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var d=[],h=[],m=1,x=null,v=3,_=!1,S=!1,T=!1,E=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function A(ke){for(var Z=n(h);Z!==null;){if(Z.callback===null)r(h);else if(Z.startTime<=ke)r(h),Z.sortIndex=Z.expirationTime,t(d,Z);else break;Z=n(h)}}function D(ke){if(T=!1,A(ke),!S)if(n(d)!==null)S=!0,De(P);else{var Z=n(h);Z!==null&&Ce(D,Z.startTime-ke)}}function P(ke,Z){S=!1,T&&(T=!1,C(J),J=-1),_=!0;var H=v;try{for(A(Z),x=n(d);x!==null&&(!(x.expirationTime>Z)||ke&&!te());){var ue=x.callback;if(typeof ue=="function"){x.callback=null,v=x.priorityLevel;var B=ue(x.expirationTime<=Z);Z=e.unstable_now(),typeof B=="function"?x.callback=B:x===n(d)&&r(d),A(Z)}else r(d);x=n(d)}if(x!==null)var X=!0;else{var q=n(h);q!==null&&Ce(D,q.startTime-Z),X=!1}return X}finally{x=null,v=H,_=!1}}var L=!1,R=null,J=-1,V=5,ne=-1;function te(){return!(e.unstable_now()-ne<V)}function Q(){if(R!==null){var ke=e.unstable_now();ne=ke;var Z=!0;try{Z=R(!0,ke)}finally{Z?me():(L=!1,R=null)}}else L=!1}var me;if(typeof I=="function")me=function(){I(Q)};else if(typeof MessageChannel<"u"){var Re=new MessageChannel,ye=Re.port2;Re.port1.onmessage=Q,me=function(){ye.postMessage(null)}}else me=function(){E(Q,0)};function De(ke){R=ke,L||(L=!0,me())}function Ce(ke,Z){J=E(function(){ke(e.unstable_now())},Z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ke){ke.callback=null},e.unstable_continueExecution=function(){S||_||(S=!0,De(P))},e.unstable_forceFrameRate=function(ke){0>ke||125<ke?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):V=0<ke?Math.floor(1e3/ke):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(ke){switch(v){case 1:case 2:case 3:var Z=3;break;default:Z=v}var H=v;v=Z;try{return ke()}finally{v=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ke,Z){switch(ke){case 1:case 2:case 3:case 4:case 5:break;default:ke=3}var H=v;v=ke;try{return Z()}finally{v=H}},e.unstable_scheduleCallback=function(ke,Z,H){var ue=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?ue+H:ue):H=ue,ke){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=H+B,ke={id:m++,callback:Z,priorityLevel:ke,startTime:H,expirationTime:B,sortIndex:-1},H>ue?(ke.sortIndex=H,t(h,ke),n(d)===null&&ke===n(h)&&(T?(C(J),J=-1):T=!0,Ce(D,H-ue))):(ke.sortIndex=B,t(d,ke),S||_||(S=!0,De(P))),ke},e.unstable_shouldYield=te,e.unstable_wrapCallback=function(ke){var Z=v;return function(){var H=v;v=Z;try{return ke.apply(this,arguments)}finally{v=H}}}}(c0)),c0}var Dm;function i2(){return Dm||(Dm=1,u0.exports=r2()),u0.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pm;function a2(){if(Pm)return Xn;Pm=1;var e=od(),t=i2();function n(a){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+a,p=1;p<arguments.length;p++)l+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+a+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(a,l){o(a,l),o(a+"Capture",l)}function o(a,l){for(i[a]=l,a=0;a<l.length;a++)r.add(l[a])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},x={};function v(a){return d.call(x,a)?!0:d.call(m,a)?!1:h.test(a)?x[a]=!0:(m[a]=!0,!1)}function _(a,l,p,g){if(p!==null&&p.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return g?!1:p!==null?!p.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function S(a,l,p,g){if(l===null||typeof l>"u"||_(a,l,p,g))return!0;if(g)return!1;if(p!==null)switch(p.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function T(a,l,p,g,w,k,N){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=g,this.attributeNamespace=w,this.mustUseProperty=p,this.propertyName=a,this.type=l,this.sanitizeURL=k,this.removeEmptyString=N}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){E[a]=new T(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var l=a[0];E[l]=new T(l,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){E[a]=new T(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){E[a]=new T(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){E[a]=new T(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){E[a]=new T(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){E[a]=new T(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){E[a]=new T(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){E[a]=new T(a,5,!1,a.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function I(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var l=a.replace(C,I);E[l]=new T(l,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var l=a.replace(C,I);E[l]=new T(l,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var l=a.replace(C,I);E[l]=new T(l,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){E[a]=new T(a,1,!1,a.toLowerCase(),null,!1,!1)}),E.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){E[a]=new T(a,1,!1,a.toLowerCase(),null,!0,!0)});function A(a,l,p,g){var w=E.hasOwnProperty(l)?E[l]:null;(w!==null?w.type!==0:g||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(S(l,p,w,g)&&(p=null),g||w===null?v(l)&&(p===null?a.removeAttribute(l):a.setAttribute(l,""+p)):w.mustUseProperty?a[w.propertyName]=p===null?w.type===3?!1:"":p:(l=w.attributeName,g=w.attributeNamespace,p===null?a.removeAttribute(l):(w=w.type,p=w===3||w===4&&p===!0?"":""+p,g?a.setAttributeNS(g,l,p):a.setAttribute(l,p))))}var D=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,P=Symbol.for("react.element"),L=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),J=Symbol.for("react.strict_mode"),V=Symbol.for("react.profiler"),ne=Symbol.for("react.provider"),te=Symbol.for("react.context"),Q=Symbol.for("react.forward_ref"),me=Symbol.for("react.suspense"),Re=Symbol.for("react.suspense_list"),ye=Symbol.for("react.memo"),De=Symbol.for("react.lazy"),Ce=Symbol.for("react.offscreen"),ke=Symbol.iterator;function Z(a){return a===null||typeof a!="object"?null:(a=ke&&a[ke]||a["@@iterator"],typeof a=="function"?a:null)}var H=Object.assign,ue;function B(a){if(ue===void 0)try{throw Error()}catch(p){var l=p.stack.trim().match(/\n( *(at )?)/);ue=l&&l[1]||""}return`
`+ue+a}var X=!1;function q(a,l){if(!a||X)return"";X=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(fe){var g=fe}Reflect.construct(a,[],l)}else{try{l.call()}catch(fe){g=fe}a.call(l.prototype)}else{try{throw Error()}catch(fe){g=fe}a()}}catch(fe){if(fe&&g&&typeof fe.stack=="string"){for(var w=fe.stack.split(`
`),k=g.stack.split(`
`),N=w.length-1,W=k.length-1;1<=N&&0<=W&&w[N]!==k[W];)W--;for(;1<=N&&0<=W;N--,W--)if(w[N]!==k[W]){if(N!==1||W!==1)do if(N--,W--,0>W||w[N]!==k[W]){var Y=`
`+w[N].replace(" at new "," at ");return a.displayName&&Y.includes("<anonymous>")&&(Y=Y.replace("<anonymous>",a.displayName)),Y}while(1<=N&&0<=W);break}}}finally{X=!1,Error.prepareStackTrace=p}return(a=a?a.displayName||a.name:"")?B(a):""}function K(a){switch(a.tag){case 5:return B(a.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return a=q(a.type,!1),a;case 11:return a=q(a.type.render,!1),a;case 1:return a=q(a.type,!0),a;default:return""}}function le(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case R:return"Fragment";case L:return"Portal";case V:return"Profiler";case J:return"StrictMode";case me:return"Suspense";case Re:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case te:return(a.displayName||"Context")+".Consumer";case ne:return(a._context.displayName||"Context")+".Provider";case Q:var l=a.render;return a=a.displayName,a||(a=l.displayName||l.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case ye:return l=a.displayName||null,l!==null?l:le(a.type)||"Memo";case De:l=a._payload,a=a._init;try{return le(a(l))}catch{}}return null}function xe(a){var l=a.type;switch(a.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=l.render,a=a.displayName||a.name||"",l.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(l);case 8:return l===J?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ve(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function we(a){var l=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function Ae(a){var l=we(a)?"checked":"value",p=Object.getOwnPropertyDescriptor(a.constructor.prototype,l),g=""+a[l];if(!a.hasOwnProperty(l)&&typeof p<"u"&&typeof p.get=="function"&&typeof p.set=="function"){var w=p.get,k=p.set;return Object.defineProperty(a,l,{configurable:!0,get:function(){return w.call(this)},set:function(N){g=""+N,k.call(this,N)}}),Object.defineProperty(a,l,{enumerable:p.enumerable}),{getValue:function(){return g},setValue:function(N){g=""+N},stopTracking:function(){a._valueTracker=null,delete a[l]}}}}function Xe(a){a._valueTracker||(a._valueTracker=Ae(a))}function G(a){if(!a)return!1;var l=a._valueTracker;if(!l)return!0;var p=l.getValue(),g="";return a&&(g=we(a)?a.checked?"true":"false":a.value),a=g,a!==p?(l.setValue(a),!0):!1}function ft(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function et(a,l){var p=l.checked;return H({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:p??a._wrapperState.initialChecked})}function dt(a,l){var p=l.defaultValue==null?"":l.defaultValue,g=l.checked!=null?l.checked:l.defaultChecked;p=ve(l.value!=null?l.value:p),a._wrapperState={initialChecked:g,initialValue:p,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function tt(a,l){l=l.checked,l!=null&&A(a,"checked",l,!1)}function Be(a,l){tt(a,l);var p=ve(l.value),g=l.type;if(p!=null)g==="number"?(p===0&&a.value===""||a.value!=p)&&(a.value=""+p):a.value!==""+p&&(a.value=""+p);else if(g==="submit"||g==="reset"){a.removeAttribute("value");return}l.hasOwnProperty("value")?At(a,l.type,p):l.hasOwnProperty("defaultValue")&&At(a,l.type,ve(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(a.defaultChecked=!!l.defaultChecked)}function yt(a,l,p){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var g=l.type;if(!(g!=="submit"&&g!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+a._wrapperState.initialValue,p||l===a.value||(a.value=l),a.defaultValue=l}p=a.name,p!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,p!==""&&(a.name=p)}function At(a,l,p){(l!=="number"||ft(a.ownerDocument)!==a)&&(p==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+p&&(a.defaultValue=""+p))}var Lt=Array.isArray;function on(a,l,p,g){if(a=a.options,l){l={};for(var w=0;w<p.length;w++)l["$"+p[w]]=!0;for(p=0;p<a.length;p++)w=l.hasOwnProperty("$"+a[p].value),a[p].selected!==w&&(a[p].selected=w),w&&g&&(a[p].defaultSelected=!0)}else{for(p=""+ve(p),l=null,w=0;w<a.length;w++){if(a[w].value===p){a[w].selected=!0,g&&(a[w].defaultSelected=!0);return}l!==null||a[w].disabled||(l=a[w])}l!==null&&(l.selected=!0)}}function Dr(a,l){if(l.dangerouslySetInnerHTML!=null)throw Error(n(91));return H({},l,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function tr(a,l){var p=l.value;if(p==null){if(p=l.children,l=l.defaultValue,p!=null){if(l!=null)throw Error(n(92));if(Lt(p)){if(1<p.length)throw Error(n(93));p=p[0]}l=p}l==null&&(l=""),p=l}a._wrapperState={initialValue:ve(p)}}function Bt(a,l){var p=ve(l.value),g=ve(l.defaultValue);p!=null&&(p=""+p,p!==a.value&&(a.value=p),l.defaultValue==null&&a.defaultValue!==p&&(a.defaultValue=p)),g!=null&&(a.defaultValue=""+g)}function yn(a){var l=a.textContent;l===a._wrapperState.initialValue&&l!==""&&l!==null&&(a.value=l)}function Xt(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function nr(a,l){return a==null||a==="http://www.w3.org/1999/xhtml"?Xt(l):a==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Gt,En=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,p,g,w){MSApp.execUnsafeLocalFunction(function(){return a(l,p,g,w)})}:a}(function(a,l){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=l;else{for(Gt=Gt||document.createElement("div"),Gt.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=Gt.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;l.firstChild;)a.appendChild(l.firstChild)}});function Qe(a,l){if(l){var p=a.firstChild;if(p&&p===a.lastChild&&p.nodeType===3){p.nodeValue=l;return}}a.textContent=l}var gt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ot=["Webkit","ms","Moz","O"];Object.keys(gt).forEach(function(a){ot.forEach(function(l){l=l+a.charAt(0).toUpperCase()+a.substring(1),gt[l]=gt[a]})});function Ot(a,l,p){return l==null||typeof l=="boolean"||l===""?"":p||typeof l!="number"||l===0||gt.hasOwnProperty(a)&&gt[a]?(""+l).trim():l+"px"}function rr(a,l){a=a.style;for(var p in l)if(l.hasOwnProperty(p)){var g=p.indexOf("--")===0,w=Ot(p,l[p],g);p==="float"&&(p="cssFloat"),g?a.setProperty(p,w):a[p]=w}}var Qa=H({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function fa(a,l){if(l){if(Qa[a]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(n(137,a));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(n(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(n(61))}if(l.style!=null&&typeof l.style!="object")throw Error(n(62))}}function da(a,l){if(a.indexOf("-")===-1)return typeof l.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fi=null;function Ri(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var Di=null,jr=null,qr=null;function oi(a){if(a=vo(a)){if(typeof Di!="function")throw Error(n(280));var l=a.stateNode;l&&(l=bl(l),Di(a.stateNode,a.type,l))}}function es(a){jr?qr?qr.push(a):qr=[a]:jr=a}function ts(){if(jr){var a=jr,l=qr;if(qr=jr=null,oi(a),l)for(a=0;a<l.length;a++)oi(l[a])}}function ns(a,l){return a(l)}function rs(){}var ha=!1;function is(a,l,p){if(ha)return a(l,p);ha=!0;try{return ns(a,l,p)}finally{ha=!1,(jr!==null||qr!==null)&&(rs(),ts())}}function li(a,l){var p=a.stateNode;if(p===null)return null;var g=bl(p);if(g===null)return null;p=g[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(a=a.type,g=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!g;break e;default:a=!1}if(a)return null;if(p&&typeof p!="function")throw Error(n(231,l,typeof p));return p}var pa=!1;if(u)try{var Pr={};Object.defineProperty(Pr,"passive",{get:function(){pa=!0}}),window.addEventListener("test",Pr,Pr),window.removeEventListener("test",Pr,Pr)}catch{pa=!1}function Qs(a,l,p,g,w,k,N,W,Y){var fe=Array.prototype.slice.call(arguments,3);try{l.apply(p,fe)}catch(Ee){this.onError(Ee)}}var ui=!1,Pi=null,F=!1,U=null,M={onError:function(a){ui=!0,Pi=a}};function O(a,l,p,g,w,k,N,W,Y){ui=!1,Pi=null,Qs.apply(M,arguments)}function z(a,l,p,g,w,k,N,W,Y){if(O.apply(this,arguments),ui){if(ui){var fe=Pi;ui=!1,Pi=null}else throw Error(n(198));F||(F=!0,U=fe)}}function b(a){var l=a,p=a;if(a.alternate)for(;l.return;)l=l.return;else{a=l;do l=a,(l.flags&4098)!==0&&(p=l.return),a=l.return;while(a)}return l.tag===3?p:null}function se(a){if(a.tag===13){var l=a.memoizedState;if(l===null&&(a=a.alternate,a!==null&&(l=a.memoizedState)),l!==null)return l.dehydrated}return null}function pe(a){if(b(a)!==a)throw Error(n(188))}function ae(a){var l=a.alternate;if(!l){if(l=b(a),l===null)throw Error(n(188));return l!==a?null:a}for(var p=a,g=l;;){var w=p.return;if(w===null)break;var k=w.alternate;if(k===null){if(g=w.return,g!==null){p=g;continue}break}if(w.child===k.child){for(k=w.child;k;){if(k===p)return pe(w),a;if(k===g)return pe(w),l;k=k.sibling}throw Error(n(188))}if(p.return!==g.return)p=w,g=k;else{for(var N=!1,W=w.child;W;){if(W===p){N=!0,p=w,g=k;break}if(W===g){N=!0,g=w,p=k;break}W=W.sibling}if(!N){for(W=k.child;W;){if(W===p){N=!0,p=k,g=w;break}if(W===g){N=!0,g=k,p=w;break}W=W.sibling}if(!N)throw Error(n(189))}}if(p.alternate!==g)throw Error(n(190))}if(p.tag!==3)throw Error(n(188));return p.stateNode.current===p?a:l}function ce(a){return a=ae(a),a!==null?j(a):null}function j(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var l=j(a);if(l!==null)return l;a=a.sibling}return null}var re=t.unstable_scheduleCallback,de=t.unstable_cancelCallback,Fe=t.unstable_shouldYield,Ie=t.unstable_requestPaint,_e=t.unstable_now,je=t.unstable_getCurrentPriorityLevel,xt=t.unstable_ImmediatePriority,ht=t.unstable_UserBlockingPriority,It=t.unstable_NormalPriority,Mr=t.unstable_LowPriority,Kr=t.unstable_IdlePriority,pr=null,tn=null;function ma(a){if(tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(pr,a,void 0,(a.current.flags&128)===128)}catch{}}var zt=Math.clz32?Math.clz32:kl,_l=Math.log,Tl=Math.LN2;function kl(a){return a>>>=0,a===0?32:31-(_l(a)/Tl|0)|0}var Jr=64,ga=4194304;function xa(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Sl(a,l){var p=a.pendingLanes;if(p===0)return 0;var g=0,w=a.suspendedLanes,k=a.pingedLanes,N=p&268435455;if(N!==0){var W=N&~w;W!==0?g=xa(W):(k&=N,k!==0&&(g=xa(k)))}else N=p&~w,N!==0?g=xa(N):k!==0&&(g=xa(k));if(g===0)return 0;if(l!==0&&l!==g&&(l&w)===0&&(w=g&-g,k=l&-l,w>=k||w===16&&(k&4194240)!==0))return l;if((g&4)!==0&&(g|=p&16),l=a.entangledLanes,l!==0)for(a=a.entanglements,l&=g;0<l;)p=31-zt(l),w=1<<p,g|=a[p],l&=~w;return g}function yw(a,l){switch(a){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ww(a,l){for(var p=a.suspendedLanes,g=a.pingedLanes,w=a.expirationTimes,k=a.pendingLanes;0<k;){var N=31-zt(k),W=1<<N,Y=w[N];Y===-1?((W&p)===0||(W&g)!==0)&&(w[N]=yw(W,l)):Y<=l&&(a.expiredLanes|=W),k&=~W}}function Cc(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function rh(){var a=Jr;return Jr<<=1,(Jr&4194240)===0&&(Jr=64),a}function Ac(a){for(var l=[],p=0;31>p;p++)l.push(a);return l}function eo(a,l,p){a.pendingLanes|=l,l!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,l=31-zt(l),a[l]=p}function _w(a,l){var p=a.pendingLanes&~l;a.pendingLanes=l,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=l,a.mutableReadLanes&=l,a.entangledLanes&=l,l=a.entanglements;var g=a.eventTimes;for(a=a.expirationTimes;0<p;){var w=31-zt(p),k=1<<w;l[w]=0,g[w]=-1,a[w]=-1,p&=~k}}function Ic(a,l){var p=a.entangledLanes|=l;for(a=a.entanglements;p;){var g=31-zt(p),w=1<<g;w&l|a[g]&l&&(a[g]|=l),p&=~w}}var wt=0;function ih(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var ah,Nc,sh,oh,lh,Fc=!1,El=[],Mi=null,Li=null,Bi=null,to=new Map,no=new Map,Oi=[],Tw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function uh(a,l){switch(a){case"focusin":case"focusout":Mi=null;break;case"dragenter":case"dragleave":Li=null;break;case"mouseover":case"mouseout":Bi=null;break;case"pointerover":case"pointerout":to.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":no.delete(l.pointerId)}}function ro(a,l,p,g,w,k){return a===null||a.nativeEvent!==k?(a={blockedOn:l,domEventName:p,eventSystemFlags:g,nativeEvent:k,targetContainers:[w]},l!==null&&(l=vo(l),l!==null&&Nc(l)),a):(a.eventSystemFlags|=g,l=a.targetContainers,w!==null&&l.indexOf(w)===-1&&l.push(w),a)}function kw(a,l,p,g,w){switch(l){case"focusin":return Mi=ro(Mi,a,l,p,g,w),!0;case"dragenter":return Li=ro(Li,a,l,p,g,w),!0;case"mouseover":return Bi=ro(Bi,a,l,p,g,w),!0;case"pointerover":var k=w.pointerId;return to.set(k,ro(to.get(k)||null,a,l,p,g,w)),!0;case"gotpointercapture":return k=w.pointerId,no.set(k,ro(no.get(k)||null,a,l,p,g,w)),!0}return!1}function ch(a){var l=va(a.target);if(l!==null){var p=b(l);if(p!==null){if(l=p.tag,l===13){if(l=se(p),l!==null){a.blockedOn=l,lh(a.priority,function(){sh(p)});return}}else if(l===3&&p.stateNode.current.memoizedState.isDehydrated){a.blockedOn=p.tag===3?p.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Cl(a){if(a.blockedOn!==null)return!1;for(var l=a.targetContainers;0<l.length;){var p=Dc(a.domEventName,a.eventSystemFlags,l[0],a.nativeEvent);if(p===null){p=a.nativeEvent;var g=new p.constructor(p.type,p);Fi=g,p.target.dispatchEvent(g),Fi=null}else return l=vo(p),l!==null&&Nc(l),a.blockedOn=p,!1;l.shift()}return!0}function fh(a,l,p){Cl(a)&&p.delete(l)}function Sw(){Fc=!1,Mi!==null&&Cl(Mi)&&(Mi=null),Li!==null&&Cl(Li)&&(Li=null),Bi!==null&&Cl(Bi)&&(Bi=null),to.forEach(fh),no.forEach(fh)}function io(a,l){a.blockedOn===l&&(a.blockedOn=null,Fc||(Fc=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Sw)))}function ao(a){function l(w){return io(w,a)}if(0<El.length){io(El[0],a);for(var p=1;p<El.length;p++){var g=El[p];g.blockedOn===a&&(g.blockedOn=null)}}for(Mi!==null&&io(Mi,a),Li!==null&&io(Li,a),Bi!==null&&io(Bi,a),to.forEach(l),no.forEach(l),p=0;p<Oi.length;p++)g=Oi[p],g.blockedOn===a&&(g.blockedOn=null);for(;0<Oi.length&&(p=Oi[0],p.blockedOn===null);)ch(p),p.blockedOn===null&&Oi.shift()}var as=D.ReactCurrentBatchConfig,Al=!0;function Ew(a,l,p,g){var w=wt,k=as.transition;as.transition=null;try{wt=1,Rc(a,l,p,g)}finally{wt=w,as.transition=k}}function Cw(a,l,p,g){var w=wt,k=as.transition;as.transition=null;try{wt=4,Rc(a,l,p,g)}finally{wt=w,as.transition=k}}function Rc(a,l,p,g){if(Al){var w=Dc(a,l,p,g);if(w===null)Jc(a,l,g,Il,p),uh(a,g);else if(kw(w,a,l,p,g))g.stopPropagation();else if(uh(a,g),l&4&&-1<Tw.indexOf(a)){for(;w!==null;){var k=vo(w);if(k!==null&&ah(k),k=Dc(a,l,p,g),k===null&&Jc(a,l,g,Il,p),k===w)break;w=k}w!==null&&g.stopPropagation()}else Jc(a,l,g,null,p)}}var Il=null;function Dc(a,l,p,g){if(Il=null,a=Ri(g),a=va(a),a!==null)if(l=b(a),l===null)a=null;else if(p=l.tag,p===13){if(a=se(l),a!==null)return a;a=null}else if(p===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;a=null}else l!==a&&(a=null);return Il=a,null}function dh(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(je()){case xt:return 1;case ht:return 4;case It:case Mr:return 16;case Kr:return 536870912;default:return 16}default:return 16}}var Ui=null,Pc=null,Nl=null;function hh(){if(Nl)return Nl;var a,l=Pc,p=l.length,g,w="value"in Ui?Ui.value:Ui.textContent,k=w.length;for(a=0;a<p&&l[a]===w[a];a++);var N=p-a;for(g=1;g<=N&&l[p-g]===w[k-g];g++);return Nl=w.slice(a,1<g?1-g:void 0)}function Fl(a){var l=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&l===13&&(a=13)):a=l,a===10&&(a=13),32<=a||a===13?a:0}function Rl(){return!0}function ph(){return!1}function ir(a){function l(p,g,w,k,N){this._reactName=p,this._targetInst=w,this.type=g,this.nativeEvent=k,this.target=N,this.currentTarget=null;for(var W in a)a.hasOwnProperty(W)&&(p=a[W],this[W]=p?p(k):k[W]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Rl:ph,this.isPropagationStopped=ph,this}return H(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var p=this.nativeEvent;p&&(p.preventDefault?p.preventDefault():typeof p.returnValue!="unknown"&&(p.returnValue=!1),this.isDefaultPrevented=Rl)},stopPropagation:function(){var p=this.nativeEvent;p&&(p.stopPropagation?p.stopPropagation():typeof p.cancelBubble!="unknown"&&(p.cancelBubble=!0),this.isPropagationStopped=Rl)},persist:function(){},isPersistent:Rl}),l}var ss={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Mc=ir(ss),so=H({},ss,{view:0,detail:0}),Aw=ir(so),Lc,Bc,oo,Dl=H({},so,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uc,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==oo&&(oo&&a.type==="mousemove"?(Lc=a.screenX-oo.screenX,Bc=a.screenY-oo.screenY):Bc=Lc=0,oo=a),Lc)},movementY:function(a){return"movementY"in a?a.movementY:Bc}}),mh=ir(Dl),Iw=H({},Dl,{dataTransfer:0}),Nw=ir(Iw),Fw=H({},so,{relatedTarget:0}),Oc=ir(Fw),Rw=H({},ss,{animationName:0,elapsedTime:0,pseudoElement:0}),Dw=ir(Rw),Pw=H({},ss,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Mw=ir(Pw),Lw=H({},ss,{data:0}),gh=ir(Lw),Bw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ow={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Uw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zw(a){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(a):(a=Uw[a])?!!l[a]:!1}function Uc(){return zw}var bw=H({},so,{key:function(a){if(a.key){var l=Bw[a.key]||a.key;if(l!=="Unidentified")return l}return a.type==="keypress"?(a=Fl(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Ow[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uc,charCode:function(a){return a.type==="keypress"?Fl(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Fl(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),Vw=ir(bw),Hw=H({},Dl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xh=ir(Hw),Ww=H({},so,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uc}),Gw=ir(Ww),$w=H({},ss,{propertyName:0,elapsedTime:0,pseudoElement:0}),jw=ir($w),qw=H({},Dl,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Kw=ir(qw),Jw=[9,13,27,32],zc=u&&"CompositionEvent"in window,lo=null;u&&"documentMode"in document&&(lo=document.documentMode);var Xw=u&&"TextEvent"in window&&!lo,vh=u&&(!zc||lo&&8<lo&&11>=lo),yh=" ",wh=!1;function _h(a,l){switch(a){case"keyup":return Jw.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Th(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var os=!1;function Yw(a,l){switch(a){case"compositionend":return Th(l);case"keypress":return l.which!==32?null:(wh=!0,yh);case"textInput":return a=l.data,a===yh&&wh?null:a;default:return null}}function Zw(a,l){if(os)return a==="compositionend"||!zc&&_h(a,l)?(a=hh(),Nl=Pc=Ui=null,os=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return vh&&l.locale!=="ko"?null:l.data;default:return null}}var Qw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function kh(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l==="input"?!!Qw[a.type]:l==="textarea"}function Sh(a,l,p,g){es(g),l=Ol(l,"onChange"),0<l.length&&(p=new Mc("onChange","change",null,p,g),a.push({event:p,listeners:l}))}var uo=null,co=null;function e_(a){Hh(a,0)}function Pl(a){var l=ds(a);if(G(l))return a}function t_(a,l){if(a==="change")return l}var Eh=!1;if(u){var bc;if(u){var Vc="oninput"in document;if(!Vc){var Ch=document.createElement("div");Ch.setAttribute("oninput","return;"),Vc=typeof Ch.oninput=="function"}bc=Vc}else bc=!1;Eh=bc&&(!document.documentMode||9<document.documentMode)}function Ah(){uo&&(uo.detachEvent("onpropertychange",Ih),co=uo=null)}function Ih(a){if(a.propertyName==="value"&&Pl(co)){var l=[];Sh(l,co,a,Ri(a)),is(e_,l)}}function n_(a,l,p){a==="focusin"?(Ah(),uo=l,co=p,uo.attachEvent("onpropertychange",Ih)):a==="focusout"&&Ah()}function r_(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Pl(co)}function i_(a,l){if(a==="click")return Pl(l)}function a_(a,l){if(a==="input"||a==="change")return Pl(l)}function s_(a,l){return a===l&&(a!==0||1/a===1/l)||a!==a&&l!==l}var Lr=typeof Object.is=="function"?Object.is:s_;function fo(a,l){if(Lr(a,l))return!0;if(typeof a!="object"||a===null||typeof l!="object"||l===null)return!1;var p=Object.keys(a),g=Object.keys(l);if(p.length!==g.length)return!1;for(g=0;g<p.length;g++){var w=p[g];if(!d.call(l,w)||!Lr(a[w],l[w]))return!1}return!0}function Nh(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Fh(a,l){var p=Nh(a);a=0;for(var g;p;){if(p.nodeType===3){if(g=a+p.textContent.length,a<=l&&g>=l)return{node:p,offset:l-a};a=g}e:{for(;p;){if(p.nextSibling){p=p.nextSibling;break e}p=p.parentNode}p=void 0}p=Nh(p)}}function Rh(a,l){return a&&l?a===l?!0:a&&a.nodeType===3?!1:l&&l.nodeType===3?Rh(a,l.parentNode):"contains"in a?a.contains(l):a.compareDocumentPosition?!!(a.compareDocumentPosition(l)&16):!1:!1}function Dh(){for(var a=window,l=ft();l instanceof a.HTMLIFrameElement;){try{var p=typeof l.contentWindow.location.href=="string"}catch{p=!1}if(p)a=l.contentWindow;else break;l=ft(a.document)}return l}function Hc(a){var l=a&&a.nodeName&&a.nodeName.toLowerCase();return l&&(l==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||l==="textarea"||a.contentEditable==="true")}function o_(a){var l=Dh(),p=a.focusedElem,g=a.selectionRange;if(l!==p&&p&&p.ownerDocument&&Rh(p.ownerDocument.documentElement,p)){if(g!==null&&Hc(p)){if(l=g.start,a=g.end,a===void 0&&(a=l),"selectionStart"in p)p.selectionStart=l,p.selectionEnd=Math.min(a,p.value.length);else if(a=(l=p.ownerDocument||document)&&l.defaultView||window,a.getSelection){a=a.getSelection();var w=p.textContent.length,k=Math.min(g.start,w);g=g.end===void 0?k:Math.min(g.end,w),!a.extend&&k>g&&(w=g,g=k,k=w),w=Fh(p,k);var N=Fh(p,g);w&&N&&(a.rangeCount!==1||a.anchorNode!==w.node||a.anchorOffset!==w.offset||a.focusNode!==N.node||a.focusOffset!==N.offset)&&(l=l.createRange(),l.setStart(w.node,w.offset),a.removeAllRanges(),k>g?(a.addRange(l),a.extend(N.node,N.offset)):(l.setEnd(N.node,N.offset),a.addRange(l)))}}for(l=[],a=p;a=a.parentNode;)a.nodeType===1&&l.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof p.focus=="function"&&p.focus(),p=0;p<l.length;p++)a=l[p],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var l_=u&&"documentMode"in document&&11>=document.documentMode,ls=null,Wc=null,ho=null,Gc=!1;function Ph(a,l,p){var g=p.window===p?p.document:p.nodeType===9?p:p.ownerDocument;Gc||ls==null||ls!==ft(g)||(g=ls,"selectionStart"in g&&Hc(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),ho&&fo(ho,g)||(ho=g,g=Ol(Wc,"onSelect"),0<g.length&&(l=new Mc("onSelect","select",null,l,p),a.push({event:l,listeners:g}),l.target=ls)))}function Ml(a,l){var p={};return p[a.toLowerCase()]=l.toLowerCase(),p["Webkit"+a]="webkit"+l,p["Moz"+a]="moz"+l,p}var us={animationend:Ml("Animation","AnimationEnd"),animationiteration:Ml("Animation","AnimationIteration"),animationstart:Ml("Animation","AnimationStart"),transitionend:Ml("Transition","TransitionEnd")},$c={},Mh={};u&&(Mh=document.createElement("div").style,"AnimationEvent"in window||(delete us.animationend.animation,delete us.animationiteration.animation,delete us.animationstart.animation),"TransitionEvent"in window||delete us.transitionend.transition);function Ll(a){if($c[a])return $c[a];if(!us[a])return a;var l=us[a],p;for(p in l)if(l.hasOwnProperty(p)&&p in Mh)return $c[a]=l[p];return a}var Lh=Ll("animationend"),Bh=Ll("animationiteration"),Oh=Ll("animationstart"),Uh=Ll("transitionend"),zh=new Map,bh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zi(a,l){zh.set(a,l),s(l,[a])}for(var jc=0;jc<bh.length;jc++){var qc=bh[jc],u_=qc.toLowerCase(),c_=qc[0].toUpperCase()+qc.slice(1);zi(u_,"on"+c_)}zi(Lh,"onAnimationEnd"),zi(Bh,"onAnimationIteration"),zi(Oh,"onAnimationStart"),zi("dblclick","onDoubleClick"),zi("focusin","onFocus"),zi("focusout","onBlur"),zi(Uh,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var po="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),f_=new Set("cancel close invalid load scroll toggle".split(" ").concat(po));function Vh(a,l,p){var g=a.type||"unknown-event";a.currentTarget=p,z(g,l,void 0,a),a.currentTarget=null}function Hh(a,l){l=(l&4)!==0;for(var p=0;p<a.length;p++){var g=a[p],w=g.event;g=g.listeners;e:{var k=void 0;if(l)for(var N=g.length-1;0<=N;N--){var W=g[N],Y=W.instance,fe=W.currentTarget;if(W=W.listener,Y!==k&&w.isPropagationStopped())break e;Vh(w,W,fe),k=Y}else for(N=0;N<g.length;N++){if(W=g[N],Y=W.instance,fe=W.currentTarget,W=W.listener,Y!==k&&w.isPropagationStopped())break e;Vh(w,W,fe),k=Y}}}if(F)throw a=U,F=!1,U=null,a}function Nt(a,l){var p=l[tf];p===void 0&&(p=l[tf]=new Set);var g=a+"__bubble";p.has(g)||(Wh(l,a,2,!1),p.add(g))}function Kc(a,l,p){var g=0;l&&(g|=4),Wh(p,a,g,l)}var Bl="_reactListening"+Math.random().toString(36).slice(2);function mo(a){if(!a[Bl]){a[Bl]=!0,r.forEach(function(p){p!=="selectionchange"&&(f_.has(p)||Kc(p,!1,a),Kc(p,!0,a))});var l=a.nodeType===9?a:a.ownerDocument;l===null||l[Bl]||(l[Bl]=!0,Kc("selectionchange",!1,l))}}function Wh(a,l,p,g){switch(dh(l)){case 1:var w=Ew;break;case 4:w=Cw;break;default:w=Rc}p=w.bind(null,l,p,a),w=void 0,!pa||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(w=!0),g?w!==void 0?a.addEventListener(l,p,{capture:!0,passive:w}):a.addEventListener(l,p,!0):w!==void 0?a.addEventListener(l,p,{passive:w}):a.addEventListener(l,p,!1)}function Jc(a,l,p,g,w){var k=g;if((l&1)===0&&(l&2)===0&&g!==null)e:for(;;){if(g===null)return;var N=g.tag;if(N===3||N===4){var W=g.stateNode.containerInfo;if(W===w||W.nodeType===8&&W.parentNode===w)break;if(N===4)for(N=g.return;N!==null;){var Y=N.tag;if((Y===3||Y===4)&&(Y=N.stateNode.containerInfo,Y===w||Y.nodeType===8&&Y.parentNode===w))return;N=N.return}for(;W!==null;){if(N=va(W),N===null)return;if(Y=N.tag,Y===5||Y===6){g=k=N;continue e}W=W.parentNode}}g=g.return}is(function(){var fe=k,Ee=Ri(p),Ne=[];e:{var Se=zh.get(a);if(Se!==void 0){var Oe=Mc,ze=a;switch(a){case"keypress":if(Fl(p)===0)break e;case"keydown":case"keyup":Oe=Vw;break;case"focusin":ze="focus",Oe=Oc;break;case"focusout":ze="blur",Oe=Oc;break;case"beforeblur":case"afterblur":Oe=Oc;break;case"click":if(p.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Oe=mh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Oe=Nw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Oe=Gw;break;case Lh:case Bh:case Oh:Oe=Dw;break;case Uh:Oe=jw;break;case"scroll":Oe=Aw;break;case"wheel":Oe=Kw;break;case"copy":case"cut":case"paste":Oe=Mw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Oe=xh}var be=(l&4)!==0,Yt=!be&&a==="scroll",ie=be?Se!==null?Se+"Capture":null:Se;be=[];for(var ee=fe,oe;ee!==null;){oe=ee;var Pe=oe.stateNode;if(oe.tag===5&&Pe!==null&&(oe=Pe,ie!==null&&(Pe=li(ee,ie),Pe!=null&&be.push(go(ee,Pe,oe)))),Yt)break;ee=ee.return}0<be.length&&(Se=new Oe(Se,ze,null,p,Ee),Ne.push({event:Se,listeners:be}))}}if((l&7)===0){e:{if(Se=a==="mouseover"||a==="pointerover",Oe=a==="mouseout"||a==="pointerout",Se&&p!==Fi&&(ze=p.relatedTarget||p.fromElement)&&(va(ze)||ze[ci]))break e;if((Oe||Se)&&(Se=Ee.window===Ee?Ee:(Se=Ee.ownerDocument)?Se.defaultView||Se.parentWindow:window,Oe?(ze=p.relatedTarget||p.toElement,Oe=fe,ze=ze?va(ze):null,ze!==null&&(Yt=b(ze),ze!==Yt||ze.tag!==5&&ze.tag!==6)&&(ze=null)):(Oe=null,ze=fe),Oe!==ze)){if(be=mh,Pe="onMouseLeave",ie="onMouseEnter",ee="mouse",(a==="pointerout"||a==="pointerover")&&(be=xh,Pe="onPointerLeave",ie="onPointerEnter",ee="pointer"),Yt=Oe==null?Se:ds(Oe),oe=ze==null?Se:ds(ze),Se=new be(Pe,ee+"leave",Oe,p,Ee),Se.target=Yt,Se.relatedTarget=oe,Pe=null,va(Ee)===fe&&(be=new be(ie,ee+"enter",ze,p,Ee),be.target=oe,be.relatedTarget=Yt,Pe=be),Yt=Pe,Oe&&ze)t:{for(be=Oe,ie=ze,ee=0,oe=be;oe;oe=cs(oe))ee++;for(oe=0,Pe=ie;Pe;Pe=cs(Pe))oe++;for(;0<ee-oe;)be=cs(be),ee--;for(;0<oe-ee;)ie=cs(ie),oe--;for(;ee--;){if(be===ie||ie!==null&&be===ie.alternate)break t;be=cs(be),ie=cs(ie)}be=null}else be=null;Oe!==null&&Gh(Ne,Se,Oe,be,!1),ze!==null&&Yt!==null&&Gh(Ne,Yt,ze,be,!0)}}e:{if(Se=fe?ds(fe):window,Oe=Se.nodeName&&Se.nodeName.toLowerCase(),Oe==="select"||Oe==="input"&&Se.type==="file")var Ve=t_;else if(kh(Se))if(Eh)Ve=a_;else{Ve=r_;var Ge=n_}else(Oe=Se.nodeName)&&Oe.toLowerCase()==="input"&&(Se.type==="checkbox"||Se.type==="radio")&&(Ve=i_);if(Ve&&(Ve=Ve(a,fe))){Sh(Ne,Ve,p,Ee);break e}Ge&&Ge(a,Se,fe),a==="focusout"&&(Ge=Se._wrapperState)&&Ge.controlled&&Se.type==="number"&&At(Se,"number",Se.value)}switch(Ge=fe?ds(fe):window,a){case"focusin":(kh(Ge)||Ge.contentEditable==="true")&&(ls=Ge,Wc=fe,ho=null);break;case"focusout":ho=Wc=ls=null;break;case"mousedown":Gc=!0;break;case"contextmenu":case"mouseup":case"dragend":Gc=!1,Ph(Ne,p,Ee);break;case"selectionchange":if(l_)break;case"keydown":case"keyup":Ph(Ne,p,Ee)}var $e;if(zc)e:{switch(a){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else os?_h(a,p)&&(Ze="onCompositionEnd"):a==="keydown"&&p.keyCode===229&&(Ze="onCompositionStart");Ze&&(vh&&p.locale!=="ko"&&(os||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&os&&($e=hh()):(Ui=Ee,Pc="value"in Ui?Ui.value:Ui.textContent,os=!0)),Ge=Ol(fe,Ze),0<Ge.length&&(Ze=new gh(Ze,a,null,p,Ee),Ne.push({event:Ze,listeners:Ge}),$e?Ze.data=$e:($e=Th(p),$e!==null&&(Ze.data=$e)))),($e=Xw?Yw(a,p):Zw(a,p))&&(fe=Ol(fe,"onBeforeInput"),0<fe.length&&(Ee=new gh("onBeforeInput","beforeinput",null,p,Ee),Ne.push({event:Ee,listeners:fe}),Ee.data=$e))}Hh(Ne,l)})}function go(a,l,p){return{instance:a,listener:l,currentTarget:p}}function Ol(a,l){for(var p=l+"Capture",g=[];a!==null;){var w=a,k=w.stateNode;w.tag===5&&k!==null&&(w=k,k=li(a,p),k!=null&&g.unshift(go(a,k,w)),k=li(a,l),k!=null&&g.push(go(a,k,w))),a=a.return}return g}function cs(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function Gh(a,l,p,g,w){for(var k=l._reactName,N=[];p!==null&&p!==g;){var W=p,Y=W.alternate,fe=W.stateNode;if(Y!==null&&Y===g)break;W.tag===5&&fe!==null&&(W=fe,w?(Y=li(p,k),Y!=null&&N.unshift(go(p,Y,W))):w||(Y=li(p,k),Y!=null&&N.push(go(p,Y,W)))),p=p.return}N.length!==0&&a.push({event:l,listeners:N})}var d_=/\r\n?/g,h_=/\u0000|\uFFFD/g;function $h(a){return(typeof a=="string"?a:""+a).replace(d_,`
`).replace(h_,"")}function Ul(a,l,p){if(l=$h(l),$h(a)!==l&&p)throw Error(n(425))}function zl(){}var Xc=null,Yc=null;function Zc(a,l){return a==="textarea"||a==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Qc=typeof setTimeout=="function"?setTimeout:void 0,p_=typeof clearTimeout=="function"?clearTimeout:void 0,jh=typeof Promise=="function"?Promise:void 0,m_=typeof queueMicrotask=="function"?queueMicrotask:typeof jh<"u"?function(a){return jh.resolve(null).then(a).catch(g_)}:Qc;function g_(a){setTimeout(function(){throw a})}function ef(a,l){var p=l,g=0;do{var w=p.nextSibling;if(a.removeChild(p),w&&w.nodeType===8)if(p=w.data,p==="/$"){if(g===0){a.removeChild(w),ao(l);return}g--}else p!=="$"&&p!=="$?"&&p!=="$!"||g++;p=w}while(p);ao(l)}function bi(a){for(;a!=null;a=a.nextSibling){var l=a.nodeType;if(l===1||l===3)break;if(l===8){if(l=a.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return a}function qh(a){a=a.previousSibling;for(var l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="$"||p==="$!"||p==="$?"){if(l===0)return a;l--}else p==="/$"&&l++}a=a.previousSibling}return null}var fs=Math.random().toString(36).slice(2),Xr="__reactFiber$"+fs,xo="__reactProps$"+fs,ci="__reactContainer$"+fs,tf="__reactEvents$"+fs,x_="__reactListeners$"+fs,v_="__reactHandles$"+fs;function va(a){var l=a[Xr];if(l)return l;for(var p=a.parentNode;p;){if(l=p[ci]||p[Xr]){if(p=l.alternate,l.child!==null||p!==null&&p.child!==null)for(a=qh(a);a!==null;){if(p=a[Xr])return p;a=qh(a)}return l}a=p,p=a.parentNode}return null}function vo(a){return a=a[Xr]||a[ci],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ds(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(n(33))}function bl(a){return a[xo]||null}var nf=[],hs=-1;function Vi(a){return{current:a}}function Ft(a){0>hs||(a.current=nf[hs],nf[hs]=null,hs--)}function Ct(a,l){hs++,nf[hs]=a.current,a.current=l}var Hi={},Cn=Vi(Hi),$n=Vi(!1),ya=Hi;function ps(a,l){var p=a.type.contextTypes;if(!p)return Hi;var g=a.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===l)return g.__reactInternalMemoizedMaskedChildContext;var w={},k;for(k in p)w[k]=l[k];return g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=l,a.__reactInternalMemoizedMaskedChildContext=w),w}function jn(a){return a=a.childContextTypes,a!=null}function Vl(){Ft($n),Ft(Cn)}function Kh(a,l,p){if(Cn.current!==Hi)throw Error(n(168));Ct(Cn,l),Ct($n,p)}function Jh(a,l,p){var g=a.stateNode;if(l=l.childContextTypes,typeof g.getChildContext!="function")return p;g=g.getChildContext();for(var w in g)if(!(w in l))throw Error(n(108,xe(a)||"Unknown",w));return H({},p,g)}function Hl(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||Hi,ya=Cn.current,Ct(Cn,a),Ct($n,$n.current),!0}function Xh(a,l,p){var g=a.stateNode;if(!g)throw Error(n(169));p?(a=Jh(a,l,ya),g.__reactInternalMemoizedMergedChildContext=a,Ft($n),Ft(Cn),Ct(Cn,a)):Ft($n),Ct($n,p)}var fi=null,Wl=!1,rf=!1;function Yh(a){fi===null?fi=[a]:fi.push(a)}function y_(a){Wl=!0,Yh(a)}function Wi(){if(!rf&&fi!==null){rf=!0;var a=0,l=wt;try{var p=fi;for(wt=1;a<p.length;a++){var g=p[a];do g=g(!0);while(g!==null)}fi=null,Wl=!1}catch(w){throw fi!==null&&(fi=fi.slice(a+1)),re(xt,Wi),w}finally{wt=l,rf=!1}}return null}var ms=[],gs=0,Gl=null,$l=0,mr=[],gr=0,wa=null,di=1,hi="";function _a(a,l){ms[gs++]=$l,ms[gs++]=Gl,Gl=a,$l=l}function Zh(a,l,p){mr[gr++]=di,mr[gr++]=hi,mr[gr++]=wa,wa=a;var g=di;a=hi;var w=32-zt(g)-1;g&=~(1<<w),p+=1;var k=32-zt(l)+w;if(30<k){var N=w-w%5;k=(g&(1<<N)-1).toString(32),g>>=N,w-=N,di=1<<32-zt(l)+w|p<<w|g,hi=k+a}else di=1<<k|p<<w|g,hi=a}function af(a){a.return!==null&&(_a(a,1),Zh(a,1,0))}function sf(a){for(;a===Gl;)Gl=ms[--gs],ms[gs]=null,$l=ms[--gs],ms[gs]=null;for(;a===wa;)wa=mr[--gr],mr[gr]=null,hi=mr[--gr],mr[gr]=null,di=mr[--gr],mr[gr]=null}var ar=null,sr=null,Ut=!1,Br=null;function Qh(a,l){var p=wr(5,null,null,0);p.elementType="DELETED",p.stateNode=l,p.return=a,l=a.deletions,l===null?(a.deletions=[p],a.flags|=16):l.push(p)}function ep(a,l){switch(a.tag){case 5:var p=a.type;return l=l.nodeType!==1||p.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(a.stateNode=l,ar=a,sr=bi(l.firstChild),!0):!1;case 6:return l=a.pendingProps===""||l.nodeType!==3?null:l,l!==null?(a.stateNode=l,ar=a,sr=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(p=wa!==null?{id:di,overflow:hi}:null,a.memoizedState={dehydrated:l,treeContext:p,retryLane:1073741824},p=wr(18,null,null,0),p.stateNode=l,p.return=a,a.child=p,ar=a,sr=null,!0):!1;default:return!1}}function of(a){return(a.mode&1)!==0&&(a.flags&128)===0}function lf(a){if(Ut){var l=sr;if(l){var p=l;if(!ep(a,l)){if(of(a))throw Error(n(418));l=bi(p.nextSibling);var g=ar;l&&ep(a,l)?Qh(g,p):(a.flags=a.flags&-4097|2,Ut=!1,ar=a)}}else{if(of(a))throw Error(n(418));a.flags=a.flags&-4097|2,Ut=!1,ar=a}}}function tp(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;ar=a}function jl(a){if(a!==ar)return!1;if(!Ut)return tp(a),Ut=!0,!1;var l;if((l=a.tag!==3)&&!(l=a.tag!==5)&&(l=a.type,l=l!=="head"&&l!=="body"&&!Zc(a.type,a.memoizedProps)),l&&(l=sr)){if(of(a))throw np(),Error(n(418));for(;l;)Qh(a,l),l=bi(l.nextSibling)}if(tp(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(n(317));e:{for(a=a.nextSibling,l=0;a;){if(a.nodeType===8){var p=a.data;if(p==="/$"){if(l===0){sr=bi(a.nextSibling);break e}l--}else p!=="$"&&p!=="$!"&&p!=="$?"||l++}a=a.nextSibling}sr=null}}else sr=ar?bi(a.stateNode.nextSibling):null;return!0}function np(){for(var a=sr;a;)a=bi(a.nextSibling)}function xs(){sr=ar=null,Ut=!1}function uf(a){Br===null?Br=[a]:Br.push(a)}var w_=D.ReactCurrentBatchConfig;function Or(a,l){if(a&&a.defaultProps){l=H({},l),a=a.defaultProps;for(var p in a)l[p]===void 0&&(l[p]=a[p]);return l}return l}var ql=Vi(null),Kl=null,vs=null,cf=null;function ff(){cf=vs=Kl=null}function df(a){var l=ql.current;Ft(ql),a._currentValue=l}function hf(a,l,p){for(;a!==null;){var g=a.alternate;if((a.childLanes&l)!==l?(a.childLanes|=l,g!==null&&(g.childLanes|=l)):g!==null&&(g.childLanes&l)!==l&&(g.childLanes|=l),a===p)break;a=a.return}}function ys(a,l){Kl=a,cf=vs=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&l)!==0&&(qn=!0),a.firstContext=null)}function xr(a){var l=a._currentValue;if(cf!==a)if(a={context:a,memoizedValue:l,next:null},vs===null){if(Kl===null)throw Error(n(308));vs=a,Kl.dependencies={lanes:0,firstContext:a}}else vs=vs.next=a;return l}var Ta=null;function pf(a){Ta===null?Ta=[a]:Ta.push(a)}function rp(a,l,p,g){var w=l.interleaved;return w===null?(p.next=p,pf(l)):(p.next=w.next,w.next=p),l.interleaved=p,pi(a,g)}function pi(a,l){a.lanes|=l;var p=a.alternate;for(p!==null&&(p.lanes|=l),p=a,a=a.return;a!==null;)a.childLanes|=l,p=a.alternate,p!==null&&(p.childLanes|=l),p=a,a=a.return;return p.tag===3?p.stateNode:null}var Gi=!1;function mf(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ip(a,l){a=a.updateQueue,l.updateQueue===a&&(l.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function mi(a,l){return{eventTime:a,lane:l,tag:0,payload:null,callback:null,next:null}}function $i(a,l,p){var g=a.updateQueue;if(g===null)return null;if(g=g.shared,(lt&2)!==0){var w=g.pending;return w===null?l.next=l:(l.next=w.next,w.next=l),g.pending=l,pi(a,p)}return w=g.interleaved,w===null?(l.next=l,pf(g)):(l.next=w.next,w.next=l),g.interleaved=l,pi(a,p)}function Jl(a,l,p){if(l=l.updateQueue,l!==null&&(l=l.shared,(p&4194240)!==0)){var g=l.lanes;g&=a.pendingLanes,p|=g,l.lanes=p,Ic(a,p)}}function ap(a,l){var p=a.updateQueue,g=a.alternate;if(g!==null&&(g=g.updateQueue,p===g)){var w=null,k=null;if(p=p.firstBaseUpdate,p!==null){do{var N={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};k===null?w=k=N:k=k.next=N,p=p.next}while(p!==null);k===null?w=k=l:k=k.next=l}else w=k=l;p={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:k,shared:g.shared,effects:g.effects},a.updateQueue=p;return}a=p.lastBaseUpdate,a===null?p.firstBaseUpdate=l:a.next=l,p.lastBaseUpdate=l}function Xl(a,l,p,g){var w=a.updateQueue;Gi=!1;var k=w.firstBaseUpdate,N=w.lastBaseUpdate,W=w.shared.pending;if(W!==null){w.shared.pending=null;var Y=W,fe=Y.next;Y.next=null,N===null?k=fe:N.next=fe,N=Y;var Ee=a.alternate;Ee!==null&&(Ee=Ee.updateQueue,W=Ee.lastBaseUpdate,W!==N&&(W===null?Ee.firstBaseUpdate=fe:W.next=fe,Ee.lastBaseUpdate=Y))}if(k!==null){var Ne=w.baseState;N=0,Ee=fe=Y=null,W=k;do{var Se=W.lane,Oe=W.eventTime;if((g&Se)===Se){Ee!==null&&(Ee=Ee.next={eventTime:Oe,lane:0,tag:W.tag,payload:W.payload,callback:W.callback,next:null});e:{var ze=a,be=W;switch(Se=l,Oe=p,be.tag){case 1:if(ze=be.payload,typeof ze=="function"){Ne=ze.call(Oe,Ne,Se);break e}Ne=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=be.payload,Se=typeof ze=="function"?ze.call(Oe,Ne,Se):ze,Se==null)break e;Ne=H({},Ne,Se);break e;case 2:Gi=!0}}W.callback!==null&&W.lane!==0&&(a.flags|=64,Se=w.effects,Se===null?w.effects=[W]:Se.push(W))}else Oe={eventTime:Oe,lane:Se,tag:W.tag,payload:W.payload,callback:W.callback,next:null},Ee===null?(fe=Ee=Oe,Y=Ne):Ee=Ee.next=Oe,N|=Se;if(W=W.next,W===null){if(W=w.shared.pending,W===null)break;Se=W,W=Se.next,Se.next=null,w.lastBaseUpdate=Se,w.shared.pending=null}}while(!0);if(Ee===null&&(Y=Ne),w.baseState=Y,w.firstBaseUpdate=fe,w.lastBaseUpdate=Ee,l=w.shared.interleaved,l!==null){w=l;do N|=w.lane,w=w.next;while(w!==l)}else k===null&&(w.shared.lanes=0);Ea|=N,a.lanes=N,a.memoizedState=Ne}}function sp(a,l,p){if(a=l.effects,l.effects=null,a!==null)for(l=0;l<a.length;l++){var g=a[l],w=g.callback;if(w!==null){if(g.callback=null,g=p,typeof w!="function")throw Error(n(191,w));w.call(g)}}}var op=new e.Component().refs;function gf(a,l,p,g){l=a.memoizedState,p=p(g,l),p=p==null?l:H({},l,p),a.memoizedState=p,a.lanes===0&&(a.updateQueue.baseState=p)}var Yl={isMounted:function(a){return(a=a._reactInternals)?b(a)===a:!1},enqueueSetState:function(a,l,p){a=a._reactInternals;var g=bn(),w=Ji(a),k=mi(g,w);k.payload=l,p!=null&&(k.callback=p),l=$i(a,k,w),l!==null&&(br(l,a,w,g),Jl(l,a,w))},enqueueReplaceState:function(a,l,p){a=a._reactInternals;var g=bn(),w=Ji(a),k=mi(g,w);k.tag=1,k.payload=l,p!=null&&(k.callback=p),l=$i(a,k,w),l!==null&&(br(l,a,w,g),Jl(l,a,w))},enqueueForceUpdate:function(a,l){a=a._reactInternals;var p=bn(),g=Ji(a),w=mi(p,g);w.tag=2,l!=null&&(w.callback=l),l=$i(a,w,g),l!==null&&(br(l,a,g,p),Jl(l,a,g))}};function lp(a,l,p,g,w,k,N){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(g,k,N):l.prototype&&l.prototype.isPureReactComponent?!fo(p,g)||!fo(w,k):!0}function up(a,l,p){var g=!1,w=Hi,k=l.contextType;return typeof k=="object"&&k!==null?k=xr(k):(w=jn(l)?ya:Cn.current,g=l.contextTypes,k=(g=g!=null)?ps(a,w):Hi),l=new l(p,k),a.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Yl,a.stateNode=l,l._reactInternals=a,g&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=w,a.__reactInternalMemoizedMaskedChildContext=k),l}function cp(a,l,p,g){a=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(p,g),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(p,g),l.state!==a&&Yl.enqueueReplaceState(l,l.state,null)}function xf(a,l,p,g){var w=a.stateNode;w.props=p,w.state=a.memoizedState,w.refs=op,mf(a);var k=l.contextType;typeof k=="object"&&k!==null?w.context=xr(k):(k=jn(l)?ya:Cn.current,w.context=ps(a,k)),w.state=a.memoizedState,k=l.getDerivedStateFromProps,typeof k=="function"&&(gf(a,l,k,p),w.state=a.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(l=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),l!==w.state&&Yl.enqueueReplaceState(w,w.state,null),Xl(a,p,w,g),w.state=a.memoizedState),typeof w.componentDidMount=="function"&&(a.flags|=4194308)}function yo(a,l,p){if(a=p.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(n(309));var g=p.stateNode}if(!g)throw Error(n(147,a));var w=g,k=""+a;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===k?l.ref:(l=function(N){var W=w.refs;W===op&&(W=w.refs={}),N===null?delete W[k]:W[k]=N},l._stringRef=k,l)}if(typeof a!="string")throw Error(n(284));if(!p._owner)throw Error(n(290,a))}return a}function Zl(a,l){throw a=Object.prototype.toString.call(l),Error(n(31,a==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":a))}function fp(a){var l=a._init;return l(a._payload)}function dp(a){function l(ie,ee){if(a){var oe=ie.deletions;oe===null?(ie.deletions=[ee],ie.flags|=16):oe.push(ee)}}function p(ie,ee){if(!a)return null;for(;ee!==null;)l(ie,ee),ee=ee.sibling;return null}function g(ie,ee){for(ie=new Map;ee!==null;)ee.key!==null?ie.set(ee.key,ee):ie.set(ee.index,ee),ee=ee.sibling;return ie}function w(ie,ee){return ie=Yi(ie,ee),ie.index=0,ie.sibling=null,ie}function k(ie,ee,oe){return ie.index=oe,a?(oe=ie.alternate,oe!==null?(oe=oe.index,oe<ee?(ie.flags|=2,ee):oe):(ie.flags|=2,ee)):(ie.flags|=1048576,ee)}function N(ie){return a&&ie.alternate===null&&(ie.flags|=2),ie}function W(ie,ee,oe,Pe){return ee===null||ee.tag!==6?(ee=e0(oe,ie.mode,Pe),ee.return=ie,ee):(ee=w(ee,oe),ee.return=ie,ee)}function Y(ie,ee,oe,Pe){var Ve=oe.type;return Ve===R?Ee(ie,ee,oe.props.children,Pe,oe.key):ee!==null&&(ee.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===De&&fp(Ve)===ee.type)?(Pe=w(ee,oe.props),Pe.ref=yo(ie,ee,oe),Pe.return=ie,Pe):(Pe=xu(oe.type,oe.key,oe.props,null,ie.mode,Pe),Pe.ref=yo(ie,ee,oe),Pe.return=ie,Pe)}function fe(ie,ee,oe,Pe){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==oe.containerInfo||ee.stateNode.implementation!==oe.implementation?(ee=t0(oe,ie.mode,Pe),ee.return=ie,ee):(ee=w(ee,oe.children||[]),ee.return=ie,ee)}function Ee(ie,ee,oe,Pe,Ve){return ee===null||ee.tag!==7?(ee=Na(oe,ie.mode,Pe,Ve),ee.return=ie,ee):(ee=w(ee,oe),ee.return=ie,ee)}function Ne(ie,ee,oe){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=e0(""+ee,ie.mode,oe),ee.return=ie,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case P:return oe=xu(ee.type,ee.key,ee.props,null,ie.mode,oe),oe.ref=yo(ie,null,ee),oe.return=ie,oe;case L:return ee=t0(ee,ie.mode,oe),ee.return=ie,ee;case De:var Pe=ee._init;return Ne(ie,Pe(ee._payload),oe)}if(Lt(ee)||Z(ee))return ee=Na(ee,ie.mode,oe,null),ee.return=ie,ee;Zl(ie,ee)}return null}function Se(ie,ee,oe,Pe){var Ve=ee!==null?ee.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number")return Ve!==null?null:W(ie,ee,""+oe,Pe);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case P:return oe.key===Ve?Y(ie,ee,oe,Pe):null;case L:return oe.key===Ve?fe(ie,ee,oe,Pe):null;case De:return Ve=oe._init,Se(ie,ee,Ve(oe._payload),Pe)}if(Lt(oe)||Z(oe))return Ve!==null?null:Ee(ie,ee,oe,Pe,null);Zl(ie,oe)}return null}function Oe(ie,ee,oe,Pe,Ve){if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return ie=ie.get(oe)||null,W(ee,ie,""+Pe,Ve);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case P:return ie=ie.get(Pe.key===null?oe:Pe.key)||null,Y(ee,ie,Pe,Ve);case L:return ie=ie.get(Pe.key===null?oe:Pe.key)||null,fe(ee,ie,Pe,Ve);case De:var Ge=Pe._init;return Oe(ie,ee,oe,Ge(Pe._payload),Ve)}if(Lt(Pe)||Z(Pe))return ie=ie.get(oe)||null,Ee(ee,ie,Pe,Ve,null);Zl(ee,Pe)}return null}function ze(ie,ee,oe,Pe){for(var Ve=null,Ge=null,$e=ee,Ze=ee=0,pn=null;$e!==null&&Ze<oe.length;Ze++){$e.index>Ze?(pn=$e,$e=null):pn=$e.sibling;var pt=Se(ie,$e,oe[Ze],Pe);if(pt===null){$e===null&&($e=pn);break}a&&$e&&pt.alternate===null&&l(ie,$e),ee=k(pt,ee,Ze),Ge===null?Ve=pt:Ge.sibling=pt,Ge=pt,$e=pn}if(Ze===oe.length)return p(ie,$e),Ut&&_a(ie,Ze),Ve;if($e===null){for(;Ze<oe.length;Ze++)$e=Ne(ie,oe[Ze],Pe),$e!==null&&(ee=k($e,ee,Ze),Ge===null?Ve=$e:Ge.sibling=$e,Ge=$e);return Ut&&_a(ie,Ze),Ve}for($e=g(ie,$e);Ze<oe.length;Ze++)pn=Oe($e,ie,Ze,oe[Ze],Pe),pn!==null&&(a&&pn.alternate!==null&&$e.delete(pn.key===null?Ze:pn.key),ee=k(pn,ee,Ze),Ge===null?Ve=pn:Ge.sibling=pn,Ge=pn);return a&&$e.forEach(function(Zi){return l(ie,Zi)}),Ut&&_a(ie,Ze),Ve}function be(ie,ee,oe,Pe){var Ve=Z(oe);if(typeof Ve!="function")throw Error(n(150));if(oe=Ve.call(oe),oe==null)throw Error(n(151));for(var Ge=Ve=null,$e=ee,Ze=ee=0,pn=null,pt=oe.next();$e!==null&&!pt.done;Ze++,pt=oe.next()){$e.index>Ze?(pn=$e,$e=null):pn=$e.sibling;var Zi=Se(ie,$e,pt.value,Pe);if(Zi===null){$e===null&&($e=pn);break}a&&$e&&Zi.alternate===null&&l(ie,$e),ee=k(Zi,ee,Ze),Ge===null?Ve=Zi:Ge.sibling=Zi,Ge=Zi,$e=pn}if(pt.done)return p(ie,$e),Ut&&_a(ie,Ze),Ve;if($e===null){for(;!pt.done;Ze++,pt=oe.next())pt=Ne(ie,pt.value,Pe),pt!==null&&(ee=k(pt,ee,Ze),Ge===null?Ve=pt:Ge.sibling=pt,Ge=pt);return Ut&&_a(ie,Ze),Ve}for($e=g(ie,$e);!pt.done;Ze++,pt=oe.next())pt=Oe($e,ie,Ze,pt.value,Pe),pt!==null&&(a&&pt.alternate!==null&&$e.delete(pt.key===null?Ze:pt.key),ee=k(pt,ee,Ze),Ge===null?Ve=pt:Ge.sibling=pt,Ge=pt);return a&&$e.forEach(function(Q_){return l(ie,Q_)}),Ut&&_a(ie,Ze),Ve}function Yt(ie,ee,oe,Pe){if(typeof oe=="object"&&oe!==null&&oe.type===R&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case P:e:{for(var Ve=oe.key,Ge=ee;Ge!==null;){if(Ge.key===Ve){if(Ve=oe.type,Ve===R){if(Ge.tag===7){p(ie,Ge.sibling),ee=w(Ge,oe.props.children),ee.return=ie,ie=ee;break e}}else if(Ge.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===De&&fp(Ve)===Ge.type){p(ie,Ge.sibling),ee=w(Ge,oe.props),ee.ref=yo(ie,Ge,oe),ee.return=ie,ie=ee;break e}p(ie,Ge);break}else l(ie,Ge);Ge=Ge.sibling}oe.type===R?(ee=Na(oe.props.children,ie.mode,Pe,oe.key),ee.return=ie,ie=ee):(Pe=xu(oe.type,oe.key,oe.props,null,ie.mode,Pe),Pe.ref=yo(ie,ee,oe),Pe.return=ie,ie=Pe)}return N(ie);case L:e:{for(Ge=oe.key;ee!==null;){if(ee.key===Ge)if(ee.tag===4&&ee.stateNode.containerInfo===oe.containerInfo&&ee.stateNode.implementation===oe.implementation){p(ie,ee.sibling),ee=w(ee,oe.children||[]),ee.return=ie,ie=ee;break e}else{p(ie,ee);break}else l(ie,ee);ee=ee.sibling}ee=t0(oe,ie.mode,Pe),ee.return=ie,ie=ee}return N(ie);case De:return Ge=oe._init,Yt(ie,ee,Ge(oe._payload),Pe)}if(Lt(oe))return ze(ie,ee,oe,Pe);if(Z(oe))return be(ie,ee,oe,Pe);Zl(ie,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"?(oe=""+oe,ee!==null&&ee.tag===6?(p(ie,ee.sibling),ee=w(ee,oe),ee.return=ie,ie=ee):(p(ie,ee),ee=e0(oe,ie.mode,Pe),ee.return=ie,ie=ee),N(ie)):p(ie,ee)}return Yt}var ws=dp(!0),hp=dp(!1),wo={},Yr=Vi(wo),_o=Vi(wo),To=Vi(wo);function ka(a){if(a===wo)throw Error(n(174));return a}function vf(a,l){switch(Ct(To,l),Ct(_o,a),Ct(Yr,wo),a=l.nodeType,a){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:nr(null,"");break;default:a=a===8?l.parentNode:l,l=a.namespaceURI||null,a=a.tagName,l=nr(l,a)}Ft(Yr),Ct(Yr,l)}function _s(){Ft(Yr),Ft(_o),Ft(To)}function pp(a){ka(To.current);var l=ka(Yr.current),p=nr(l,a.type);l!==p&&(Ct(_o,a),Ct(Yr,p))}function yf(a){_o.current===a&&(Ft(Yr),Ft(_o))}var bt=Vi(0);function Ql(a){for(var l=a;l!==null;){if(l.tag===13){var p=l.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||p.data==="$?"||p.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var wf=[];function _f(){for(var a=0;a<wf.length;a++)wf[a]._workInProgressVersionPrimary=null;wf.length=0}var eu=D.ReactCurrentDispatcher,Tf=D.ReactCurrentBatchConfig,Sa=0,Vt=null,ln=null,dn=null,tu=!1,ko=!1,So=0,__=0;function An(){throw Error(n(321))}function kf(a,l){if(l===null)return!1;for(var p=0;p<l.length&&p<a.length;p++)if(!Lr(a[p],l[p]))return!1;return!0}function Sf(a,l,p,g,w,k){if(Sa=k,Vt=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,eu.current=a===null||a.memoizedState===null?E_:C_,a=p(g,w),ko){k=0;do{if(ko=!1,So=0,25<=k)throw Error(n(301));k+=1,dn=ln=null,l.updateQueue=null,eu.current=A_,a=p(g,w)}while(ko)}if(eu.current=iu,l=ln!==null&&ln.next!==null,Sa=0,dn=ln=Vt=null,tu=!1,l)throw Error(n(300));return a}function Ef(){var a=So!==0;return So=0,a}function Zr(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?Vt.memoizedState=dn=a:dn=dn.next=a,dn}function vr(){if(ln===null){var a=Vt.alternate;a=a!==null?a.memoizedState:null}else a=ln.next;var l=dn===null?Vt.memoizedState:dn.next;if(l!==null)dn=l,ln=a;else{if(a===null)throw Error(n(310));ln=a,a={memoizedState:ln.memoizedState,baseState:ln.baseState,baseQueue:ln.baseQueue,queue:ln.queue,next:null},dn===null?Vt.memoizedState=dn=a:dn=dn.next=a}return dn}function Eo(a,l){return typeof l=="function"?l(a):l}function Cf(a){var l=vr(),p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=a;var g=ln,w=g.baseQueue,k=p.pending;if(k!==null){if(w!==null){var N=w.next;w.next=k.next,k.next=N}g.baseQueue=w=k,p.pending=null}if(w!==null){k=w.next,g=g.baseState;var W=N=null,Y=null,fe=k;do{var Ee=fe.lane;if((Sa&Ee)===Ee)Y!==null&&(Y=Y.next={lane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),g=fe.hasEagerState?fe.eagerState:a(g,fe.action);else{var Ne={lane:Ee,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null};Y===null?(W=Y=Ne,N=g):Y=Y.next=Ne,Vt.lanes|=Ee,Ea|=Ee}fe=fe.next}while(fe!==null&&fe!==k);Y===null?N=g:Y.next=W,Lr(g,l.memoizedState)||(qn=!0),l.memoizedState=g,l.baseState=N,l.baseQueue=Y,p.lastRenderedState=g}if(a=p.interleaved,a!==null){w=a;do k=w.lane,Vt.lanes|=k,Ea|=k,w=w.next;while(w!==a)}else w===null&&(p.lanes=0);return[l.memoizedState,p.dispatch]}function Af(a){var l=vr(),p=l.queue;if(p===null)throw Error(n(311));p.lastRenderedReducer=a;var g=p.dispatch,w=p.pending,k=l.memoizedState;if(w!==null){p.pending=null;var N=w=w.next;do k=a(k,N.action),N=N.next;while(N!==w);Lr(k,l.memoizedState)||(qn=!0),l.memoizedState=k,l.baseQueue===null&&(l.baseState=k),p.lastRenderedState=k}return[k,g]}function mp(){}function gp(a,l){var p=Vt,g=vr(),w=l(),k=!Lr(g.memoizedState,w);if(k&&(g.memoizedState=w,qn=!0),g=g.queue,If(yp.bind(null,p,g,a),[a]),g.getSnapshot!==l||k||dn!==null&&dn.memoizedState.tag&1){if(p.flags|=2048,Co(9,vp.bind(null,p,g,w,l),void 0,null),hn===null)throw Error(n(349));(Sa&30)!==0||xp(p,l,w)}return w}function xp(a,l,p){a.flags|=16384,a={getSnapshot:l,value:p},l=Vt.updateQueue,l===null?(l={lastEffect:null,stores:null},Vt.updateQueue=l,l.stores=[a]):(p=l.stores,p===null?l.stores=[a]:p.push(a))}function vp(a,l,p,g){l.value=p,l.getSnapshot=g,wp(l)&&_p(a)}function yp(a,l,p){return p(function(){wp(l)&&_p(a)})}function wp(a){var l=a.getSnapshot;a=a.value;try{var p=l();return!Lr(a,p)}catch{return!0}}function _p(a){var l=pi(a,1);l!==null&&br(l,a,1,-1)}function Tp(a){var l=Zr();return typeof a=="function"&&(a=a()),l.memoizedState=l.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eo,lastRenderedState:a},l.queue=a,a=a.dispatch=S_.bind(null,Vt,a),[l.memoizedState,a]}function Co(a,l,p,g){return a={tag:a,create:l,destroy:p,deps:g,next:null},l=Vt.updateQueue,l===null?(l={lastEffect:null,stores:null},Vt.updateQueue=l,l.lastEffect=a.next=a):(p=l.lastEffect,p===null?l.lastEffect=a.next=a:(g=p.next,p.next=a,a.next=g,l.lastEffect=a)),a}function kp(){return vr().memoizedState}function nu(a,l,p,g){var w=Zr();Vt.flags|=a,w.memoizedState=Co(1|l,p,void 0,g===void 0?null:g)}function ru(a,l,p,g){var w=vr();g=g===void 0?null:g;var k=void 0;if(ln!==null){var N=ln.memoizedState;if(k=N.destroy,g!==null&&kf(g,N.deps)){w.memoizedState=Co(l,p,k,g);return}}Vt.flags|=a,w.memoizedState=Co(1|l,p,k,g)}function Sp(a,l){return nu(8390656,8,a,l)}function If(a,l){return ru(2048,8,a,l)}function Ep(a,l){return ru(4,2,a,l)}function Cp(a,l){return ru(4,4,a,l)}function Ap(a,l){if(typeof l=="function")return a=a(),l(a),function(){l(null)};if(l!=null)return a=a(),l.current=a,function(){l.current=null}}function Ip(a,l,p){return p=p!=null?p.concat([a]):null,ru(4,4,Ap.bind(null,l,a),p)}function Nf(){}function Np(a,l){var p=vr();l=l===void 0?null:l;var g=p.memoizedState;return g!==null&&l!==null&&kf(l,g[1])?g[0]:(p.memoizedState=[a,l],a)}function Fp(a,l){var p=vr();l=l===void 0?null:l;var g=p.memoizedState;return g!==null&&l!==null&&kf(l,g[1])?g[0]:(a=a(),p.memoizedState=[a,l],a)}function Rp(a,l,p){return(Sa&21)===0?(a.baseState&&(a.baseState=!1,qn=!0),a.memoizedState=p):(Lr(p,l)||(p=rh(),Vt.lanes|=p,Ea|=p,a.baseState=!0),l)}function T_(a,l){var p=wt;wt=p!==0&&4>p?p:4,a(!0);var g=Tf.transition;Tf.transition={};try{a(!1),l()}finally{wt=p,Tf.transition=g}}function Dp(){return vr().memoizedState}function k_(a,l,p){var g=Ji(a);if(p={lane:g,action:p,hasEagerState:!1,eagerState:null,next:null},Pp(a))Mp(l,p);else if(p=rp(a,l,p,g),p!==null){var w=bn();br(p,a,g,w),Lp(p,l,g)}}function S_(a,l,p){var g=Ji(a),w={lane:g,action:p,hasEagerState:!1,eagerState:null,next:null};if(Pp(a))Mp(l,w);else{var k=a.alternate;if(a.lanes===0&&(k===null||k.lanes===0)&&(k=l.lastRenderedReducer,k!==null))try{var N=l.lastRenderedState,W=k(N,p);if(w.hasEagerState=!0,w.eagerState=W,Lr(W,N)){var Y=l.interleaved;Y===null?(w.next=w,pf(l)):(w.next=Y.next,Y.next=w),l.interleaved=w;return}}catch{}finally{}p=rp(a,l,w,g),p!==null&&(w=bn(),br(p,a,g,w),Lp(p,l,g))}}function Pp(a){var l=a.alternate;return a===Vt||l!==null&&l===Vt}function Mp(a,l){ko=tu=!0;var p=a.pending;p===null?l.next=l:(l.next=p.next,p.next=l),a.pending=l}function Lp(a,l,p){if((p&4194240)!==0){var g=l.lanes;g&=a.pendingLanes,p|=g,l.lanes=p,Ic(a,p)}}var iu={readContext:xr,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useInsertionEffect:An,useLayoutEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useMutableSource:An,useSyncExternalStore:An,useId:An,unstable_isNewReconciler:!1},E_={readContext:xr,useCallback:function(a,l){return Zr().memoizedState=[a,l===void 0?null:l],a},useContext:xr,useEffect:Sp,useImperativeHandle:function(a,l,p){return p=p!=null?p.concat([a]):null,nu(4194308,4,Ap.bind(null,l,a),p)},useLayoutEffect:function(a,l){return nu(4194308,4,a,l)},useInsertionEffect:function(a,l){return nu(4,2,a,l)},useMemo:function(a,l){var p=Zr();return l=l===void 0?null:l,a=a(),p.memoizedState=[a,l],a},useReducer:function(a,l,p){var g=Zr();return l=p!==void 0?p(l):l,g.memoizedState=g.baseState=l,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:l},g.queue=a,a=a.dispatch=k_.bind(null,Vt,a),[g.memoizedState,a]},useRef:function(a){var l=Zr();return a={current:a},l.memoizedState=a},useState:Tp,useDebugValue:Nf,useDeferredValue:function(a){return Zr().memoizedState=a},useTransition:function(){var a=Tp(!1),l=a[0];return a=T_.bind(null,a[1]),Zr().memoizedState=a,[l,a]},useMutableSource:function(){},useSyncExternalStore:function(a,l,p){var g=Vt,w=Zr();if(Ut){if(p===void 0)throw Error(n(407));p=p()}else{if(p=l(),hn===null)throw Error(n(349));(Sa&30)!==0||xp(g,l,p)}w.memoizedState=p;var k={value:p,getSnapshot:l};return w.queue=k,Sp(yp.bind(null,g,k,a),[a]),g.flags|=2048,Co(9,vp.bind(null,g,k,p,l),void 0,null),p},useId:function(){var a=Zr(),l=hn.identifierPrefix;if(Ut){var p=hi,g=di;p=(g&~(1<<32-zt(g)-1)).toString(32)+p,l=":"+l+"R"+p,p=So++,0<p&&(l+="H"+p.toString(32)),l+=":"}else p=__++,l=":"+l+"r"+p.toString(32)+":";return a.memoizedState=l},unstable_isNewReconciler:!1},C_={readContext:xr,useCallback:Np,useContext:xr,useEffect:If,useImperativeHandle:Ip,useInsertionEffect:Ep,useLayoutEffect:Cp,useMemo:Fp,useReducer:Cf,useRef:kp,useState:function(){return Cf(Eo)},useDebugValue:Nf,useDeferredValue:function(a){var l=vr();return Rp(l,ln.memoizedState,a)},useTransition:function(){var a=Cf(Eo)[0],l=vr().memoizedState;return[a,l]},useMutableSource:mp,useSyncExternalStore:gp,useId:Dp,unstable_isNewReconciler:!1},A_={readContext:xr,useCallback:Np,useContext:xr,useEffect:If,useImperativeHandle:Ip,useInsertionEffect:Ep,useLayoutEffect:Cp,useMemo:Fp,useReducer:Af,useRef:kp,useState:function(){return Af(Eo)},useDebugValue:Nf,useDeferredValue:function(a){var l=vr();return ln===null?l.memoizedState=a:Rp(l,ln.memoizedState,a)},useTransition:function(){var a=Af(Eo)[0],l=vr().memoizedState;return[a,l]},useMutableSource:mp,useSyncExternalStore:gp,useId:Dp,unstable_isNewReconciler:!1};function Ts(a,l){try{var p="",g=l;do p+=K(g),g=g.return;while(g);var w=p}catch(k){w=`
Error generating stack: `+k.message+`
`+k.stack}return{value:a,source:l,stack:w,digest:null}}function Ff(a,l,p){return{value:a,source:null,stack:p??null,digest:l??null}}function Rf(a,l){try{console.error(l.value)}catch(p){setTimeout(function(){throw p})}}var I_=typeof WeakMap=="function"?WeakMap:Map;function Bp(a,l,p){p=mi(-1,p),p.tag=3,p.payload={element:null};var g=l.value;return p.callback=function(){fu||(fu=!0,jf=g),Rf(a,l)},p}function Op(a,l,p){p=mi(-1,p),p.tag=3;var g=a.type.getDerivedStateFromError;if(typeof g=="function"){var w=l.value;p.payload=function(){return g(w)},p.callback=function(){Rf(a,l)}}var k=a.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(p.callback=function(){Rf(a,l),typeof g!="function"&&(qi===null?qi=new Set([this]):qi.add(this));var N=l.stack;this.componentDidCatch(l.value,{componentStack:N!==null?N:""})}),p}function Up(a,l,p){var g=a.pingCache;if(g===null){g=a.pingCache=new I_;var w=new Set;g.set(l,w)}else w=g.get(l),w===void 0&&(w=new Set,g.set(l,w));w.has(p)||(w.add(p),a=H_.bind(null,a,l,p),l.then(a,a))}function zp(a){do{var l;if((l=a.tag===13)&&(l=a.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return a;a=a.return}while(a!==null);return null}function bp(a,l,p,g,w){return(a.mode&1)===0?(a===l?a.flags|=65536:(a.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(l=mi(-1,1),l.tag=2,$i(p,l,1))),p.lanes|=1),a):(a.flags|=65536,a.lanes=w,a)}var N_=D.ReactCurrentOwner,qn=!1;function zn(a,l,p,g){l.child=a===null?hp(l,null,p,g):ws(l,a.child,p,g)}function Vp(a,l,p,g,w){p=p.render;var k=l.ref;return ys(l,w),g=Sf(a,l,p,g,k,w),p=Ef(),a!==null&&!qn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~w,gi(a,l,w)):(Ut&&p&&af(l),l.flags|=1,zn(a,l,g,w),l.child)}function Hp(a,l,p,g,w){if(a===null){var k=p.type;return typeof k=="function"&&!Qf(k)&&k.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(l.tag=15,l.type=k,Wp(a,l,k,g,w)):(a=xu(p.type,null,g,l,l.mode,w),a.ref=l.ref,a.return=l,l.child=a)}if(k=a.child,(a.lanes&w)===0){var N=k.memoizedProps;if(p=p.compare,p=p!==null?p:fo,p(N,g)&&a.ref===l.ref)return gi(a,l,w)}return l.flags|=1,a=Yi(k,g),a.ref=l.ref,a.return=l,l.child=a}function Wp(a,l,p,g,w){if(a!==null){var k=a.memoizedProps;if(fo(k,g)&&a.ref===l.ref)if(qn=!1,l.pendingProps=g=k,(a.lanes&w)!==0)(a.flags&131072)!==0&&(qn=!0);else return l.lanes=a.lanes,gi(a,l,w)}return Df(a,l,p,g,w)}function Gp(a,l,p){var g=l.pendingProps,w=g.children,k=a!==null?a.memoizedState:null;if(g.mode==="hidden")if((l.mode&1)===0)l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ct(Ss,or),or|=p;else{if((p&1073741824)===0)return a=k!==null?k.baseLanes|p:p,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:a,cachePool:null,transitions:null},l.updateQueue=null,Ct(Ss,or),or|=a,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=k!==null?k.baseLanes:p,Ct(Ss,or),or|=g}else k!==null?(g=k.baseLanes|p,l.memoizedState=null):g=p,Ct(Ss,or),or|=g;return zn(a,l,w,p),l.child}function $p(a,l){var p=l.ref;(a===null&&p!==null||a!==null&&a.ref!==p)&&(l.flags|=512,l.flags|=2097152)}function Df(a,l,p,g,w){var k=jn(p)?ya:Cn.current;return k=ps(l,k),ys(l,w),p=Sf(a,l,p,g,k,w),g=Ef(),a!==null&&!qn?(l.updateQueue=a.updateQueue,l.flags&=-2053,a.lanes&=~w,gi(a,l,w)):(Ut&&g&&af(l),l.flags|=1,zn(a,l,p,w),l.child)}function jp(a,l,p,g,w){if(jn(p)){var k=!0;Hl(l)}else k=!1;if(ys(l,w),l.stateNode===null)su(a,l),up(l,p,g),xf(l,p,g,w),g=!0;else if(a===null){var N=l.stateNode,W=l.memoizedProps;N.props=W;var Y=N.context,fe=p.contextType;typeof fe=="object"&&fe!==null?fe=xr(fe):(fe=jn(p)?ya:Cn.current,fe=ps(l,fe));var Ee=p.getDerivedStateFromProps,Ne=typeof Ee=="function"||typeof N.getSnapshotBeforeUpdate=="function";Ne||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(W!==g||Y!==fe)&&cp(l,N,g,fe),Gi=!1;var Se=l.memoizedState;N.state=Se,Xl(l,g,N,w),Y=l.memoizedState,W!==g||Se!==Y||$n.current||Gi?(typeof Ee=="function"&&(gf(l,p,Ee,g),Y=l.memoizedState),(W=Gi||lp(l,p,W,g,Se,Y,fe))?(Ne||typeof N.UNSAFE_componentWillMount!="function"&&typeof N.componentWillMount!="function"||(typeof N.componentWillMount=="function"&&N.componentWillMount(),typeof N.UNSAFE_componentWillMount=="function"&&N.UNSAFE_componentWillMount()),typeof N.componentDidMount=="function"&&(l.flags|=4194308)):(typeof N.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=g,l.memoizedState=Y),N.props=g,N.state=Y,N.context=fe,g=W):(typeof N.componentDidMount=="function"&&(l.flags|=4194308),g=!1)}else{N=l.stateNode,ip(a,l),W=l.memoizedProps,fe=l.type===l.elementType?W:Or(l.type,W),N.props=fe,Ne=l.pendingProps,Se=N.context,Y=p.contextType,typeof Y=="object"&&Y!==null?Y=xr(Y):(Y=jn(p)?ya:Cn.current,Y=ps(l,Y));var Oe=p.getDerivedStateFromProps;(Ee=typeof Oe=="function"||typeof N.getSnapshotBeforeUpdate=="function")||typeof N.UNSAFE_componentWillReceiveProps!="function"&&typeof N.componentWillReceiveProps!="function"||(W!==Ne||Se!==Y)&&cp(l,N,g,Y),Gi=!1,Se=l.memoizedState,N.state=Se,Xl(l,g,N,w);var ze=l.memoizedState;W!==Ne||Se!==ze||$n.current||Gi?(typeof Oe=="function"&&(gf(l,p,Oe,g),ze=l.memoizedState),(fe=Gi||lp(l,p,fe,g,Se,ze,Y)||!1)?(Ee||typeof N.UNSAFE_componentWillUpdate!="function"&&typeof N.componentWillUpdate!="function"||(typeof N.componentWillUpdate=="function"&&N.componentWillUpdate(g,ze,Y),typeof N.UNSAFE_componentWillUpdate=="function"&&N.UNSAFE_componentWillUpdate(g,ze,Y)),typeof N.componentDidUpdate=="function"&&(l.flags|=4),typeof N.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof N.componentDidUpdate!="function"||W===a.memoizedProps&&Se===a.memoizedState||(l.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||W===a.memoizedProps&&Se===a.memoizedState||(l.flags|=1024),l.memoizedProps=g,l.memoizedState=ze),N.props=g,N.state=ze,N.context=Y,g=fe):(typeof N.componentDidUpdate!="function"||W===a.memoizedProps&&Se===a.memoizedState||(l.flags|=4),typeof N.getSnapshotBeforeUpdate!="function"||W===a.memoizedProps&&Se===a.memoizedState||(l.flags|=1024),g=!1)}return Pf(a,l,p,g,k,w)}function Pf(a,l,p,g,w,k){$p(a,l);var N=(l.flags&128)!==0;if(!g&&!N)return w&&Xh(l,p,!1),gi(a,l,k);g=l.stateNode,N_.current=l;var W=N&&typeof p.getDerivedStateFromError!="function"?null:g.render();return l.flags|=1,a!==null&&N?(l.child=ws(l,a.child,null,k),l.child=ws(l,null,W,k)):zn(a,l,W,k),l.memoizedState=g.state,w&&Xh(l,p,!0),l.child}function qp(a){var l=a.stateNode;l.pendingContext?Kh(a,l.pendingContext,l.pendingContext!==l.context):l.context&&Kh(a,l.context,!1),vf(a,l.containerInfo)}function Kp(a,l,p,g,w){return xs(),uf(w),l.flags|=256,zn(a,l,p,g),l.child}var Mf={dehydrated:null,treeContext:null,retryLane:0};function Lf(a){return{baseLanes:a,cachePool:null,transitions:null}}function Jp(a,l,p){var g=l.pendingProps,w=bt.current,k=!1,N=(l.flags&128)!==0,W;if((W=N)||(W=a!==null&&a.memoizedState===null?!1:(w&2)!==0),W?(k=!0,l.flags&=-129):(a===null||a.memoizedState!==null)&&(w|=1),Ct(bt,w&1),a===null)return lf(l),a=l.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((l.mode&1)===0?l.lanes=1:a.data==="$!"?l.lanes=8:l.lanes=1073741824,null):(N=g.children,a=g.fallback,k?(g=l.mode,k=l.child,N={mode:"hidden",children:N},(g&1)===0&&k!==null?(k.childLanes=0,k.pendingProps=N):k=vu(N,g,0,null),a=Na(a,g,p,null),k.return=l,a.return=l,k.sibling=a,l.child=k,l.child.memoizedState=Lf(p),l.memoizedState=Mf,a):Bf(l,N));if(w=a.memoizedState,w!==null&&(W=w.dehydrated,W!==null))return F_(a,l,N,g,W,w,p);if(k){k=g.fallback,N=l.mode,w=a.child,W=w.sibling;var Y={mode:"hidden",children:g.children};return(N&1)===0&&l.child!==w?(g=l.child,g.childLanes=0,g.pendingProps=Y,l.deletions=null):(g=Yi(w,Y),g.subtreeFlags=w.subtreeFlags&14680064),W!==null?k=Yi(W,k):(k=Na(k,N,p,null),k.flags|=2),k.return=l,g.return=l,g.sibling=k,l.child=g,g=k,k=l.child,N=a.child.memoizedState,N=N===null?Lf(p):{baseLanes:N.baseLanes|p,cachePool:null,transitions:N.transitions},k.memoizedState=N,k.childLanes=a.childLanes&~p,l.memoizedState=Mf,g}return k=a.child,a=k.sibling,g=Yi(k,{mode:"visible",children:g.children}),(l.mode&1)===0&&(g.lanes=p),g.return=l,g.sibling=null,a!==null&&(p=l.deletions,p===null?(l.deletions=[a],l.flags|=16):p.push(a)),l.child=g,l.memoizedState=null,g}function Bf(a,l){return l=vu({mode:"visible",children:l},a.mode,0,null),l.return=a,a.child=l}function au(a,l,p,g){return g!==null&&uf(g),ws(l,a.child,null,p),a=Bf(l,l.pendingProps.children),a.flags|=2,l.memoizedState=null,a}function F_(a,l,p,g,w,k,N){if(p)return l.flags&256?(l.flags&=-257,g=Ff(Error(n(422))),au(a,l,N,g)):l.memoizedState!==null?(l.child=a.child,l.flags|=128,null):(k=g.fallback,w=l.mode,g=vu({mode:"visible",children:g.children},w,0,null),k=Na(k,w,N,null),k.flags|=2,g.return=l,k.return=l,g.sibling=k,l.child=g,(l.mode&1)!==0&&ws(l,a.child,null,N),l.child.memoizedState=Lf(N),l.memoizedState=Mf,k);if((l.mode&1)===0)return au(a,l,N,null);if(w.data==="$!"){if(g=w.nextSibling&&w.nextSibling.dataset,g)var W=g.dgst;return g=W,k=Error(n(419)),g=Ff(k,g,void 0),au(a,l,N,g)}if(W=(N&a.childLanes)!==0,qn||W){if(g=hn,g!==null){switch(N&-N){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(g.suspendedLanes|N))!==0?0:w,w!==0&&w!==k.retryLane&&(k.retryLane=w,pi(a,w),br(g,a,w,-1))}return Zf(),g=Ff(Error(n(421))),au(a,l,N,g)}return w.data==="$?"?(l.flags|=128,l.child=a.child,l=W_.bind(null,a),w._reactRetry=l,null):(a=k.treeContext,sr=bi(w.nextSibling),ar=l,Ut=!0,Br=null,a!==null&&(mr[gr++]=di,mr[gr++]=hi,mr[gr++]=wa,di=a.id,hi=a.overflow,wa=l),l=Bf(l,g.children),l.flags|=4096,l)}function Xp(a,l,p){a.lanes|=l;var g=a.alternate;g!==null&&(g.lanes|=l),hf(a.return,l,p)}function Of(a,l,p,g,w){var k=a.memoizedState;k===null?a.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:g,tail:p,tailMode:w}:(k.isBackwards=l,k.rendering=null,k.renderingStartTime=0,k.last=g,k.tail=p,k.tailMode=w)}function Yp(a,l,p){var g=l.pendingProps,w=g.revealOrder,k=g.tail;if(zn(a,l,g.children,p),g=bt.current,(g&2)!==0)g=g&1|2,l.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=l.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Xp(a,p,l);else if(a.tag===19)Xp(a,p,l);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}g&=1}if(Ct(bt,g),(l.mode&1)===0)l.memoizedState=null;else switch(w){case"forwards":for(p=l.child,w=null;p!==null;)a=p.alternate,a!==null&&Ql(a)===null&&(w=p),p=p.sibling;p=w,p===null?(w=l.child,l.child=null):(w=p.sibling,p.sibling=null),Of(l,!1,w,p,k);break;case"backwards":for(p=null,w=l.child,l.child=null;w!==null;){if(a=w.alternate,a!==null&&Ql(a)===null){l.child=w;break}a=w.sibling,w.sibling=p,p=w,w=a}Of(l,!0,p,null,k);break;case"together":Of(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function su(a,l){(l.mode&1)===0&&a!==null&&(a.alternate=null,l.alternate=null,l.flags|=2)}function gi(a,l,p){if(a!==null&&(l.dependencies=a.dependencies),Ea|=l.lanes,(p&l.childLanes)===0)return null;if(a!==null&&l.child!==a.child)throw Error(n(153));if(l.child!==null){for(a=l.child,p=Yi(a,a.pendingProps),l.child=p,p.return=l;a.sibling!==null;)a=a.sibling,p=p.sibling=Yi(a,a.pendingProps),p.return=l;p.sibling=null}return l.child}function R_(a,l,p){switch(l.tag){case 3:qp(l),xs();break;case 5:pp(l);break;case 1:jn(l.type)&&Hl(l);break;case 4:vf(l,l.stateNode.containerInfo);break;case 10:var g=l.type._context,w=l.memoizedProps.value;Ct(ql,g._currentValue),g._currentValue=w;break;case 13:if(g=l.memoizedState,g!==null)return g.dehydrated!==null?(Ct(bt,bt.current&1),l.flags|=128,null):(p&l.child.childLanes)!==0?Jp(a,l,p):(Ct(bt,bt.current&1),a=gi(a,l,p),a!==null?a.sibling:null);Ct(bt,bt.current&1);break;case 19:if(g=(p&l.childLanes)!==0,(a.flags&128)!==0){if(g)return Yp(a,l,p);l.flags|=128}if(w=l.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),Ct(bt,bt.current),g)break;return null;case 22:case 23:return l.lanes=0,Gp(a,l,p)}return gi(a,l,p)}var Zp,Uf,Qp,em;Zp=function(a,l){for(var p=l.child;p!==null;){if(p.tag===5||p.tag===6)a.appendChild(p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===l)break;for(;p.sibling===null;){if(p.return===null||p.return===l)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Uf=function(){},Qp=function(a,l,p,g){var w=a.memoizedProps;if(w!==g){a=l.stateNode,ka(Yr.current);var k=null;switch(p){case"input":w=et(a,w),g=et(a,g),k=[];break;case"select":w=H({},w,{value:void 0}),g=H({},g,{value:void 0}),k=[];break;case"textarea":w=Dr(a,w),g=Dr(a,g),k=[];break;default:typeof w.onClick!="function"&&typeof g.onClick=="function"&&(a.onclick=zl)}fa(p,g);var N;p=null;for(fe in w)if(!g.hasOwnProperty(fe)&&w.hasOwnProperty(fe)&&w[fe]!=null)if(fe==="style"){var W=w[fe];for(N in W)W.hasOwnProperty(N)&&(p||(p={}),p[N]="")}else fe!=="dangerouslySetInnerHTML"&&fe!=="children"&&fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&fe!=="autoFocus"&&(i.hasOwnProperty(fe)?k||(k=[]):(k=k||[]).push(fe,null));for(fe in g){var Y=g[fe];if(W=w!=null?w[fe]:void 0,g.hasOwnProperty(fe)&&Y!==W&&(Y!=null||W!=null))if(fe==="style")if(W){for(N in W)!W.hasOwnProperty(N)||Y&&Y.hasOwnProperty(N)||(p||(p={}),p[N]="");for(N in Y)Y.hasOwnProperty(N)&&W[N]!==Y[N]&&(p||(p={}),p[N]=Y[N])}else p||(k||(k=[]),k.push(fe,p)),p=Y;else fe==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,W=W?W.__html:void 0,Y!=null&&W!==Y&&(k=k||[]).push(fe,Y)):fe==="children"?typeof Y!="string"&&typeof Y!="number"||(k=k||[]).push(fe,""+Y):fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&(i.hasOwnProperty(fe)?(Y!=null&&fe==="onScroll"&&Nt("scroll",a),k||W===Y||(k=[])):(k=k||[]).push(fe,Y))}p&&(k=k||[]).push("style",p);var fe=k;(l.updateQueue=fe)&&(l.flags|=4)}},em=function(a,l,p,g){p!==g&&(l.flags|=4)};function Ao(a,l){if(!Ut)switch(a.tailMode){case"hidden":l=a.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?a.tail=null:p.sibling=null;break;case"collapsed":p=a.tail;for(var g=null;p!==null;)p.alternate!==null&&(g=p),p=p.sibling;g===null?l||a.tail===null?a.tail=null:a.tail.sibling=null:g.sibling=null}}function In(a){var l=a.alternate!==null&&a.alternate.child===a.child,p=0,g=0;if(l)for(var w=a.child;w!==null;)p|=w.lanes|w.childLanes,g|=w.subtreeFlags&14680064,g|=w.flags&14680064,w.return=a,w=w.sibling;else for(w=a.child;w!==null;)p|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=a,w=w.sibling;return a.subtreeFlags|=g,a.childLanes=p,l}function D_(a,l,p){var g=l.pendingProps;switch(sf(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return In(l),null;case 1:return jn(l.type)&&Vl(),In(l),null;case 3:return g=l.stateNode,_s(),Ft($n),Ft(Cn),_f(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(a===null||a.child===null)&&(jl(l)?l.flags|=4:a===null||a.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Br!==null&&(Jf(Br),Br=null))),Uf(a,l),In(l),null;case 5:yf(l);var w=ka(To.current);if(p=l.type,a!==null&&l.stateNode!=null)Qp(a,l,p,g,w),a.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!g){if(l.stateNode===null)throw Error(n(166));return In(l),null}if(a=ka(Yr.current),jl(l)){g=l.stateNode,p=l.type;var k=l.memoizedProps;switch(g[Xr]=l,g[xo]=k,a=(l.mode&1)!==0,p){case"dialog":Nt("cancel",g),Nt("close",g);break;case"iframe":case"object":case"embed":Nt("load",g);break;case"video":case"audio":for(w=0;w<po.length;w++)Nt(po[w],g);break;case"source":Nt("error",g);break;case"img":case"image":case"link":Nt("error",g),Nt("load",g);break;case"details":Nt("toggle",g);break;case"input":dt(g,k),Nt("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!k.multiple},Nt("invalid",g);break;case"textarea":tr(g,k),Nt("invalid",g)}fa(p,k),w=null;for(var N in k)if(k.hasOwnProperty(N)){var W=k[N];N==="children"?typeof W=="string"?g.textContent!==W&&(k.suppressHydrationWarning!==!0&&Ul(g.textContent,W,a),w=["children",W]):typeof W=="number"&&g.textContent!==""+W&&(k.suppressHydrationWarning!==!0&&Ul(g.textContent,W,a),w=["children",""+W]):i.hasOwnProperty(N)&&W!=null&&N==="onScroll"&&Nt("scroll",g)}switch(p){case"input":Xe(g),yt(g,k,!0);break;case"textarea":Xe(g),yn(g);break;case"select":case"option":break;default:typeof k.onClick=="function"&&(g.onclick=zl)}g=w,l.updateQueue=g,g!==null&&(l.flags|=4)}else{N=w.nodeType===9?w:w.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Xt(p)),a==="http://www.w3.org/1999/xhtml"?p==="script"?(a=N.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof g.is=="string"?a=N.createElement(p,{is:g.is}):(a=N.createElement(p),p==="select"&&(N=a,g.multiple?N.multiple=!0:g.size&&(N.size=g.size))):a=N.createElementNS(a,p),a[Xr]=l,a[xo]=g,Zp(a,l,!1,!1),l.stateNode=a;e:{switch(N=da(p,g),p){case"dialog":Nt("cancel",a),Nt("close",a),w=g;break;case"iframe":case"object":case"embed":Nt("load",a),w=g;break;case"video":case"audio":for(w=0;w<po.length;w++)Nt(po[w],a);w=g;break;case"source":Nt("error",a),w=g;break;case"img":case"image":case"link":Nt("error",a),Nt("load",a),w=g;break;case"details":Nt("toggle",a),w=g;break;case"input":dt(a,g),w=et(a,g),Nt("invalid",a);break;case"option":w=g;break;case"select":a._wrapperState={wasMultiple:!!g.multiple},w=H({},g,{value:void 0}),Nt("invalid",a);break;case"textarea":tr(a,g),w=Dr(a,g),Nt("invalid",a);break;default:w=g}fa(p,w),W=w;for(k in W)if(W.hasOwnProperty(k)){var Y=W[k];k==="style"?rr(a,Y):k==="dangerouslySetInnerHTML"?(Y=Y?Y.__html:void 0,Y!=null&&En(a,Y)):k==="children"?typeof Y=="string"?(p!=="textarea"||Y!=="")&&Qe(a,Y):typeof Y=="number"&&Qe(a,""+Y):k!=="suppressContentEditableWarning"&&k!=="suppressHydrationWarning"&&k!=="autoFocus"&&(i.hasOwnProperty(k)?Y!=null&&k==="onScroll"&&Nt("scroll",a):Y!=null&&A(a,k,Y,N))}switch(p){case"input":Xe(a),yt(a,g,!1);break;case"textarea":Xe(a),yn(a);break;case"option":g.value!=null&&a.setAttribute("value",""+ve(g.value));break;case"select":a.multiple=!!g.multiple,k=g.value,k!=null?on(a,!!g.multiple,k,!1):g.defaultValue!=null&&on(a,!!g.multiple,g.defaultValue,!0);break;default:typeof w.onClick=="function"&&(a.onclick=zl)}switch(p){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return In(l),null;case 6:if(a&&l.stateNode!=null)em(a,l,a.memoizedProps,g);else{if(typeof g!="string"&&l.stateNode===null)throw Error(n(166));if(p=ka(To.current),ka(Yr.current),jl(l)){if(g=l.stateNode,p=l.memoizedProps,g[Xr]=l,(k=g.nodeValue!==p)&&(a=ar,a!==null))switch(a.tag){case 3:Ul(g.nodeValue,p,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Ul(g.nodeValue,p,(a.mode&1)!==0)}k&&(l.flags|=4)}else g=(p.nodeType===9?p:p.ownerDocument).createTextNode(g),g[Xr]=l,l.stateNode=g}return In(l),null;case 13:if(Ft(bt),g=l.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Ut&&sr!==null&&(l.mode&1)!==0&&(l.flags&128)===0)np(),xs(),l.flags|=98560,k=!1;else if(k=jl(l),g!==null&&g.dehydrated!==null){if(a===null){if(!k)throw Error(n(318));if(k=l.memoizedState,k=k!==null?k.dehydrated:null,!k)throw Error(n(317));k[Xr]=l}else xs(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;In(l),k=!1}else Br!==null&&(Jf(Br),Br=null),k=!0;if(!k)return l.flags&65536?l:null}return(l.flags&128)!==0?(l.lanes=p,l):(g=g!==null,g!==(a!==null&&a.memoizedState!==null)&&g&&(l.child.flags|=8192,(l.mode&1)!==0&&(a===null||(bt.current&1)!==0?un===0&&(un=3):Zf())),l.updateQueue!==null&&(l.flags|=4),In(l),null);case 4:return _s(),Uf(a,l),a===null&&mo(l.stateNode.containerInfo),In(l),null;case 10:return df(l.type._context),In(l),null;case 17:return jn(l.type)&&Vl(),In(l),null;case 19:if(Ft(bt),k=l.memoizedState,k===null)return In(l),null;if(g=(l.flags&128)!==0,N=k.rendering,N===null)if(g)Ao(k,!1);else{if(un!==0||a!==null&&(a.flags&128)!==0)for(a=l.child;a!==null;){if(N=Ql(a),N!==null){for(l.flags|=128,Ao(k,!1),g=N.updateQueue,g!==null&&(l.updateQueue=g,l.flags|=4),l.subtreeFlags=0,g=p,p=l.child;p!==null;)k=p,a=g,k.flags&=14680066,N=k.alternate,N===null?(k.childLanes=0,k.lanes=a,k.child=null,k.subtreeFlags=0,k.memoizedProps=null,k.memoizedState=null,k.updateQueue=null,k.dependencies=null,k.stateNode=null):(k.childLanes=N.childLanes,k.lanes=N.lanes,k.child=N.child,k.subtreeFlags=0,k.deletions=null,k.memoizedProps=N.memoizedProps,k.memoizedState=N.memoizedState,k.updateQueue=N.updateQueue,k.type=N.type,a=N.dependencies,k.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),p=p.sibling;return Ct(bt,bt.current&1|2),l.child}a=a.sibling}k.tail!==null&&_e()>Es&&(l.flags|=128,g=!0,Ao(k,!1),l.lanes=4194304)}else{if(!g)if(a=Ql(N),a!==null){if(l.flags|=128,g=!0,p=a.updateQueue,p!==null&&(l.updateQueue=p,l.flags|=4),Ao(k,!0),k.tail===null&&k.tailMode==="hidden"&&!N.alternate&&!Ut)return In(l),null}else 2*_e()-k.renderingStartTime>Es&&p!==1073741824&&(l.flags|=128,g=!0,Ao(k,!1),l.lanes=4194304);k.isBackwards?(N.sibling=l.child,l.child=N):(p=k.last,p!==null?p.sibling=N:l.child=N,k.last=N)}return k.tail!==null?(l=k.tail,k.rendering=l,k.tail=l.sibling,k.renderingStartTime=_e(),l.sibling=null,p=bt.current,Ct(bt,g?p&1|2:p&1),l):(In(l),null);case 22:case 23:return Yf(),g=l.memoizedState!==null,a!==null&&a.memoizedState!==null!==g&&(l.flags|=8192),g&&(l.mode&1)!==0?(or&1073741824)!==0&&(In(l),l.subtreeFlags&6&&(l.flags|=8192)):In(l),null;case 24:return null;case 25:return null}throw Error(n(156,l.tag))}function P_(a,l){switch(sf(l),l.tag){case 1:return jn(l.type)&&Vl(),a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 3:return _s(),Ft($n),Ft(Cn),_f(),a=l.flags,(a&65536)!==0&&(a&128)===0?(l.flags=a&-65537|128,l):null;case 5:return yf(l),null;case 13:if(Ft(bt),a=l.memoizedState,a!==null&&a.dehydrated!==null){if(l.alternate===null)throw Error(n(340));xs()}return a=l.flags,a&65536?(l.flags=a&-65537|128,l):null;case 19:return Ft(bt),null;case 4:return _s(),null;case 10:return df(l.type._context),null;case 22:case 23:return Yf(),null;case 24:return null;default:return null}}var ou=!1,Nn=!1,M_=typeof WeakSet=="function"?WeakSet:Set,Ue=null;function ks(a,l){var p=a.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(g){$t(a,l,g)}else p.current=null}function zf(a,l,p){try{p()}catch(g){$t(a,l,g)}}var tm=!1;function L_(a,l){if(Xc=Al,a=Dh(),Hc(a)){if("selectionStart"in a)var p={start:a.selectionStart,end:a.selectionEnd};else e:{p=(p=a.ownerDocument)&&p.defaultView||window;var g=p.getSelection&&p.getSelection();if(g&&g.rangeCount!==0){p=g.anchorNode;var w=g.anchorOffset,k=g.focusNode;g=g.focusOffset;try{p.nodeType,k.nodeType}catch{p=null;break e}var N=0,W=-1,Y=-1,fe=0,Ee=0,Ne=a,Se=null;t:for(;;){for(var Oe;Ne!==p||w!==0&&Ne.nodeType!==3||(W=N+w),Ne!==k||g!==0&&Ne.nodeType!==3||(Y=N+g),Ne.nodeType===3&&(N+=Ne.nodeValue.length),(Oe=Ne.firstChild)!==null;)Se=Ne,Ne=Oe;for(;;){if(Ne===a)break t;if(Se===p&&++fe===w&&(W=N),Se===k&&++Ee===g&&(Y=N),(Oe=Ne.nextSibling)!==null)break;Ne=Se,Se=Ne.parentNode}Ne=Oe}p=W===-1||Y===-1?null:{start:W,end:Y}}else p=null}p=p||{start:0,end:0}}else p=null;for(Yc={focusedElem:a,selectionRange:p},Al=!1,Ue=l;Ue!==null;)if(l=Ue,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,Ue=a;else for(;Ue!==null;){l=Ue;try{var ze=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(ze!==null){var be=ze.memoizedProps,Yt=ze.memoizedState,ie=l.stateNode,ee=ie.getSnapshotBeforeUpdate(l.elementType===l.type?be:Or(l.type,be),Yt);ie.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var oe=l.stateNode.containerInfo;oe.nodeType===1?oe.textContent="":oe.nodeType===9&&oe.documentElement&&oe.removeChild(oe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Pe){$t(l,l.return,Pe)}if(a=l.sibling,a!==null){a.return=l.return,Ue=a;break}Ue=l.return}return ze=tm,tm=!1,ze}function Io(a,l,p){var g=l.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var w=g=g.next;do{if((w.tag&a)===a){var k=w.destroy;w.destroy=void 0,k!==void 0&&zf(l,p,k)}w=w.next}while(w!==g)}}function lu(a,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var p=l=l.next;do{if((p.tag&a)===a){var g=p.create;p.destroy=g()}p=p.next}while(p!==l)}}function bf(a){var l=a.ref;if(l!==null){var p=a.stateNode;switch(a.tag){case 5:a=p;break;default:a=p}typeof l=="function"?l(a):l.current=a}}function nm(a){var l=a.alternate;l!==null&&(a.alternate=null,nm(l)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(l=a.stateNode,l!==null&&(delete l[Xr],delete l[xo],delete l[tf],delete l[x_],delete l[v_])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function rm(a){return a.tag===5||a.tag===3||a.tag===4}function im(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||rm(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function Vf(a,l,p){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?p.nodeType===8?p.parentNode.insertBefore(a,l):p.insertBefore(a,l):(p.nodeType===8?(l=p.parentNode,l.insertBefore(a,p)):(l=p,l.appendChild(a)),p=p._reactRootContainer,p!=null||l.onclick!==null||(l.onclick=zl));else if(g!==4&&(a=a.child,a!==null))for(Vf(a,l,p),a=a.sibling;a!==null;)Vf(a,l,p),a=a.sibling}function Hf(a,l,p){var g=a.tag;if(g===5||g===6)a=a.stateNode,l?p.insertBefore(a,l):p.appendChild(a);else if(g!==4&&(a=a.child,a!==null))for(Hf(a,l,p),a=a.sibling;a!==null;)Hf(a,l,p),a=a.sibling}var wn=null,Ur=!1;function ji(a,l,p){for(p=p.child;p!==null;)am(a,l,p),p=p.sibling}function am(a,l,p){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(pr,p)}catch{}switch(p.tag){case 5:Nn||ks(p,l);case 6:var g=wn,w=Ur;wn=null,ji(a,l,p),wn=g,Ur=w,wn!==null&&(Ur?(a=wn,p=p.stateNode,a.nodeType===8?a.parentNode.removeChild(p):a.removeChild(p)):wn.removeChild(p.stateNode));break;case 18:wn!==null&&(Ur?(a=wn,p=p.stateNode,a.nodeType===8?ef(a.parentNode,p):a.nodeType===1&&ef(a,p),ao(a)):ef(wn,p.stateNode));break;case 4:g=wn,w=Ur,wn=p.stateNode.containerInfo,Ur=!0,ji(a,l,p),wn=g,Ur=w;break;case 0:case 11:case 14:case 15:if(!Nn&&(g=p.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){w=g=g.next;do{var k=w,N=k.destroy;k=k.tag,N!==void 0&&((k&2)!==0||(k&4)!==0)&&zf(p,l,N),w=w.next}while(w!==g)}ji(a,l,p);break;case 1:if(!Nn&&(ks(p,l),g=p.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=p.memoizedProps,g.state=p.memoizedState,g.componentWillUnmount()}catch(W){$t(p,l,W)}ji(a,l,p);break;case 21:ji(a,l,p);break;case 22:p.mode&1?(Nn=(g=Nn)||p.memoizedState!==null,ji(a,l,p),Nn=g):ji(a,l,p);break;default:ji(a,l,p)}}function sm(a){var l=a.updateQueue;if(l!==null){a.updateQueue=null;var p=a.stateNode;p===null&&(p=a.stateNode=new M_),l.forEach(function(g){var w=G_.bind(null,a,g);p.has(g)||(p.add(g),g.then(w,w))})}}function zr(a,l){var p=l.deletions;if(p!==null)for(var g=0;g<p.length;g++){var w=p[g];try{var k=a,N=l,W=N;e:for(;W!==null;){switch(W.tag){case 5:wn=W.stateNode,Ur=!1;break e;case 3:wn=W.stateNode.containerInfo,Ur=!0;break e;case 4:wn=W.stateNode.containerInfo,Ur=!0;break e}W=W.return}if(wn===null)throw Error(n(160));am(k,N,w),wn=null,Ur=!1;var Y=w.alternate;Y!==null&&(Y.return=null),w.return=null}catch(fe){$t(w,l,fe)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)om(l,a),l=l.sibling}function om(a,l){var p=a.alternate,g=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(zr(l,a),Qr(a),g&4){try{Io(3,a,a.return),lu(3,a)}catch(be){$t(a,a.return,be)}try{Io(5,a,a.return)}catch(be){$t(a,a.return,be)}}break;case 1:zr(l,a),Qr(a),g&512&&p!==null&&ks(p,p.return);break;case 5:if(zr(l,a),Qr(a),g&512&&p!==null&&ks(p,p.return),a.flags&32){var w=a.stateNode;try{Qe(w,"")}catch(be){$t(a,a.return,be)}}if(g&4&&(w=a.stateNode,w!=null)){var k=a.memoizedProps,N=p!==null?p.memoizedProps:k,W=a.type,Y=a.updateQueue;if(a.updateQueue=null,Y!==null)try{W==="input"&&k.type==="radio"&&k.name!=null&&tt(w,k),da(W,N);var fe=da(W,k);for(N=0;N<Y.length;N+=2){var Ee=Y[N],Ne=Y[N+1];Ee==="style"?rr(w,Ne):Ee==="dangerouslySetInnerHTML"?En(w,Ne):Ee==="children"?Qe(w,Ne):A(w,Ee,Ne,fe)}switch(W){case"input":Be(w,k);break;case"textarea":Bt(w,k);break;case"select":var Se=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!k.multiple;var Oe=k.value;Oe!=null?on(w,!!k.multiple,Oe,!1):Se!==!!k.multiple&&(k.defaultValue!=null?on(w,!!k.multiple,k.defaultValue,!0):on(w,!!k.multiple,k.multiple?[]:"",!1))}w[xo]=k}catch(be){$t(a,a.return,be)}}break;case 6:if(zr(l,a),Qr(a),g&4){if(a.stateNode===null)throw Error(n(162));w=a.stateNode,k=a.memoizedProps;try{w.nodeValue=k}catch(be){$t(a,a.return,be)}}break;case 3:if(zr(l,a),Qr(a),g&4&&p!==null&&p.memoizedState.isDehydrated)try{ao(l.containerInfo)}catch(be){$t(a,a.return,be)}break;case 4:zr(l,a),Qr(a);break;case 13:zr(l,a),Qr(a),w=a.child,w.flags&8192&&(k=w.memoizedState!==null,w.stateNode.isHidden=k,!k||w.alternate!==null&&w.alternate.memoizedState!==null||($f=_e())),g&4&&sm(a);break;case 22:if(Ee=p!==null&&p.memoizedState!==null,a.mode&1?(Nn=(fe=Nn)||Ee,zr(l,a),Nn=fe):zr(l,a),Qr(a),g&8192){if(fe=a.memoizedState!==null,(a.stateNode.isHidden=fe)&&!Ee&&(a.mode&1)!==0)for(Ue=a,Ee=a.child;Ee!==null;){for(Ne=Ue=Ee;Ue!==null;){switch(Se=Ue,Oe=Se.child,Se.tag){case 0:case 11:case 14:case 15:Io(4,Se,Se.return);break;case 1:ks(Se,Se.return);var ze=Se.stateNode;if(typeof ze.componentWillUnmount=="function"){g=Se,p=Se.return;try{l=g,ze.props=l.memoizedProps,ze.state=l.memoizedState,ze.componentWillUnmount()}catch(be){$t(g,p,be)}}break;case 5:ks(Se,Se.return);break;case 22:if(Se.memoizedState!==null){cm(Ne);continue}}Oe!==null?(Oe.return=Se,Ue=Oe):cm(Ne)}Ee=Ee.sibling}e:for(Ee=null,Ne=a;;){if(Ne.tag===5){if(Ee===null){Ee=Ne;try{w=Ne.stateNode,fe?(k=w.style,typeof k.setProperty=="function"?k.setProperty("display","none","important"):k.display="none"):(W=Ne.stateNode,Y=Ne.memoizedProps.style,N=Y!=null&&Y.hasOwnProperty("display")?Y.display:null,W.style.display=Ot("display",N))}catch(be){$t(a,a.return,be)}}}else if(Ne.tag===6){if(Ee===null)try{Ne.stateNode.nodeValue=fe?"":Ne.memoizedProps}catch(be){$t(a,a.return,be)}}else if((Ne.tag!==22&&Ne.tag!==23||Ne.memoizedState===null||Ne===a)&&Ne.child!==null){Ne.child.return=Ne,Ne=Ne.child;continue}if(Ne===a)break e;for(;Ne.sibling===null;){if(Ne.return===null||Ne.return===a)break e;Ee===Ne&&(Ee=null),Ne=Ne.return}Ee===Ne&&(Ee=null),Ne.sibling.return=Ne.return,Ne=Ne.sibling}}break;case 19:zr(l,a),Qr(a),g&4&&sm(a);break;case 21:break;default:zr(l,a),Qr(a)}}function Qr(a){var l=a.flags;if(l&2){try{e:{for(var p=a.return;p!==null;){if(rm(p)){var g=p;break e}p=p.return}throw Error(n(160))}switch(g.tag){case 5:var w=g.stateNode;g.flags&32&&(Qe(w,""),g.flags&=-33);var k=im(a);Hf(a,k,w);break;case 3:case 4:var N=g.stateNode.containerInfo,W=im(a);Vf(a,W,N);break;default:throw Error(n(161))}}catch(Y){$t(a,a.return,Y)}a.flags&=-3}l&4096&&(a.flags&=-4097)}function B_(a,l,p){Ue=a,lm(a)}function lm(a,l,p){for(var g=(a.mode&1)!==0;Ue!==null;){var w=Ue,k=w.child;if(w.tag===22&&g){var N=w.memoizedState!==null||ou;if(!N){var W=w.alternate,Y=W!==null&&W.memoizedState!==null||Nn;W=ou;var fe=Nn;if(ou=N,(Nn=Y)&&!fe)for(Ue=w;Ue!==null;)N=Ue,Y=N.child,N.tag===22&&N.memoizedState!==null?fm(w):Y!==null?(Y.return=N,Ue=Y):fm(w);for(;k!==null;)Ue=k,lm(k),k=k.sibling;Ue=w,ou=W,Nn=fe}um(a)}else(w.subtreeFlags&8772)!==0&&k!==null?(k.return=w,Ue=k):um(a)}}function um(a){for(;Ue!==null;){var l=Ue;if((l.flags&8772)!==0){var p=l.alternate;try{if((l.flags&8772)!==0)switch(l.tag){case 0:case 11:case 15:Nn||lu(5,l);break;case 1:var g=l.stateNode;if(l.flags&4&&!Nn)if(p===null)g.componentDidMount();else{var w=l.elementType===l.type?p.memoizedProps:Or(l.type,p.memoizedProps);g.componentDidUpdate(w,p.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var k=l.updateQueue;k!==null&&sp(l,k,g);break;case 3:var N=l.updateQueue;if(N!==null){if(p=null,l.child!==null)switch(l.child.tag){case 5:p=l.child.stateNode;break;case 1:p=l.child.stateNode}sp(l,N,p)}break;case 5:var W=l.stateNode;if(p===null&&l.flags&4){p=W;var Y=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":Y.autoFocus&&p.focus();break;case"img":Y.src&&(p.src=Y.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var fe=l.alternate;if(fe!==null){var Ee=fe.memoizedState;if(Ee!==null){var Ne=Ee.dehydrated;Ne!==null&&ao(Ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Nn||l.flags&512&&bf(l)}catch(Se){$t(l,l.return,Se)}}if(l===a){Ue=null;break}if(p=l.sibling,p!==null){p.return=l.return,Ue=p;break}Ue=l.return}}function cm(a){for(;Ue!==null;){var l=Ue;if(l===a){Ue=null;break}var p=l.sibling;if(p!==null){p.return=l.return,Ue=p;break}Ue=l.return}}function fm(a){for(;Ue!==null;){var l=Ue;try{switch(l.tag){case 0:case 11:case 15:var p=l.return;try{lu(4,l)}catch(Y){$t(l,p,Y)}break;case 1:var g=l.stateNode;if(typeof g.componentDidMount=="function"){var w=l.return;try{g.componentDidMount()}catch(Y){$t(l,w,Y)}}var k=l.return;try{bf(l)}catch(Y){$t(l,k,Y)}break;case 5:var N=l.return;try{bf(l)}catch(Y){$t(l,N,Y)}}}catch(Y){$t(l,l.return,Y)}if(l===a){Ue=null;break}var W=l.sibling;if(W!==null){W.return=l.return,Ue=W;break}Ue=l.return}}var O_=Math.ceil,uu=D.ReactCurrentDispatcher,Wf=D.ReactCurrentOwner,yr=D.ReactCurrentBatchConfig,lt=0,hn=null,nn=null,_n=0,or=0,Ss=Vi(0),un=0,No=null,Ea=0,cu=0,Gf=0,Fo=null,Kn=null,$f=0,Es=1/0,xi=null,fu=!1,jf=null,qi=null,du=!1,Ki=null,hu=0,Ro=0,qf=null,pu=-1,mu=0;function bn(){return(lt&6)!==0?_e():pu!==-1?pu:pu=_e()}function Ji(a){return(a.mode&1)===0?1:(lt&2)!==0&&_n!==0?_n&-_n:w_.transition!==null?(mu===0&&(mu=rh()),mu):(a=wt,a!==0||(a=window.event,a=a===void 0?16:dh(a.type)),a)}function br(a,l,p,g){if(50<Ro)throw Ro=0,qf=null,Error(n(185));eo(a,p,g),((lt&2)===0||a!==hn)&&(a===hn&&((lt&2)===0&&(cu|=p),un===4&&Xi(a,_n)),Jn(a,g),p===1&&lt===0&&(l.mode&1)===0&&(Es=_e()+500,Wl&&Wi()))}function Jn(a,l){var p=a.callbackNode;ww(a,l);var g=Sl(a,a===hn?_n:0);if(g===0)p!==null&&de(p),a.callbackNode=null,a.callbackPriority=0;else if(l=g&-g,a.callbackPriority!==l){if(p!=null&&de(p),l===1)a.tag===0?y_(hm.bind(null,a)):Yh(hm.bind(null,a)),m_(function(){(lt&6)===0&&Wi()}),p=null;else{switch(ih(g)){case 1:p=xt;break;case 4:p=ht;break;case 16:p=It;break;case 536870912:p=Kr;break;default:p=It}p=_m(p,dm.bind(null,a))}a.callbackPriority=l,a.callbackNode=p}}function dm(a,l){if(pu=-1,mu=0,(lt&6)!==0)throw Error(n(327));var p=a.callbackNode;if(Cs()&&a.callbackNode!==p)return null;var g=Sl(a,a===hn?_n:0);if(g===0)return null;if((g&30)!==0||(g&a.expiredLanes)!==0||l)l=gu(a,g);else{l=g;var w=lt;lt|=2;var k=mm();(hn!==a||_n!==l)&&(xi=null,Es=_e()+500,Aa(a,l));do try{b_();break}catch(W){pm(a,W)}while(!0);ff(),uu.current=k,lt=w,nn!==null?l=0:(hn=null,_n=0,l=un)}if(l!==0){if(l===2&&(w=Cc(a),w!==0&&(g=w,l=Kf(a,w))),l===1)throw p=No,Aa(a,0),Xi(a,g),Jn(a,_e()),p;if(l===6)Xi(a,g);else{if(w=a.current.alternate,(g&30)===0&&!U_(w)&&(l=gu(a,g),l===2&&(k=Cc(a),k!==0&&(g=k,l=Kf(a,k))),l===1))throw p=No,Aa(a,0),Xi(a,g),Jn(a,_e()),p;switch(a.finishedWork=w,a.finishedLanes=g,l){case 0:case 1:throw Error(n(345));case 2:Ia(a,Kn,xi);break;case 3:if(Xi(a,g),(g&130023424)===g&&(l=$f+500-_e(),10<l)){if(Sl(a,0)!==0)break;if(w=a.suspendedLanes,(w&g)!==g){bn(),a.pingedLanes|=a.suspendedLanes&w;break}a.timeoutHandle=Qc(Ia.bind(null,a,Kn,xi),l);break}Ia(a,Kn,xi);break;case 4:if(Xi(a,g),(g&4194240)===g)break;for(l=a.eventTimes,w=-1;0<g;){var N=31-zt(g);k=1<<N,N=l[N],N>w&&(w=N),g&=~k}if(g=w,g=_e()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*O_(g/1960))-g,10<g){a.timeoutHandle=Qc(Ia.bind(null,a,Kn,xi),g);break}Ia(a,Kn,xi);break;case 5:Ia(a,Kn,xi);break;default:throw Error(n(329))}}}return Jn(a,_e()),a.callbackNode===p?dm.bind(null,a):null}function Kf(a,l){var p=Fo;return a.current.memoizedState.isDehydrated&&(Aa(a,l).flags|=256),a=gu(a,l),a!==2&&(l=Kn,Kn=p,l!==null&&Jf(l)),a}function Jf(a){Kn===null?Kn=a:Kn.push.apply(Kn,a)}function U_(a){for(var l=a;;){if(l.flags&16384){var p=l.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var g=0;g<p.length;g++){var w=p[g],k=w.getSnapshot;w=w.value;try{if(!Lr(k(),w))return!1}catch{return!1}}}if(p=l.child,l.subtreeFlags&16384&&p!==null)p.return=l,l=p;else{if(l===a)break;for(;l.sibling===null;){if(l.return===null||l.return===a)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Xi(a,l){for(l&=~Gf,l&=~cu,a.suspendedLanes|=l,a.pingedLanes&=~l,a=a.expirationTimes;0<l;){var p=31-zt(l),g=1<<p;a[p]=-1,l&=~g}}function hm(a){if((lt&6)!==0)throw Error(n(327));Cs();var l=Sl(a,0);if((l&1)===0)return Jn(a,_e()),null;var p=gu(a,l);if(a.tag!==0&&p===2){var g=Cc(a);g!==0&&(l=g,p=Kf(a,g))}if(p===1)throw p=No,Aa(a,0),Xi(a,l),Jn(a,_e()),p;if(p===6)throw Error(n(345));return a.finishedWork=a.current.alternate,a.finishedLanes=l,Ia(a,Kn,xi),Jn(a,_e()),null}function Xf(a,l){var p=lt;lt|=1;try{return a(l)}finally{lt=p,lt===0&&(Es=_e()+500,Wl&&Wi())}}function Ca(a){Ki!==null&&Ki.tag===0&&(lt&6)===0&&Cs();var l=lt;lt|=1;var p=yr.transition,g=wt;try{if(yr.transition=null,wt=1,a)return a()}finally{wt=g,yr.transition=p,lt=l,(lt&6)===0&&Wi()}}function Yf(){or=Ss.current,Ft(Ss)}function Aa(a,l){a.finishedWork=null,a.finishedLanes=0;var p=a.timeoutHandle;if(p!==-1&&(a.timeoutHandle=-1,p_(p)),nn!==null)for(p=nn.return;p!==null;){var g=p;switch(sf(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Vl();break;case 3:_s(),Ft($n),Ft(Cn),_f();break;case 5:yf(g);break;case 4:_s();break;case 13:Ft(bt);break;case 19:Ft(bt);break;case 10:df(g.type._context);break;case 22:case 23:Yf()}p=p.return}if(hn=a,nn=a=Yi(a.current,null),_n=or=l,un=0,No=null,Gf=cu=Ea=0,Kn=Fo=null,Ta!==null){for(l=0;l<Ta.length;l++)if(p=Ta[l],g=p.interleaved,g!==null){p.interleaved=null;var w=g.next,k=p.pending;if(k!==null){var N=k.next;k.next=w,g.next=N}p.pending=g}Ta=null}return a}function pm(a,l){do{var p=nn;try{if(ff(),eu.current=iu,tu){for(var g=Vt.memoizedState;g!==null;){var w=g.queue;w!==null&&(w.pending=null),g=g.next}tu=!1}if(Sa=0,dn=ln=Vt=null,ko=!1,So=0,Wf.current=null,p===null||p.return===null){un=1,No=l,nn=null;break}e:{var k=a,N=p.return,W=p,Y=l;if(l=_n,W.flags|=32768,Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var fe=Y,Ee=W,Ne=Ee.tag;if((Ee.mode&1)===0&&(Ne===0||Ne===11||Ne===15)){var Se=Ee.alternate;Se?(Ee.updateQueue=Se.updateQueue,Ee.memoizedState=Se.memoizedState,Ee.lanes=Se.lanes):(Ee.updateQueue=null,Ee.memoizedState=null)}var Oe=zp(N);if(Oe!==null){Oe.flags&=-257,bp(Oe,N,W,k,l),Oe.mode&1&&Up(k,fe,l),l=Oe,Y=fe;var ze=l.updateQueue;if(ze===null){var be=new Set;be.add(Y),l.updateQueue=be}else ze.add(Y);break e}else{if((l&1)===0){Up(k,fe,l),Zf();break e}Y=Error(n(426))}}else if(Ut&&W.mode&1){var Yt=zp(N);if(Yt!==null){(Yt.flags&65536)===0&&(Yt.flags|=256),bp(Yt,N,W,k,l),uf(Ts(Y,W));break e}}k=Y=Ts(Y,W),un!==4&&(un=2),Fo===null?Fo=[k]:Fo.push(k),k=N;do{switch(k.tag){case 3:k.flags|=65536,l&=-l,k.lanes|=l;var ie=Bp(k,Y,l);ap(k,ie);break e;case 1:W=Y;var ee=k.type,oe=k.stateNode;if((k.flags&128)===0&&(typeof ee.getDerivedStateFromError=="function"||oe!==null&&typeof oe.componentDidCatch=="function"&&(qi===null||!qi.has(oe)))){k.flags|=65536,l&=-l,k.lanes|=l;var Pe=Op(k,W,l);ap(k,Pe);break e}}k=k.return}while(k!==null)}xm(p)}catch(Ve){l=Ve,nn===p&&p!==null&&(nn=p=p.return);continue}break}while(!0)}function mm(){var a=uu.current;return uu.current=iu,a===null?iu:a}function Zf(){(un===0||un===3||un===2)&&(un=4),hn===null||(Ea&268435455)===0&&(cu&268435455)===0||Xi(hn,_n)}function gu(a,l){var p=lt;lt|=2;var g=mm();(hn!==a||_n!==l)&&(xi=null,Aa(a,l));do try{z_();break}catch(w){pm(a,w)}while(!0);if(ff(),lt=p,uu.current=g,nn!==null)throw Error(n(261));return hn=null,_n=0,un}function z_(){for(;nn!==null;)gm(nn)}function b_(){for(;nn!==null&&!Fe();)gm(nn)}function gm(a){var l=wm(a.alternate,a,or);a.memoizedProps=a.pendingProps,l===null?xm(a):nn=l,Wf.current=null}function xm(a){var l=a;do{var p=l.alternate;if(a=l.return,(l.flags&32768)===0){if(p=D_(p,l,or),p!==null){nn=p;return}}else{if(p=P_(p,l),p!==null){p.flags&=32767,nn=p;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{un=6,nn=null;return}}if(l=l.sibling,l!==null){nn=l;return}nn=l=a}while(l!==null);un===0&&(un=5)}function Ia(a,l,p){var g=wt,w=yr.transition;try{yr.transition=null,wt=1,V_(a,l,p,g)}finally{yr.transition=w,wt=g}return null}function V_(a,l,p,g){do Cs();while(Ki!==null);if((lt&6)!==0)throw Error(n(327));p=a.finishedWork;var w=a.finishedLanes;if(p===null)return null;if(a.finishedWork=null,a.finishedLanes=0,p===a.current)throw Error(n(177));a.callbackNode=null,a.callbackPriority=0;var k=p.lanes|p.childLanes;if(_w(a,k),a===hn&&(nn=hn=null,_n=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||du||(du=!0,_m(It,function(){return Cs(),null})),k=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||k){k=yr.transition,yr.transition=null;var N=wt;wt=1;var W=lt;lt|=4,Wf.current=null,L_(a,p),om(p,a),o_(Yc),Al=!!Xc,Yc=Xc=null,a.current=p,B_(p),Ie(),lt=W,wt=N,yr.transition=k}else a.current=p;if(du&&(du=!1,Ki=a,hu=w),k=a.pendingLanes,k===0&&(qi=null),ma(p.stateNode),Jn(a,_e()),l!==null)for(g=a.onRecoverableError,p=0;p<l.length;p++)w=l[p],g(w.value,{componentStack:w.stack,digest:w.digest});if(fu)throw fu=!1,a=jf,jf=null,a;return(hu&1)!==0&&a.tag!==0&&Cs(),k=a.pendingLanes,(k&1)!==0?a===qf?Ro++:(Ro=0,qf=a):Ro=0,Wi(),null}function Cs(){if(Ki!==null){var a=ih(hu),l=yr.transition,p=wt;try{if(yr.transition=null,wt=16>a?16:a,Ki===null)var g=!1;else{if(a=Ki,Ki=null,hu=0,(lt&6)!==0)throw Error(n(331));var w=lt;for(lt|=4,Ue=a.current;Ue!==null;){var k=Ue,N=k.child;if((Ue.flags&16)!==0){var W=k.deletions;if(W!==null){for(var Y=0;Y<W.length;Y++){var fe=W[Y];for(Ue=fe;Ue!==null;){var Ee=Ue;switch(Ee.tag){case 0:case 11:case 15:Io(8,Ee,k)}var Ne=Ee.child;if(Ne!==null)Ne.return=Ee,Ue=Ne;else for(;Ue!==null;){Ee=Ue;var Se=Ee.sibling,Oe=Ee.return;if(nm(Ee),Ee===fe){Ue=null;break}if(Se!==null){Se.return=Oe,Ue=Se;break}Ue=Oe}}}var ze=k.alternate;if(ze!==null){var be=ze.child;if(be!==null){ze.child=null;do{var Yt=be.sibling;be.sibling=null,be=Yt}while(be!==null)}}Ue=k}}if((k.subtreeFlags&2064)!==0&&N!==null)N.return=k,Ue=N;else e:for(;Ue!==null;){if(k=Ue,(k.flags&2048)!==0)switch(k.tag){case 0:case 11:case 15:Io(9,k,k.return)}var ie=k.sibling;if(ie!==null){ie.return=k.return,Ue=ie;break e}Ue=k.return}}var ee=a.current;for(Ue=ee;Ue!==null;){N=Ue;var oe=N.child;if((N.subtreeFlags&2064)!==0&&oe!==null)oe.return=N,Ue=oe;else e:for(N=ee;Ue!==null;){if(W=Ue,(W.flags&2048)!==0)try{switch(W.tag){case 0:case 11:case 15:lu(9,W)}}catch(Ve){$t(W,W.return,Ve)}if(W===N){Ue=null;break e}var Pe=W.sibling;if(Pe!==null){Pe.return=W.return,Ue=Pe;break e}Ue=W.return}}if(lt=w,Wi(),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(pr,a)}catch{}g=!0}return g}finally{wt=p,yr.transition=l}}return!1}function vm(a,l,p){l=Ts(p,l),l=Bp(a,l,1),a=$i(a,l,1),l=bn(),a!==null&&(eo(a,1,l),Jn(a,l))}function $t(a,l,p){if(a.tag===3)vm(a,a,p);else for(;l!==null;){if(l.tag===3){vm(l,a,p);break}else if(l.tag===1){var g=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(qi===null||!qi.has(g))){a=Ts(p,a),a=Op(l,a,1),l=$i(l,a,1),a=bn(),l!==null&&(eo(l,1,a),Jn(l,a));break}}l=l.return}}function H_(a,l,p){var g=a.pingCache;g!==null&&g.delete(l),l=bn(),a.pingedLanes|=a.suspendedLanes&p,hn===a&&(_n&p)===p&&(un===4||un===3&&(_n&130023424)===_n&&500>_e()-$f?Aa(a,0):Gf|=p),Jn(a,l)}function ym(a,l){l===0&&((a.mode&1)===0?l=1:(l=ga,ga<<=1,(ga&130023424)===0&&(ga=4194304)));var p=bn();a=pi(a,l),a!==null&&(eo(a,l,p),Jn(a,p))}function W_(a){var l=a.memoizedState,p=0;l!==null&&(p=l.retryLane),ym(a,p)}function G_(a,l){var p=0;switch(a.tag){case 13:var g=a.stateNode,w=a.memoizedState;w!==null&&(p=w.retryLane);break;case 19:g=a.stateNode;break;default:throw Error(n(314))}g!==null&&g.delete(l),ym(a,p)}var wm;wm=function(a,l,p){if(a!==null)if(a.memoizedProps!==l.pendingProps||$n.current)qn=!0;else{if((a.lanes&p)===0&&(l.flags&128)===0)return qn=!1,R_(a,l,p);qn=(a.flags&131072)!==0}else qn=!1,Ut&&(l.flags&1048576)!==0&&Zh(l,$l,l.index);switch(l.lanes=0,l.tag){case 2:var g=l.type;su(a,l),a=l.pendingProps;var w=ps(l,Cn.current);ys(l,p),w=Sf(null,l,g,a,w,p);var k=Ef();return l.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,jn(g)?(k=!0,Hl(l)):k=!1,l.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,mf(l),w.updater=Yl,l.stateNode=w,w._reactInternals=l,xf(l,g,a,p),l=Pf(null,l,g,!0,k,p)):(l.tag=0,Ut&&k&&af(l),zn(null,l,w,p),l=l.child),l;case 16:g=l.elementType;e:{switch(su(a,l),a=l.pendingProps,w=g._init,g=w(g._payload),l.type=g,w=l.tag=j_(g),a=Or(g,a),w){case 0:l=Df(null,l,g,a,p);break e;case 1:l=jp(null,l,g,a,p);break e;case 11:l=Vp(null,l,g,a,p);break e;case 14:l=Hp(null,l,g,Or(g.type,a),p);break e}throw Error(n(306,g,""))}return l;case 0:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:Or(g,w),Df(a,l,g,w,p);case 1:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:Or(g,w),jp(a,l,g,w,p);case 3:e:{if(qp(l),a===null)throw Error(n(387));g=l.pendingProps,k=l.memoizedState,w=k.element,ip(a,l),Xl(l,g,null,p);var N=l.memoizedState;if(g=N.element,k.isDehydrated)if(k={element:g,isDehydrated:!1,cache:N.cache,pendingSuspenseBoundaries:N.pendingSuspenseBoundaries,transitions:N.transitions},l.updateQueue.baseState=k,l.memoizedState=k,l.flags&256){w=Ts(Error(n(423)),l),l=Kp(a,l,g,p,w);break e}else if(g!==w){w=Ts(Error(n(424)),l),l=Kp(a,l,g,p,w);break e}else for(sr=bi(l.stateNode.containerInfo.firstChild),ar=l,Ut=!0,Br=null,p=hp(l,null,g,p),l.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(xs(),g===w){l=gi(a,l,p);break e}zn(a,l,g,p)}l=l.child}return l;case 5:return pp(l),a===null&&lf(l),g=l.type,w=l.pendingProps,k=a!==null?a.memoizedProps:null,N=w.children,Zc(g,w)?N=null:k!==null&&Zc(g,k)&&(l.flags|=32),$p(a,l),zn(a,l,N,p),l.child;case 6:return a===null&&lf(l),null;case 13:return Jp(a,l,p);case 4:return vf(l,l.stateNode.containerInfo),g=l.pendingProps,a===null?l.child=ws(l,null,g,p):zn(a,l,g,p),l.child;case 11:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:Or(g,w),Vp(a,l,g,w,p);case 7:return zn(a,l,l.pendingProps,p),l.child;case 8:return zn(a,l,l.pendingProps.children,p),l.child;case 12:return zn(a,l,l.pendingProps.children,p),l.child;case 10:e:{if(g=l.type._context,w=l.pendingProps,k=l.memoizedProps,N=w.value,Ct(ql,g._currentValue),g._currentValue=N,k!==null)if(Lr(k.value,N)){if(k.children===w.children&&!$n.current){l=gi(a,l,p);break e}}else for(k=l.child,k!==null&&(k.return=l);k!==null;){var W=k.dependencies;if(W!==null){N=k.child;for(var Y=W.firstContext;Y!==null;){if(Y.context===g){if(k.tag===1){Y=mi(-1,p&-p),Y.tag=2;var fe=k.updateQueue;if(fe!==null){fe=fe.shared;var Ee=fe.pending;Ee===null?Y.next=Y:(Y.next=Ee.next,Ee.next=Y),fe.pending=Y}}k.lanes|=p,Y=k.alternate,Y!==null&&(Y.lanes|=p),hf(k.return,p,l),W.lanes|=p;break}Y=Y.next}}else if(k.tag===10)N=k.type===l.type?null:k.child;else if(k.tag===18){if(N=k.return,N===null)throw Error(n(341));N.lanes|=p,W=N.alternate,W!==null&&(W.lanes|=p),hf(N,p,l),N=k.sibling}else N=k.child;if(N!==null)N.return=k;else for(N=k;N!==null;){if(N===l){N=null;break}if(k=N.sibling,k!==null){k.return=N.return,N=k;break}N=N.return}k=N}zn(a,l,w.children,p),l=l.child}return l;case 9:return w=l.type,g=l.pendingProps.children,ys(l,p),w=xr(w),g=g(w),l.flags|=1,zn(a,l,g,p),l.child;case 14:return g=l.type,w=Or(g,l.pendingProps),w=Or(g.type,w),Hp(a,l,g,w,p);case 15:return Wp(a,l,l.type,l.pendingProps,p);case 17:return g=l.type,w=l.pendingProps,w=l.elementType===g?w:Or(g,w),su(a,l),l.tag=1,jn(g)?(a=!0,Hl(l)):a=!1,ys(l,p),up(l,g,w),xf(l,g,w,p),Pf(null,l,g,!0,a,p);case 19:return Yp(a,l,p);case 22:return Gp(a,l,p)}throw Error(n(156,l.tag))};function _m(a,l){return re(a,l)}function $_(a,l,p,g){this.tag=a,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wr(a,l,p,g){return new $_(a,l,p,g)}function Qf(a){return a=a.prototype,!(!a||!a.isReactComponent)}function j_(a){if(typeof a=="function")return Qf(a)?1:0;if(a!=null){if(a=a.$$typeof,a===Q)return 11;if(a===ye)return 14}return 2}function Yi(a,l){var p=a.alternate;return p===null?(p=wr(a.tag,l,a.key,a.mode),p.elementType=a.elementType,p.type=a.type,p.stateNode=a.stateNode,p.alternate=a,a.alternate=p):(p.pendingProps=l,p.type=a.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=a.flags&14680064,p.childLanes=a.childLanes,p.lanes=a.lanes,p.child=a.child,p.memoizedProps=a.memoizedProps,p.memoizedState=a.memoizedState,p.updateQueue=a.updateQueue,l=a.dependencies,p.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},p.sibling=a.sibling,p.index=a.index,p.ref=a.ref,p}function xu(a,l,p,g,w,k){var N=2;if(g=a,typeof a=="function")Qf(a)&&(N=1);else if(typeof a=="string")N=5;else e:switch(a){case R:return Na(p.children,w,k,l);case J:N=8,w|=8;break;case V:return a=wr(12,p,l,w|2),a.elementType=V,a.lanes=k,a;case me:return a=wr(13,p,l,w),a.elementType=me,a.lanes=k,a;case Re:return a=wr(19,p,l,w),a.elementType=Re,a.lanes=k,a;case Ce:return vu(p,w,k,l);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case ne:N=10;break e;case te:N=9;break e;case Q:N=11;break e;case ye:N=14;break e;case De:N=16,g=null;break e}throw Error(n(130,a==null?a:typeof a,""))}return l=wr(N,p,l,w),l.elementType=a,l.type=g,l.lanes=k,l}function Na(a,l,p,g){return a=wr(7,a,g,l),a.lanes=p,a}function vu(a,l,p,g){return a=wr(22,a,g,l),a.elementType=Ce,a.lanes=p,a.stateNode={isHidden:!1},a}function e0(a,l,p){return a=wr(6,a,null,l),a.lanes=p,a}function t0(a,l,p){return l=wr(4,a.children!==null?a.children:[],a.key,l),l.lanes=p,l.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},l}function q_(a,l,p,g,w){this.tag=l,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ac(0),this.expirationTimes=Ac(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ac(0),this.identifierPrefix=g,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function n0(a,l,p,g,w,k,N,W,Y){return a=new q_(a,l,p,W,Y),l===1?(l=1,k===!0&&(l|=8)):l=0,k=wr(3,null,null,l),a.current=k,k.stateNode=a,k.memoizedState={element:g,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},mf(k),a}function K_(a,l,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:L,key:g==null?null:""+g,children:a,containerInfo:l,implementation:p}}function Tm(a){if(!a)return Hi;a=a._reactInternals;e:{if(b(a)!==a||a.tag!==1)throw Error(n(170));var l=a;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(jn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(n(171))}if(a.tag===1){var p=a.type;if(jn(p))return Jh(a,p,l)}return l}function km(a,l,p,g,w,k,N,W,Y){return a=n0(p,g,!0,a,w,k,N,W,Y),a.context=Tm(null),p=a.current,g=bn(),w=Ji(p),k=mi(g,w),k.callback=l??null,$i(p,k,w),a.current.lanes=w,eo(a,w,g),Jn(a,g),a}function yu(a,l,p,g){var w=l.current,k=bn(),N=Ji(w);return p=Tm(p),l.context===null?l.context=p:l.pendingContext=p,l=mi(k,N),l.payload={element:a},g=g===void 0?null:g,g!==null&&(l.callback=g),a=$i(w,l,N),a!==null&&(br(a,w,N,k),Jl(a,w,N)),N}function wu(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function Sm(a,l){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var p=a.retryLane;a.retryLane=p!==0&&p<l?p:l}}function r0(a,l){Sm(a,l),(a=a.alternate)&&Sm(a,l)}function J_(){return null}var Em=typeof reportError=="function"?reportError:function(a){console.error(a)};function i0(a){this._internalRoot=a}_u.prototype.render=i0.prototype.render=function(a){var l=this._internalRoot;if(l===null)throw Error(n(409));yu(a,l,null,null)},_u.prototype.unmount=i0.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var l=a.containerInfo;Ca(function(){yu(null,a,null,null)}),l[ci]=null}};function _u(a){this._internalRoot=a}_u.prototype.unstable_scheduleHydration=function(a){if(a){var l=oh();a={blockedOn:null,target:a,priority:l};for(var p=0;p<Oi.length&&l!==0&&l<Oi[p].priority;p++);Oi.splice(p,0,a),p===0&&ch(a)}};function a0(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Tu(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function Cm(){}function X_(a,l,p,g,w){if(w){if(typeof g=="function"){var k=g;g=function(){var fe=wu(N);k.call(fe)}}var N=km(l,g,a,0,null,!1,!1,"",Cm);return a._reactRootContainer=N,a[ci]=N.current,mo(a.nodeType===8?a.parentNode:a),Ca(),N}for(;w=a.lastChild;)a.removeChild(w);if(typeof g=="function"){var W=g;g=function(){var fe=wu(Y);W.call(fe)}}var Y=n0(a,0,!1,null,null,!1,!1,"",Cm);return a._reactRootContainer=Y,a[ci]=Y.current,mo(a.nodeType===8?a.parentNode:a),Ca(function(){yu(l,Y,p,g)}),Y}function ku(a,l,p,g,w){var k=p._reactRootContainer;if(k){var N=k;if(typeof w=="function"){var W=w;w=function(){var Y=wu(N);W.call(Y)}}yu(l,N,a,w)}else N=X_(p,l,a,w,g);return wu(N)}ah=function(a){switch(a.tag){case 3:var l=a.stateNode;if(l.current.memoizedState.isDehydrated){var p=xa(l.pendingLanes);p!==0&&(Ic(l,p|1),Jn(l,_e()),(lt&6)===0&&(Es=_e()+500,Wi()))}break;case 13:Ca(function(){var g=pi(a,1);if(g!==null){var w=bn();br(g,a,1,w)}}),r0(a,1)}},Nc=function(a){if(a.tag===13){var l=pi(a,134217728);if(l!==null){var p=bn();br(l,a,134217728,p)}r0(a,134217728)}},sh=function(a){if(a.tag===13){var l=Ji(a),p=pi(a,l);if(p!==null){var g=bn();br(p,a,l,g)}r0(a,l)}},oh=function(){return wt},lh=function(a,l){var p=wt;try{return wt=a,l()}finally{wt=p}},Di=function(a,l,p){switch(l){case"input":if(Be(a,p),l=p.name,p.type==="radio"&&l!=null){for(p=a;p.parentNode;)p=p.parentNode;for(p=p.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<p.length;l++){var g=p[l];if(g!==a&&g.form===a.form){var w=bl(g);if(!w)throw Error(n(90));G(g),Be(g,w)}}}break;case"textarea":Bt(a,p);break;case"select":l=p.value,l!=null&&on(a,!!p.multiple,l,!1)}},ns=Xf,rs=Ca;var Y_={usingClientEntryPoint:!1,Events:[vo,ds,bl,es,ts,Xf]},Do={findFiberByHostInstance:va,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},Z_={bundleType:Do.bundleType,version:Do.version,rendererPackageName:Do.rendererPackageName,rendererConfig:Do.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:D.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=ce(a),a===null?null:a.stateNode},findFiberByHostInstance:Do.findFiberByHostInstance||J_,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Su.isDisabled&&Su.supportsFiber)try{pr=Su.inject(Z_),tn=Su}catch{}}return Xn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y_,Xn.createPortal=function(a,l){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!a0(l))throw Error(n(200));return K_(a,l,null,p)},Xn.createRoot=function(a,l){if(!a0(a))throw Error(n(299));var p=!1,g="",w=Em;return l!=null&&(l.unstable_strictMode===!0&&(p=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(w=l.onRecoverableError)),l=n0(a,1,!1,null,null,p,!1,g,w),a[ci]=l.current,mo(a.nodeType===8?a.parentNode:a),new i0(l)},Xn.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var l=a._reactInternals;if(l===void 0)throw typeof a.render=="function"?Error(n(188)):(a=Object.keys(a).join(","),Error(n(268,a)));return a=ce(l),a=a===null?null:a.stateNode,a},Xn.flushSync=function(a){return Ca(a)},Xn.hydrate=function(a,l,p){if(!Tu(l))throw Error(n(200));return ku(null,a,l,!0,p)},Xn.hydrateRoot=function(a,l,p){if(!a0(a))throw Error(n(405));var g=p!=null&&p.hydratedSources||null,w=!1,k="",N=Em;if(p!=null&&(p.unstable_strictMode===!0&&(w=!0),p.identifierPrefix!==void 0&&(k=p.identifierPrefix),p.onRecoverableError!==void 0&&(N=p.onRecoverableError)),l=km(l,null,a,1,p??null,w,!1,k,N),a[ci]=l.current,mo(a),g)for(a=0;a<g.length;a++)p=g[a],w=p._getVersion,w=w(p._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[p,w]:l.mutableSourceEagerHydrationData.push(p,w);return new _u(l)},Xn.render=function(a,l,p){if(!Tu(l))throw Error(n(200));return ku(null,a,l,!1,p)},Xn.unmountComponentAtNode=function(a){if(!Tu(a))throw Error(n(40));return a._reactRootContainer?(Ca(function(){ku(null,null,a,!1,function(){a._reactRootContainer=null,a[ci]=null})}),!0):!1},Xn.unstable_batchedUpdates=Xf,Xn.unstable_renderSubtreeIntoContainer=function(a,l,p,g){if(!Tu(p))throw Error(n(200));if(a==null||a._reactInternals===void 0)throw Error(n(38));return ku(a,l,p,!1,g)},Xn.version="18.2.0-next-9e3b772b8-20220608",Xn}var Mm;function s2(){if(Mm)return l0.exports;Mm=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),l0.exports=a2(),l0.exports}var Lm;function o2(){if(Lm)return Eu;Lm=1;var e=s2();return Eu.createRoot=e.createRoot,Eu.hydrateRoot=e.hydrateRoot,Eu}var l2=o2();const u2=w1(l2),c2="ReleaseManagerDB",Ba="releases",ii="packages",Oa="tasks",D0="reviews",vi="backlog",P0="roadmap",M0="reEstimations",L0="withdrawalRequests",Gu="events",$u=["todo","planning","ready","inProgress","completed"],wi={todo:"Do zaplanowania",planning:"W planowaniu",ready:"Gotowa do realizacji",inProgress:"W realizacji",completed:"Zakoczona"},_1={todo:"bg-gray-500 text-white",planning:"bg-blue-600 text-white",ready:"bg-purple-600 text-white",inProgress:"bg-yellow-400 text-yellow-800",completed:"bg-green-600 text-white"},ld=["analysis","development","testing","deployment","stabilization"],ta={analysis:"Analiza",development:"Programowanie",testing:"Testy",deployment:"Wdroenie",stabilization:"Stabilizacja"},f2={analysis:"bg-indigo-500",development:"bg-sky-500",testing:"bg-amber-500",deployment:"bg-teal-500",stabilization:"bg-rose-500"},d2=["Not Reviewed","Passed","Passed with Conditions","Failed"],T1={"Not Reviewed":"Nieprzegldnity",Passed:"Zaliczony","Passed with Conditions":"Zaliczony warunkowo",Failed:"Niezaliczony"},h2={"Not Reviewed":"bg-gray-400 text-white",Passed:"bg-green-500 text-white","Passed with Conditions":"bg-yellow-400 text-yellow-800",Failed:"bg-red-600 text-white"},k1=["wysoki","niski","brak"],S1=["Nowy","Do Oceny","Zaplanowany","Analiza","Decyzja","Wstrzymany","Odrzucona","z roadmapy"],E1=["GO","NO GO","W TOKU"],p2=["Niedoszacowane","Przeszacowane","Zmiana okazaa si trudniejsza"],f0={create:"Utworzenie",update:"Aktualizacja",delete:"Usunicie",status_change:"Zmiana statusu",approve:"Zatwierdzenie",start:"Rozpoczcie",re_estimate:"Reestymacja",withdraw:"Wycofanie"};let cc;const m2=()=>new Promise((e,t)=>{const n=indexedDB.open(c2,11);n.onupgradeneeded=r=>{const i=n.result,s=n.transaction,o=r.oldVersion;if(o<1&&i.createObjectStore(ii,{keyPath:"id",autoIncrement:!0}).createIndex("status","status",{unique:!1}),o<2&&(i.objectStoreNames.contains(Ba)||i.createObjectStore(Ba,{keyPath:"id",autoIncrement:!0}),s)){const u=s.objectStore(ii);u.indexNames.contains("releaseId")||u.createIndex("releaseId","releaseId",{unique:!1})}o<3&&(i.objectStoreNames.contains(Oa)||i.createObjectStore(Oa,{keyPath:"id",autoIncrement:!0}).createIndex("packageId","packageId",{unique:!1})),o<4&&(i.objectStoreNames.contains(vi)||i.createObjectStore(vi,{keyPath:"id",autoIncrement:!0}),i.objectStoreNames.contains(P0)||i.createObjectStore(P0,{keyPath:"id",autoIncrement:!0})),o<6&&(i.objectStoreNames.contains(vi)&&i.deleteObjectStore(vi),i.createObjectStore(vi,{keyPath:"internalId",autoIncrement:!0})),o<7&&(i.objectStoreNames.contains(D0)||i.createObjectStore(D0,{keyPath:"id",autoIncrement:!0}).createIndex("packageId","packageId",{unique:!1})),o<9&&(i.objectStoreNames.contains(M0)||i.createObjectStore(M0,{keyPath:"id",autoIncrement:!0}).createIndex("roadmapItemId","roadmapItemId",{unique:!1})),o<10&&(i.objectStoreNames.contains(L0)||i.createObjectStore(L0,{keyPath:"id",autoIncrement:!0})),o<11&&(i.objectStoreNames.contains(Gu)||i.createObjectStore(Gu,{keyPath:"id",autoIncrement:!0}))},n.onsuccess=()=>{cc=n.result,e(!0)},n.onerror=()=>{console.error("Error initializing database:",n.error),t(n.error)}}),xn=(e,t)=>cc.transaction(e,t).objectStore(e),fc=e=>({add:t=>new Promise((n,r)=>{const s=xn(e,"readwrite").add(t);s.onsuccess=()=>n(s.result),s.onerror=()=>r(s.error)}),getAll:()=>new Promise((t,n)=>{const i=xn(e,"readonly").getAll();i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),update:t=>new Promise((n,r)=>{const s=xn(e,"readwrite").put(t);s.onsuccess=()=>n(t),s.onerror=()=>r(s.error)}),delete:t=>new Promise((n,r)=>{const s=xn(e,"readwrite").delete(t);s.onsuccess=()=>n(),s.onerror=()=>r(s.error)})}),d0=e=>new Promise((t,n)=>{const i=xn(Ba,"readwrite").add(e);i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),Bm=()=>new Promise((e,t)=>{const r=xn(Ba,"readonly").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),g2=e=>new Promise((t,n)=>{const i=xn(Ba,"readwrite").put(e);i.onsuccess=()=>t(e),i.onerror=()=>n(i.error)}),x2=e=>new Promise((t,n)=>{const r=cc.transaction([Ba,ii,Oa],"readwrite");r.oncomplete=()=>t(),r.onerror=h=>{console.error("Transaction failed during release deletion:",h.target.error),n(h.target.error)};const i=r.objectStore(Ba),s=r.objectStore(ii),o=r.objectStore(Oa),d=s.index("releaseId").getAll(IDBKeyRange.only(e));d.onsuccess=()=>{const m=d.result.map(v=>v.id).filter(v=>v!==void 0);if(m.length===0){i.delete(e);return}let x=0;m.forEach(v=>{const S=o.index("packageId").getAllKeys(IDBKeyRange.only(v));S.onsuccess=()=>{S.result.forEach(E=>{o.delete(E)}),x++,x===m.length&&(m.forEach(E=>{s.delete(E)}),i.delete(e))}})}}),Om=e=>new Promise((t,n)=>{const i=xn(ii,"readwrite").add(e);i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),Um=()=>new Promise((e,t)=>{const r=xn(ii,"readonly").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),v2=e=>new Promise((t,n)=>{const s=xn(ii,"readonly").index("status").getAll(e);s.onsuccess=()=>t(s.result),s.onerror=()=>n(s.error)}),Mo=e=>new Promise((t,n)=>{const i=xn(ii,"readwrite").put(e);i.onsuccess=()=>t(e),i.onerror=()=>n(i.error)}),y2=e=>new Promise((t,n)=>{const r=cc.transaction([ii,Oa],"readwrite");r.oncomplete=()=>t(),r.onerror=d=>{console.error("Transaction failed during package deletion:",d.target.error),n(d.target.error)};const i=r.objectStore(ii),s=r.objectStore(Oa),u=s.index("packageId").getAllKeys(IDBKeyRange.only(e));u.onsuccess=()=>{u.result.forEach(h=>{s.delete(h)}),i.delete(e)}}),w2=e=>new Promise((t,n)=>{const s=xn(Oa,"readonly").index("packageId").getAll(e);s.onsuccess=()=>t(s.result),s.onerror=()=>n(s.error)}),ud=fc(D0),_2=ud.getAll,T2=ud.add,k2=ud.update,S2=()=>new Promise((e,t)=>{const r=xn(vi,"readonly").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),h0=e=>new Promise((t,n)=>{const i=xn(vi,"readwrite").add(e);i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),E2=e=>new Promise((t,n)=>{const i=xn(vi,"readwrite").put(e);i.onsuccess=()=>t(e),i.onerror=()=>n(i.error)}),zm=e=>new Promise((t,n)=>{const i=xn(vi,"readwrite").delete(e);i.onsuccess=()=>t(),i.onerror=()=>n(i.error)}),dc=fc(P0),C2=dc.getAll,bm=dc.add,Vm=dc.update,Hm=dc.delete,C1=fc(M0),A2=C1.add,I2=C1.getAll,N2=fc(L0),F2=N2.add,R2=e=>new Promise((t,n)=>{const i=xn(Gu,"readwrite").add(e);i.onsuccess=()=>t(i.result),i.onerror=()=>n(i.error)}),D2=()=>new Promise((e,t)=>{const r=xn(Gu,"readonly").getAll();r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ju={};ju.version="0.18.5";var A1=1252,P2=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],cd={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},fd=function(e){P2.indexOf(e)!=-1&&(A1=cd[0]=e)};function M2(){fd(1252)}var Hr=function(e){fd(e)};function dd(){Hr(1200),M2()}function Wm(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function L2(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}function I1(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var Oo=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return t==255&&n==254?L2(e.slice(2)):t==254&&n==255?I1(e.slice(2)):t==65279?e.slice(1):e},Cu=function(t){return String.fromCharCode(t)},Gm=function(t){return String.fromCharCode(t)},Jo,na="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Xo(e){for(var t="",n=0,r=0,i=0,s=0,o=0,u=0,d=0,h=0;h<e.length;)n=e.charCodeAt(h++),s=n>>2,r=e.charCodeAt(h++),o=(n&3)<<4|r>>4,i=e.charCodeAt(h++),u=(r&15)<<2|i>>6,d=i&63,isNaN(r)?u=d=64:isNaN(i)&&(d=64),t+=na.charAt(s)+na.charAt(o)+na.charAt(u)+na.charAt(d);return t}function hr(e){var t="",n=0,r=0,i=0,s=0,o=0,u=0,d=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)s=na.indexOf(e.charAt(h++)),o=na.indexOf(e.charAt(h++)),n=s<<2|o>>4,t+=String.fromCharCode(n),u=na.indexOf(e.charAt(h++)),r=(o&15)<<4|u>>2,u!==64&&(t+=String.fromCharCode(r)),d=na.indexOf(e.charAt(h++)),i=(u&3)<<6|d,d!==64&&(t+=String.fromCharCode(i));return t}var it=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ci=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ia(e){return it?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function $m(e){return it?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var cr=function(t){return it?Ci(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function hc(e){if(typeof ArrayBuffer>"u")return cr(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function la(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function B2(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function hd(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return hd(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var gn=it?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ci(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function O2(e){for(var t=[],n=0,r=e.length+250,i=ia(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[n++]=o;else if(o<2048)i[n++]=192|o>>6&31,i[n++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var u=e.charCodeAt(++s)&1023;i[n++]=240|o>>8&7,i[n++]=128|o>>2&63,i[n++]=128|u>>6&15|(o&3)<<4,i[n++]=128|u&63}else i[n++]=224|o>>12&15,i[n++]=128|o>>6&63,i[n++]=128|o&63;n>r&&(t.push(i.slice(0,n)),n=0,i=ia(65535),r=65530)}return t.push(i.slice(0,n)),gn(t)}var Gn=/\u0000/g,Uo=/[\u0001-\u0006]/g;function Ps(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Wr(e,t){var n=""+e;return n.length>=t?n:qt("0",t-n.length)+n}function pd(e,t){var n=""+e;return n.length>=t?n:qt(" ",t-n.length)+n}function qu(e,t){var n=""+e;return n.length>=t?n:n+qt(" ",t-n.length)}function U2(e,t){var n=""+Math.round(e);return n.length>=t?n:qt("0",t-n.length)+n}function z2(e,t){var n=""+e;return n.length>=t?n:qt("0",t-n.length)+n}var jm=Math.pow(2,32);function As(e,t){if(e>jm||e<-jm)return U2(e,t);var n=Math.round(e);return z2(n,t)}function Ku(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var qm=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],p0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function b2(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Ke={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},Km={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},V2={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ju(e,t,n){for(var r=e<0?-1:1,i=e*r,s=0,o=1,u=0,d=1,h=0,m=0,x=Math.floor(i);h<t&&(x=Math.floor(i),u=x*o+s,m=x*h+d,!(i-x<5e-8));)i=1/(i-x),s=o,o=u,d=h,h=m;if(m>t&&(h>t?(m=d,u=s):(m=h,u=o)),!n)return[0,r*u,m];var v=Math.floor(r*u/m);return[v,r*u-v*m,m]}function Ra(e,t,n){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),s=0,o=[],u={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),t&&t.date1904&&(r+=1462),u.u>.9999&&(u.u=0,++i==86400&&(u.T=i=0,++r,++u.D)),r===60)o=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)o=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),o=[d.getFullYear(),d.getMonth()+1,d.getDate()],s=d.getDay(),r<60&&(s=(s+6)%7),n&&(s=q2(d,o))}return u.y=o[0],u.m=o[1],u.d=o[2],u.S=i%60,i=Math.floor(i/60),u.M=i%60,i=Math.floor(i/60),u.H=i,u.q=s,u}var N1=new Date(1899,11,31,0,0,0),H2=N1.getTime(),W2=new Date(1900,2,1,0,0,0);function F1(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=W2&&(n+=1440*60*1e3),(n-(H2+(e.getTimezoneOffset()-N1.getTimezoneOffset())*6e4))/(1440*60*1e3)}function md(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function G2(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function $2(e){var t=e<0?12:11,n=md(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function j2(e){var t=md(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Yo(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=$2(e):t===10?n=e.toFixed(10).substr(0,12):n=j2(e),md(G2(n.toUpperCase()))}function Ua(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Yo(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Fr(14,F1(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function q2(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function K2(e,t,n,r){var i="",s=0,o=0,u=n.y,d,h=0;switch(e){case 98:u=n.y+543;case 121:switch(t.length){case 1:case 2:d=u%100,h=2;break;default:d=u%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:d=n.m,h=t.length;break;case 3:return p0[n.m-1][1];case 5:return p0[n.m-1][0];default:return p0[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=n.d,h=t.length;break;case 3:return qm[n.q][0];default:return qm[n.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(n.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=n.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=n.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Wr(n.S,t.length):(r>=2?o=r===3?1e3:100:o=r===1?10:1,s=Math.round(o*(n.S+n.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=Wr(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:d=u,h=1;break}var m=h>0?Wr(d,h):"";return m}function ra(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var R1=/%/g;function J2(e,t,n){var r=t.replace(R1,""),i=t.length-r.length;return _i(e,r,n*Math.pow(10,2*i))+qt("%",i)}function X2(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return _i(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function D1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+D1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(i+s)%i)+"."+m.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var P1=/# (\?+)( ?)\/( ?)(\d+)/;function Y2(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),s=Math.floor(i/r),o=i-s*r,u=r;return n+(s===0?"":""+s)+" "+(o===0?qt(" ",e[1].length+1+e[4].length):pd(o,e[1].length)+e[2]+"/"+e[3]+Wr(u,e[4].length))}function Z2(e,t,n){return n+(t===0?"":""+t)+qt(" ",e[1].length+2+e[4].length)}var M1=/^#*0*\.([0#]+)/,L1=/\).*[0#]/,B1=/\(###\) ###\\?-####/;function Vn(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function Jm(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function Xm(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function Q2(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function eT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Tr(e,t,n){if(e.charCodeAt(0)===40&&!t.match(L1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Tr("n",r,n):"("+Tr("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return X2(e,t,n);if(t.indexOf("%")!==-1)return J2(e,t,n);if(t.indexOf("E")!==-1)return D1(t,n);if(t.charCodeAt(0)===36)return"$"+Tr(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,u,d=Math.abs(n),h=n<0?"-":"";if(t.match(/^00+$/))return h+As(d,t.length);if(t.match(/^[#?]+$/))return i=As(n,0),i==="0"&&(i=""),i.length>t.length?i:Vn(t.substr(0,t.length-i.length))+i;if(s=t.match(P1))return Y2(s,d,h);if(t.match(/^#+0+$/))return h+As(d,t.length-t.indexOf("0"));if(s=t.match(M1))return i=Jm(n,s[1].length).replace(/^([^\.]+)$/,"$1."+Vn(s[1])).replace(/\.$/,"."+Vn(s[1])).replace(/\.(\d*)$/,function(S,T){return"."+T+qt("0",Vn(s[1]).length-T.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+Jm(d,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+ra(As(d,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Tr(e,t,-n):ra(""+(Math.floor(n)+Q2(n,s[1].length)))+"."+Wr(Xm(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Tr(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ps(Tr(e,t.replace(/[\\-]/g,""),n)),o=0,Ps(Ps(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return o<i.length?i.charAt(o++):S==="0"?"0":""}));if(t.match(B1))return i=Tr(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),u=Ju(d,Math.pow(10,o)-1,!1),i=""+h,m=_i("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+s[2]+"/"+s[3],m=qu(u[2],o),m.length<s[4].length&&(m=Vn(s[4].substr(s[4].length-m.length))+m),i+=m,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u=Ju(d,Math.pow(10,o)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?pd(u[1],o)+s[2]+"/"+s[3]+qu(u[2],o):qt(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=As(n,0),t.length<=i.length?i:Vn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=t.indexOf(".")-o,v=t.length-i.length-x;return Vn(t.substr(0,x)+i+t.substr(t.length-v))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=Xm(n,s[1].length),n<0?"-"+Tr(e,t,-n):ra(eT(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Wr(0,3-S.length):"")+S})+"."+Wr(o,s[1].length);switch(t){case"###,##0.00":return Tr(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var _=ra(As(d,0));return _!=="0"?h+_:"";case"###,###.00":return Tr(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Tr(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function tT(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return _i(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function nT(e,t,n){var r=t.replace(R1,""),i=t.length-r.length;return _i(e,r,n*Math.pow(10,2*i))+qt("%",i)}function O1(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+O1(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(o-n.length+s):n+="E+"+(o-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,d,h,m){return d+h+m.substr(0,(i+s)%i)+"."+m.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function ti(e,t,n){if(e.charCodeAt(0)===40&&!t.match(L1)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?ti("n",r,n):"("+ti("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return tT(e,t,n);if(t.indexOf("%")!==-1)return nT(e,t,n);if(t.indexOf("E")!==-1)return O1(t,n);if(t.charCodeAt(0)===36)return"$"+ti(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,o,u,d=Math.abs(n),h=n<0?"-":"";if(t.match(/^00+$/))return h+Wr(d,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:Vn(t.substr(0,t.length-i.length))+i;if(s=t.match(P1))return Z2(s,d,h);if(t.match(/^#+0+$/))return h+Wr(d,t.length-t.indexOf("0"));if(s=t.match(M1))return i=(""+n).replace(/^([^\.]+)$/,"$1."+Vn(s[1])).replace(/\.$/,"."+Vn(s[1])),i=i.replace(/\.(\d*)$/,function(S,T){return"."+T+qt("0",Vn(s[1]).length-T.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+ra(""+d);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+ti(e,t,-n):ra(""+n)+"."+qt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ti(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Ps(ti(e,t.replace(/[\\-]/g,""),n)),o=0,Ps(Ps(t.replace(/\\/g,"")).replace(/[0#]/g,function(S){return o<i.length?i.charAt(o++):S==="0"?"0":""}));if(t.match(B1))return i=ti(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var m="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),u=Ju(d,Math.pow(10,o)-1,!1),i=""+h,m=_i("n",s[1],u[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),i+=m+s[2]+"/"+s[3],m=qu(u[2],o),m.length<s[4].length&&(m=Vn(s[4].substr(s[4].length-m.length))+m),i+=m,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),u=Ju(d,Math.pow(10,o)-1,!0),h+(u[0]||(u[1]?"":"0"))+" "+(u[1]?pd(u[1],o)+s[2]+"/"+s[3]+qu(u[2],o):qt(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:Vn(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var x=t.indexOf(".")-o,v=t.length-i.length-x;return Vn(t.substr(0,x)+i+t.substr(t.length-v))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+ti(e,t,-n):ra(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(S){return"00,"+(S.length<3?Wr(0,3-S.length):"")+S})+"."+Wr(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var _=ra(""+d);return _!=="0"?h+_:"";default:if(t.match(/\.[0#?]*$/))return ti(e,t.slice(0,t.lastIndexOf(".")),n)+Vn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function _i(e,t,n){return(n|0)===n?ti(e,t,n):Tr(e,t,n)}function rT(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var U1=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Gs(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":Ku(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(U1))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function iT(e,t,n,r){for(var i=[],s="",o=0,u="",d="t",h,m,x,v="H";o<e.length;)switch(u=e.charAt(o)){case"G":if(!Ku(e,o))throw new Error("unrecognized character "+u+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(x=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(x);i[i.length]={t:"t",v:s},++o;break;case"\\":var _=e.charAt(++o),S=_==="("||_===")"?_:"t";i[i.length]={t:S,v:_},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(h==null&&(h=Ra(t,n,e.charAt(o+1)==="2"),h==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},d=u,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=Ra(t,n),h==null))return"";for(s=u;++o<e.length&&e.charAt(o).toLowerCase()===u;)s+=u;u==="m"&&d.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=v),i[i.length]={t:u,v:s},d=u;break;case"A":case"a":case"":var T={t:u,v:u};if(h==null&&(h=Ra(t,n)),e.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(T.v=h.H>=12?"P":"A"),T.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(T.v=h.H>=12?"PM":"AM"),T.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="/"?(h!=null&&(T.v=h.H>=12?"":""),T.t="T",o+=5,v="h"):(T.t="t",++o),h==null&&T.t==="T")return"";i[i.length]=T,d=u;break;case"[":for(s=u;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(U1)){if(h==null&&(h=Ra(t,n),h==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},d=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Gs(e)||(i[i.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=u;++o<e.length&&(u=e.charAt(o))==="0";)s+=u;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=u;++o<e.length&&"0#?.,E+-%".indexOf(u=e.charAt(o))>-1;)s+=u;i[i.length]={t:"n",v:s};break;case"?":for(s=u;e.charAt(++o)===u;)s+=u;i[i.length]={t:u,v:s},d=u;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:r===1?"t":u,v:u},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=u;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:u,v:u},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+e);i[i.length]={t:"t",v:u},++o;break}var E=0,C=0,I;for(o=i.length-1,d="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=v,d="h",E<1&&(E=1);break;case"s":(I=i[o].v.match(/\.0+$/))&&(C=Math.max(C,I[0].length-1)),E<3&&(E=3);case"d":case"y":case"M":case"e":d=i[o].t;break;case"m":d==="s"&&(i[o].t="M",E<2&&(E=2));break;case"X":break;case"Z":E<1&&i[o].v.match(/[Hh]/)&&(E=1),E<2&&i[o].v.match(/[Mm]/)&&(E=2),E<3&&i[o].v.match(/[Ss]/)&&(E=3)}switch(E){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var A="",D;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=K2(i[o].t.charCodeAt(0),i[o].v,h,C),i[o].t="t";break;case"n":case"?":for(D=o+1;i[D]!=null&&((u=i[D].t)==="?"||u==="D"||(u===" "||u==="t")&&i[D+1]!=null&&(i[D+1].t==="?"||i[D+1].t==="t"&&i[D+1].v==="/")||i[o].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(i[D].v==="/"||i[D].v===" "&&i[D+1]!=null&&i[D+1].t=="?"));)i[o].v+=i[D].v,i[D]={v:"",t:";"},++D;A+=i[o].v,o=D-1;break;case"G":i[o].t="t",i[o].v=Ua(t,n);break}var P="",L,R;if(A.length>0){A.charCodeAt(0)==40?(L=t<0&&A.charCodeAt(0)===45?-t:t,R=_i("n",A,L)):(L=t<0&&r>1?-t:t,R=_i("n",A,L),L<0&&i[0]&&i[0].t=="t"&&(R=R.substr(1),i[0].v="-"+i[0].v)),D=R.length-1;var J=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){J=o;break}var V=i.length;if(J===i.length&&R.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(D>=i[o].v.length-1?(D-=i[o].v.length,i[o].v=R.substr(D+1,i[o].v.length)):D<0?i[o].v="":(i[o].v=R.substr(0,D+1),D=-1),i[o].t="t",V=o);D>=0&&V<i.length&&(i[V].v=R.substr(0,D+1)+i[V].v)}else if(J!==i.length&&R.indexOf("E")===-1){for(D=R.indexOf(".")-1,o=J;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(m=i[o].v.indexOf(".")>-1&&o===J?i[o].v.indexOf(".")-1:i[o].v.length-1,P=i[o].v.substr(m+1);m>=0;--m)D>=0&&(i[o].v.charAt(m)==="0"||i[o].v.charAt(m)==="#")&&(P=R.charAt(D--)+P);i[o].v=P,i[o].t="t",V=o}for(D>=0&&V<i.length&&(i[V].v=R.substr(0,D+1)+i[V].v),D=R.indexOf(".")+1,o=J;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==J)){for(m=i[o].v.indexOf(".")>-1&&o===J?i[o].v.indexOf(".")+1:0,P=i[o].v.substr(0,m);m<i[o].v.length;++m)D<R.length&&(P+=R.charAt(D++));i[o].v=P,i[o].t="t",V=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(L=r>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=_i(i[o].t,i[o].v,L),i[o].t="t");var ne="";for(o=0;o!==i.length;++o)i[o]!=null&&(ne+=i[o].v);return ne}var Ym=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Zm(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function aT(e,t){var n=rT(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var o=n[0].match(Ym),u=n[1].match(Ym);return Zm(t,o)?[r,n[0]]:Zm(t,u)?[r,n[1]]:[r,n[o!=null&&u!=null?2:1]]}return[r,s]}function Fr(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:Ke)[e],r==null&&(r=n.table&&n.table[Km[e]]||Ke[Km[e]]),r==null&&(r=V2[e]||"General");break}if(Ku(r,0))return Ua(t,n);t instanceof Date&&(t=F1(t,n.date1904));var i=aT(r,t);if(Ku(i[1]))return Ua(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return iT(i[1],t,n,i[0])}function Ti(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(Ke[n]==null){t<0&&(t=n);continue}if(Ke[n]==e){t=n;break}}t<0&&(t=391)}return Ke[t]=e,t}function pc(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ti(e[t],t)}function $s(){Ke=b2()}var sT={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},z1=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function oT(e){var t=typeof e=="number"?Ke[e]:e;return t=t.replace(z1,"(\\d+)"),new RegExp("^"+t+"$")}function lT(e,t,n){var r=-1,i=-1,s=-1,o=-1,u=-1,d=-1;(t.match(z1)||[]).forEach(function(x,v){var _=parseInt(n[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":r=_;break;case"d":s=_;break;case"h":o=_;break;case"s":d=_;break;case"m":o>=0?u=_:i=_;break}}),d>=0&&u==-1&&i>=0&&(u=i,i=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var m=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return o==-1&&u==-1&&d==-1?h:r==-1&&i==-1&&s==-1?m:h+"T"+m}var uT=function(){var e={};e.version="1.2.0";function t(){for(var R=0,J=new Array(256),V=0;V!=256;++V)R=V,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,J[V]=R;return typeof Int32Array<"u"?new Int32Array(J):J}var n=t();function r(R){var J=0,V=0,ne=0,te=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ne=0;ne!=256;++ne)te[ne]=R[ne];for(ne=0;ne!=256;++ne)for(V=R[ne],J=256+ne;J<4096;J+=256)V=te[J]=V>>>8^R[V&255];var Q=[];for(ne=1;ne!=16;++ne)Q[ne-1]=typeof Int32Array<"u"?te.subarray(ne*256,ne*256+256):te.slice(ne*256,ne*256+256);return Q}var i=r(n),s=i[0],o=i[1],u=i[2],d=i[3],h=i[4],m=i[5],x=i[6],v=i[7],_=i[8],S=i[9],T=i[10],E=i[11],C=i[12],I=i[13],A=i[14];function D(R,J){for(var V=J^-1,ne=0,te=R.length;ne<te;)V=V>>>8^n[(V^R.charCodeAt(ne++))&255];return~V}function P(R,J){for(var V=J^-1,ne=R.length-15,te=0;te<ne;)V=A[R[te++]^V&255]^I[R[te++]^V>>8&255]^C[R[te++]^V>>16&255]^E[R[te++]^V>>>24]^T[R[te++]]^S[R[te++]]^_[R[te++]]^v[R[te++]]^x[R[te++]]^m[R[te++]]^h[R[te++]]^d[R[te++]]^u[R[te++]]^o[R[te++]]^s[R[te++]]^n[R[te++]];for(ne+=15;te<ne;)V=V>>>8^n[(V^R[te++])&255];return~V}function L(R,J){for(var V=J^-1,ne=0,te=R.length,Q=0,me=0;ne<te;)Q=R.charCodeAt(ne++),Q<128?V=V>>>8^n[(V^Q)&255]:Q<2048?(V=V>>>8^n[(V^(192|Q>>6&31))&255],V=V>>>8^n[(V^(128|Q&63))&255]):Q>=55296&&Q<57344?(Q=(Q&1023)+64,me=R.charCodeAt(ne++)&1023,V=V>>>8^n[(V^(240|Q>>8&7))&255],V=V>>>8^n[(V^(128|Q>>2&63))&255],V=V>>>8^n[(V^(128|me>>6&15|(Q&3)<<4))&255],V=V>>>8^n[(V^(128|me&63))&255]):(V=V>>>8^n[(V^(224|Q>>12&15))&255],V=V>>>8^n[(V^(128|Q>>6&63))&255],V=V>>>8^n[(V^(128|Q&63))&255]);return~V}return e.table=n,e.bstr=D,e.buf=P,e.str=L,e}(),We=function(){var t={};t.version="1.2.1";function n(F,U){for(var M=F.split("/"),O=U.split("/"),z=0,b=0,se=Math.min(M.length,O.length);z<se;++z){if(b=M[z].length-O[z].length)return b;if(M[z]!=O[z])return M[z]<O[z]?-1:1}return M.length-O.length}function r(F){if(F.charAt(F.length-1)=="/")return F.slice(0,-1).indexOf("/")===-1?F:r(F.slice(0,-1));var U=F.lastIndexOf("/");return U===-1?F:F.slice(0,U+1)}function i(F){if(F.charAt(F.length-1)=="/")return i(F.slice(0,-1));var U=F.lastIndexOf("/");return U===-1?F:F.slice(U+1)}function s(F,U){typeof U=="string"&&(U=new Date(U));var M=U.getHours();M=M<<6|U.getMinutes(),M=M<<5|U.getSeconds()>>>1,F.write_shift(2,M);var O=U.getFullYear()-1980;O=O<<4|U.getMonth()+1,O=O<<5|U.getDate(),F.write_shift(2,O)}function o(F){var U=F.read_shift(2)&65535,M=F.read_shift(2)&65535,O=new Date,z=M&31;M>>>=5;var b=M&15;M>>>=4,O.setMilliseconds(0),O.setFullYear(M+1980),O.setMonth(b-1),O.setDate(z);var se=U&31;U>>>=5;var pe=U&63;return U>>>=6,O.setHours(U),O.setMinutes(pe),O.setSeconds(se<<1),O}function u(F){kn(F,0);for(var U={},M=0;F.l<=F.length-4;){var O=F.read_shift(2),z=F.read_shift(2),b=F.l+z,se={};switch(O){case 21589:M=F.read_shift(1),M&1&&(se.mtime=F.read_shift(4)),z>5&&(M&2&&(se.atime=F.read_shift(4)),M&4&&(se.ctime=F.read_shift(4))),se.mtime&&(se.mt=new Date(se.mtime*1e3));break}F.l=b,U[O]=se}return U}var d;function h(){return d||(d={})}function m(F,U){if(F[0]==80&&F[1]==75)return Di(F,U);if((F[0]|32)==109&&(F[1]|32)==105)return is(F,U);if(F.length<512)throw new Error("CFB file size "+F.length+" < 512");var M=3,O=512,z=0,b=0,se=0,pe=0,ae=0,ce=[],j=F.slice(0,512);kn(j,0);var re=x(j);switch(M=re[0],M){case 3:O=512;break;case 4:O=4096;break;case 0:if(re[1]==0)return Di(F,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}O!==512&&(j=F.slice(0,O),kn(j,28));var de=F.slice(0,O);v(j,M);var Fe=j.read_shift(4,"i");if(M===3&&Fe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Fe);j.l+=4,se=j.read_shift(4,"i"),j.l+=4,j.chk("00100000","Mini Stream Cutoff Size: "),pe=j.read_shift(4,"i"),z=j.read_shift(4,"i"),ae=j.read_shift(4,"i"),b=j.read_shift(4,"i");for(var Ie=-1,_e=0;_e<109&&(Ie=j.read_shift(4,"i"),!(Ie<0));++_e)ce[_e]=Ie;var je=_(F,O);E(ae,b,je,O,ce);var xt=I(je,se,ce,O);xt[se].name="!Directory",z>0&&pe!==me&&(xt[pe].name="!MiniFAT"),xt[ce[0]].name="!FAT",xt.fat_addrs=ce,xt.ssz=O;var ht={},It=[],Mr=[],Kr=[];A(se,xt,je,It,z,ht,Mr,pe),S(Mr,Kr,It),It.shift();var pr={FileIndex:Mr,FullPaths:Kr};return U&&U.raw&&(pr.raw={header:de,sectors:je}),pr}function x(F){if(F[F.l]==80&&F[F.l+1]==75)return[0,0];F.chk(Re,"Header Signature: "),F.l+=16;var U=F.read_shift(2,"u");return[F.read_shift(2,"u"),U]}function v(F,U){var M=9;switch(F.l+=2,M=F.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}F.chk("0600","Mini Sector Shift: "),F.chk("000000000000","Reserved: ")}function _(F,U){for(var M=Math.ceil(F.length/U)-1,O=[],z=1;z<M;++z)O[z-1]=F.slice(z*U,(z+1)*U);return O[M-1]=F.slice(M*U),O}function S(F,U,M){for(var O=0,z=0,b=0,se=0,pe=0,ae=M.length,ce=[],j=[];O<ae;++O)ce[O]=j[O]=O,U[O]=M[O];for(;pe<j.length;++pe)O=j[pe],z=F[O].L,b=F[O].R,se=F[O].C,ce[O]===O&&(z!==-1&&ce[z]!==z&&(ce[O]=ce[z]),b!==-1&&ce[b]!==b&&(ce[O]=ce[b])),se!==-1&&(ce[se]=O),z!==-1&&O!=ce[O]&&(ce[z]=ce[O],j.lastIndexOf(z)<pe&&j.push(z)),b!==-1&&O!=ce[O]&&(ce[b]=ce[O],j.lastIndexOf(b)<pe&&j.push(b));for(O=1;O<ae;++O)ce[O]===O&&(b!==-1&&ce[b]!==b?ce[O]=ce[b]:z!==-1&&ce[z]!==z&&(ce[O]=ce[z]));for(O=1;O<ae;++O)if(F[O].type!==0){if(pe=O,pe!=ce[pe])do pe=ce[pe],U[O]=U[pe]+"/"+U[O];while(pe!==0&&ce[pe]!==-1&&pe!=ce[pe]);ce[O]=-1}for(U[0]+="/",O=1;O<ae;++O)F[O].type!==2&&(U[O]+="/")}function T(F,U,M){for(var O=F.start,z=F.size,b=[],se=O;M&&z>0&&se>=0;)b.push(U.slice(se*Q,se*Q+Q)),z-=Q,se=Fa(M,se*4);return b.length===0?he(0):gn(b).slice(0,F.size)}function E(F,U,M,O,z){var b=me;if(F===me){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(F!==-1){var se=M[F],pe=(O>>>2)-1;if(!se)return;for(var ae=0;ae<pe&&(b=Fa(se,ae*4))!==me;++ae)z.push(b);E(Fa(se,O-4),U-1,M,O,z)}}function C(F,U,M,O,z){var b=[],se=[];z||(z=[]);var pe=O-1,ae=0,ce=0;for(ae=U;ae>=0;){z[ae]=!0,b[b.length]=ae,se.push(F[ae]);var j=M[Math.floor(ae*4/O)];if(ce=ae*4&pe,O<4+ce)throw new Error("FAT boundary crossed: "+ae+" 4 "+O);if(!F[j])break;ae=Fa(F[j],ce)}return{nodes:b,data:cg([se])}}function I(F,U,M,O){var z=F.length,b=[],se=[],pe=[],ae=[],ce=O-1,j=0,re=0,de=0,Fe=0;for(j=0;j<z;++j)if(pe=[],de=j+U,de>=z&&(de-=z),!se[de]){ae=[];var Ie=[];for(re=de;re>=0;){Ie[re]=!0,se[re]=!0,pe[pe.length]=re,ae.push(F[re]);var _e=M[Math.floor(re*4/O)];if(Fe=re*4&ce,O<4+Fe)throw new Error("FAT boundary crossed: "+re+" 4 "+O);if(!F[_e]||(re=Fa(F[_e],Fe),Ie[re]))break}b[de]={nodes:pe,data:cg([ae])}}return b}function A(F,U,M,O,z,b,se,pe){for(var ae=0,ce=O.length?2:0,j=U[F].data,re=0,de=0,Fe;re<j.length;re+=128){var Ie=j.slice(re,re+128);kn(Ie,64),de=Ie.read_shift(2),Fe=Td(Ie,0,de-ce),O.push(Fe);var _e={name:Fe,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},je=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);je!==0&&(_e.ct=D(Ie,Ie.l-8));var xt=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);xt!==0&&(_e.mt=D(Ie,Ie.l-8)),_e.start=Ie.read_shift(4,"i"),_e.size=Ie.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=me,_e.name=""),_e.type===5?(ae=_e.start,z>0&&ae!==me&&(U[ae].name="!StreamData")):_e.size>=4096?(_e.storage="fat",U[_e.start]===void 0&&(U[_e.start]=C(M,_e.start,U.fat_addrs,U.ssz)),U[_e.start].name=_e.name,_e.content=U[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:ae!==me&&_e.start!==me&&U[ae]&&(_e.content=T(_e,U[ae].data,(U[pe]||{}).data))),_e.content&&kn(_e.content,0),b[Fe]=_e,se.push(_e)}}function D(F,U){return new Date((ur(F,U+4)/1e7*Math.pow(2,32)+ur(F,U)/1e7-11644473600)*1e3)}function P(F,U){return h(),m(d.readFileSync(F),U)}function L(F,U){var M=U&&U.type;switch(M||it&&Buffer.isBuffer(F)&&(M="buffer"),M||"base64"){case"file":return P(F,U);case"base64":return m(cr(hr(F)),U);case"binary":return m(cr(F),U)}return m(F,U)}function R(F,U){var M=U||{},O=M.root||"Root Entry";if(F.FullPaths||(F.FullPaths=[]),F.FileIndex||(F.FileIndex=[]),F.FullPaths.length!==F.FileIndex.length)throw new Error("inconsistent CFB structure");F.FullPaths.length===0&&(F.FullPaths[0]=O+"/",F.FileIndex[0]={name:O,type:5}),M.CLSID&&(F.FileIndex[0].clsid=M.CLSID),J(F)}function J(F){var U="Sh33tJ5";if(!We.find(F,"/"+U)){var M=he(4);M[0]=55,M[1]=M[3]=50,M[2]=54,F.FileIndex.push({name:U,type:2,content:M,size:4,L:69,R:69,C:69}),F.FullPaths.push(F.FullPaths[0]+U),V(F)}}function V(F,U){R(F);for(var M=!1,O=!1,z=F.FullPaths.length-1;z>=0;--z){var b=F.FileIndex[z];switch(b.type){case 0:O?M=!0:(F.FileIndex.pop(),F.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(b.R*b.L*b.C)&&(M=!0),b.R>-1&&b.L>-1&&b.R==b.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!U)){var se=new Date(1987,1,19),pe=0,ae=Object.create?Object.create(null):{},ce=[];for(z=0;z<F.FullPaths.length;++z)ae[F.FullPaths[z]]=!0,F.FileIndex[z].type!==0&&ce.push([F.FullPaths[z],F.FileIndex[z]]);for(z=0;z<ce.length;++z){var j=r(ce[z][0]);O=ae[j],O||(ce.push([j,{name:i(j).replace("/",""),type:1,clsid:De,ct:se,mt:se,content:null}]),ae[j]=!0)}for(ce.sort(function(Fe,Ie){return n(Fe[0],Ie[0])}),F.FullPaths=[],F.FileIndex=[],z=0;z<ce.length;++z)F.FullPaths[z]=ce[z][0],F.FileIndex[z]=ce[z][1];for(z=0;z<ce.length;++z){var re=F.FileIndex[z],de=F.FullPaths[z];if(re.name=i(de).replace("/",""),re.L=re.R=re.C=-(re.color=1),re.size=re.content?re.content.length:0,re.start=0,re.clsid=re.clsid||De,z===0)re.C=ce.length>1?1:-1,re.size=0,re.type=5;else if(de.slice(-1)=="/"){for(pe=z+1;pe<ce.length&&r(F.FullPaths[pe])!=de;++pe);for(re.C=pe>=ce.length?-1:pe,pe=z+1;pe<ce.length&&r(F.FullPaths[pe])!=r(de);++pe);re.R=pe>=ce.length?-1:pe,re.type=1}else r(F.FullPaths[z+1]||"")==r(de)&&(re.R=z+1),re.type=2}}}function ne(F,U){var M=U||{};if(M.fileType=="mad")return li(F,M);switch(V(F),M.fileType){case"zip":return qr(F,M)}var O=function(Fe){for(var Ie=0,_e=0,je=0;je<Fe.FileIndex.length;++je){var xt=Fe.FileIndex[je];if(xt.content){var ht=xt.content.length;ht>0&&(ht<4096?Ie+=ht+63>>6:_e+=ht+511>>9)}}for(var It=Fe.FullPaths.length+3>>2,Mr=Ie+7>>3,Kr=Ie+127>>7,pr=Mr+_e+It+Kr,tn=pr+127>>7,ma=tn<=109?0:Math.ceil((tn-109)/127);pr+tn+ma+127>>7>tn;)ma=++tn<=109?0:Math.ceil((tn-109)/127);var zt=[1,ma,tn,Kr,It,_e,Ie,0];return Fe.FileIndex[0].size=Ie<<6,zt[7]=(Fe.FileIndex[0].start=zt[0]+zt[1]+zt[2]+zt[3]+zt[4]+zt[5])+(zt[6]+7>>3),zt}(F),z=he(O[7]<<9),b=0,se=0;{for(b=0;b<8;++b)z.write_shift(1,ye[b]);for(b=0;b<8;++b)z.write_shift(2,0);for(z.write_shift(2,62),z.write_shift(2,3),z.write_shift(2,65534),z.write_shift(2,9),z.write_shift(2,6),b=0;b<3;++b)z.write_shift(2,0);for(z.write_shift(4,0),z.write_shift(4,O[2]),z.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),z.write_shift(4,0),z.write_shift(4,4096),z.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:me),z.write_shift(4,O[3]),z.write_shift(-4,O[1]?O[0]-1:me),z.write_shift(4,O[1]),b=0;b<109;++b)z.write_shift(-4,b<O[2]?O[1]+b:-1)}if(O[1])for(se=0;se<O[1];++se){for(;b<236+se*127;++b)z.write_shift(-4,b<O[2]?O[1]+b:-1);z.write_shift(-4,se===O[1]-1?me:se+1)}var pe=function(Fe){for(se+=Fe;b<se-1;++b)z.write_shift(-4,b+1);Fe&&(++b,z.write_shift(-4,me))};for(se=b=0,se+=O[1];b<se;++b)z.write_shift(-4,Ce.DIFSECT);for(se+=O[2];b<se;++b)z.write_shift(-4,Ce.FATSECT);pe(O[3]),pe(O[4]);for(var ae=0,ce=0,j=F.FileIndex[0];ae<F.FileIndex.length;++ae)j=F.FileIndex[ae],j.content&&(ce=j.content.length,!(ce<4096)&&(j.start=se,pe(ce+511>>9)));for(pe(O[6]+7>>3);z.l&511;)z.write_shift(-4,Ce.ENDOFCHAIN);for(se=b=0,ae=0;ae<F.FileIndex.length;++ae)j=F.FileIndex[ae],j.content&&(ce=j.content.length,!(!ce||ce>=4096)&&(j.start=se,pe(ce+63>>6)));for(;z.l&511;)z.write_shift(-4,Ce.ENDOFCHAIN);for(b=0;b<O[4]<<2;++b){var re=F.FullPaths[b];if(!re||re.length===0){for(ae=0;ae<17;++ae)z.write_shift(4,0);for(ae=0;ae<3;++ae)z.write_shift(4,-1);for(ae=0;ae<12;++ae)z.write_shift(4,0);continue}j=F.FileIndex[b],b===0&&(j.start=j.size?j.start-1:me);var de=b===0&&M.root||j.name;if(ce=2*(de.length+1),z.write_shift(64,de,"utf16le"),z.write_shift(2,ce),z.write_shift(1,j.type),z.write_shift(1,j.color),z.write_shift(-4,j.L),z.write_shift(-4,j.R),z.write_shift(-4,j.C),j.clsid)z.write_shift(16,j.clsid,"hex");else for(ae=0;ae<4;++ae)z.write_shift(4,0);z.write_shift(4,j.state||0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,0),z.write_shift(4,j.start),z.write_shift(4,j.size),z.write_shift(4,0)}for(b=1;b<F.FileIndex.length;++b)if(j=F.FileIndex[b],j.size>=4096)if(z.l=j.start+1<<9,it&&Buffer.isBuffer(j.content))j.content.copy(z,z.l,0,j.size),z.l+=j.size+511&-512;else{for(ae=0;ae<j.size;++ae)z.write_shift(1,j.content[ae]);for(;ae&511;++ae)z.write_shift(1,0)}for(b=1;b<F.FileIndex.length;++b)if(j=F.FileIndex[b],j.size>0&&j.size<4096)if(it&&Buffer.isBuffer(j.content))j.content.copy(z,z.l,0,j.size),z.l+=j.size+63&-64;else{for(ae=0;ae<j.size;++ae)z.write_shift(1,j.content[ae]);for(;ae&63;++ae)z.write_shift(1,0)}if(it)z.l=z.length;else for(;z.l<z.length;)z.write_shift(1,0);return z}function te(F,U){var M=F.FullPaths.map(function(ae){return ae.toUpperCase()}),O=M.map(function(ae){var ce=ae.split("/");return ce[ce.length-(ae.slice(-1)=="/"?2:1)]}),z=!1;U.charCodeAt(0)===47?(z=!0,U=M[0].slice(0,-1)+U):z=U.indexOf("/")!==-1;var b=U.toUpperCase(),se=z===!0?M.indexOf(b):O.indexOf(b);if(se!==-1)return F.FileIndex[se];var pe=!b.match(Uo);for(b=b.replace(Gn,""),pe&&(b=b.replace(Uo,"!")),se=0;se<M.length;++se)if((pe?M[se].replace(Uo,"!"):M[se]).replace(Gn,"")==b||(pe?O[se].replace(Uo,"!"):O[se]).replace(Gn,"")==b)return F.FileIndex[se];return null}var Q=64,me=-2,Re="d0cf11e0a1b11ae1",ye=[208,207,17,224,161,177,26,225],De="00000000000000000000000000000000",Ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:me,FREESECT:-1,HEADER_SIGNATURE:Re,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:De,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ke(F,U,M){h();var O=ne(F,M);d.writeFileSync(U,O)}function Z(F){for(var U=new Array(F.length),M=0;M<F.length;++M)U[M]=String.fromCharCode(F[M]);return U.join("")}function H(F,U){var M=ne(F,U);switch(U&&U.type||"buffer"){case"file":return h(),d.writeFileSync(U.filename,M),M;case"binary":return typeof M=="string"?M:Z(M);case"base64":return Xo(typeof M=="string"?M:Z(M));case"buffer":if(it)return Buffer.isBuffer(M)?M:Ci(M);case"array":return typeof M=="string"?cr(M):M}return M}var ue;function B(F){try{var U=F.InflateRaw,M=new U;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)ue=F;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function X(F,U){if(!ue)return Fi(F,U);var M=ue.InflateRaw,O=new M,z=O._processChunk(F.slice(F.l),O._finishFlushFlag);return F.l+=O.bytesRead,z}function q(F){return ue?ue.deflateRawSync(F):Qe(F)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],xe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(F){var U=(F<<1|F<<11)&139536|(F<<5|F<<15)&558144;return(U>>16|U>>8|U)&255}for(var we=typeof Uint8Array<"u",Ae=we?new Uint8Array(256):[],Xe=0;Xe<256;++Xe)Ae[Xe]=ve(Xe);function G(F,U){var M=Ae[F&255];return U<=8?M>>>8-U:(M=M<<8|Ae[F>>8&255],U<=16?M>>>16-U:(M=M<<8|Ae[F>>16&255],M>>>24-U))}function ft(F,U){var M=U&7,O=U>>>3;return(F[O]|(M<=6?0:F[O+1]<<8))>>>M&3}function et(F,U){var M=U&7,O=U>>>3;return(F[O]|(M<=5?0:F[O+1]<<8))>>>M&7}function dt(F,U){var M=U&7,O=U>>>3;return(F[O]|(M<=4?0:F[O+1]<<8))>>>M&15}function tt(F,U){var M=U&7,O=U>>>3;return(F[O]|(M<=3?0:F[O+1]<<8))>>>M&31}function Be(F,U){var M=U&7,O=U>>>3;return(F[O]|(M<=1?0:F[O+1]<<8))>>>M&127}function yt(F,U,M){var O=U&7,z=U>>>3,b=(1<<M)-1,se=F[z]>>>O;return M<8-O||(se|=F[z+1]<<8-O,M<16-O)||(se|=F[z+2]<<16-O,M<24-O)||(se|=F[z+3]<<24-O),se&b}function At(F,U,M){var O=U&7,z=U>>>3;return O<=5?F[z]|=(M&7)<<O:(F[z]|=M<<O&255,F[z+1]=(M&7)>>8-O),U+3}function Lt(F,U,M){var O=U&7,z=U>>>3;return M=(M&1)<<O,F[z]|=M,U+1}function on(F,U,M){var O=U&7,z=U>>>3;return M<<=O,F[z]|=M&255,M>>>=8,F[z+1]=M,U+8}function Dr(F,U,M){var O=U&7,z=U>>>3;return M<<=O,F[z]|=M&255,M>>>=8,F[z+1]=M&255,F[z+2]=M>>>8,U+16}function tr(F,U){var M=F.length,O=2*M>U?2*M:U+5,z=0;if(M>=U)return F;if(it){var b=$m(O);if(F.copy)F.copy(b);else for(;z<F.length;++z)b[z]=F[z];return b}else if(we){var se=new Uint8Array(O);if(se.set)se.set(F);else for(;z<M;++z)se[z]=F[z];return se}return F.length=O,F}function Bt(F){for(var U=new Array(F),M=0;M<F;++M)U[M]=0;return U}function yn(F,U,M){var O=1,z=0,b=0,se=0,pe=0,ae=F.length,ce=we?new Uint16Array(32):Bt(32);for(b=0;b<32;++b)ce[b]=0;for(b=ae;b<M;++b)F[b]=0;ae=F.length;var j=we?new Uint16Array(ae):Bt(ae);for(b=0;b<ae;++b)ce[z=F[b]]++,O<z&&(O=z),j[b]=0;for(ce[0]=0,b=1;b<=O;++b)ce[b+16]=pe=pe+ce[b-1]<<1;for(b=0;b<ae;++b)pe=F[b],pe!=0&&(j[b]=ce[pe+16]++);var re=0;for(b=0;b<ae;++b)if(re=F[b],re!=0)for(pe=G(j[b],O)>>O-re,se=(1<<O+4-re)-1;se>=0;--se)U[pe|se<<re]=re&15|b<<4;return O}var Xt=we?new Uint16Array(512):Bt(512),nr=we?new Uint16Array(32):Bt(32);if(!we){for(var Gt=0;Gt<512;++Gt)Xt[Gt]=0;for(Gt=0;Gt<32;++Gt)nr[Gt]=0}(function(){for(var F=[],U=0;U<32;U++)F.push(5);yn(F,nr,32);var M=[];for(U=0;U<=143;U++)M.push(8);for(;U<=255;U++)M.push(9);for(;U<=279;U++)M.push(7);for(;U<=287;U++)M.push(8);yn(M,Xt,288)})();var En=function(){for(var U=we?new Uint8Array(32768):[],M=0,O=0;M<xe.length-1;++M)for(;O<xe[M+1];++O)U[O]=M;for(;O<32768;++O)U[O]=29;var z=we?new Uint8Array(259):[];for(M=0,O=0;M<le.length-1;++M)for(;O<le[M+1];++O)z[O]=M;function b(pe,ae){for(var ce=0;ce<pe.length;){var j=Math.min(65535,pe.length-ce),re=ce+j==pe.length;for(ae.write_shift(1,+re),ae.write_shift(2,j),ae.write_shift(2,~j&65535);j-- >0;)ae[ae.l++]=pe[ce++]}return ae.l}function se(pe,ae){for(var ce=0,j=0,re=we?new Uint16Array(32768):[];j<pe.length;){var de=Math.min(65535,pe.length-j);if(de<10){for(ce=At(ae,ce,+(j+de==pe.length)),ce&7&&(ce+=8-(ce&7)),ae.l=ce/8|0,ae.write_shift(2,de),ae.write_shift(2,~de&65535);de-- >0;)ae[ae.l++]=pe[j++];ce=ae.l*8;continue}ce=At(ae,ce,+(j+de==pe.length)+2);for(var Fe=0;de-- >0;){var Ie=pe[j];Fe=(Fe<<5^Ie)&32767;var _e=-1,je=0;if((_e=re[Fe])&&(_e|=j&-32768,_e>j&&(_e-=32768),_e<j))for(;pe[_e+je]==pe[j+je]&&je<250;)++je;if(je>2){Ie=z[je],Ie<=22?ce=on(ae,ce,Ae[Ie+1]>>1)-1:(on(ae,ce,3),ce+=5,on(ae,ce,Ae[Ie-23]>>5),ce+=3);var xt=Ie<8?0:Ie-4>>2;xt>0&&(Dr(ae,ce,je-le[Ie]),ce+=xt),Ie=U[j-_e],ce=on(ae,ce,Ae[Ie]>>3),ce-=3;var ht=Ie<4?0:Ie-2>>1;ht>0&&(Dr(ae,ce,j-_e-xe[Ie]),ce+=ht);for(var It=0;It<je;++It)re[Fe]=j&32767,Fe=(Fe<<5^pe[j])&32767,++j;de-=je-1}else Ie<=143?Ie=Ie+48:ce=Lt(ae,ce,1),ce=on(ae,ce,Ae[Ie]),re[Fe]=j&32767,++j}ce=on(ae,ce,0)-1}return ae.l=(ce+7)/8|0,ae.l}return function(ae,ce){return ae.length<8?b(ae,ce):se(ae,ce)}}();function Qe(F){var U=he(50+Math.floor(F.length*1.1)),M=En(F,U);return U.slice(0,M)}var gt=we?new Uint16Array(32768):Bt(32768),ot=we?new Uint16Array(32768):Bt(32768),Ot=we?new Uint16Array(128):Bt(128),rr=1,Qa=1;function fa(F,U){var M=tt(F,U)+257;U+=5;var O=tt(F,U)+1;U+=5;var z=dt(F,U)+4;U+=4;for(var b=0,se=we?new Uint8Array(19):Bt(19),pe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ae=1,ce=we?new Uint8Array(8):Bt(8),j=we?new Uint8Array(8):Bt(8),re=se.length,de=0;de<z;++de)se[K[de]]=b=et(F,U),ae<b&&(ae=b),ce[b]++,U+=3;var Fe=0;for(ce[0]=0,de=1;de<=ae;++de)j[de]=Fe=Fe+ce[de-1]<<1;for(de=0;de<re;++de)(Fe=se[de])!=0&&(pe[de]=j[Fe]++);var Ie=0;for(de=0;de<re;++de)if(Ie=se[de],Ie!=0){Fe=Ae[pe[de]]>>8-Ie;for(var _e=(1<<7-Ie)-1;_e>=0;--_e)Ot[Fe|_e<<Ie]=Ie&7|de<<3}var je=[];for(ae=1;je.length<M+O;)switch(Fe=Ot[Be(F,U)],U+=Fe&7,Fe>>>=3){case 16:for(b=3+ft(F,U),U+=2,Fe=je[je.length-1];b-- >0;)je.push(Fe);break;case 17:for(b=3+et(F,U),U+=3;b-- >0;)je.push(0);break;case 18:for(b=11+Be(F,U),U+=7;b-- >0;)je.push(0);break;default:je.push(Fe),ae<Fe&&(ae=Fe);break}var xt=je.slice(0,M),ht=je.slice(M);for(de=M;de<286;++de)xt[de]=0;for(de=O;de<30;++de)ht[de]=0;return rr=yn(xt,gt,286),Qa=yn(ht,ot,30),U}function da(F,U){if(F[0]==3&&!(F[1]&3))return[ia(U),2];for(var M=0,O=0,z=$m(U||1<<18),b=0,se=z.length>>>0,pe=0,ae=0;(O&1)==0;){if(O=et(F,M),M+=3,O>>>1)O>>1==1?(pe=9,ae=5):(M=fa(F,M),pe=rr,ae=Qa);else{M&7&&(M+=8-(M&7));var ce=F[M>>>3]|F[(M>>>3)+1]<<8;if(M+=32,ce>0)for(!U&&se<b+ce&&(z=tr(z,b+ce),se=z.length);ce-- >0;)z[b++]=F[M>>>3],M+=8;continue}for(;;){!U&&se<b+32767&&(z=tr(z,b+32767),se=z.length);var j=yt(F,M,pe),re=O>>>1==1?Xt[j]:gt[j];if(M+=re&15,re>>>=4,(re>>>8&255)===0)z[b++]=re;else{if(re==256)break;re-=257;var de=re<8?0:re-4>>2;de>5&&(de=0);var Fe=b+le[re];de>0&&(Fe+=yt(F,M,de),M+=de),j=yt(F,M,ae),re=O>>>1==1?nr[j]:ot[j],M+=re&15,re>>>=4;var Ie=re<4?0:re-2>>1,_e=xe[re];for(Ie>0&&(_e+=yt(F,M,Ie),M+=Ie),!U&&se<Fe&&(z=tr(z,Fe+100),se=z.length);b<Fe;)z[b]=z[b-_e],++b}}}return U?[z,M+7>>>3]:[z.slice(0,b),M+7>>>3]}function Fi(F,U){var M=F.slice(F.l||0),O=da(M,U);return F.l+=O[1],O[0]}function Ri(F,U){if(F)typeof console<"u"&&console.error(U);else throw new Error(U)}function Di(F,U){var M=F;kn(M,0);var O=[],z=[],b={FileIndex:O,FullPaths:z};R(b,{root:U.root});for(var se=M.length-4;(M[se]!=80||M[se+1]!=75||M[se+2]!=5||M[se+3]!=6)&&se>=0;)--se;M.l=se+4,M.l+=4;var pe=M.read_shift(2);M.l+=6;var ae=M.read_shift(4);for(M.l=ae,se=0;se<pe;++se){M.l+=20;var ce=M.read_shift(4),j=M.read_shift(4),re=M.read_shift(2),de=M.read_shift(2),Fe=M.read_shift(2);M.l+=8;var Ie=M.read_shift(4),_e=u(M.slice(M.l+re,M.l+re+de));M.l+=re+de+Fe;var je=M.l;M.l=Ie+4,jr(M,ce,j,b,_e),M.l=je}return b}function jr(F,U,M,O,z){F.l+=2;var b=F.read_shift(2),se=F.read_shift(2),pe=o(F);if(b&8257)throw new Error("Unsupported ZIP encryption");for(var ae=F.read_shift(4),ce=F.read_shift(4),j=F.read_shift(4),re=F.read_shift(2),de=F.read_shift(2),Fe="",Ie=0;Ie<re;++Ie)Fe+=String.fromCharCode(F[F.l++]);if(de){var _e=u(F.slice(F.l,F.l+de));(_e[21589]||{}).mt&&(pe=_e[21589].mt),((z||{})[21589]||{}).mt&&(pe=z[21589].mt)}F.l+=de;var je=F.slice(F.l,F.l+ce);switch(se){case 8:je=X(F,j);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+se)}var xt=!1;b&8&&(ae=F.read_shift(4),ae==134695760&&(ae=F.read_shift(4),xt=!0),ce=F.read_shift(4),j=F.read_shift(4)),ce!=U&&Ri(xt,"Bad compressed size: "+U+" != "+ce),j!=M&&Ri(xt,"Bad uncompressed size: "+M+" != "+j),Pr(O,Fe,je,{unsafe:!0,mt:pe})}function qr(F,U){var M=U||{},O=[],z=[],b=he(1),se=M.compression?8:0,pe=0,ae=0,ce=0,j=0,re=0,de=F.FullPaths[0],Fe=de,Ie=F.FileIndex[0],_e=[],je=0;for(ae=1;ae<F.FullPaths.length;++ae)if(Fe=F.FullPaths[ae].slice(de.length),Ie=F.FileIndex[ae],!(!Ie.size||!Ie.content||Fe=="Sh33tJ5")){var xt=j,ht=he(Fe.length);for(ce=0;ce<Fe.length;++ce)ht.write_shift(1,Fe.charCodeAt(ce)&127);ht=ht.slice(0,ht.l),_e[re]=uT.buf(Ie.content,0);var It=Ie.content;se==8&&(It=q(It)),b=he(30),b.write_shift(4,67324752),b.write_shift(2,20),b.write_shift(2,pe),b.write_shift(2,se),Ie.mt?s(b,Ie.mt):b.write_shift(4,0),b.write_shift(-4,_e[re]),b.write_shift(4,It.length),b.write_shift(4,Ie.content.length),b.write_shift(2,ht.length),b.write_shift(2,0),j+=b.length,O.push(b),j+=ht.length,O.push(ht),j+=It.length,O.push(It),b=he(46),b.write_shift(4,33639248),b.write_shift(2,0),b.write_shift(2,20),b.write_shift(2,pe),b.write_shift(2,se),b.write_shift(4,0),b.write_shift(-4,_e[re]),b.write_shift(4,It.length),b.write_shift(4,Ie.content.length),b.write_shift(2,ht.length),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(4,0),b.write_shift(4,xt),je+=b.l,z.push(b),je+=ht.length,z.push(ht),++re}return b=he(22),b.write_shift(4,101010256),b.write_shift(2,0),b.write_shift(2,0),b.write_shift(2,re),b.write_shift(2,re),b.write_shift(4,je),b.write_shift(4,j),b.write_shift(2,0),gn([gn(O),gn(z),b])}var oi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function es(F,U){if(F.ctype)return F.ctype;var M=F.name||"",O=M.match(/\.([^\.]+)$/);return O&&oi[O[1]]||U&&(O=(M=U).match(/[\.\\]([^\.\\])+$/),O&&oi[O[1]])?oi[O[1]]:"application/octet-stream"}function ts(F){for(var U=Xo(F),M=[],O=0;O<U.length;O+=76)M.push(U.slice(O,O+76));return M.join(`\r
`)+`\r
`}function ns(F){var U=F.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ce){var j=ce.charCodeAt(0).toString(16).toUpperCase();return"="+(j.length==1?"0"+j:j)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],O=U.split(`\r
`),z=0;z<O.length;++z){var b=O[z];if(b.length==0){M.push("");continue}for(var se=0;se<b.length;){var pe=76,ae=b.slice(se,se+pe);ae.charAt(pe-1)=="="?pe--:ae.charAt(pe-2)=="="?pe-=2:ae.charAt(pe-3)=="="&&(pe-=3),ae=b.slice(se,se+pe),se+=pe,se<b.length&&(ae+="="),M.push(ae)}}return M.join(`\r
`)}function rs(F){for(var U=[],M=0;M<F.length;++M){for(var O=F[M];M<=F.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+F[++M];U.push(O)}for(var z=0;z<U.length;++z)U[z]=U[z].replace(/[=][0-9A-Fa-f]{2}/g,function(b){return String.fromCharCode(parseInt(b.slice(1),16))});return cr(U.join(`\r
`))}function ha(F,U,M){for(var O="",z="",b="",se,pe=0;pe<10;++pe){var ae=U[pe];if(!ae||ae.match(/^\s*$/))break;var ce=ae.match(/^(.*?):\s*([^\s].*)$/);if(ce)switch(ce[1].toLowerCase()){case"content-location":O=ce[2].trim();break;case"content-type":b=ce[2].trim();break;case"content-transfer-encoding":z=ce[2].trim();break}}switch(++pe,z.toLowerCase()){case"base64":se=cr(hr(U.slice(pe).join("")));break;case"quoted-printable":se=rs(U.slice(pe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+z)}var j=Pr(F,O.slice(M.length),se,{unsafe:!0});b&&(j.ctype=b)}function is(F,U){if(Z(F.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=U&&U.root||"",O=(it&&Buffer.isBuffer(F)?F.toString("binary"):Z(F)).split(`\r
`),z=0,b="";for(z=0;z<O.length;++z)if(b=O[z],!!/^Content-Location:/i.test(b)&&(b=b.slice(b.indexOf("file")),M||(M=b.slice(0,b.lastIndexOf("/")+1)),b.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),b.slice(0,M.length)!=M););var se=(O[1]||"").match(/boundary="(.*?)"/);if(!se)throw new Error("MAD cannot find boundary");var pe="--"+(se[1]||""),ae=[],ce=[],j={FileIndex:ae,FullPaths:ce};R(j);var re,de=0;for(z=0;z<O.length;++z){var Fe=O[z];Fe!==pe&&Fe!==pe+"--"||(de++&&ha(j,O.slice(re,z),M),re=z)}return j}function li(F,U){var M=U||{},O=M.boundary||"SheetJS";O="------="+O;for(var z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],b=F.FullPaths[0],se=b,pe=F.FileIndex[0],ae=1;ae<F.FullPaths.length;++ae)if(se=F.FullPaths[ae].slice(b.length),pe=F.FileIndex[ae],!(!pe.size||!pe.content||se=="Sh33tJ5")){se=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(je){return"_x"+je.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(je){return"_u"+je.charCodeAt(0).toString(16)+"_"});for(var ce=pe.content,j=it&&Buffer.isBuffer(ce)?ce.toString("binary"):Z(ce),re=0,de=Math.min(1024,j.length),Fe=0,Ie=0;Ie<=de;++Ie)(Fe=j.charCodeAt(Ie))>=32&&Fe<128&&++re;var _e=re>=de*4/5;z.push(O),z.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+se),z.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),z.push("Content-Type: "+es(pe,se)),z.push(""),z.push(_e?ns(j):ts(j))}return z.push(O+`--\r
`),z.join(`\r
`)}function pa(F){var U={};return R(U,F),U}function Pr(F,U,M,O){var z=O&&O.unsafe;z||R(F);var b=!z&&We.find(F,U);if(!b){var se=F.FullPaths[0];U.slice(0,se.length)==se?se=U:(se.slice(-1)!="/"&&(se+="/"),se=(se+U).replace("//","/")),b={name:i(U),type:2},F.FileIndex.push(b),F.FullPaths.push(se),z||We.utils.cfb_gc(F)}return b.content=M,b.size=M?M.length:0,O&&(O.CLSID&&(b.clsid=O.CLSID),O.mt&&(b.mt=O.mt),O.ct&&(b.ct=O.ct)),b}function Qs(F,U){R(F);var M=We.find(F,U);if(M){for(var O=0;O<F.FileIndex.length;++O)if(F.FileIndex[O]==M)return F.FileIndex.splice(O,1),F.FullPaths.splice(O,1),!0}return!1}function ui(F,U,M){R(F);var O=We.find(F,U);if(O){for(var z=0;z<F.FileIndex.length;++z)if(F.FileIndex[z]==O)return F.FileIndex[z].name=i(M),F.FullPaths[z]=M,!0}return!1}function Pi(F){V(F,!0)}return t.find=te,t.read=L,t.parse=m,t.write=H,t.writeFile=ke,t.utils={cfb_new:pa,cfb_add:Pr,cfb_del:Qs,cfb_mov:ui,cfb_gc:Pi,ReadShift:bo,CheckField:ov,prep_blob:kn,bconcat:gn,use_zlib:B,_deflateRaw:Qe,_inflateRaw:Fi,consts:Ce},t}();function cT(e){return typeof e=="string"?hc(e):Array.isArray(e)?B2(e):e}function ul(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=hc(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?ri(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var i=new Blob([cT(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(e);return u.open("w"),u.encoding="binary",Array.isArray(t)&&(t=la(t)),u.write(t),u.close(),t}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+e)}function fT(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Jt(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function Qm(e,t){for(var n=[],r=Jt(e),i=0;i!==r.length;++i)n[e[r[i]][t]]==null&&(n[e[r[i]][t]]=r[i]);return n}function mc(e){for(var t=[],n=Jt(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function gc(e){for(var t=[],n=Jt(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function dT(e){for(var t=[],n=Jt(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var Xu=new Date(1899,11,30,0,0,0);function fn(e,t){var n=e.getTime(),r=Xu.getTime()+(e.getTimezoneOffset()-Xu.getTimezoneOffset())*6e4;return(n-r)/(1440*60*1e3)}var b1=new Date,hT=Xu.getTime()+(b1.getTimezoneOffset()-Xu.getTimezoneOffset())*6e4,eg=b1.getTimezoneOffset();function xc(e){var t=new Date;return t.setTime(e*24*60*60*1e3+hT),t.getTimezoneOffset()!==eg&&t.setTime(t.getTime()+(t.getTimezoneOffset()-eg)*6e4),t}function pT(e){var t=0,n=0,r=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(n=1,s>3&&(r=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=n*parseInt(i[s],10)}return t}var tg=new Date("2017-02-19T19:06:09.000Z"),V1=isNaN(tg.getFullYear())?new Date("2/19/17"):tg,mT=V1.getFullYear()==2017;function Pt(e,t){var n=new Date(e);if(mT)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(V1.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function za(e,t){if(it&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ri(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ri(I1(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ri(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ri(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function Mt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=Mt(e[n]));return t}function qt(e,t){for(var n="";n.length<t;)n+=e;return n}function Gr(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(t=Number(r)))?t/n:t}var gT=["january","february","march","april","may","june","july","august","september","october","november","december"];function Vs(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&gT.indexOf(o)==-1)return n}else if(o.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}var xT=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,r,i){if(e||typeof r=="string")return n.split(r);for(var s=n.split(r),o=[s[0]],u=1;u<s.length;++u)o.push(i),o.push(s[u]);return o}}();function H1(e){return e?e.content&&e.type?za(e.content,!0):e.data?Oo(e.data):e.asNodeBuffer&&it?Oo(e.asNodeBuffer().toString("binary")):e.asBinary?Oo(e.asBinary()):e._data&&e._data.getContent?Oo(za(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function W1(e){if(!e)return null;if(e.data)return Wm(e.data);if(e.asNodeBuffer&&it)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Wm(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function vT(e){return e&&e.name.slice(-4)===".bin"?W1(e):H1(e)}function Er(e,t){for(var n=e.FullPaths||Jt(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),s=0;s<n.length;++s){var o=n[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==o||i==o)return e.files?e.files[n[s]]:e.FileIndex[s]}return null}function gd(e,t){var n=Er(e,t);if(n==null)throw new Error("Cannot find file "+t+" in zip");return n}function an(e,t,n){if(!n)return vT(gd(e,t));if(!t)return null;try{return an(e,t)}catch{return null}}function fr(e,t,n){if(!n)return H1(gd(e,t));if(!t)return null;try{return fr(e,t)}catch{return null}}function yT(e,t,n){return W1(gd(e,t))}function ng(e){for(var t=e.FullPaths||Jt(e.files),n=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function rt(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return it?r=Ci(n):r=O2(n),We.utils.cfb_add(e,t,r)}We.utils.cfb_add(e,t,n)}else e.file(t,n)}function xd(){return We.utils.cfb_new()}function G1(e,t){switch(t.type){case"base64":return We.read(e,{type:"base64"});case"binary":return We.read(e,{type:"binary"});case"buffer":case"array":return We.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function zo(e,t){if(e.charAt(0)=="/")return e.slice(1);var n=t.split("/");t.slice(-1)!="/"&&n.pop();for(var r=e.split("/");r.length!==0;){var i=r.shift();i===".."?n.pop():i!=="."&&n.push(i)}return n.join("/")}var en=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,wT=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,rg=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,_T=/<[^>]*>/g,Un=en.match(rg)?rg:_T,TT=/<\w*:/,kT=/<(\/?)\w+:/;function Ye(e,t,n){for(var r={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(r[0]=e.slice(0,i)),i===e.length)return r;var o=e.match(wT),u=0,d="",h=0,m="",x="",v=1;if(o)for(h=0;h!=o.length;++h){for(x=o[h],s=0;s!=x.length&&x.charCodeAt(s)!==61;++s);for(m=x.slice(0,s).trim();x.charCodeAt(s+1)==32;)++s;for(v=(i=x.charCodeAt(s+1))==34||i==39?1:0,d=x.slice(s+1+v,x.length-v),u=0;u!=m.length&&m.charCodeAt(u)!==58;++u);if(u===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),r[m]=d,r[m.toLowerCase()]=d;else{var _=(u===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(u+1);if(r[_]&&m.slice(u-3,u)=="ext")continue;r[_]=d,r[_.toLowerCase()]=d}}return r}function ai(e){return e.replace(kT,"<$1")}var $1={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},vd=mc($1),ut=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function n(r){var i=r+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(u,d){return $1[u]||String.fromCharCode(parseInt(d,u.indexOf("x")>-1?16:10))||u}).replace(t,function(u,d){return String.fromCharCode(parseInt(d,16))});var o=i.indexOf("]]>");return n(i.slice(0,s))+i.slice(s+9,o)+n(i.slice(o+3))}}(),yd=/[&<>'"]/g,ST=/[\u0000-\u0008\u000b-\u001f]/g;function kt(e){var t=e+"";return t.replace(yd,function(n){return vd[n]}).replace(ST,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ig(e){return kt(e).replace(/ /g,"_x0020_")}var j1=/[\u0000-\u001f]/g;function wd(e){var t=e+"";return t.replace(yd,function(n){return vd[n]}).replace(/\n/g,"<br/>").replace(j1,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function ET(e){var t=e+"";return t.replace(yd,function(n){return vd[n]}).replace(j1,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}var ag=function(){var e=/&#(\d+);/g;function t(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}}();function CT(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Dt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function m0(e){for(var t="",n=0,r=0,i=0,s=0,o=0,u=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(i=e.charCodeAt(n++),r>191&&r<224){o=(r&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(n++),u=((r&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(u>>>10&1023)),t+=String.fromCharCode(56320+(u&1023))}return t}function sg(e){var t=ia(2*e.length),n,r,i=1,s=0,o=0,u;for(r=0;r<e.length;r+=i)i=1,(u=e.charCodeAt(r))<128?n=u:u<224?(n=(u&31)*64+(e.charCodeAt(r+1)&63),i=2):u<240?(n=(u&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,n=(u&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,o=55296+(n>>>10&1023),n=56320+(n&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=n%256,t[s++]=n>>>8;return t.slice(0,s).toString("ucs2")}function og(e){return Ci(e,"binary").toString("utf8")}var Au="foo bar baz",Et=it&&(og(Au)==m0(Au)&&og||sg(Au)==m0(Au)&&sg)||m0,ri=it?function(e){return Ci(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},Zo=function(){var e={};return function(n,r){var i=n+"|"+(r||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),q1=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),AT=function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),IT=/<\/?(?:vt:)?variant>/g,NT=/<(?:vt:)([^>]*)>([\s\S]*)</;function lg(e,t){var n=Ye(e),r=e.match(AT(n.baseType))||[],i=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return i}return r.forEach(function(s){var o=s.replace(IT,"").match(NT);o&&i.push({v:Et(o[2]),t:o[1]})}),i}var K1=/(^\s|\s$|\n)/;function Sn(e,t){return"<"+e+(t.match(K1)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Qo(e){return Jt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Me(e,t,n){return"<"+e+(n!=null?Qo(n):"")+(t!=null?(t.match(K1)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function B0(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function FT(e,t){switch(typeof e){case"string":var n=Me("vt:lpwstr",kt(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return Me((e|0)==e?"vt:i4":"vt:r8",kt(String(e)));case"boolean":return Me("vt:bool",e?"true":"false")}if(e instanceof Date)return Me("vt:filetime",B0(e));throw new Error("Unable to serialize "+e)}function _d(e){if(it&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Et(la(hd(e)));throw new Error("Bad input format: expected Buffer or string")}var el=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,cn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$a=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],lr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function RT(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function DT(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=r?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var u=0;u<=5;++u,s/=256)e[n+u]=s&255;e[n+6]=(i&15)<<4|s&15,e[n+7]=i>>4|r}var ug=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,s=e[0][r].length;i<s;i+=n)t.push.apply(t,e[0][r].slice(i,i+n));return t},cg=it?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ci(t)})):ug(e)}:ug,fg=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(yi(e,i)));return r.join("").replace(Gn,"")},Td=it?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(Gn,""):fg(e,t,n)}:fg,dg=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},J1=it?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):dg(e,t,n)}:dg,hg=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(Fs(e,i)));return r.join("")},cl=it?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):hg(t,n,r)}:hg,X1=function(e,t){var n=ur(e,t);return n>0?cl(e,t+4,t+4+n-1):""},Y1=X1,Z1=function(e,t){var n=ur(e,t);return n>0?cl(e,t+4,t+4+n-1):""},Q1=Z1,ev=function(e,t){var n=2*ur(e,t);return n>0?cl(e,t+4,t+4+n-1):""},tv=ev,nv=function(t,n){var r=ur(t,n);return r>0?Td(t,n+4,n+4+r):""},rv=nv,iv=function(e,t){var n=ur(e,t);return n>0?cl(e,t+4,t+4+n):""},av=iv,sv=function(e,t){return RT(e,t)},Yu=sv,kd=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};it&&(Y1=function(t,n){if(!Buffer.isBuffer(t))return X1(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},Q1=function(t,n){if(!Buffer.isBuffer(t))return Z1(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},tv=function(t,n){if(!Buffer.isBuffer(t))return ev(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},rv=function(t,n){if(!Buffer.isBuffer(t))return nv(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},av=function(t,n){if(!Buffer.isBuffer(t))return iv(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},Yu=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):sv(t,n)},kd=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Fs=function(e,t){return e[t]},yi=function(e,t){return e[t+1]*256+e[t]},PT=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},ur=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Fa=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},MT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function bo(e,t){var n="",r,i,s=[],o,u,d,h;switch(t){case"dbcs":if(h=this.l,it&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(d=0;d<e;++d)n+=String.fromCharCode(yi(this,h)),h+=2;e*=2;break;case"utf8":n=cl(this,this.l,this.l+e);break;case"utf16le":e*=2,n=Td(this,this.l,this.l+e);break;case"wstr":return bo.call(this,e,"dbcs");case"lpstr-ansi":n=Y1(this,this.l),e=4+ur(this,this.l);break;case"lpstr-cp":n=Q1(this,this.l),e=4+ur(this,this.l);break;case"lpwstr":n=tv(this,this.l),e=4+2*ur(this,this.l);break;case"lpp4":e=4+ur(this,this.l),n=rv(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ur(this,this.l),n=av(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(o=Fs(this,this.l+e++))!==0;)s.push(Cu(o));n=s.join("");break;case"_wstr":for(e=0,n="";(o=yi(this,this.l+e))!==0;)s.push(Cu(o)),e+=2;e+=2,n=s.join("");break;case"dbcs-cont":for(n="",h=this.l,d=0;d<e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Fs(this,h),this.l=h+1,u=bo.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(Cu(yi(this,h))),h+=2}n=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",h=this.l,d=0;d!=e;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Fs(this,h),this.l=h+1,u=bo.call(this,e-d,o?"dbcs-cont":"sbcs-cont"),s.join("")+u;s.push(Cu(Fs(this,h))),h+=1}n=s.join("");break;default:switch(e){case 1:return r=Fs(this,this.l),this.l++,r;case 2:return r=(t==="i"?PT:yi)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(r=(e>0?Fa:MT)(this,this.l),this.l+=4,r):(i=ur(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=Yu(this,this.l):i=Yu([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=J1(this,this.l,e);break}}return this.l+=e,n}var LT=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},BT=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},OT=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function UT(e,t,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)OT(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,LT(this,t,this.l);break;case 8:if(r=8,n==="f"){DT(this,t,this.l);break}case 16:break;case-4:r=4,BT(this,t,this.l);break}return this.l+=r,this}function ov(e,t){var n=J1(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function kn(e,t){e.l=t,e.read_shift=bo,e.chk=ov,e.write_shift=UT}function On(e,t){e.l+=t}function he(e){var t=ia(e);return kn(t,0),t}function Ai(e,t,n){if(e){var r,i,s;kn(e,e.l||0);for(var o=e.length,u=0,d=0;e.l<o;){u=e.read_shift(1),u&128&&(u=(u&127)+((e.read_shift(1)&127)<<7));var h=sl[u]||sl[65535];for(r=e.read_shift(1),s=r&127,i=1;i<4&&r&128;++i)s+=((r=e.read_shift(1))&127)<<7*i;d=e.l+s;var m=h.f&&h.f(e,s,n);if(e.l=d,t(m,h,u))return}}}function Zn(){var e=[],t=it?256:2048,n=function(h){var m=he(h);return kn(m,0),m},r=n(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},s=function(h){return r&&h<r.length-r.l?r:(i(),r=n(Math.max(h+1,t)))},o=function(){return i(),gn(e)},u=function(h){i(),r=h,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:u,end:o,_bufs:e}}function Te(e,t,n,r){var i=+t,s;if(!isNaN(i)){r||(r=sl[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var u=0;u!=4;++u)if(r>=128)o.write_shift(1,(r&127)+128),r>>=7;else{o.write_shift(1,r);break}r>0&&kd(n)&&e.push(n)}}function Vo(e,t,n){var r=Mt(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function pg(e,t,n){var r=Mt(e);return r.s=Vo(r.s,t.s,n),r.e=Vo(r.e,t.s,n),r}function Ho(e,t){if(e.cRel&&e.c<0)for(e=Mt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Mt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=Je(e);return!e.cRel&&e.cRel!=null&&(n=VT(n)),!e.rRel&&e.rRel!=null&&(n=zT(n)),n}function g0(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Ht(e.s.c)+":"+(e.e.cRel?"":"$")+Ht(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Qt(e.s.r)+":"+(e.e.rRel?"":"$")+Qt(e.e.r):Ho(e.s,t.biff)+":"+Ho(e.e,t.biff)}function Sd(e){return parseInt(bT(e),10)-1}function Qt(e){return""+(e+1)}function zT(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function bT(e){return e.replace(/\$(\d+)$/,"$1")}function Ed(e){for(var t=HT(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function Ht(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function VT(e){return e.replace(/^([A-Z])/,"$$$1")}function HT(e){return e.replace(/^\$([A-Z])/,"$1")}function WT(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Wt(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function Je(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Qn(e){var t=e.indexOf(":");return t==-1?{s:Wt(e),e:Wt(e)}:{s:Wt(e.slice(0,t)),e:Wt(e.slice(t+1))}}function nt(e,t){return typeof t>"u"||typeof t=="number"?nt(e.s,e.e):(typeof e!="string"&&(e=Je(e)),typeof t!="string"&&(t=Je(t)),e==t?e:e+":"+t)}function ct(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=e.length;for(n=0;r<s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function mg(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Fr(e.z,n?fn(t):t)}catch{}try{return e.w=Fr((e.XF||{}).numFmtId||(n?14:0),n?fn(t):t)}catch{return""+t}}function Si(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?Ii[e.v]||e.v:t==null?mg(e,e.v):mg(e,t))}function ua(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function lv(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,s=e||(i?[]:{}),o=0,u=0;if(s&&r.origin!=null){if(typeof r.origin=="number")o=r.origin;else{var d=typeof r.origin=="string"?Wt(r.origin):r.origin;o=d.r,u=d.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var m=ct(s["!ref"]);h.s.c=m.s.c,h.s.r=m.s.r,h.e.c=Math.max(h.e.c,m.e.c),h.e.r=Math.max(h.e.r,m.e.r),o==-1&&(h.e.r=o=m.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[x].length;++v)if(!(typeof t[x][v]>"u")){var _={v:t[x][v]},S=o+x,T=u+v;if(h.s.r>S&&(h.s.r=S),h.s.c>T&&(h.s.c=T),h.e.r<S&&(h.e.r=S),h.e.c<T&&(h.e.c=T),t[x][v]&&typeof t[x][v]=="object"&&!Array.isArray(t[x][v])&&!(t[x][v]instanceof Date))_=t[x][v];else if(Array.isArray(_.v)&&(_.f=t[x][v][1],_.v=_.v[0]),_.v===null)if(_.f)_.t="n";else if(r.nullError)_.t="e",_.v=0;else if(r.sheetStubs)_.t="z";else continue;else typeof _.v=="number"?_.t="n":typeof _.v=="boolean"?_.t="b":_.v instanceof Date?(_.z=r.dateNF||Ke[14],r.cellDates?(_.t="d",_.w=Fr(_.z,fn(_.v))):(_.t="n",_.v=fn(_.v),_.w=Fr(_.z,_.v))):_.t="s";if(i)s[S]||(s[S]=[]),s[S][T]&&s[S][T].z&&(_.z=s[S][T].z),s[S][T]=_;else{var E=Je({c:T,r:S});s[E]&&s[E].z&&(_.z=s[E].z),s[E]=_}}}return h.s.c<1e7&&(s["!ref"]=nt(h)),s}function js(e,t){return lv(null,e,t)}function GT(e){return e.read_shift(4,"i")}function $r(e,t){return t||(t=he(4)),t.write_shift(4,e),t}function Bn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function vn(e,t){var n=!1;return t==null&&(n=!0,t=he(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function $T(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function jT(e,t){return t||(t=he(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Cd(e,t){var n=e.l,r=e.read_shift(1),i=Bn(e),s=[],o={t:i,h:i};if((r&1)!==0){for(var u=e.read_shift(4),d=0;d!=u;++d)s.push($T(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=n+t,o}function qT(e,t){var n=!1;return t==null&&(n=!0,t=he(15+4*e.t.length)),t.write_shift(1,0),vn(e.t,t),n?t.slice(0,t.l):t}var KT=Cd;function JT(e,t){var n=!1;return t==null&&(n=!0,t=he(23+4*e.t.length)),t.write_shift(1,1),vn(e.t,t),t.write_shift(4,1),jT({},t),n?t.slice(0,t.l):t}function Rr(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function ja(e,t){return t==null&&(t=he(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function qa(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ka(e,t){return t==null&&(t=he(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var XT=Bn,uv=vn;function Ad(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Zu(e,t){var n=!1;return t==null&&(n=!0,t=he(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var YT=Bn,O0=Ad,Id=Zu;function Nd(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var i=r===0?Yu([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Fa(t,0)>>2;return n?i/100:i}function cv(e,t){t==null&&(t=he(4));var n=0,r=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?i:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function fv(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function ZT(e,t){return t||(t=he(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ja=fv,qs=ZT;function Mn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function ba(e,t){return(t||he(8)).write_shift(8,e,"f")}function QT(e){var t={},n=e.read_shift(1),r=n>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),u=e.read_shift(1),d=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var h=Da[i];h&&(t.rgb=nl(h));break;case 2:t.rgb=nl([o,u,d]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Qu(e,t){if(t||(t=he(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function ek(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function tk(e,t){t||(t=he(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}function dv(e,t){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function nk(e){return dv(e,1)}function rk(e){return dv(e,2)}var Fd=2,Yn=3,Iu=11,gg=12,ec=19,Nu=64,ik=65,ak=71,sk=4108,ok=4126,mn=80,hv=81,lk=[mn,hv],U0={1:{n:"CodePage",t:Fd},2:{n:"Category",t:mn},3:{n:"PresentationFormat",t:mn},4:{n:"ByteCount",t:Yn},5:{n:"LineCount",t:Yn},6:{n:"ParagraphCount",t:Yn},7:{n:"SlideCount",t:Yn},8:{n:"NoteCount",t:Yn},9:{n:"HiddenCount",t:Yn},10:{n:"MultimediaClipCount",t:Yn},11:{n:"ScaleCrop",t:Iu},12:{n:"HeadingPairs",t:sk},13:{n:"TitlesOfParts",t:ok},14:{n:"Manager",t:mn},15:{n:"Company",t:mn},16:{n:"LinksUpToDate",t:Iu},17:{n:"CharacterCount",t:Yn},19:{n:"SharedDoc",t:Iu},22:{n:"HyperlinksChanged",t:Iu},23:{n:"AppVersion",t:Yn,p:"version"},24:{n:"DigSig",t:ik},26:{n:"ContentType",t:mn},27:{n:"ContentStatus",t:mn},28:{n:"Language",t:mn},29:{n:"Version",t:mn},255:{},2147483648:{n:"Locale",t:ec},2147483651:{n:"Behavior",t:ec},1919054434:{}},z0={1:{n:"CodePage",t:Fd},2:{n:"Title",t:mn},3:{n:"Subject",t:mn},4:{n:"Author",t:mn},5:{n:"Keywords",t:mn},6:{n:"Comments",t:mn},7:{n:"Template",t:mn},8:{n:"LastAuthor",t:mn},9:{n:"RevNumber",t:mn},10:{n:"EditTime",t:Nu},11:{n:"LastPrinted",t:Nu},12:{n:"CreatedDate",t:Nu},13:{n:"ModifiedDate",t:Nu},14:{n:"PageCount",t:Yn},15:{n:"WordCount",t:Yn},16:{n:"CharCount",t:Yn},17:{n:"Thumbnail",t:ak},18:{n:"Application",t:mn},19:{n:"DocSecurity",t:Yn},255:{},2147483648:{n:"Locale",t:ec},2147483651:{n:"Behavior",t:ec},1919054434:{}},xg={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},uk=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function ck(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var fk=ck([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Da=Mt(fk),Ii={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},pv={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},b0={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Fu={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Rd(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function dk(e){var t=Rd();if(!e||!e.match)return t;var n={};if((e.match(Un)||[]).forEach(function(r){var i=Ye(r);switch(i[0].replace(TT,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[i.Extension]=i.ContentType;break;case"<Override":t[b0[i.ContentType]]!==void 0&&t[b0[i.ContentType]].push(i.PartName);break}}),t.xmlns!==cn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}function mv(e,t){var n=dT(b0),r=[],i;r[r.length]=en,r[r.length]=Me("Types",null,{xmlns:cn.CT,"xmlns:xsd":cn.xsd,"xmlns:xsi":cn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Me("Default",null,{Extension:d[0],ContentType:d[1]})}));var s=function(d){e[d]&&e[d].length>0&&(i=e[d][0],r[r.length]=Me("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Fu[d][t.bookType]||Fu[d].xlsx}))},o=function(d){(e[d]||[]).forEach(function(h){r[r.length]=Me("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Fu[d][t.bookType]||Fu[d].xlsx})})},u=function(d){(e[d]||[]).forEach(function(h){r[r.length]=Me("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:n[d][0]})})};return s("workbooks"),o("sheets"),o("charts"),u("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),o("metadata"),u("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var at={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function tl(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Wo(e,t){var n={"!id":{}};if(!e)return n;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match(Un)||[]).forEach(function(i){var s=Ye(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var u=s.TargetMode==="External"?s.Target:zo(s.Target,t);n[u]=o,r[s.Id]=o}}),n["!id"]=r,n}function Ms(e){var t=[en,Me("Relationships",null,{xmlns:cn.RELS})];return Jt(e["!id"]).forEach(function(n){t[t.length]=Me("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Tt(e,t,n,r,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,[at.HLINK,at.XPATH,at.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var hk="application/vnd.oasis.opendocument.spreadsheet";function pk(e,t){for(var n=_d(e),r,i;r=el.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(i=Ye(r[0],!1),i.path=="/"&&i.type!==hk)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}function mk(e){var t=[en];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function vg(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function gk(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function xk(e){var t=[en];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(vg(e[n][0],e[n][1])),t.push(gk("",e[n][0]));return t.push(vg("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function gv(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ju.version+"</meta:generator></office:meta></office:document-meta>"}var Ir=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vk=function(){for(var e=new Array(Ir.length),t=0;t<Ir.length;++t){var n=Ir[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function xv(e){var t={};e=Et(e);for(var n=0;n<Ir.length;++n){var r=Ir[n],i=e.match(vk[n]);i!=null&&i.length>0&&(t[r[1]]=ut(i[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=Pt(t[r[1]]))}return t}function x0(e,t,n,r,i){i[e]!=null||t==null||t===""||(i[e]=t,t=kt(t),r[r.length]=n?Me(e,t,n):Sn(e,t))}function vv(e,t){var n=t||{},r=[en,Me("cp:coreProperties",null,{"xmlns:cp":cn.CORE_PROPS,"xmlns:dc":cn.dc,"xmlns:dcterms":cn.dcterms,"xmlns:dcmitype":cn.dcmitype,"xmlns:xsi":cn.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&x0("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:B0(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),e.ModifiedDate!=null&&x0("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:B0(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=Ir.length;++s){var o=Ir[s],u=n.Props&&n.Props[o[1]]!=null?n.Props[o[1]]:e?e[o[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&x0(o[0],u,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Pa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],yv=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wv(e,t,n,r){var i=[];if(typeof e=="string")i=lg(e,r);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(m){return{v:m}}));var o=typeof t=="string"?lg(t,r).map(function(m){return m.v}):t,u=0,d=0;if(o.length>0)for(var h=0;h!==i.length;h+=2){switch(d=+i[h+1].v,i[h].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=d,n.SheetNames=o.slice(u,u+d);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=d,n.DefinedNames=o.slice(u,u+d);break;case"Charts":case"Diagramme":n.Chartsheets=d,n.ChartNames=o.slice(u,u+d);break}u+=d}}function yk(e,t,n){var r={};return t||(t={}),e=Et(e),Pa.forEach(function(i){var s=(e.match(Zo(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=ut(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(r[i[1]]=o[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&wv(r.HeadingPairs,r.TitlesOfParts,t,n),t}function _v(e){var t=[],n=Me;return e||(e={}),e.Application="SheetJS",t[t.length]=en,t[t.length]=Me("Properties",null,{xmlns:cn.EXT_PROPS,"xmlns:vt":cn.vt}),Pa.forEach(function(r){if(e[r[1]]!==void 0){var i;switch(r[2]){case"string":i=kt(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+kt(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var wk=/<[^>]+>[^<]*/g;function _k(e,t){var n={},r="",i=e.match(wk);if(i)for(var s=0;s!=i.length;++s){var o=i[s],u=Ye(o);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":r=ut(u.name);break;case"</property>":r=null;break;default:if(o.indexOf("<vt:")===0){var d=o.split(">"),h=d[0].slice(4),m=d[1];switch(h){case"lpstr":case"bstr":case"lpwstr":n[r]=ut(m);break;case"bool":n[r]=Dt(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(m,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(m);break;case"filetime":case"date":n[r]=Pt(m);break;case"cy":case"error":n[r]=ut(m);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,d)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return n}function Tv(e){var t=[en,Me("Properties",null,{xmlns:cn.CUST_PROPS,"xmlns:vt":cn.vt})];if(!e)return t.join("");var n=1;return Jt(e).forEach(function(i){++n,t[t.length]=Me("property",FT(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:kt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var V0={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},v0;function Tk(e,t,n){v0||(v0=mc(V0)),t=v0[t]||t,e[t]=n}function kk(e,t){var n=[];return Jt(V0).map(function(r){for(var i=0;i<Ir.length;++i)if(Ir[i][1]==r)return Ir[i];for(i=0;i<Pa.length;++i)if(Pa[i][1]==r)return Pa[i];throw r}).forEach(function(r){if(e[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Sn(V0[r[1]]||r[1],i))}}),Me("DocumentProperties",n.join(""),{xmlns:lr.o})}function Sk(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&Jt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<Ir.length;++o)if(s==Ir[o][1])return;for(o=0;o<Pa.length;++o)if(s==Pa[o][1])return;for(o=0;o<n.length;++o)if(s==n[o])return;var u=e[s],d="string";typeof u=="number"?(d="float",u=String(u)):u===!0||u===!1?(d="boolean",u=u?"1":"0"):u=String(u),i.push(Me(ig(s),u,{"dt:dt":d}))}}),t&&Jt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],u="string";typeof o=="number"?(u="float",o=String(o)):o===!0||o===!1?(u="boolean",o=o?"1":"0"):o instanceof Date?(u="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Me(ig(s),o,{"dt:dt":u}))}}),"<"+r+' xmlns="'+lr.o+'">'+i.join("")+"</"+r+">"}function Dd(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Ek(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var o=he(8);return o.write_shift(4,r),o.write_shift(4,i),o}function kv(e,t,n){var r=e.l,i=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return i}function Sv(e,t,n){var r=e.read_shift(0,"lpwstr");return r}function Ev(e,t,n){return t===31?Sv(e):kv(e,t,n)}function H0(e,t,n){return Ev(e,t,n===!1?0:4)}function Ck(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Ev(e,t,0)}function Ak(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var i=e.l;n[r]=e.read_shift(0,"lpwstr").replace(Gn,""),e.l-i&2&&(e.l+=2)}return n}function Ik(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(Gn,"");return n}function Nk(e){var t=e.l,n=tc(e,hv);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=tc(e,Yn);return[n,r]}function Fk(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(Nk(e));return n}function yg(e,t){for(var n=e.read_shift(4),r={},i=0;i!=n;++i){var s=e.read_shift(4),o=e.read_shift(4);r[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Gn,"").replace(Uo,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function Cv(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),n}function Rk(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function tc(e,t,n){var r=e.read_shift(2),i,s=n||{};if(e.l+=2,t!==gg&&r!==t&&lk.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===gg?r:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return kv(e,r,4).replace(Gn,"");case 31:return Sv(e);case 64:return Dd(e);case 65:return Cv(e);case 71:return Rk(e);case 80:return H0(e,r,!s.raw).replace(Gn,"");case 81:return Ck(e,r).replace(Gn,"");case 4108:return Fk(e);case 4126:case 4127:return r==4127?Ak(e):Ik(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function wg(e,t){var n=he(4),r=he(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=he(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=Ek(t);break;case 31:case 80:for(r=he(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return gn([n,r])}function _g(e,t){var n=e.l,r=e.read_shift(4),i=e.read_shift(4),s=[],o=0,u=0,d=-1,h={};for(o=0;o!=i;++o){var m=e.read_shift(4),x=e.read_shift(4);s[o]=[m,x+n]}s.sort(function(I,A){return I[1]-A[1]});var v={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var _=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,_=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],_=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],_=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(_=!1,e.l=s[o][1]),_)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var S=t[s[o][0]];if(v[S.n]=tc(e,S.t,{raw:!0}),S.p==="version"&&(v[S.n]=String(v[S.n]>>16)+"."+("0000"+String(v[S.n]&65535)).slice(-4)),S.n=="CodePage")switch(v[S.n]){case 0:v[S.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Hr(u=v[S.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[S.n])}}else if(s[o][0]===1){if(u=v.CodePage=tc(e,Fd),Hr(u),d!==-1){var T=e.l;e.l=s[d][1],h=yg(e,u),e.l=T}}else if(s[o][0]===0){if(u===0){d=o,e.l=s[o+1][1];continue}h=yg(e,u)}else{var E=h[s[o][0]],C;switch(e[e.l]){case 65:e.l+=4,C=Cv(e);break;case 30:e.l+=4,C=H0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=H0(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=Zt(e,4);break;case 64:e.l+=4,C=Pt(Dd(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[E]=C}}return e.l=n+r,v}var Av=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Dk(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Tg(e,t,n){var r=he(8),i=[],s=[],o=8,u=0,d=he(8),h=he(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),s.push(d),i.push(h),o+=8+d.length,!t){h=he(8),h.write_shift(4,0),i.unshift(h);var m=[he(4)];for(m[0].write_shift(4,e.length),u=0;u<e.length;++u){var x=e[u][0];for(d=he(8+2*(x.length+1)+(x.length%2?0:2)),d.write_shift(4,u+2),d.write_shift(4,x.length+1),d.write_shift(0,x,"dbcs");d.l!=d.length;)d.write_shift(1,0);m.push(d)}d=gn(m),s.unshift(d),o+=8+d.length}for(u=0;u<e.length;++u)if(!(t&&!t[e[u][0]])&&!(Av.indexOf(e[u][0])>-1||yv.indexOf(e[u][0])>-1)&&e[u][1]!=null){var v=e[u][1],_=0;if(t){_=+t[e[u][0]];var S=n[_];if(S.p=="version"&&typeof v=="string"){var T=v.split(".");v=(+T[0]<<16)+(+T[1]||0)}d=wg(S.t,v)}else{var E=Dk(v);E==-1&&(E=31,v=String(v)),d=wg(E,v)}s.push(d),h=he(8),h.write_shift(4,t?_:2+u),i.push(h),o+=8+d.length}var C=8*(s.length+1);for(u=0;u<s.length;++u)i[u].write_shift(4,C),C+=s[u].length;return r.write_shift(4,o),r.write_shift(4,s.length),gn([r].concat(i).concat(s))}function kg(e,t,n){var r=e.content;if(!r)return{};kn(r,0);var i,s,o,u,d=0;r.chk("feff","Byte Order: "),r.read_shift(2);var h=r.read_shift(4),m=r.read_shift(16);if(m!==We.utils.consts.HEADER_CLSID&&m!==n)throw new Error("Bad PropertySet CLSID "+m);if(i=r.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=r.read_shift(16),u=r.read_shift(4),i===1&&u!==r.l)throw new Error("Length mismatch: "+u+" !== "+r.l);i===2&&(o=r.read_shift(16),d=r.read_shift(4));var x=_g(r,t),v={SystemIdentifier:h};for(var _ in x)v[_]=x[_];if(v.FMTID=s,i===1)return v;if(d-r.l==2&&(r.l+=2),r.l!==d)throw new Error("Length mismatch 2: "+r.l+" !== "+d);var S;try{S=_g(r,null)}catch{}for(_ in S)v[_]=S[_];return v.FMTID=[s,o],v}function Sg(e,t,n,r,i,s){var o=he(i?68:48),u=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,We.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var d=Tg(e,n,r);if(u.push(d),i){var h=Tg(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+d.length),u.push(h)}return gn(u)}function Qi(e,t){return e.read_shift(t),null}function Pk(e,t){t||(t=he(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function Mk(e,t,n){for(var r=[],i=e.l+t;e.l<i;)r.push(n(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return r}function Zt(e,t){return e.read_shift(t)===1}function Hn(e,t){return t||(t=he(2)),t.write_shift(2,+!!e),t}function sn(e){return e.read_shift(2,"u")}function Cr(e,t){return t||(t=he(2)),t.write_shift(2,e),t}function Iv(e,t){return Mk(e,t,sn)}function Lk(e){var t=e.read_shift(1),n=e.read_shift(1);return n===1?t:t===1}function Nv(e,t,n){return n||(n=he(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function fl(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var o=r?e.read_shift(r,i):"";return o}function Bk(e){var t=e.read_shift(2),n=e.read_shift(1),r=n&4,i=n&8,s=1+(n&1),o=0,u,d={};i&&(o=e.read_shift(2)),r&&(u=e.read_shift(4));var h=s==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,h);return i&&(e.l+=4*o),r&&(e.l+=u),d.t=m,i||(d.raw="<t>"+d.t+"</t>",d.r=d.t),d}function Ok(e){var t=e.t||"",n=he(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=he(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[n,r];return gn(i)}function Va(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function dl(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):Va(e,r,n)}function Xa(e,t,n){if(n.biff>5)return dl(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Fv(e,t,n){return n||(n=he(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function Uk(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}function zk(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=n);var i=e.read_shift((r?t-24:t)>>1,"utf16le").replace(Gn,"");return r&&(e.l+=24),i}function bk(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return n+r.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(Gn,"");return n+o}function Vk(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return zk(e);case"0303000000000000c000000000000046":return bk(e);default:throw new Error("Unsupported Moniker "+n)}}function Ru(e){var t=e.read_shift(4),n=t>0?e.read_shift(t,"utf16le").replace(Gn,""):"";return n}function Eg(e,t){t||(t=he(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function Hk(e,t){var n=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var i=e.read_shift(2);e.l+=2;var s,o,u,d,h="",m,x;i&16&&(s=Ru(e,n-e.l)),i&128&&(o=Ru(e,n-e.l)),(i&257)===257&&(u=Ru(e,n-e.l)),(i&257)===1&&(d=Vk(e,n-e.l)),i&8&&(h=Ru(e,n-e.l)),i&32&&(m=e.read_shift(16)),i&64&&(x=Dd(e)),e.l=n;var v=o||u||d||"";v&&h&&(v+="#"+h),v||(v="#"+h),i&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var _={Target:v};return m&&(_.guid=m),x&&(_.time=x),s&&(_.Tooltip=s),_}function Wk(e){var t=he(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(n=0;n<o.length;++n)t.write_shift(4,o[n]);if(s==28)r=r.slice(1),Eg(r,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));var u=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(u.length+1)),n=0;n<u.length;++n)t.write_shift(2,u.charCodeAt(n));t.write_shift(2,0),s&8&&Eg(i>-1?r.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<o.length;++n)t.write_shift(1,parseInt(o[n],16));for(var d=0;r.slice(d*3,d*3+3)=="../"||r.slice(d*3,d*3+3)=="..\\";)++d;for(t.write_shift(2,d),t.write_shift(4,r.length-3*d+1),n=0;n<r.length-3*d;++n)t.write_shift(1,r.charCodeAt(n+3*d)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function Rv(e){var t=e.read_shift(1),n=e.read_shift(1),r=e.read_shift(1),i=e.read_shift(1);return[t,n,r,i]}function Dv(e,t){var n=Rv(e);return n[3]=0,n}function si(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return{r:t,c:n,ixfe:r}}function Ha(e,t,n,r){return r||(r=he(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function Gk(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}function $k(e,t,n){return t===0?"":Xa(e,t,n)}function jk(e,t,n){var r=n.biff>8?4:2,i=e.read_shift(r),s=e.read_shift(r,"i"),o=e.read_shift(r,"i");return[i,s,o]}function Pv(e){var t=e.read_shift(2),n=Nd(e);return[t,n]}function qk(e,t,n){e.l+=4,t-=4;var r=e.l+t,i=fl(e,t,n),s=e.read_shift(2);if(r-=e.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return e.l+=s,i}function vc(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:n}}}function Mv(e,t){return t||(t=he(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Lv(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(1),i=e.read_shift(1);return{s:{c:r,r:t},e:{c:i,r:n}}}var Kk=Lv;function Bv(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function Jk(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Xk(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Fn(e){e.l+=2,e.l+=e.read_shift(2)}var Yk={0:Fn,4:Fn,5:Fn,6:Fn,7:Xk,8:Fn,9:Fn,10:Fn,11:Fn,12:Fn,13:Jk,14:Fn,15:Fn,16:Fn,17:Fn,18:Fn,19:Fn,20:Fn,21:Bv};function Zk(e,t){for(var n=e.l+t,r=[];e.l<n;){var i=e.read_shift(2);e.l-=2;try{r.push(Yk[i](e,n-e.l))}catch{return e.l=n,r}}return e.l!=n&&(e.l=n),r}function Du(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),t-=2,t>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function Pd(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=he(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Qk(e,t){return t===0||e.read_shift(2),1200}function eS(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,i=Xa(e,0,n);return e.read_shift(t+r-e.l),i}function tS(e,t){var n=!t||t.biff==8,r=he(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function nS(e,t,n){var r=n&&n.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function rS(e,t,n){var r=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=fl(e,0,n);return o.length===0&&(o="Sheet1"),{pos:r,hs:i,dt:s,name:o}}function iS(e,t){var n=!t||t.biff>=8?2:1,r=he(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function aS(e,t){for(var n=e.l+t,r=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<n;++o)s.push(Bk(e));return s.Count=r,s.Unique=i,s}function sS(e,t){var n=he(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=Ok(e[i]);var s=gn([n].concat(r));return s.parts=[n.length].concat(r.map(function(o){return o.length})),s}function oS(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}function lS(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=n/20),t}function uS(e){var t=Gk(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var n=e.read_shift(4);return n!==0}function cS(e){return e.read_shift(2),e.read_shift(4)}function Cg(e,t,n){var r=0;n&&n.biff==2||(r=e.read_shift(2));var i=e.read_shift(2);n&&n.biff==2&&(r=1-(i>>15),i&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,i]}function fS(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),u=e.read_shift(2),d=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,n],Dim:[r,i],Flags:s,CurTab:o,FirstTab:u,Selected:d,TabRatio:h}}function dS(){var e=he(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function hS(e,t,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function pS(e){var t=he(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function mS(){}function gS(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=fl(e,0,n),r}function xS(e,t){var n=e.name||"Arial",r=t&&t.biff==5,i=r?15+n.length:16+2*n.length,s=he(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function vS(e){var t=si(e);return t.isst=e.read_shift(4),t}function yS(e,t,n,r){var i=he(10);return Ha(e,t,r,i),i.write_shift(4,n),i}function wS(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=e.l+t,i=si(e);n.biff==2&&e.l++;var s=dl(e,r-e.l,n);return i.val=s,i}function _S(e,t,n,r,i){var s=!i||i.biff==8,o=he(8+ +s+(1+s)*n.length);return Ha(e,t,r,o),o.write_shift(2,n.length),s&&o.write_shift(1,1),o.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),o}function TS(e,t,n){var r=e.read_shift(2),i=Xa(e,0,n);return[r,i]}function kS(e,t,n,r){var i=n&&n.biff==5;r||(r=he(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}var SS=Xa;function Ag(e,t,n){var r=e.l+t,i=n.biff==8||!n.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),u=e.read_shift(2),d=e.read_shift(2);return e.l=r,{s:{r:s,c:u},e:{r:o,c:d}}}function ES(e,t){var n=t.biff==8||!t.biff?4:2,r=he(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function CS(e){var t=e.read_shift(2),n=e.read_shift(2),r=Pv(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}function AS(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),s=[];e.l<n;)s.push(Pv(e));if(e.l!==n)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r,c:i,C:o,rkrec:s}}function IS(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),s=[];e.l<n;)s.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r,c:i,C:o,ixfe:s}}function NS(e,t,n,r){var i={},s=e.read_shift(4),o=e.read_shift(4),u=e.read_shift(4),d=e.read_shift(2);return i.patternType=uk[u>>26],r.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=u&127,i.icvBottom=u>>7&127,i.icvDiag=u>>14&127,i.dgDiag=u>>21&15,i.icvFore=d&127,i.icvBack=d>>7&127,i.fsxButton=d>>14&1),i}function FS(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=NS(e,t,r.fStyle,n),r}function Ig(e,t,n,r){var i=n&&n.biff==5;r||(r=he(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function RS(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function DS(e){var t=he(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function Ng(e,t,n){var r=si(e);(n.biff==2||t==9)&&++e.l;var i=Lk(e);return r.val=i,r.t=i===!0||i===!1?"b":"e",r}function PS(e,t,n,r,i,s){var o=he(8);return Ha(e,t,r,o),Nv(n,s,o),o}function MS(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=si(e),i=Mn(e);return r.val=i,r}function LS(e,t,n,r){var i=he(14);return Ha(e,t,r,i),ba(n,i),i}var Fg=$k;function BS(e,t,n){var r=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(n.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=Va(e,s),u=[];r>e.l;)u.push(dl(e));return[s,i,o,u]}function Rg(e,t,n){var r=e.read_shift(2),i,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(i=qk(e,t-2,n)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var OS=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Dg(e,t,n){var r=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),u=e.read_shift(n&&n.biff==2?1:2),d=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),d=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var h=Va(e,o,n);i&32&&(h=OS[h.charCodeAt(0)]);var m=r-e.l;n&&n.biff==2&&--m;var x=r==e.l||u===0||!(m>0)?[]:Z4(e,m,n,u);return{chKey:s,Name:h,itab:d,rgce:x}}function Ov(e,t,n){if(n.biff<8)return US(e,t,n);for(var r=[],i=e.l+t,s=e.read_shift(n.biff>8?4:2);s--!==0;)r.push(jk(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function US(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=fl(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function zS(e,t,n){if(n.biff<8){e.l+=t;return}var r=e.read_shift(2),i=e.read_shift(2),s=Va(e,r,n),o=Va(e,i,n);return[s,o]}function bS(e,t,n){var r=Lv(e);e.l++;var i=e.read_shift(1);return t-=8,[Q4(e,t,n),i,r]}function Pg(e,t,n){var r=Kk(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,X4(e,t,n)]}function VS(e){var t=e.read_shift(4)!==0,n=e.read_shift(4)!==0,r=e.read_shift(4);return[t,n,r]}function HS(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),u=Xa(e,0,n);return n.biff<8&&e.read_shift(1),[{r,c:i},u,o,s]}}function WS(e,t,n){return HS(e,t,n)}function GS(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(vc(e));return n}function $S(e){var t=he(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)Mv(e[n],t);return t}function jS(e,t,n){if(n&&n.biff<8)return KS(e,t,n);var r=Bv(e),i=Zk(e,t-22,r[1]);return{cmo:r,ft:i}}var qS={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=n,{fmt:r}}};function KS(e,t,n){e.l+=4;var r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((qS[r]||On)(e,t,n)),{cmo:[i,r,s],ft:o}}function JS(e,t,n){var r=e.l,i="";try{e.l+=4;var s=(n.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=Uk(e,6,n);var u=e.read_shift(2);e.read_shift(2),sn(e,2);var d=e.read_shift(2);e.l+=d;for(var h=1;h<e.lens.length-1;++h){if(e.l-r!=e.lens[h])throw new Error("TxO: bad continue record");var m=e[e.l],x=Va(e,e.lens[h+1]-e.lens[h]-1);if(i+=x,i.length>=(m?u:2*u))break}if(i.length!==u&&i.length!==u*2)throw new Error("cchText: "+u+" != "+i.length);return e.l=r+t,{t:i}}catch{return e.l=r+t,{t:i}}}function XS(e,t){var n=vc(e);e.l+=16;var r=Hk(e,t-24);return[n,r]}function YS(e){var t=he(24),n=Wt(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return gn([t,Wk(e[1])])}function ZS(e,t){e.read_shift(2);var n=vc(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(Gn,""),[n,r]}function QS(e){var t=e[1].Tooltip,n=he(10+2*(t.length+1));n.write_shift(2,2048);var r=Wt(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function eE(e){var t=[0,0],n;return n=e.read_shift(2),t[0]=xg[n]||n,n=e.read_shift(2),t[1]=xg[n]||n,t}function tE(e){return e||(e=he(4)),e.write_shift(2,1),e.write_shift(2,1),e}function nE(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Dv(e));return n}function rE(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(Dv(e));return n}function iE(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function Uv(e,t,n){if(!n.cellStyles)return On(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),s=e.read_shift(r),o=e.read_shift(r),u=e.read_shift(r),d=e.read_shift(2);r==2&&(e.l+=2);var h={s:i,e:s,w:o,ixfe:u,flags:d};return(n.biff>=5||!n.biff)&&(h.level=d>>8&7),h}function aE(e,t){var n=he(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function sE(e,t){var n={};return t<32||(e.l+=16,n.header=Mn(e),n.footer=Mn(e),e.l+=2),n}function oE(e,t,n){var r={area:!1};if(n.biff!=5)return e.l+=t,r;var i=e.read_shift(1);return e.l+=3,i&16&&(r.area=!0),r}function lE(e){for(var t=he(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}var uE=si,cE=Iv,fE=dl;function dE(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,i}function hE(e,t,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=si(e);++e.l;var i=Xa(e,t-7,n);return r.t="str",r.val=i,r}function pE(e){var t=si(e);++e.l;var n=Mn(e);return t.t="n",t.val=n,t}function mE(e,t,n){var r=he(15);return gl(r,e,t),r.write_shift(8,n,"f"),r}function gE(e){var t=si(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}function xE(e,t,n){var r=he(9);return gl(r,e,t),r.write_shift(2,n),r}function vE(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function yE(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function wE(e,t,n){var r=e.l+t,i=si(e),s=e.read_shift(2),o=Va(e,s,n);return e.l=r,i.t="str",i.val=o,i}var _E=[2,3,48,49,131,139,140,245],W0=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=mc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(u,d){var h=[],m=ia(1);switch(d.type){case"base64":m=cr(hr(u));break;case"binary":m=cr(u);break;case"buffer":case"array":m=u;break}kn(m,0);var x=m.read_shift(1),v=!!(x&136),_=!1,S=!1;switch(x){case 2:break;case 3:break;case 48:_=!0,v=!0;break;case 49:_=!0,v=!0;break;case 131:break;case 139:break;case 140:S=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var T=0,E=521;x==2&&(T=m.read_shift(2)),m.l+=3,x!=2&&(T=m.read_shift(4)),T>1048576&&(T=1e6),x!=2&&(E=m.read_shift(2));var C=m.read_shift(2),I=d.codepage||1252;x!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(I=e[m[m.l]]),m.l+=1,m.l+=2),S&&(m.l+=36);for(var A=[],D={},P=Math.min(m.length,x==2?521:E-10-(_?264:0)),L=S?32:11;m.l<P&&m[m.l]!=13;)switch(D={},D.name=Jo.utils.decode(I,m.slice(m.l,m.l+L)).replace(/[\u0000\r\n].*$/g,""),m.l+=L,D.type=String.fromCharCode(m.read_shift(1)),x!=2&&!S&&(D.offset=m.read_shift(4)),D.len=m.read_shift(1),x==2&&(D.offset=m.read_shift(2)),D.dec=m.read_shift(1),D.name.length&&A.push(D),x!=2&&(m.l+=S?13:14),D.type){case"B":(!_||D.len!=8)&&d.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+D.name+":"+D.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+D.type)}if(m[m.l]!==13&&(m.l=E-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=E;var R=0,J=0;for(h[0]=[],J=0;J!=A.length;++J)h[0][J]=A[J].name;for(;T-- >0;){if(m[m.l]===42){m.l+=C;continue}for(++m.l,h[++R]=[],J=0,J=0;J!=A.length;++J){var V=m.slice(m.l,m.l+A[J].len);m.l+=A[J].len,kn(V,0);var ne=Jo.utils.decode(I,V);switch(A[J].type){case"C":ne.trim().length&&(h[R][J]=ne.replace(/\s+$/,""));break;case"D":ne.length===8?h[R][J]=new Date(+ne.slice(0,4),+ne.slice(4,6)-1,+ne.slice(6,8)):h[R][J]=ne;break;case"F":h[R][J]=parseFloat(ne.trim());break;case"+":case"I":h[R][J]=S?V.read_shift(-4,"i")^2147483648:V.read_shift(4,"i");break;case"L":switch(ne.trim().toUpperCase()){case"Y":case"T":h[R][J]=!0;break;case"N":case"F":h[R][J]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ne+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[R][J]="##MEMO##"+(S?parseInt(ne.trim(),10):V.read_shift(4));break;case"N":ne=ne.replace(/\u0000/g,"").trim(),ne&&ne!="."&&(h[R][J]=+ne||0);break;case"@":h[R][J]=new Date(V.read_shift(-8,"f")-621356832e5);break;case"T":h[R][J]=new Date((V.read_shift(4)-2440588)*864e5+V.read_shift(4));break;case"Y":h[R][J]=V.read_shift(4,"i")/1e4+V.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[R][J]=-V.read_shift(-8,"f");break;case"B":if(_&&A[J].len==8){h[R][J]=V.read_shift(8,"f");break}case"G":case"P":V.l+=A[J].len;break;case"0":if(A[J].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[J].type)}}}if(x!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=A,h}function r(u,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var m=js(n(u,h),h);return m["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,m}function i(u,d){try{return ua(r(u,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(u,d){var h=d||{};if(+h.codepage>=0&&Hr(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var m=Zn(),x=ic(u,{header:1,raw:!0,cellDates:!0}),v=x[0],_=x.slice(1),S=u["!cols"]||[],T=0,E=0,C=0,I=1;for(T=0;T<v.length;++T){if(((S[T]||{}).DBF||{}).name){v[T]=S[T].DBF.name,++C;continue}if(v[T]!=null){if(++C,typeof v[T]=="number"&&(v[T]=v[T].toString(10)),typeof v[T]!="string")throw new Error("DBF Invalid column name "+v[T]+" |"+typeof v[T]+"|");if(v.indexOf(v[T])!==T){for(E=0;E<1024;++E)if(v.indexOf(v[T]+"_"+E)==-1){v[T]+="_"+E;break}}}}var A=ct(u["!ref"]),D=[],P=[],L=[];for(T=0;T<=A.e.c-A.s.c;++T){var R="",J="",V=0,ne=[];for(E=0;E<_.length;++E)_[E][T]!=null&&ne.push(_[E][T]);if(ne.length==0||v[T]==null){D[T]="?";continue}for(E=0;E<ne.length;++E){switch(typeof ne[E]){case"number":J="B";break;case"string":J="C";break;case"boolean":J="L";break;case"object":J=ne[E]instanceof Date?"D":"C";break;default:J="C"}V=Math.max(V,String(ne[E]).length),R=R&&R!=J?"C":J}V>250&&(V=250),J=((S[T]||{}).DBF||{}).type,J=="C"&&S[T].DBF.len>V&&(V=S[T].DBF.len),R=="B"&&J=="N"&&(R="N",L[T]=S[T].DBF.dec,V=S[T].DBF.len),P[T]=R=="C"||J=="N"?V:s[R]||0,I+=P[T],D[T]=R}var te=m.next(32);for(te.write_shift(4,318902576),te.write_shift(4,_.length),te.write_shift(2,296+32*C),te.write_shift(2,I),T=0;T<4;++T)te.write_shift(4,0);for(te.write_shift(4,0|(+t[A1]||3)<<8),T=0,E=0;T<v.length;++T)if(v[T]!=null){var Q=m.next(32),me=(v[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Q.write_shift(1,me,"sbcs"),Q.write_shift(1,D[T]=="?"?"C":D[T],"sbcs"),Q.write_shift(4,E),Q.write_shift(1,P[T]||s[D[T]]||0),Q.write_shift(1,L[T]||0),Q.write_shift(1,2),Q.write_shift(4,0),Q.write_shift(1,0),Q.write_shift(4,0),Q.write_shift(4,0),E+=P[T]||s[D[T]]||0}var Re=m.next(264);for(Re.write_shift(4,13),T=0;T<65;++T)Re.write_shift(4,0);for(T=0;T<_.length;++T){var ye=m.next(I);for(ye.write_shift(1,0),E=0;E<v.length;++E)if(v[E]!=null)switch(D[E]){case"L":ye.write_shift(1,_[T][E]==null?63:_[T][E]?84:70);break;case"B":ye.write_shift(8,_[T][E]||0,"f");break;case"N":var De="0";for(typeof _[T][E]=="number"&&(De=_[T][E].toFixed(L[E]||0)),C=0;C<P[E]-De.length;++C)ye.write_shift(1,32);ye.write_shift(1,De,"sbcs");break;case"D":_[T][E]?(ye.write_shift(4,("0000"+_[T][E].getFullYear()).slice(-4),"sbcs"),ye.write_shift(2,("00"+(_[T][E].getMonth()+1)).slice(-2),"sbcs"),ye.write_shift(2,("00"+_[T][E].getDate()).slice(-2),"sbcs")):ye.write_shift(8,"00000000","sbcs");break;case"C":var Ce=String(_[T][E]!=null?_[T][E]:"").slice(0,P[E]);for(ye.write_shift(1,Ce,"sbcs"),C=0;C<P[E]-Ce.length;++C)ye.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:i,to_sheet:r,from_sheet:o}}(),zv=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Jt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(v,_){var S=e[_];return typeof S=="number"?Gm(S):S},r=function(v,_,S){var T=_.charCodeAt(0)-32<<4|S.charCodeAt(0)-48;return T==59?v:Gm(T)};e["|"]=254;function i(v,_){switch(_.type){case"base64":return s(hr(v),_);case"binary":return s(v,_);case"buffer":return s(it&&Buffer.isBuffer(v)?v.toString("binary"):la(v),_);case"array":return s(za(v),_)}throw new Error("Unrecognized type "+_.type)}function s(v,_){var S=v.split(/[\n\r]+/),T=-1,E=-1,C=0,I=0,A=[],D=[],P=null,L={},R=[],J=[],V=[],ne=0,te;for(+_.codepage>=0&&Hr(+_.codepage);C!==S.length;++C){ne=0;var Q=S[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),me=Q.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),Re=me[0],ye;if(Q.length>0)switch(Re){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":me[1].charAt(0)=="P"&&D.push(Q.slice(3).replace(/;;/g,";"));break;case"C":var De=!1,Ce=!1,ke=!1,Z=!1,H=-1,ue=-1;for(I=1;I<me.length;++I)switch(me[I].charAt(0)){case"A":break;case"X":E=parseInt(me[I].slice(1))-1,Ce=!0;break;case"Y":for(T=parseInt(me[I].slice(1))-1,Ce||(E=0),te=A.length;te<=T;++te)A[te]=[];break;case"K":ye=me[I].slice(1),ye.charAt(0)==='"'?ye=ye.slice(1,ye.length-1):ye==="TRUE"?ye=!0:ye==="FALSE"?ye=!1:isNaN(Gr(ye))?isNaN(Vs(ye).getDate())||(ye=Pt(ye)):(ye=Gr(ye),P!==null&&Gs(P)&&(ye=xc(ye))),De=!0;break;case"E":Z=!0;var B=Ls(me[I].slice(1),{r:T,c:E});A[T][E]=[A[T][E],B];break;case"S":ke=!0,A[T][E]=[A[T][E],"S5S"];break;case"G":break;case"R":H=parseInt(me[I].slice(1))-1;break;case"C":ue=parseInt(me[I].slice(1))-1;break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}if(De&&(A[T][E]&&A[T][E].length==2?A[T][E][0]=ye:A[T][E]=ye,P=null),ke){if(Z)throw new Error("SYLK shared formula cannot have own formula");var X=H>-1&&A[H][ue];if(!X||!X[1])throw new Error("SYLK shared formula cannot find base");A[T][E][1]=ry(X[1],{r:T-H,c:E-ue})}break;case"F":var q=0;for(I=1;I<me.length;++I)switch(me[I].charAt(0)){case"X":E=parseInt(me[I].slice(1))-1,++q;break;case"Y":for(T=parseInt(me[I].slice(1))-1,te=A.length;te<=T;++te)A[te]=[];break;case"M":ne=parseInt(me[I].slice(1))/20;break;case"F":break;case"G":break;case"P":P=D[parseInt(me[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(V=me[I].slice(1).split(" "),te=parseInt(V[0],10);te<=parseInt(V[1],10);++te)ne=parseInt(V[2],10),J[te-1]=ne===0?{hidden:!0}:{wch:ne},aa(J[te-1]);break;case"C":E=parseInt(me[I].slice(1))-1,J[E]||(J[E]={});break;case"R":T=parseInt(me[I].slice(1))-1,R[T]||(R[T]={}),ne>0?(R[T].hpt=ne,R[T].hpx=Ws(ne)):ne===0&&(R[T].hidden=!0);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}q<1&&(P=null);break;default:if(_&&_.WTF)throw new Error("SYLK bad record "+Q)}}return R.length>0&&(L["!rows"]=R),J.length>0&&(L["!cols"]=J),_&&_.sheetRows&&(A=A.slice(0,_.sheetRows)),[A,L]}function o(v,_){var S=i(v,_),T=S[0],E=S[1],C=js(T,_);return Jt(E).forEach(function(I){C[I]=E[I]}),C}function u(v,_){return ua(o(v,_),_)}function d(v,_,S,T){var E="C;Y"+(S+1)+";X"+(T+1)+";K";switch(v.t){case"n":E+=v.v||0,v.f&&!v.F&&(E+=";E"+zd(v.f,{r:S,c:T}));break;case"b":E+=v.v?"TRUE":"FALSE";break;case"e":E+=v.w||v.v;break;case"d":E+='"'+(v.w||v.v)+'"';break;case"s":E+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return E}function h(v,_){_.forEach(function(S,T){var E="F;W"+(T+1)+" "+(T+1)+" ";S.hidden?E+="0":(typeof S.width=="number"&&!S.wpx&&(S.wpx=rl(S.width)),typeof S.wpx=="number"&&!S.wch&&(S.wch=il(S.wpx)),typeof S.wch=="number"&&(E+=Math.round(S.wch))),E.charAt(E.length-1)!=" "&&v.push(E)})}function m(v,_){_.forEach(function(S,T){var E="F;";S.hidden?E+="M0;":S.hpt?E+="M"+20*S.hpt+";":S.hpx&&(E+="M"+20*al(S.hpx)+";"),E.length>2&&v.push(E+"R"+(T+1))})}function x(v,_){var S=["ID;PWXL;N;E"],T=[],E=ct(v["!ref"]),C,I=Array.isArray(v),A=`\r
`;S.push("P;PGeneral"),S.push("F;P0;DG0G8;M255"),v["!cols"]&&h(S,v["!cols"]),v["!rows"]&&m(S,v["!rows"]),S.push("B;Y"+(E.e.r-E.s.r+1)+";X"+(E.e.c-E.s.c+1)+";D"+[E.s.c,E.s.r,E.e.c,E.e.r].join(" "));for(var D=E.s.r;D<=E.e.r;++D)for(var P=E.s.c;P<=E.e.c;++P){var L=Je({r:D,c:P});C=I?(v[D]||[])[P]:v[L],!(!C||C.v==null&&(!C.f||C.F))&&T.push(d(C,v,D,P))}return S.join(A)+A+T.join(A)+A+"E"+A}return{to_workbook:u,to_sheet:o,from_sheet:x}}(),bv=function(){function e(s,o){switch(o.type){case"base64":return t(hr(s),o);case"binary":return t(s,o);case"buffer":return t(it&&Buffer.isBuffer(s)?s.toString("binary"):la(s),o);case"array":return t(za(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var u=s.split(`
`),d=-1,h=-1,m=0,x=[];m!==u.length;++m){if(u[m].trim()==="BOT"){x[++d]=[],h=0;continue}if(!(d<0)){var v=u[m].trim().split(","),_=v[0],S=v[1];++m;for(var T=u[m]||"";(T.match(/["]/g)||[]).length&1&&m<u.length-1;)T+=`
`+u[++m];switch(T=T.trim(),+_){case-1:if(T==="BOT"){x[++d]=[],h=0;continue}else if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?x[d][h]=!0:T==="FALSE"?x[d][h]=!1:isNaN(Gr(S))?isNaN(Vs(S).getDate())?x[d][h]=S:x[d][h]=Pt(S):x[d][h]=Gr(S),++h;break;case 1:T=T.slice(1,T.length-1),T=T.replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),x[d][h++]=T!==""?T:null;break}if(T==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function n(s,o){return js(e(s,o),o)}function r(s,o){return ua(n(s,o),o)}var i=function(){var s=function(d,h,m,x,v){d.push(h),d.push(m+","+x),d.push('"'+v.replace(/"/g,'""')+'"')},o=function(d,h,m,x){d.push(h+","+m),d.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(d){var h=[],m=ct(d["!ref"]),x,v=Array.isArray(d);s(h,"TABLE",0,1,"sheetjs"),s(h,"VECTORS",0,m.e.r-m.s.r+1,""),s(h,"TUPLES",0,m.e.c-m.s.c+1,""),s(h,"DATA",0,0,"");for(var _=m.s.r;_<=m.e.r;++_){o(h,-1,0,"BOT");for(var S=m.s.c;S<=m.e.c;++S){var T=Je({r:_,c:S});if(x=v?(d[_]||[])[S]:d[T],!x){o(h,1,0,"");continue}switch(x.t){case"n":var E=x.w;!E&&x.v!=null&&(E=x.v),E==null?x.f&&!x.F?o(h,1,0,"="+x.f):o(h,1,0,""):o(h,0,E,"V");break;case"b":o(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Fr(x.z||Ke[14],fn(Pt(x.v)))),o(h,0,x.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var C=`\r
`,I=h.join(C);return I}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),Vv=function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(x,v){for(var _=x.split(`
`),S=-1,T=-1,E=0,C=[];E!==_.length;++E){var I=_[E].trim().split(":");if(I[0]==="cell"){var A=Wt(I[1]);if(C.length<=A.r)for(S=C.length;S<=A.r;++S)C[S]||(C[S]=[]);switch(S=A.r,T=A.c,I[2]){case"t":C[S][T]=e(I[3]);break;case"v":C[S][T]=+I[3];break;case"vtf":var D=I[I.length-1];case"vtc":switch(I[3]){case"nl":C[S][T]=!!+I[4];break;default:C[S][T]=+I[4];break}I[2]=="vtf"&&(C[S][T]=[C[S][T],D])}}}return v&&v.sheetRows&&(C=C.slice(0,v.sheetRows)),C}function r(x,v){return js(n(x,v),v)}function i(x,v){return ua(r(x,v),v)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var v=[],_=[],S,T="",E=Qn(x["!ref"]),C=Array.isArray(x),I=E.s.r;I<=E.e.r;++I)for(var A=E.s.c;A<=E.e.c;++A)if(T=Je({r:I,c:A}),S=C?(x[I]||[])[A]:x[T],!(!S||S.v==null||S.t==="z")){switch(_=["cell",T,"t"],S.t){case"s":case"str":_.push(t(S.v));break;case"n":S.f?(_[2]="vtf",_[3]="n",_[4]=S.v,_[5]=t(S.f)):(_[2]="v",_[3]=S.v);break;case"b":_[2]="vt"+(S.f?"f":"c"),_[3]="nl",_[4]=S.v?"1":"0",_[5]=t(S.f||(S.v?"TRUE":"FALSE"));break;case"d":var D=fn(Pt(S.v));_[2]="vtc",_[3]="nd",_[4]=""+D,_[5]=S.w||Fr(S.z||Ke[14],D);break;case"e":continue}v.push(_.join(":"))}return v.push("sheet:c:"+(E.e.c-E.s.c+1)+":r:"+(E.e.r-E.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(x){return[s,o,u,o,h(x),d].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:m}}(),Hs=function(){function e(m,x,v,_,S){S.raw?x[v][_]=m:m===""||(m==="TRUE"?x[v][_]=!0:m==="FALSE"?x[v][_]=!1:isNaN(Gr(m))?isNaN(Vs(m).getDate())?x[v][_]=m:x[v][_]=Pt(m):x[v][_]=Gr(m))}function t(m,x){var v=x||{},_=[];if(!m||m.length===0)return _;for(var S=m.split(/[\r\n]/),T=S.length-1;T>=0&&S[T].length===0;)--T;for(var E=10,C=0,I=0;I<=T;++I)C=S[I].indexOf(" "),C==-1?C=S[I].length:C++,E=Math.max(E,C);for(I=0;I<=T;++I){_[I]=[];var A=0;for(e(S[I].slice(0,E).trim(),_,I,A,v),A=1;A<=(S[I].length-E)/10+1;++A)e(S[I].slice(E+(A-1)*10,E+A*10).trim(),_,I,A,v)}return v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(m){for(var x={},v=!1,_=0,S=0;_<m.length;++_)(S=m.charCodeAt(_))==34?v=!v:!v&&S in n&&(x[S]=(x[S]||0)+1);S=[];for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&S.push([x[_],_]);if(!S.length){x=r;for(_ in x)Object.prototype.hasOwnProperty.call(x,_)&&S.push([x[_],_])}return S.sort(function(T,E){return T[0]-E[0]||r[T[1]]-r[E[1]]}),n[S.pop()[1]]||44}function s(m,x){var v=x||{},_="",S=v.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(_=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(_=m.charAt(4),m=m.slice(6)):_=i(m.slice(0,1024)):v&&v.FS?_=v.FS:_=i(m.slice(0,1024));var E=0,C=0,I=0,A=0,D=0,P=_.charCodeAt(0),L=!1,R=0,J=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var V=v.dateNF!=null?oT(v.dateNF):null;function ne(){var te=m.slice(A,D),Q={};if(te.charAt(0)=='"'&&te.charAt(te.length-1)=='"'&&(te=te.slice(1,-1).replace(/""/g,'"')),te.length===0)Q.t="z";else if(v.raw)Q.t="s",Q.v=te;else if(te.trim().length===0)Q.t="s",Q.v=te;else if(te.charCodeAt(0)==61)te.charCodeAt(1)==34&&te.charCodeAt(te.length-1)==34?(Q.t="s",Q.v=te.slice(2,-1).replace(/""/g,'"')):BA(te)?(Q.t="n",Q.f=te.slice(1)):(Q.t="s",Q.v=te);else if(te=="TRUE")Q.t="b",Q.v=!0;else if(te=="FALSE")Q.t="b",Q.v=!1;else if(!isNaN(I=Gr(te)))Q.t="n",v.cellText!==!1&&(Q.w=te),Q.v=I;else if(!isNaN(Vs(te).getDate())||V&&te.match(V)){Q.z=v.dateNF||Ke[14];var me=0;V&&te.match(V)&&(te=lT(te,v.dateNF,te.match(V)||[]),me=1),v.cellDates?(Q.t="d",Q.v=Pt(te,me)):(Q.t="n",Q.v=fn(Pt(te,me))),v.cellText!==!1&&(Q.w=Fr(Q.z,Q.v instanceof Date?fn(Q.v):Q.v)),v.cellNF||delete Q.z}else Q.t="s",Q.v=te;if(Q.t=="z"||(v.dense?(S[E]||(S[E]=[]),S[E][C]=Q):S[Je({c:C,r:E})]=Q),A=D+1,J=m.charCodeAt(A),T.e.c<C&&(T.e.c=C),T.e.r<E&&(T.e.r=E),R==P)++C;else if(C=0,++E,v.sheetRows&&v.sheetRows<=E)return!0}e:for(;D<m.length;++D)switch(R=m.charCodeAt(D)){case 34:J===34&&(L=!L);break;case P:case 10:case 13:if(!L&&ne())break e;break}return D-A>0&&ne(),S["!ref"]=nt(T),S}function o(m,x){return!(x&&x.PRN)||x.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?s(m,x):js(t(m,x),x)}function u(m,x){var v="",_=x.type=="string"?[0,0,0,0]:qd(m,x);switch(x.type){case"base64":v=hr(m);break;case"binary":v=m;break;case"buffer":x.codepage==65001?v=m.toString("utf8"):x.codepage&&typeof Jo<"u"||(v=it&&Buffer.isBuffer(m)?m.toString("binary"):la(m));break;case"array":v=za(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+x.type)}return _[0]==239&&_[1]==187&&_[2]==191?v=Et(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=Et(v):x.type=="binary"&&typeof Jo<"u",v.slice(0,19)=="socialcalc:version:"?Vv.to_sheet(x.type=="string"?v:Et(v),x):o(v,x)}function d(m,x){return ua(u(m,x),x)}function h(m){for(var x=[],v=ct(m["!ref"]),_,S=Array.isArray(m),T=v.s.r;T<=v.e.r;++T){for(var E=[],C=v.s.c;C<=v.e.c;++C){var I=Je({r:T,c:C});if(_=S?(m[T]||[])[C]:m[I],!_||_.v==null){E.push("          ");continue}for(var A=(_.w||(Si(_),_.w)||"").slice(0,10);A.length<10;)A+=" ";E.push(A+(C===0?" ":""))}x.push(E.join(""))}return x.join(`
`)}return{to_workbook:d,to_sheet:u,from_sheet:h}}();function TE(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var i=zv.to_workbook(e,n);return n.WTF=r,i}catch(s){if(n.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return Hs.to_workbook(e,t)}}var Ma=function(){function e(B,X,q){if(B){kn(B,B.l||0);for(var K=q.Enum||H;B.l<B.length;){var le=B.read_shift(2),xe=K[le]||K[65535],ve=B.read_shift(2),we=B.l+ve,Ae=xe.f&&xe.f(B,ve,q);if(B.l=we,X(Ae,xe,le))return}}}function t(B,X){switch(X.type){case"base64":return n(cr(hr(B)),X);case"binary":return n(cr(B),X);case"buffer":case"array":return n(B,X)}throw"Unsupported type "+X.type}function n(B,X){if(!B)return B;var q=X||{},K=q.dense?[]:{},le="Sheet1",xe="",ve=0,we={},Ae=[],Xe=[],G={s:{r:0,c:0},e:{r:0,c:0}},ft=q.sheetRows||0;if(B[2]==0&&(B[3]==8||B[3]==9)&&B.length>=16&&B[14]==5&&B[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(B[2]==2)q.Enum=H,e(B,function(Be,yt,At){switch(At){case 0:q.vers=Be,Be>=4096&&(q.qpro=!0);break;case 6:G=Be;break;case 204:Be&&(xe=Be);break;case 222:xe=Be;break;case 15:case 51:q.qpro||(Be[1].v=Be[1].v.slice(1));case 13:case 14:case 16:At==14&&(Be[2]&112)==112&&(Be[2]&15)>1&&(Be[2]&15)<15&&(Be[1].z=q.dateNF||Ke[14],q.cellDates&&(Be[1].t="d",Be[1].v=xc(Be[1].v))),q.qpro&&Be[3]>ve&&(K["!ref"]=nt(G),we[le]=K,Ae.push(le),K=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},ve=Be[3],le=xe||"Sheet"+(ve+1),xe="");var Lt=q.dense?(K[Be[0].r]||[])[Be[0].c]:K[Je(Be[0])];if(Lt){Lt.t=Be[1].t,Lt.v=Be[1].v,Be[1].z!=null&&(Lt.z=Be[1].z),Be[1].f!=null&&(Lt.f=Be[1].f);break}q.dense?(K[Be[0].r]||(K[Be[0].r]=[]),K[Be[0].r][Be[0].c]=Be[1]):K[Je(Be[0])]=Be[1];break}},q);else if(B[2]==26||B[2]==14)q.Enum=ue,B[2]==14&&(q.qpro=!0,B.l=0),e(B,function(Be,yt,At){switch(At){case 204:le=Be;break;case 22:Be[1].v=Be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Be[3]>ve&&(K["!ref"]=nt(G),we[le]=K,Ae.push(le),K=q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},ve=Be[3],le="Sheet"+(ve+1)),ft>0&&Be[0].r>=ft)break;q.dense?(K[Be[0].r]||(K[Be[0].r]=[]),K[Be[0].r][Be[0].c]=Be[1]):K[Je(Be[0])]=Be[1],G.e.c<Be[0].c&&(G.e.c=Be[0].c),G.e.r<Be[0].r&&(G.e.r=Be[0].r);break;case 27:Be[14e3]&&(Xe[Be[14e3][0]]=Be[14e3][1]);break;case 1537:Xe[Be[0]]=Be[1],Be[0]==ve&&(le=Be[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+B[2]);if(K["!ref"]=nt(G),we[xe||le]=K,Ae.push(xe||le),!Xe.length)return{SheetNames:Ae,Sheets:we};for(var et={},dt=[],tt=0;tt<Xe.length;++tt)we[Ae[tt]]?(dt.push(Xe[tt]||Ae[tt]),et[Xe[tt]]=we[Xe[tt]]||we[Ae[tt]]):(dt.push(Xe[tt]),et[Xe[tt]]={"!ref":"A1"});return{SheetNames:dt,Sheets:et}}function r(B,X){var q=X||{};if(+q.codepage>=0&&Hr(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var K=Zn(),le=ct(B["!ref"]),xe=Array.isArray(B),ve=[];Le(K,0,s(1030)),Le(K,6,d(le));for(var we=Math.min(le.e.r,8191),Ae=le.s.r;Ae<=we;++Ae)for(var Xe=Qt(Ae),G=le.s.c;G<=le.e.c;++G){Ae===le.s.r&&(ve[G]=Ht(G));var ft=ve[G]+Xe,et=xe?(B[Ae]||[])[G]:B[ft];if(!(!et||et.t=="z"))if(et.t=="n")(et.v|0)==et.v&&et.v>=-32768&&et.v<=32767?Le(K,13,_(Ae,G,et.v)):Le(K,14,T(Ae,G,et.v));else{var dt=Si(et);Le(K,15,x(Ae,G,dt.slice(0,239)))}}return Le(K,1),K.end()}function i(B,X){var q=X||{};if(+q.codepage>=0&&Hr(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var K=Zn();Le(K,0,o(B));for(var le=0,xe=0;le<B.SheetNames.length;++le)(B.Sheets[B.SheetNames[le]]||{})["!ref"]&&Le(K,27,Z(B.SheetNames[le],xe++));var ve=0;for(le=0;le<B.SheetNames.length;++le){var we=B.Sheets[B.SheetNames[le]];if(!(!we||!we["!ref"])){for(var Ae=ct(we["!ref"]),Xe=Array.isArray(we),G=[],ft=Math.min(Ae.e.r,8191),et=Ae.s.r;et<=ft;++et)for(var dt=Qt(et),tt=Ae.s.c;tt<=Ae.e.c;++tt){et===Ae.s.r&&(G[tt]=Ht(tt));var Be=G[tt]+dt,yt=Xe?(we[et]||[])[tt]:we[Be];if(!(!yt||yt.t=="z"))if(yt.t=="n")Le(K,23,ne(et,tt,ve,yt.v));else{var At=Si(yt);Le(K,22,R(et,tt,ve,At.slice(0,239)))}}++ve}}return Le(K,1),K.end()}function s(B){var X=he(2);return X.write_shift(2,B),X}function o(B){var X=he(26);X.write_shift(2,4096),X.write_shift(2,4),X.write_shift(4,0);for(var q=0,K=0,le=0,xe=0;xe<B.SheetNames.length;++xe){var ve=B.SheetNames[xe],we=B.Sheets[ve];if(!(!we||!we["!ref"])){++le;var Ae=Qn(we["!ref"]);q<Ae.e.r&&(q=Ae.e.r),K<Ae.e.c&&(K=Ae.e.c)}}return q>8191&&(q=8191),X.write_shift(2,q),X.write_shift(1,le),X.write_shift(1,K),X.write_shift(2,0),X.write_shift(2,0),X.write_shift(1,1),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(4,0),X}function u(B,X,q){var K={s:{c:0,r:0},e:{c:0,r:0}};return X==8&&q.qpro?(K.s.c=B.read_shift(1),B.l++,K.s.r=B.read_shift(2),K.e.c=B.read_shift(1),B.l++,K.e.r=B.read_shift(2),K):(K.s.c=B.read_shift(2),K.s.r=B.read_shift(2),X==12&&q.qpro&&(B.l+=2),K.e.c=B.read_shift(2),K.e.r=B.read_shift(2),X==12&&q.qpro&&(B.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function d(B){var X=he(8);return X.write_shift(2,B.s.c),X.write_shift(2,B.s.r),X.write_shift(2,B.e.c),X.write_shift(2,B.e.r),X}function h(B,X,q){var K=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(K[0].c=B.read_shift(1),K[3]=B.read_shift(1),K[0].r=B.read_shift(2),B.l+=2):(K[2]=B.read_shift(1),K[0].c=B.read_shift(2),K[0].r=B.read_shift(2)),K}function m(B,X,q){var K=B.l+X,le=h(B,X,q);if(le[1].t="s",q.vers==20768){B.l++;var xe=B.read_shift(1);return le[1].v=B.read_shift(xe,"utf8"),le}return q.qpro&&B.l++,le[1].v=B.read_shift(K-B.l,"cstr"),le}function x(B,X,q){var K=he(7+q.length);K.write_shift(1,255),K.write_shift(2,X),K.write_shift(2,B),K.write_shift(1,39);for(var le=0;le<K.length;++le){var xe=q.charCodeAt(le);K.write_shift(1,xe>=128?95:xe)}return K.write_shift(1,0),K}function v(B,X,q){var K=h(B,X,q);return K[1].v=B.read_shift(2,"i"),K}function _(B,X,q){var K=he(7);return K.write_shift(1,255),K.write_shift(2,X),K.write_shift(2,B),K.write_shift(2,q,"i"),K}function S(B,X,q){var K=h(B,X,q);return K[1].v=B.read_shift(8,"f"),K}function T(B,X,q){var K=he(13);return K.write_shift(1,255),K.write_shift(2,X),K.write_shift(2,B),K.write_shift(8,q,"f"),K}function E(B,X,q){var K=B.l+X,le=h(B,X,q);if(le[1].v=B.read_shift(8,"f"),q.qpro)B.l=K;else{var xe=B.read_shift(2);D(B.slice(B.l,B.l+xe),le),B.l+=xe}return le}function C(B,X,q){var K=X&32768;return X&=-32769,X=(K?B:0)+(X>=8192?X-16384:X),(K?"":"$")+(q?Ht(X):Qt(X))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function D(B,X){kn(B,0);for(var q=[],K=0,le="",xe="",ve="",we="";B.l<B.length;){var Ae=B[B.l++];switch(Ae){case 0:q.push(B.read_shift(8,"f"));break;case 1:xe=C(X[0].c,B.read_shift(2),!0),le=C(X[0].r,B.read_shift(2),!1),q.push(xe+le);break;case 2:{var Xe=C(X[0].c,B.read_shift(2),!0),G=C(X[0].r,B.read_shift(2),!1);xe=C(X[0].c,B.read_shift(2),!0),le=C(X[0].r,B.read_shift(2),!1),q.push(Xe+G+":"+xe+le)}break;case 3:if(B.l<B.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(B.read_shift(2));break;case 6:{for(var ft="";Ae=B[B.l++];)ft+=String.fromCharCode(Ae);q.push('"'+ft.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:we=q.pop(),ve=q.pop(),q.push(["AND","OR"][Ae-20]+"("+ve+","+we+")");break;default:if(Ae<32&&A[Ae])we=q.pop(),ve=q.pop(),q.push(ve+A[Ae]+we);else if(I[Ae]){if(K=I[Ae][1],K==69&&(K=B[B.l++]),K>q.length){console.error("WK1 bad formula parse 0x"+Ae.toString(16)+":|"+q.join("|")+"|");return}var et=q.slice(-K);q.length-=K,q.push(I[Ae][0]+"("+et.join(",")+")")}else return Ae<=7?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=24?console.error("WK1 unsupported op "+Ae.toString(16)):Ae<=30?console.error("WK1 invalid opcode "+Ae.toString(16)):Ae<=115?console.error("WK1 unsupported function opcode "+Ae.toString(16)):console.error("WK1 unrecognized opcode "+Ae.toString(16))}}q.length==1?X[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function P(B){var X=[{c:0,r:0},{t:"n",v:0},0];return X[0].r=B.read_shift(2),X[3]=B[B.l++],X[0].c=B[B.l++],X}function L(B,X){var q=P(B);return q[1].t="s",q[1].v=B.read_shift(X-4,"cstr"),q}function R(B,X,q,K){var le=he(6+K.length);le.write_shift(2,B),le.write_shift(1,q),le.write_shift(1,X),le.write_shift(1,39);for(var xe=0;xe<K.length;++xe){var ve=K.charCodeAt(xe);le.write_shift(1,ve>=128?95:ve)}return le.write_shift(1,0),le}function J(B,X){var q=P(B);q[1].v=B.read_shift(2);var K=q[1].v>>1;if(q[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return q[1].v=K,q}function V(B,X){var q=P(B),K=B.read_shift(4),le=B.read_shift(4),xe=B.read_shift(2);if(xe==65535)return K===0&&le===3221225472?(q[1].t="e",q[1].v=15):K===0&&le===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var ve=xe&32768;return xe=(xe&32767)-16446,q[1].v=(1-ve*2)*(le*Math.pow(2,xe+32)+K*Math.pow(2,xe)),q}function ne(B,X,q,K){var le=he(14);if(le.write_shift(2,B),le.write_shift(1,q),le.write_shift(1,X),K==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var xe=0,ve=0,we=0,Ae=0;return K<0&&(xe=1,K=-K),ve=Math.log2(K)|0,K/=Math.pow(2,ve-31),Ae=K>>>0,(Ae&2147483648)==0&&(K/=2,++ve,Ae=K>>>0),K-=Ae,Ae|=2147483648,Ae>>>=0,K*=Math.pow(2,32),we=K>>>0,le.write_shift(4,we),le.write_shift(4,Ae),ve+=16383+(xe?32768:0),le.write_shift(2,ve),le}function te(B,X){var q=V(B);return B.l+=X-14,q}function Q(B,X){var q=P(B),K=B.read_shift(4);return q[1].v=K>>6,q}function me(B,X){var q=P(B),K=B.read_shift(8,"f");return q[1].v=K,q}function Re(B,X){var q=me(B);return B.l+=X-10,q}function ye(B,X){return B[B.l+X-1]==0?B.read_shift(X,"cstr"):""}function De(B,X){var q=B[B.l++];q>X-1&&(q=X-1);for(var K="";K.length<q;)K+=String.fromCharCode(B[B.l++]);return K}function Ce(B,X,q){if(!(!q.qpro||X<21)){var K=B.read_shift(1);B.l+=17,B.l+=1,B.l+=2;var le=B.read_shift(X-21,"cstr");return[K,le]}}function ke(B,X){for(var q={},K=B.l+X;B.l<K;){var le=B.read_shift(2);if(le==14e3){for(q[le]=[0,""],q[le][0]=B.read_shift(2);B[B.l];)q[le][1]+=String.fromCharCode(B[B.l]),B.l++;B.l++}}return q}function Z(B,X){var q=he(5+B.length);q.write_shift(2,14e3),q.write_shift(2,X);for(var K=0;K<B.length;++K){var le=B.charCodeAt(K);q[q.l++]=le>127?95:le}return q[q.l++]=0,q}var H={0:{n:"BOF",f:sn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:S},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:E},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ye},222:{n:"SHEETNAMELP",f:De},65535:{n:""}},ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:V},24:{n:"NUMBER18",f:J},25:{n:"FORMULA19",f:te},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ke},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Q},38:{n:"??"},39:{n:"NUMBER27",f:me},40:{n:"FORMULA28",f:Re},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ye},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}}();function kE(e){var t={},n=e.match(Un),r=0,i=!1;if(n)for(;r!=n.length;++r){var s=Ye(n[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=cd[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var SE=function(){var e=Zo("t"),t=Zo("rPr");function n(s){var o=s.match(e);if(!o)return{t:"s",v:""};var u={t:"s",v:ut(o[1])},d=s.match(t);return d&&(u.s=kE(d[1])),u}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(r,"").split(i).map(n).filter(function(u){return u.v})}}(),EE=function(){var t=/(\r\n|\n)/g;function n(i,s,o){var u=[];i.u&&u.push("text-decoration: underline;"),i.uval&&u.push("text-underline-style:"+i.uval+";"),i.sz&&u.push("font-size:"+i.sz+"pt;"),i.outline&&u.push("text-effect: outline;"),i.shadow&&u.push("text-shadow: auto;"),s.push('<span style="'+u.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var d=i.valign||"";return d=="superscript"||d=="super"?d="sup":d=="subscript"&&(d="sub"),d!=""&&(s.push("<"+d+">"),o.push("</"+d+">")),o.push("</span>"),i}function r(i){var s=[[],i.v,[]];return i.v?(i.s&&n(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),CE=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,AE=/<(?:\w+:)?r>/,IE=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Md(e,t){var n=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=ut(Et(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=Et(e),n&&(r.h=wd(r.t))):e.match(AE)&&(r.r=Et(e),r.t=ut(Et((e.replace(IE,"").match(CE)||[]).join("").replace(Un,""))),n&&(r.h=EE(SE(r.r)))),r):{t:""}}var NE=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,FE=/<(?:\w+:)?(?:si|sstItem)>/g,RE=/<\/(?:\w+:)?(?:si|sstItem)>/;function DE(e,t){var n=[],r="";if(!e)return n;var i=e.match(NE);if(i){r=i[2].replace(FE,"").split(RE);for(var s=0;s!=r.length;++s){var o=Md(r[s].trim(),t);o!=null&&(n[n.length]=o)}i=Ye(i[1]),n.Count=i.count,n.Unique=i.uniqueCount}return n}var PE=/^\s|\s$|[\t\n\r]/;function Hv(e,t){if(!t.bookSST)return"";var n=[en];n[n.length]=Me("sst",null,{xmlns:$a[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var i=e[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(PE)&&(s+=' xml:space="preserve"'),s+=">"+kt(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function ME(e){return[e.read_shift(4),e.read_shift(4)]}function LE(e,t){var n=[],r=!1;return Ai(e,function(s,o,u){switch(u){case 159:n.Count=s[0],n.Unique=s[1];break;case 19:n.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(o.T,!r||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function BE(e,t){return t||(t=he(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var OE=qT;function UE(e){var t=Zn();Te(t,159,BE(e));for(var n=0;n<e.length;++n)Te(t,19,OE(e[n]));return Te(t,160),t.end()}function Wv(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function ki(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function zE(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ki(e,4),t.U=ki(e,4),t.W=ki(e,4),t}function bE(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=s,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function VE(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(bE(e));return t}function HE(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function WE(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ki(e,4),t.U=ki(e,4),t.W=ki(e,4),t}function GE(e){var t=WE(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function Gv(e,t){var n=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=r.Flags==36;break;case 26625:i=r.Flags==4;break;case 0:i=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function $v(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function $E(e){var t=ki(e);switch(t.Minor){case 2:return[t.Minor,jE(e)];case 3:return[t.Minor,qE()];case 4:return[t.Minor,KE(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function jE(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),r=Gv(e,n),i=$v(e,e.length-e.l);return{t:"Std",h:r,v:i}}function qE(){throw new Error("File is password-protected: ECMA-376 Extensible")}function KE(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(Un,function(s){var o=Ye(s);switch(ai(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(u){r[u]=o[u]});break;case"<dataIntegrity":r.encryptedHmacKey=o.encryptedHmacKey,r.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(o);break;default:throw o[0]}}),r}function JE(e,t){var n={},r=n.EncryptionVersionInfo=ki(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,n.EncryptionHeader=Gv(e,i),t-=i,n.EncryptionVerifier=$v(e,t),n}function XE(e){var t={},n=t.EncryptionVersionInfo=ki(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Ld(e){var t=0,n,r=Wv(e),i=r.length+1,s,o,u,d,h;for(n=ia(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)o=n[s],u=(t&16384)===0?0:1,d=t<<1&32767,h=u|d,t=h^o;return t^52811}var jv=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(o){return(o/2|o*128)&255},i=function(o,u){return r(o^u)},s=function(o){for(var u=t[o.length-1],d=104,h=o.length-1;h>=0;--h)for(var m=o[h],x=0;x!=7;++x)m&64&&(u^=n[d]),m*=2,--d;return u};return function(o){for(var u=Wv(o),d=s(u),h=u.length,m=ia(16),x=0;x!=16;++x)m[x]=0;var v,_,S;for((h&1)===1&&(v=d>>8,m[h]=i(e[0],v),--h,v=d&255,_=u[u.length-1],m[h]=i(_,v));h>0;)--h,v=d>>8,m[h]=i(u[h],v),--h,v=d&255,m[h]=i(u[h],v);for(h=15,S=15-u.length;S>0;)v=d>>8,m[h]=i(e[S],v),--h,--S,v=d&255,m[h]=i(u[h],v),--h,--S;return m}}(),YE=function(e,t,n,r,i){i||(i=t),r||(r=jv(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=r[n],o=(o>>5|o<<3)&255,i[s]=o,++n;return[i,n,r]},ZE=function(e){var t=0,n=jv(e);return function(r){var i=YE("",r,t,n);return t=i[1],i[0]}};function QE(e,t,n,r){var i={key:sn(e),verificationBytes:sn(e)};return n.password&&(i.verifier=Ld(n.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=ZE(n.password)),i}function eC(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=XE(e):r.Data=JE(e,t),r}function tC(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?eC(e,t-2,r):QE(e,n.biff>=8?t:t-2,n,r),r}var qv=function(){function e(i,s){switch(s.type){case"base64":return t(hr(i),s);case"binary":return t(i,s);case"buffer":return t(it&&Buffer.isBuffer(i)?i.toString("binary"):la(i),s);case"array":return t(za(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},u=o.dense?[]:{},d=i.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(m,x){Array.isArray(u)&&(u[x]=[]);for(var v=/\\\w+\b/g,_=0,S,T=-1;S=v.exec(m);){switch(S[0]){case"\\cell":var E=m.slice(_,v.lastIndex-S[0].length);if(E[0]==" "&&(E=E.slice(1)),++T,E.length){var C={v:E,t:"s"};Array.isArray(u)?u[x][T]=C:u[Je({r:x,c:T})]=C}break}_=v.lastIndex}T>h.e.c&&(h.e.c=T)}),u["!ref"]=nt(h),u}function n(i,s){return ua(e(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],o=ct(i["!ref"]),u,d=Array.isArray(i),h=o.s.r;h<=o.e.r;++h){s.push("\\trowd\\trautofit1");for(var m=o.s.c;m<=o.e.c;++m)s.push("\\cellx"+(m+1));for(s.push("\\pard\\intbl"),m=o.s.c;m<=o.e.c;++m){var x=Je({r:h,c:m});u=d?(i[h]||[])[m]:i[x],!(!u||u.v==null&&(!u.f||u.F))&&(s.push(" "+(u.w||(Si(u),u.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function nC(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function nl(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function rC(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(t,n,r),s=Math.min(t,n,r),o=i-s;if(o===0)return[0,0,t];var u=0,d=0,h=i+s;switch(d=o/(h>1?2-h:h),i){case t:u=((n-r)/o+6)%6;break;case n:u=(r-t)/o+2;break;case r:u=(t-n)/o+4;break}return[u/6,d,h/2]}function iC(e){var t=e[0],n=e[1],r=e[2],i=n*2*(r<.5?r:1-r),s=r-i/2,o=[s,s,s],u=6*t,d;if(n!==0)switch(u|0){case 0:case 6:d=i*u,o[0]+=i,o[1]+=d;break;case 1:d=i*(2-u),o[0]+=d,o[1]+=i;break;case 2:d=i*(u-2),o[1]+=i,o[2]+=d;break;case 3:d=i*(4-u),o[1]+=d,o[2]+=i;break;case 4:d=i*(u-4),o[2]+=i,o[0]+=d;break;case 5:d=i*(6-u),o[2]+=d,o[0]+=i;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function nc(e,t){if(t===0)return e;var n=rC(nC(e));return t<0?n[2]=n[2]*(1+t):n[2]=1-(1-n[2])*(1-t),nl(iC(n))}var Kv=6,aC=15,sC=1,Pn=Kv;function rl(e){return Math.floor((e+Math.round(128/Pn)/256)*Pn)}function il(e){return Math.floor((e-5)/Pn*100+.5)/100}function rc(e){return Math.round((e*Pn+5)/Pn*256)/256}function y0(e){return rc(il(rl(e)))}function Bd(e){var t=Math.abs(e-y0(e)),n=Pn;if(t>.005)for(Pn=sC;Pn<aC;++Pn)Math.abs(e-y0(e))<=t&&(t=Math.abs(e-y0(e)),n=Pn);Pn=n}function aa(e){e.width?(e.wpx=rl(e.width),e.wch=il(e.wpx),e.MDW=Pn):e.wpx?(e.wch=il(e.wpx),e.width=rc(e.wch),e.MDW=Pn):typeof e.wch=="number"&&(e.width=rc(e.wch),e.wpx=rl(e.width),e.MDW=Pn),e.customWidth&&delete e.customWidth}var oC=96,Jv=oC;function al(e){return e*96/Jv}function Ws(e){return e*Jv/96}var lC={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function uC(e,t,n,r){t.Borders=[];var i={},s=!1;(e[0].match(Un)||[]).forEach(function(o){var u=Ye(o);switch(ai(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},u.diagonalUp&&(i.diagonalUp=Dt(u.diagonalUp)),u.diagonalDown&&(i.diagonalDown=Dt(u.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+u[0]+" in borders")}})}function cC(e,t,n,r){t.Fills=[];var i={},s=!1;(e[0].match(Un)||[]).forEach(function(o){var u=Ye(o);switch(ai(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":u.patternType&&(i.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),u.indexed&&(i.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(i.bgColor.theme=parseInt(u.theme,10)),u.tint&&(i.bgColor.tint=parseFloat(u.tint)),u.rgb&&(i.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),u.theme&&(i.fgColor.theme=parseInt(u.theme,10)),u.tint&&(i.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(i.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fills")}})}function fC(e,t,n,r){t.Fonts=[];var i={},s=!1;(e[0].match(Un)||[]).forEach(function(o){var u=Ye(o);switch(ai(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":u.val&&(i.name=Et(u.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=u.val?Dt(u.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=u.val?Dt(u.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(u.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=u.val?Dt(u.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=u.val?Dt(u.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=u.val?Dt(u.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=u.val?Dt(u.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=u.val?Dt(u.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":u.val&&(i.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(i.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(i.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(i.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=cd[parseInt(u.val,10)];break;case"<color":if(i.color||(i.color={}),u.auto&&(i.color.auto=Dt(u.auto)),u.rgb)i.color.rgb=u.rgb.slice(-6);else if(u.indexed){i.color.index=parseInt(u.indexed,10);var d=Da[i.color.index];i.color.index==81&&(d=Da[1]),d||(d=Da[1]),i.color.rgb=d[0].toString(16)+d[1].toString(16)+d[2].toString(16)}else u.theme&&(i.color.theme=parseInt(u.theme,10),u.tint&&(i.color.tint=parseFloat(u.tint)),u.theme&&n.themeElements&&n.themeElements.clrScheme&&(i.color.rgb=nc(n.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+u[0]+" in fonts")}})}function dC(e,t,n){t.NumberFmt=[];for(var r=Jt(Ke),i=0;i<r.length;++i)t.NumberFmt[r[i]]=Ke[r[i]];var s=e[0].match(Un);if(s)for(i=0;i<s.length;++i){var o=Ye(s[i]);switch(ai(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=ut(Et(o.formatCode)),d=parseInt(o.numFmtId,10);if(t.NumberFmt[d]=u,d>0){if(d>392){for(d=392;d>60&&t.NumberFmt[d]!=null;--d);t.NumberFmt[d]=u}Ti(u,d)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function hC(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=Me("numFmt",null,{numFmtId:r,formatCode:kt(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Me("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Pu=["numFmtId","fillId","fontId","borderId","xfId"],Mu=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function pC(e,t,n){t.CellXf=[];var r,i=!1;(e[0].match(Un)||[]).forEach(function(s){var o=Ye(s),u=0;switch(ai(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=o,delete r[0],u=0;u<Pu.length;++u)r[Pu[u]]&&(r[Pu[u]]=parseInt(r[Pu[u]],10));for(u=0;u<Mu.length;++u)r[Mu[u]]&&(r[Mu[u]]=Dt(r[Mu[u]]));if(t.NumberFmt&&r.numFmtId>392){for(u=392;u>60;--u)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[u]){r.numFmtId=u;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var d={};o.vertical&&(d.vertical=o.vertical),o.horizontal&&(d.horizontal=o.horizontal),o.textRotation!=null&&(d.textRotation=o.textRotation),o.indent&&(d.indent=o.indent),o.wrapText&&(d.wrapText=Dt(o.wrapText)),r.alignment=d;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function mC(e){var t=[];return t[t.length]=Me("cellXfs",null),e.forEach(function(n){t[t.length]=Me("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Me("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var gC=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,d,h){var m={};if(!u)return m;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=u.match(t))&&dC(x,m,h),(x=u.match(i))&&fC(x,m,d,h),(x=u.match(r))&&cC(x,m,d,h),(x=u.match(s))&&uC(x,m,d,h),(x=u.match(n))&&pC(x,m,h),m}}();function Xv(e,t){var n=[en,Me("styleSheet",null,{xmlns:$a[0],"xmlns:vt":cn.vt})],r;return e.SSF&&(r=hC(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=mC(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function xC(e,t){var n=e.read_shift(2),r=Bn(e);return[n,r]}function vC(e,t,n){n||(n=he(6+4*t.length)),n.write_shift(2,e),vn(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function yC(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=ek(e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=e.read_shift(2);switch(s===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(r.underline=o);var u=e.read_shift(1);u>0&&(r.family=u);var d=e.read_shift(1);switch(d>0&&(r.charset=d),e.l++,r.color=QT(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Bn(e),r}function wC(e,t){t||(t=he(153)),t.write_shift(2,e.sz*20),tk(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Qu(e.color,t);var r=0;return r=2,t.write_shift(1,r),vn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var _C=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],w0,TC=On;function Mg(e,t){t||(t=he(84)),w0||(w0=mc(_C));var n=w0[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(Qu({auto:1},t),Qu({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function kC(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}function Yv(e,t,n){n||(n=he(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Lo(e,t){return t||(t=he(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var SC=On;function EC(e,t){return t||(t=he(51)),t.write_shift(1,0),Lo(null,t),Lo(null,t),Lo(null,t),Lo(null,t),Lo(null,t),t.length>t.l?t.slice(0,t.l):t}function CC(e,t){return t||(t=he(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Zu(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function AC(e,t,n){var r=he(2052);return r.write_shift(4,e),Zu(t,r),Zu(n,r),r.length>r.l?r.slice(0,r.l):r}function IC(e,t,n){var r={};r.NumberFmt=[];for(var i in Ke)r.NumberFmt[i]=Ke[i];r.CellXf=[],r.Fonts=[];var s=[],o=!1;return Ai(e,function(d,h,m){switch(m){case 44:r.NumberFmt[d[0]]=d[1],Ti(d[1],d[0]);break;case 43:r.Fonts.push(d),d.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(d.color.rgb=nc(t.themeElements.clrScheme[d.color.theme].rgb,d.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(d);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(m),o=!0;break;case 38:s.pop(),o=!1;break;default:if(h.T>0)s.push(m);else if(h.T<0)s.pop();else if(!o||n.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),r}function NC(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++n}),n!=0&&(Te(e,615,$r(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Te(e,44,vC(i,t[i]))}),Te(e,616))}}function FC(e){var t=1;Te(e,611,$r(t)),Te(e,43,wC({sz:12,color:{theme:1},name:"Calibri",family:2})),Te(e,612)}function RC(e){var t=2;Te(e,603,$r(t)),Te(e,45,Mg({patternType:"none"})),Te(e,45,Mg({patternType:"gray125"})),Te(e,604)}function DC(e){var t=1;Te(e,613,$r(t)),Te(e,46,EC()),Te(e,614)}function PC(e){var t=1;Te(e,626,$r(t)),Te(e,47,Yv({numFmtId:0},65535)),Te(e,627)}function MC(e,t){Te(e,617,$r(t.length)),t.forEach(function(n){Te(e,47,Yv(n,0))}),Te(e,618)}function LC(e){var t=1;Te(e,619,$r(t)),Te(e,48,CC({xfId:0,name:"Normal"})),Te(e,620)}function BC(e){var t=0;Te(e,505,$r(t)),Te(e,506)}function OC(e){var t=0;Te(e,508,AC(t,"TableStyleMedium9","PivotStyleMedium4")),Te(e,509)}function UC(e,t){var n=Zn();return Te(n,278),NC(n,e.SSF),FC(n),RC(n),DC(n),PC(n),MC(n,t.cellXfs),LC(n),BC(n),OC(n),Te(n,279),n.end()}var zC=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function bC(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(Un)||[]).forEach(function(i){var s=Ye(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[zC.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function VC(){}function HC(){}var WC=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,GC=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,$C=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function jC(e,t,n){t.themeElements={};var r;[["clrScheme",WC,bC],["fontScheme",GC,VC],["fmtScheme",$C,HC]].forEach(function(i){if(!(r=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,t,n)})}var qC=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Zv(e,t){(!e||e.length===0)&&(e=Od());var n,r={};if(!(n=e.match(qC)))throw new Error("themeElements not found in theme");return jC(n[0],r,t),r.raw=e,r}function Od(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[en];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function KC(e,t,n){var r=e.l+t,i=e.read_shift(4);if(i!==124226){if(!n.cellStyles){e.l=r;return}var s=e.slice(e.l);e.l=r;var o;try{o=G1(s,{type:"array"})}catch{return}var u=fr(o,"theme/theme/theme1.xml",!0);if(u)return Zv(u,n)}}function JC(e){return e.read_shift(4)}function XC(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=YC(e,4);break;case 2:t.xclrValue=Rv(e);break;case 3:t.xclrValue=JC(e);break;case 4:e.l+=4;break}return e.l+=8,t}function YC(e,t){return On(e,t)}function ZC(e,t){return On(e,t)}function QC(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=XC(e);break;case 6:r[1]=ZC(e,n);break;case 14:case 15:r[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function eA(e,t){var n=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(QC(e,n-e.l));return{ixfe:r,ext:s}}function tA(e,t){t.forEach(function(n){n[0]})}function nA(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Bn(e)}}function rA(e){var t=he(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),vn(e.name,t),t.slice(0,t.l)}function iA(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function aA(e){var t=he(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function sA(e,t){var n=he(8+2*t.length);return n.write_shift(4,e),vn(t,n),n.slice(0,n.l)}function oA(e){return e.l+=4,e.read_shift(4)!=0}function lA(e,t){var n=he(8);return n.write_shift(4,e),n.write_shift(4,1),n}function uA(e,t,n){var r={Types:[],Cell:[],Value:[]},i=n||{},s=[],o=!1,u=2;return Ai(e,function(d,h,m){switch(m){case 335:r.Types.push({name:d.name});break;case 51:d.forEach(function(x){u==1?r.Cell.push({type:r.Types[x[0]-1].name,index:x[1]}):u==0&&r.Value.push({type:r.Types[x[0]-1].name,index:x[1]})});break;case 337:u=d?1:0;break;case 338:u=2;break;case 35:s.push(m),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!h.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),r}function cA(){var e=Zn();return Te(e,332),Te(e,334,$r(1)),Te(e,335,rA({name:"XLDAPR",version:12e4,flags:3496657072})),Te(e,336),Te(e,339,sA(1,"XLDAPR")),Te(e,52),Te(e,35,$r(514)),Te(e,4096,$r(0)),Te(e,4097,Cr(1)),Te(e,36),Te(e,53),Te(e,340),Te(e,337,lA(1)),Te(e,51,aA([[1,0]])),Te(e,338),Te(e,333),e.end()}function fA(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var i=!1,s=2,o;return e.replace(Un,function(u){var d=Ye(u);switch(ai(d[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:d.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<r.Types.length;++h)r.Types[h].name==d.name&&(o=r.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[d.t-1].name,index:+d.v}):s==0&&r.Value.push({type:r.Types[d.t-1].name,index:+d.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+d.i);break;default:if(!i&&n.WTF)throw new Error("unrecognized "+d[0]+" in metadata")}return u}),r}function Qv(){var e=[en];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function dA(e){var t=[];if(!e)return t;var n=1;return(e.match(Un)||[]).forEach(function(r){var i=Ye(r);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?n=i.i:i.i=n,t.push(i);break}}),t}function hA(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=Je(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function pA(e,t,n){var r=[];return Ai(e,function(s,o,u){switch(u){case 63:r.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function mA(e,t,n,r){if(!e)return e;var i=r||{},s=!1;Ai(e,function(u,d,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!d.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function gA(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}var Rs=1024;function ey(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Me("xml",null,{"xmlns:v":lr.v,"xmlns:o":lr.o,"xmlns:x":lr.x,"xmlns:mv":lr.mv}).replace(/\/>/,">"),Me("o:shapelayout",Me("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Me("v:shapetype",[Me("v:stroke",null,{joinstyle:"miter"}),Me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Rs<e*1e3;)Rs+=1e3;return t.forEach(function(s){var o=Wt(s[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var d=u.type=="gradient"?Me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Me("v:fill",d,u),m={on:"t",obscured:"t"};++Rs,i=i.concat(["<v:shape"+Qo({id:"_x0000_s"+Rs,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Me("v:shadow",null,m),Me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Sn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Sn("x:AutoFill","False"),Sn("x:Row",String(o.r)),Sn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function Lg(e,t,n,r){var i=Array.isArray(e),s;t.forEach(function(o){var u=Wt(o.ref);if(i?(e[u.r]||(e[u.r]=[]),s=e[u.r][u.c]):s=e[o.ref],!s){s={t:"z"},i?e[u.r][u.c]=s:e[o.ref]=s;var d=ct(e["!ref"]||"BDWGO1000001:A1");d.s.r>u.r&&(d.s.r=u.r),d.e.r<u.r&&(d.e.r=u.r),d.s.c>u.c&&(d.s.c=u.c),d.e.c<u.c&&(d.e.c=u.c);var h=nt(d);h!==e["!ref"]&&(e["!ref"]=h)}s.c||(s.c=[]);var m={a:o.author,t:o.t,r:o.r,T:n};o.h&&(m.h=o.h);for(var x=s.c.length-1;x>=0;--x){if(!n&&s.c[x].T)return;n&&!s.c[x].T&&s.c.splice(x,1)}if(n&&r){for(x=0;x<r.length;++x)if(m.a==r[x].id){m.a=r[x].name||m.a;break}}s.c.push(m)})}function xA(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&n.push(u[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var u=o.match(/<(?:\w+:)?comment[^>]*>/);if(u){var d=Ye(u[0]),h={author:d.authorId&&n[d.authorId]||"sheetjsghost",ref:d.ref,guid:d.guid},m=Wt(d.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!x&&!!x[1]&&Md(x[1])||{r:"",t:"",h:""};h.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),h.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=v.h),r.push(h)}}}}),r}function ty(e){var t=[en,Me("comments",null,{xmlns:$a[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(i){var s=kt(i.a);n.indexOf(s)==-1&&(n.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(d){d.a&&(i=n.indexOf(kt(d.a))),s.push(d.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Sn("t",kt(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,u=1;u<s.length;++u)o+=`Reply:
    `+s[u]+`
`;t.push(Sn("t",kt(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function vA(e,t){var n=[],r=!1,i={},s=0;return e.replace(Un,function(u,d){var h=Ye(u);switch(ai(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":i.t!=null&&n.push(i);break;case"<text>":case"<text":s=d+u.length;break;case"</text>":i.t=e.slice(s,d).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return u}),n}function yA(e,t,n){var r=[en,Me("ThreadedComments",null,{xmlns:cn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,u){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var d={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};u==0?s=d.id:d.parentId=s,o.ID=d.id,o.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),r.push(Me("threadedComment",Sn("text",o.t||""),d))})}),r.push("</ThreadedComments>"),r.join("")}function wA(e,t){var n=[],r=!1;return e.replace(Un,function(s){var o=Ye(s);switch(ai(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),n}function _A(e){var t=[en,Me("personList",null,{xmlns:cn.TCMNT,"xmlns:x":$a[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(Me("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function TA(e){var t={};t.iauthor=e.read_shift(4);var n=Ja(e);return t.rfx=n.s,t.ref=Je(n.s),e.l+=16,t}function kA(e,t){return t==null&&(t=he(36)),t.write_shift(4,e[1].iauthor),qs(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var SA=Bn;function EA(e){return vn(e.slice(0,54))}function CA(e,t){var n=[],r=[],i={},s=!1;return Ai(e,function(u,d,h){switch(h){case 632:r.push(u);break;case 635:i=u;break;case 637:i.t=u.t,i.h=u.h,i.r=u.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,n.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!d.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function AA(e){var t=Zn(),n=[];return Te(t,628),Te(t,630),e.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),Te(t,632,EA(i.a)))})}),Te(t,631),Te(t,633),e.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:Wt(r[0]),e:Wt(r[0])};Te(t,635,kA([s,i])),i.t&&i.t.length>0&&Te(t,637,JT(i)),Te(t,636),delete i.iauthor})}),Te(t,634),Te(t,629),t.end()}var IA="application/vnd.ms-office.vbaProject";function NA(e){var t=We.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var i=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");We.utils.cfb_add(t,i,e.FileIndex[r].content)}}),We.write(t)}function FA(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&We.utils.cfb_add(e,i,t.FileIndex[r].content)}})}var ny=["xlsb","xlsm","xlam","biff8","xla"];function RA(){return{"!type":"dialog"}}function DA(){return{"!type":"dialog"}}function PA(){return{"!type":"macro"}}function MA(){return{"!type":"macro"}}var Ls=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,i,s,o){var u=!1,d=!1;s.length==0?d=!0:s.charAt(0)=="["&&(d=!0,s=s.slice(1,-1)),o.length==0?u=!0:o.charAt(0)=="["&&(u=!0,o=o.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,m=o.length>0?parseInt(o,10)|0:0;return u?m+=t.c:--m,d?h+=t.r:--h,i+(u?"":"$")+Ht(m)+(d?"":"$")+Qt(h)}return function(i,s){return t=s,i.replace(e,n)}}(),Ud=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,zd=function(){return function(t,n){return t.replace(Ud,function(r,i,s,o,u,d){var h=Ed(o)-(s?0:n.c),m=Sd(d)-(u?0:n.r),x=m==0?"":u?m+1:"["+m+"]",v=h==0?"":s?h+1:"["+h+"]";return i+"R"+x+"C"+v})}}();function ry(e,t){return e.replace(Ud,function(n,r,i,s,o,u){return r+(i=="$"?i+s:Ht(Ed(s)+t.c))+(o=="$"?o+u:Qt(Sd(u)+t.r))})}function LA(e,t,n){var r=Qn(t),i=r.s,s=Wt(n),o={r:s.r-i.r,c:s.c-i.c};return ry(e,o)}function BA(e){return e.length!=1}function Bg(e){return e.replace(/_xlfn\./g,"")}function rn(e){e.l+=1}function sa(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function iy(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return ay(e);n.biff==12&&(r=4)}var i=e.read_shift(r),s=e.read_shift(r),o=sa(e),u=sa(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:u[0],cRel:u[1],rRel:u[2]}}}function ay(e){var t=sa(e),n=sa(e),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function OA(e,t,n){if(n.biff<8)return ay(e);var r=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),s=sa(e),o=sa(e);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function sy(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return UA(e);var r=e.read_shift(n&&n.biff==12?4:2),i=sa(e);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function UA(e){var t=sa(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function zA(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function bA(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return VA(e);var i=e.read_shift(r>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,u=(s&32768)>>15;if(s&=16383,u==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:u}}function VA(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:r}}function HA(e,t,n){var r=(e[e.l++]&96)>>5,i=iy(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function WA(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=iy(e,s,n);return[r,i,o]}function GA(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function $A(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[r,i]}function jA(e,t,n){var r=(e[e.l++]&96)>>5,i=OA(e,t-1,n);return[r,i]}function qA(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function Og(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function KA(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function JA(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function XA(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function YA(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function ZA(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function oy(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function QA(e){return e.read_shift(2),oy(e)}function e4(e){return e.read_shift(2),oy(e)}function t4(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=sy(e,0,n);return[r,i]}function n4(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=bA(e,0,n);return[r,i]}function r4(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var s=sy(e,0,n);return[r,i,s]}function i4(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[oI[i],cy[i],r]}function a4(e,t,n){var r=e[e.l++],i=e.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:s4(e);return[i,(s[0]===0?cy:sI)[s[1]]]}function s4(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function o4(e,t,n){e.l+=n&&n.biff==2?3:4}function l4(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function u4(e){return e.l++,Ii[e.read_shift(1)]}function c4(e){return e.l++,e.read_shift(2)}function f4(e){return e.l++,e.read_shift(1)!==0}function d4(e){return e.l++,Mn(e)}function h4(e,t,n){return e.l++,fl(e,t-1,n)}function p4(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=Zt(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=Ii[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=Mn(e);break;case 2:n[1]=Xa(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function m4(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?Ja:vc)(e));return i}function g4(e,t,n){var r=0,i=0;n.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,o=[];s!=r&&(o[s]=[]);++s)for(var u=0;u!=i;++u)o[s][u]=p4(e,n.biff);return o}function x4(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,s]}function v4(e,t,n){if(n.biff==5)return y4(e);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[r,i,s]}function y4(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function w4(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function _4(e,t,n){var r=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function T4(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function k4(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[r,i]}var S4=On,E4=On,C4=On;function hl(e,t,n){return e.l+=2,[zA(e)]}function bd(e){return e.l+=6,[]}var A4=hl,I4=bd,N4=bd,F4=hl;function ly(e){return e.l+=2,[sn(e),e.read_shift(2)&1]}var R4=hl,D4=ly,P4=bd,M4=hl,L4=hl,B4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function O4(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=B4[n>>2&31];return{ixti:t,coltype:n&3,rt:o,idx:r,c:i,C:s}}function U4(e){return e.l+=2,[e.read_shift(4)]}function z4(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function b4(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function V4(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function H4(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function W4(e){return e.l+=4,[0,0]}var Ug={1:{n:"PtgExp",f:l4},2:{n:"PtgTbl",f:C4},3:{n:"PtgAdd",f:rn},4:{n:"PtgSub",f:rn},5:{n:"PtgMul",f:rn},6:{n:"PtgDiv",f:rn},7:{n:"PtgPower",f:rn},8:{n:"PtgConcat",f:rn},9:{n:"PtgLt",f:rn},10:{n:"PtgLe",f:rn},11:{n:"PtgEq",f:rn},12:{n:"PtgGe",f:rn},13:{n:"PtgGt",f:rn},14:{n:"PtgNe",f:rn},15:{n:"PtgIsect",f:rn},16:{n:"PtgUnion",f:rn},17:{n:"PtgRange",f:rn},18:{n:"PtgUplus",f:rn},19:{n:"PtgUminus",f:rn},20:{n:"PtgPercent",f:rn},21:{n:"PtgParen",f:rn},22:{n:"PtgMissArg",f:rn},23:{n:"PtgStr",f:h4},26:{n:"PtgSheet",f:z4},27:{n:"PtgEndSheet",f:b4},28:{n:"PtgErr",f:u4},29:{n:"PtgBool",f:f4},30:{n:"PtgInt",f:c4},31:{n:"PtgNum",f:d4},32:{n:"PtgArray",f:qA},33:{n:"PtgFunc",f:i4},34:{n:"PtgFuncVar",f:a4},35:{n:"PtgName",f:x4},36:{n:"PtgRef",f:t4},37:{n:"PtgArea",f:HA},38:{n:"PtgMemArea",f:w4},39:{n:"PtgMemErr",f:S4},40:{n:"PtgMemNoMem",f:E4},41:{n:"PtgMemFunc",f:_4},42:{n:"PtgRefErr",f:T4},43:{n:"PtgAreaErr",f:GA},44:{n:"PtgRefN",f:n4},45:{n:"PtgAreaN",f:jA},46:{n:"PtgMemAreaN",f:V4},47:{n:"PtgMemNoMemN",f:H4},57:{n:"PtgNameX",f:v4},58:{n:"PtgRef3d",f:r4},59:{n:"PtgArea3d",f:WA},60:{n:"PtgRefErr3d",f:k4},61:{n:"PtgAreaErr3d",f:$A},255:{}},G4={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},$4={1:{n:"PtgElfLel",f:ly},2:{n:"PtgElfRw",f:M4},3:{n:"PtgElfCol",f:A4},6:{n:"PtgElfRwV",f:L4},7:{n:"PtgElfColV",f:F4},10:{n:"PtgElfRadical",f:R4},11:{n:"PtgElfRadicalS",f:P4},13:{n:"PtgElfColS",f:I4},15:{n:"PtgElfColSV",f:N4},16:{n:"PtgElfRadicalLel",f:D4},25:{n:"PtgList",f:O4},29:{n:"PtgSxName",f:U4},255:{}},j4={0:{n:"PtgAttrNoop",f:W4},1:{n:"PtgAttrSemi",f:ZA},2:{n:"PtgAttrIf",f:XA},4:{n:"PtgAttrChoose",f:KA},8:{n:"PtgAttrGoto",f:JA},16:{n:"PtgAttrSum",f:o4},32:{n:"PtgAttrBaxcel",f:Og},33:{n:"PtgAttrBaxcel",f:Og},64:{n:"PtgAttrSpace",f:QA},65:{n:"PtgAttrSpaceSemi",f:e4},128:{n:"PtgAttrIfError",f:YA},255:{}};function pl(e,t,n,r){if(r.biff<8)return On(e,t);for(var i=e.l+t,s=[],o=0;o!==n.length;++o)switch(n[o][0]){case"PtgArray":n[o][1]=g4(e,0,r),s.push(n[o][1]);break;case"PtgMemArea":n[o][2]=m4(e,n[o][1],r),s.push(n[o][2]);break;case"PtgExp":r&&r.biff==12&&(n[o][1][1]=e.read_shift(4),s.push(n[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[o][0]}return t=i-e.l,t!==0&&s.push(On(e,t)),s}function ml(e,t,n){for(var r=e.l+t,i,s,o=[];r!=e.l;)t=r-e.l,s=e[e.l],i=Ug[s]||Ug[G4[s]],(s===24||s===25)&&(i=(s===24?$4:j4)[e[e.l+1]]),!i||!i.f?On(e,t):o.push([i.n,i.f(e,t,n)]);return o}function q4(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],s=0;s<r.length;++s){var o=r[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var K4={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function J4(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function uy(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function zg(e,t,n){var r=uy(e,t,n);return r=="#REF"?r:J4(r,n)}function Dn(e,t,n,r,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},u=[],d,h,m,x=0,v=0,_,S="";if(!e[0]||!e[0][0])return"";for(var T=-1,E="",C=0,I=e[0].length;C<I;++C){var A=e[0][C];switch(A[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=u.pop(),h=u.pop(),T>=0){switch(e[0][T][1][0]){case 0:E=qt(" ",e[0][T][1][1]);break;case 1:E=qt("\r",e[0][T][1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][T][1][0])}h=h+E,T=-1}u.push(h+K4[A[0]]+d);break;case"PtgIsect":d=u.pop(),h=u.pop(),u.push(h+" "+d);break;case"PtgUnion":d=u.pop(),h=u.pop(),u.push(h+","+d);break;case"PtgRange":d=u.pop(),h=u.pop(),u.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Vo(A[1][1],o,i),u.push(Ho(m,s));break;case"PtgRefN":m=n?Vo(A[1][1],n,i):A[1][1],u.push(Ho(m,s));break;case"PtgRef3d":x=A[1][1],m=Vo(A[1][2],o,i),S=zg(r,x,i),u.push(S+"!"+Ho(m,s));break;case"PtgFunc":case"PtgFuncVar":var D=A[1][0],P=A[1][1];D||(D=0),D&=127;var L=D==0?[]:u.slice(-D);u.length-=D,P==="User"&&(P=L.shift()),u.push(P+"("+L.join(",")+")");break;case"PtgBool":u.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(A[1]);break;case"PtgNum":u.push(String(A[1]));break;case"PtgStr":u.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(A[1]);break;case"PtgAreaN":_=pg(A[1][1],n?{s:n}:o,i),u.push(g0(_,i));break;case"PtgArea":_=pg(A[1][1],o,i),u.push(g0(_,i));break;case"PtgArea3d":x=A[1][1],_=A[1][2],S=zg(r,x,i),u.push(S+"!"+g0(_,i));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=A[1][2];var R=(r.names||[])[v-1]||(r[0]||[])[v],J=R?R.Name:"SH33TJSNAME"+String(v);J&&J.slice(0,6)=="_xlfn."&&!i.xlfn&&(J=J.slice(6)),u.push(J);break;case"PtgNameX":var V=A[1][1];v=A[1][2];var ne;if(i.biff<=5)V<0&&(V=-V),r[V]&&(ne=r[V][v]);else{var te="";if(((r[V]||[])[0]||[])[0]==14849||(((r[V]||[])[0]||[])[0]==1025?r[V][v]&&r[V][v].itab>0&&(te=r.SheetNames[r[V][v].itab-1]+"!"):te=r.SheetNames[v-1]+"!"),r[V]&&r[V][v])te+=r[V][v].Name;else if(r[0]&&r[0][v])te+=r[0][v].Name;else{var Q=(uy(r,V,i)||"").split(";;");Q[v-1]?te=Q[v-1]:te+="SH33TJSERRX"}u.push(te);break}ne||(ne={Name:"SH33TJSERRY"}),u.push(ne.Name);break;case"PtgParen":var me="(",Re=")";if(T>=0){switch(E="",e[0][T][1][0]){case 2:me=qt(" ",e[0][T][1][1])+me;break;case 3:me=qt("\r",e[0][T][1][1])+me;break;case 4:Re=qt(" ",e[0][T][1][1])+Re;break;case 5:Re=qt("\r",e[0][T][1][1])+Re;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][T][1][0])}T=-1}u.push(me+u.pop()+Re);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":m={c:A[1][1],r:A[1][0]};var ye={c:n.c,r:n.r};if(r.sharedf[Je(m)]){var De=r.sharedf[Je(m)];u.push(Dn(De,o,ye,r,i))}else{var Ce=!1;for(d=0;d!=r.arrayf.length;++d)if(h=r.arrayf[d],!(m.c<h[0].s.c||m.c>h[0].e.c)&&!(m.r<h[0].s.r||m.r>h[0].e.r)){u.push(Dn(h[1],o,ye,r,i)),Ce=!0;break}Ce||u.push(A[1])}break;case"PtgArray":u.push("{"+q4(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var ke=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&T>=0&&ke.indexOf(e[0][C][0])==-1){A=e[0][T];var Z=!0;switch(A[1][0]){case 4:Z=!1;case 0:E=qt(" ",A[1][1]);break;case 5:Z=!1;case 1:E=qt("\r",A[1][1]);break;default:if(E="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}u.push((Z?E:"")+u.pop()+(Z?"":E)),T=-1}}if(u.length>1&&i.WTF)throw new Error("bad formula stack");return u[0]}function X4(e,t,n){var r=e.l+t,i=n.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],On(e,t-2)];var u=ml(e,o,n);return t!==o+i&&(s=pl(e,t-o-i,u,n)),e.l=r,[u,s]}function Y4(e,t,n){var r=e.l+t,i=n.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],On(e,t-2)];var u=ml(e,o,n);return t!==o+i&&(s=pl(e,t-o-i,u,n)),e.l=r,[u,s]}function Z4(e,t,n,r){var i=e.l+t,s=ml(e,r,n),o;return i!==e.l&&(o=pl(e,i-e.l,s,n)),[s,o]}function Q4(e,t,n){var r=e.l+t,i,s=e.read_shift(2),o=ml(e,s,n);return s==65535?[[],On(e,t-2)]:(t!==s+2&&(i=pl(e,r-s-2,o,n)),[o,i])}function eI(e){var t;if(yi(e,e.l+6)!==65535)return[Mn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function tI(e){if(e==null){var t=he(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return ba(e);return ba(0)}function _0(e,t,n){var r=e.l+t,i=si(e);n.biff==2&&++e.l;var s=eI(e),o=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var u=Y4(e,r-e.l,n);return{cell:i,val:s[0],formula:u,shared:o>>3&1,tt:s[1]}}function nI(e,t,n,r,i){var s=Ha(t,n,i),o=tI(e.v),u=he(6),d=33;u.write_shift(2,d),u.write_shift(4,0);for(var h=he(e.bf.length),m=0;m<e.bf.length;++m)h[m]=e.bf[m];var x=gn([s,o,u,h]);return x}function yc(e,t,n){var r=e.read_shift(4),i=ml(e,r,n),s=e.read_shift(4),o=s>0?pl(e,s,i,n):null;return[i,o]}var rI=yc,wc=yc,iI=yc,aI=yc,sI={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},cy={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},oI={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function bg(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function lI(e){var t="of:="+e.replace(Ud,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function T0(e){var t=e.split(":"),n=t[0].split(".")[0];return[n,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function uI(e){return e.replace(/\./,"!")}var Go={},Bs={},$o=typeof Map<"u";function Vd(e,t,n){var r=0,i=e.length;if(n){if($o?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var s=$o?n.get(t):n[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&($o?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function _c(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(Pn=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=il(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=rc(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function La(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function ca(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){Ti(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===r)return i;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function fy(e,t,n,r,i,s){try{r.cellNF&&(e.z=Ke[t])}catch(u){if(r.WTF)throw u}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Pt(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(Ke[t]==null&&Ti(sT[t]||"General",t),e.t==="e")e.w=e.w||Ii[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yo(e.v);else if(e.t==="d"){var o=fn(e.v);(o|0)===o?e.w=o.toString(10):e.w=Yo(o)}else{if(e.v===void 0)return"";e.w=Ua(e.v,Bs)}else e.t==="d"?e.w=Fr(t,fn(e.v),Bs):e.w=Fr(t,e.v,Bs)}catch(u){if(r.WTF)throw u}if(r.cellStyles&&n!=null)try{e.s=s.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=nc(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=nc(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(u){if(r.WTF&&s.Fills)throw u}}}function cI(e,t,n){if(e&&e["!ref"]){var r=ct(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function fI(e,t){var n=ct(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=nt(n))}var dI=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,hI=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,pI=/<(?:\w:)?hyperlink [^>]*>/mg,mI=/"(\w*:\w*)"/,gI=/<(?:\w:)?col\b[^>]*[\/]?>/g,xI=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,vI=/<(?:\w:)?pageMargins[^>]*\/>/g,dy=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,yI=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,wI=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function _I(e,t,n,r,i,s,o){if(!e)return e;r||(r={"!id":{}});var u=t.dense?[]:{},d={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",m="",x=e.match(hI);x?(h=e.slice(0,x.index),m=e.slice(x.index+x[0].length)):h=m=e;var v=h.match(dy);v?Hd(v[0],u,i,n):(v=h.match(yI))&&kI(v[0],v[1]||"",u,i,n);var _=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(_>0){var S=h.slice(_,_+50).match(mI);S&&fI(u,S[1])}var T=h.match(wI);T&&T[1]&&BI(T[1],i);var E=[];if(t.cellStyles){var C=h.match(gI);C&&RI(E,C)}x&&zI(x[1],u,t,d,s,o);var I=m.match(xI);I&&(u["!autofilter"]=PI(I[0]));var A=[],D=m.match(dI);if(D)for(_=0;_!=D.length;++_)A[_]=ct(D[_].slice(D[_].indexOf('"')+1));var P=m.match(pI);P&&II(u,P,r);var L=m.match(vI);if(L&&(u["!margins"]=NI(Ye(L[0]))),!u["!ref"]&&d.e.c>=d.s.c&&d.e.r>=d.s.r&&(u["!ref"]=nt(d)),t.sheetRows>0&&u["!ref"]){var R=ct(u["!ref"]);t.sheetRows<=+R.e.r&&(R.e.r=t.sheetRows-1,R.e.r>d.e.r&&(R.e.r=d.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>d.e.c&&(R.e.c=d.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),u["!fullref"]=u["!ref"],u["!ref"]=nt(R))}return E.length>0&&(u["!cols"]=E),A.length>0&&(u["!merges"]=A),u}function TI(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+nt(e[n])+'"/>';return t+"</mergeCells>"}function Hd(e,t,n,r){var i=Ye(e);n.Sheets[r]||(n.Sheets[r]={}),i.codeName&&(n.Sheets[r].CodeName=ut(Et(i.codeName)))}function kI(e,t,n,r,i){Hd(e.slice(0,e.indexOf(">")),n,r,i)}function SI(e,t,n,r,i){var s=!1,o={},u=null;if(r.bookType!=="xlsx"&&t.vbaraw){var d=t.SheetNames[n];try{t.Workbook&&(d=t.Workbook.Sheets[n].CodeName||d)}catch{}s=!0,o.codeName=ri(kt(d))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),u=(u||"")+Me("outlinePr",null,h)}!s&&!u||(i[i.length]=Me("sheetPr",u,o))}var EI=["objects","scenarios","selectLockedCells","selectUnlockedCells"],CI=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function AI(e){var t={sheet:1};return EI.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),CI.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=Ld(e.password).toString(16).toUpperCase()),Me("sheetProtection",null,t)}function II(e,t,n){for(var r=Array.isArray(e),i=0;i!=t.length;++i){var s=Ye(Et(t[i]),!0);if(!s.ref)return;var o=((n||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+ut(s.location))):(s.Target="#"+ut(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var u=ct(s.ref),d=u.s.r;d<=u.e.r;++d)for(var h=u.s.c;h<=u.e.c;++h){var m=Je({c:h,r:d});r?(e[d]||(e[d]=[]),e[d][h]||(e[d][h]={t:"z",v:void 0}),e[d][h].l=s):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=s)}}}function NI(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}function FI(e){return La(e),Me("pageMargins",null,e)}function RI(e,t){for(var n=!1,r=0;r!=t.length;++r){var i=Ye(t[r],!0);i.hidden&&(i.hidden=Dt(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!n&&i.width&&(n=!0,Bd(i.width)),aa(i);s<=o;)e[s++]=Mt(i)}}function DI(e,t){for(var n=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=Me("col",null,_c(i,r)));return n[n.length]="</cols>",n.join("")}function PI(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function MI(e,t,n,r){var i=typeof e.ref=="string"?e.ref:nt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,o=Qn(i);o.s.r==o.e.r&&(o.e.r=Qn(t["!ref"]).e.r,i=nt(o));for(var u=0;u<s.length;++u){var d=s[u];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==r){d.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return u==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),Me("autoFilter",null,{ref:i})}var LI=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function BI(e,t){t.Views||(t.Views=[{}]),(e.match(LI)||[]).forEach(function(n,r){var i=Ye(n);t.Views[r]||(t.Views[r]={}),+i.zoomScale&&(t.Views[r].zoom=+i.zoomScale),Dt(i.rightToLeft)&&(t.Views[r].RTL=!0)})}function OI(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Me("sheetViews",Me("sheetView",null,i),{})}function UI(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ii[e.v];break;case"d":r&&r.cellDates?i=Pt(e.v,-1).toISOString():(e=Mt(e),e.t="n",i=""+(e.v=fn(Pt(e.v)))),typeof e.z>"u"&&(e.z=Ke[14]);break;default:i=e.v;break}var u=Sn("v",kt(i)),d={r:t},h=ca(r.cellXfs,e,r);switch(h!==0&&(d.s=h),e.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){u=Sn("v",""+Vd(r.Strings,e.v,r.revStrings)),d.t="s";break}d.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;u=Me("f",kt(e.f),m)+(e.v!=null?u:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(d.cm=1),Me("c",u,d)}var zI=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Zo("v"),o=Zo("f");return function(d,h,m,x,v,_){for(var S=0,T="",E=[],C=[],I=0,A=0,D=0,P="",L,R,J=0,V=0,ne,te,Q=0,me=0,Re=Array.isArray(_.CellXf),ye,De=[],Ce=[],ke=Array.isArray(h),Z=[],H={},ue=!1,B=!!m.sheetStubs,X=d.split(t),q=0,K=X.length;q!=K;++q){T=X[q].trim();var le=T.length;if(le!==0){var xe=0;e:for(S=0;S<le;++S)switch(T[S]){case">":if(T[S-1]!="/"){++S;break e}if(m&&m.cellStyles){if(R=Ye(T.slice(xe,S),!0),J=R.r!=null?parseInt(R.r,10):J+1,V=-1,m.sheetRows&&m.sheetRows<J)continue;H={},ue=!1,R.ht&&(ue=!0,H.hpt=parseFloat(R.ht),H.hpx=Ws(H.hpt)),R.hidden=="1"&&(ue=!0,H.hidden=!0),R.outlineLevel!=null&&(ue=!0,H.level=+R.outlineLevel),ue&&(Z[J-1]=H)}break;case"<":xe=S;break}if(xe>=S)break;if(R=Ye(T.slice(xe,S),!0),J=R.r!=null?parseInt(R.r,10):J+1,V=-1,!(m.sheetRows&&m.sheetRows<J)){x.s.r>J-1&&(x.s.r=J-1),x.e.r<J-1&&(x.e.r=J-1),m&&m.cellStyles&&(H={},ue=!1,R.ht&&(ue=!0,H.hpt=parseFloat(R.ht),H.hpx=Ws(H.hpt)),R.hidden=="1"&&(ue=!0,H.hidden=!0),R.outlineLevel!=null&&(ue=!0,H.level=+R.outlineLevel),ue&&(Z[J-1]=H)),E=T.slice(S).split(e);for(var ve=0;ve!=E.length&&E[ve].trim().charAt(0)=="<";++ve);for(E=E.slice(ve),S=0;S!=E.length;++S)if(T=E[S].trim(),T.length!==0){if(C=T.match(n),I=S,A=0,D=0,T="<c "+(T.slice(0,1)=="<"?">":"")+T,C!=null&&C.length===2){for(I=0,P=C[1],A=0;A!=P.length&&!((D=P.charCodeAt(A)-64)<1||D>26);++A)I=26*I+D;--I,V=I}else++V;for(A=0;A!=T.length&&T.charCodeAt(A)!==62;++A);if(++A,R=Ye(T.slice(0,A),!0),R.r||(R.r=Je({r:J-1,c:V})),P=T.slice(A),L={t:""},(C=P.match(s))!=null&&C[1]!==""&&(L.v=ut(C[1])),m.cellFormula){if((C=P.match(o))!=null&&C[1]!==""){if(L.f=ut(Et(C[1])).replace(/\r\n/g,`
`),m.xlfn||(L.f=Bg(L.f)),C[0].indexOf('t="array"')>-1)L.F=(P.match(i)||[])[1],L.F.indexOf(":")>-1&&De.push([ct(L.F),L.F]);else if(C[0].indexOf('t="shared"')>-1){te=Ye(C[0]);var we=ut(Et(C[1]));m.xlfn||(we=Bg(we)),Ce[parseInt(te.si,10)]=[te,we,R.r]}}else(C=P.match(/<f[^>]*\/>/))&&(te=Ye(C[0]),Ce[te.si]&&(L.f=LA(Ce[te.si][1],Ce[te.si][2],R.r)));var Ae=Wt(R.r);for(A=0;A<De.length;++A)Ae.r>=De[A][0].s.r&&Ae.r<=De[A][0].e.r&&Ae.c>=De[A][0].s.c&&Ae.c<=De[A][0].e.c&&(L.F=De[A][1])}if(R.t==null&&L.v===void 0)if(L.f||L.F)L.v=0,L.t="n";else if(B)L.t="z";else continue;else L.t=R.t||"n";switch(x.s.c>V&&(x.s.c=V),x.e.c<V&&(x.e.c=V),L.t){case"n":if(L.v==""||L.v==null){if(!B)continue;L.t="z"}else L.v=parseFloat(L.v);break;case"s":if(typeof L.v>"u"){if(!B)continue;L.t="z"}else ne=Go[parseInt(L.v,10)],L.v=ne.t,L.r=ne.r,m.cellHTML&&(L.h=ne.h);break;case"str":L.t="s",L.v=L.v!=null?Et(L.v):"",m.cellHTML&&(L.h=wd(L.v));break;case"inlineStr":C=P.match(r),L.t="s",C!=null&&(ne=Md(C[1]))?(L.v=ne.t,m.cellHTML&&(L.h=ne.h)):L.v="";break;case"b":L.v=Dt(L.v);break;case"d":m.cellDates?L.v=Pt(L.v,1):(L.v=fn(Pt(L.v,1)),L.t="n");break;case"e":(!m||m.cellText!==!1)&&(L.w=L.v),L.v=pv[L.v];break}if(Q=me=0,ye=null,Re&&R.s!==void 0&&(ye=_.CellXf[R.s],ye!=null&&(ye.numFmtId!=null&&(Q=ye.numFmtId),m.cellStyles&&ye.fillId!=null&&(me=ye.fillId))),fy(L,Q,me,m,v,_),m.cellDates&&Re&&L.t=="n"&&Gs(Ke[Q])&&(L.t="d",L.v=xc(L.v)),R.cm&&m.xlmeta){var Xe=(m.xlmeta.Cell||[])[+R.cm-1];Xe&&Xe.type=="XLDAPR"&&(L.D=!0)}if(ke){var G=Wt(R.r);h[G.r]||(h[G.r]=[]),h[G.r][G.c]=L}else h[R.r]=L}}}}Z.length>0&&(h["!rows"]=Z)}}();function bI(e,t,n,r){var i=[],s=[],o=ct(e["!ref"]),u="",d,h="",m=[],x=0,v=0,_=e["!rows"],S=Array.isArray(e),T={r:h},E,C=-1;for(v=o.s.c;v<=o.e.c;++v)m[v]=Ht(v);for(x=o.s.r;x<=o.e.r;++x){for(s=[],h=Qt(x),v=o.s.c;v<=o.e.c;++v){d=m[v]+h;var I=S?(e[x]||[])[v]:e[d];I!==void 0&&(u=UI(I,d,e,t))!=null&&s.push(u)}(s.length>0||_&&_[x])&&(T={r:h},_&&_[x]&&(E=_[x],E.hidden&&(T.hidden=1),C=-1,E.hpx?C=al(E.hpx):E.hpt&&(C=E.hpt),C>-1&&(T.ht=C,T.customHeight=1),E.level&&(T.outlineLevel=E.level)),i[i.length]=Me("row",s.join(""),T))}if(_)for(;x<_.length;++x)_&&_[x]&&(T={r:x+1},E=_[x],E.hidden&&(T.hidden=1),C=-1,E.hpx?C=al(E.hpx):E.hpt&&(C=E.hpt),C>-1&&(T.ht=C,T.customHeight=1),E.level&&(T.outlineLevel=E.level),i[i.length]=Me("row","",T));return i.join("")}function hy(e,t,n,r){var i=[en,Me("worksheet",null,{xmlns:$a[0],"xmlns:r":cn.r})],s=n.SheetNames[e],o=0,u="",d=n.Sheets[s];d==null&&(d={});var h=d["!ref"]||"A1",m=ct(h);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),h=nt(m)}r||(r={}),d["!comments"]=[];var x=[];SI(d,n,e,t,i),i[i.length]=Me("dimension",null,{ref:h}),i[i.length]=OI(d,t,e,n),t.sheetFormat&&(i[i.length]=Me("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(i[i.length]=DI(d,d["!cols"])),i[o=i.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(u=bI(d,t),u.length>0&&(i[i.length]=u)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),d["!protect"]&&(i[i.length]=AI(d["!protect"])),d["!autofilter"]!=null&&(i[i.length]=MI(d["!autofilter"],d,n,e)),d["!merges"]!=null&&d["!merges"].length>0&&(i[i.length]=TI(d["!merges"]));var v=-1,_,S=-1;return d["!links"].length>0&&(i[i.length]="<hyperlinks>",d["!links"].forEach(function(T){T[1].Target&&(_={ref:T[0]},T[1].Target.charAt(0)!="#"&&(S=Tt(r,-1,kt(T[1].Target).replace(/#.*$/,""),at.HLINK),_["r:id"]="rId"+S),(v=T[1].Target.indexOf("#"))>-1&&(_.location=kt(T[1].Target.slice(v+1))),T[1].Tooltip&&(_.tooltip=kt(T[1].Tooltip)),i[i.length]=Me("hyperlink",null,_))}),i[i.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(i[i.length]=FI(d["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Sn("ignoredErrors",Me("ignoredError",null,{numberStoredAsText:1,sqref:h}))),x.length>0&&(S=Tt(r,-1,"../drawings/drawing"+(e+1)+".xml",at.DRAW),i[i.length]=Me("drawing",null,{"r:id":"rId"+S}),d["!drawing"]=x),d["!comments"].length>0&&(S=Tt(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",at.VML),i[i.length]=Me("legacyDrawing",null,{"r:id":"rId"+S}),d["!legacy"]=S),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function VI(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function HI(e,t,n){var r=he(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;i.hpx?s=al(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),r.write_shift(1,o),r.write_shift(1,0);var u=0,d=r.l;r.l+=4;for(var h={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var x=-1,v=-1,_=m<<10;_<m+1<<10;++_){h.c=_;var S=Array.isArray(n)?(n[h.r]||[])[h.c]:n[Je(h)];S&&(x<0&&(x=_),v=_)}x<0||(++u,r.write_shift(4,x),r.write_shift(4,v))}var T=r.l;return r.l=d,r.write_shift(4,u),r.l=T,r.length>r.l?r.slice(0,r.l):r}function WI(e,t,n,r){var i=HI(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&Te(e,0,i)}var GI=Ja,$I=qs;function jI(){}function qI(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=XT(e),n}function KI(e,t,n){n==null&&(n=he(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return Qu({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),uv(e,n),n.slice(0,n.l)}function JI(e){var t=Rr(e);return[t]}function XI(e,t,n){return n==null&&(n=he(8)),ja(t,n)}function YI(e){var t=qa(e);return[t]}function ZI(e,t,n){return n==null&&(n=he(4)),Ka(t,n)}function QI(e){var t=Rr(e),n=e.read_shift(1);return[t,n,"b"]}function eN(e,t,n){return n==null&&(n=he(9)),ja(t,n),n.write_shift(1,e.v?1:0),n}function tN(e){var t=qa(e),n=e.read_shift(1);return[t,n,"b"]}function nN(e,t,n){return n==null&&(n=he(5)),Ka(t,n),n.write_shift(1,e.v?1:0),n}function rN(e){var t=Rr(e),n=e.read_shift(1);return[t,n,"e"]}function iN(e,t,n){return n==null&&(n=he(9)),ja(t,n),n.write_shift(1,e.v),n}function aN(e){var t=qa(e),n=e.read_shift(1);return[t,n,"e"]}function sN(e,t,n){return n==null&&(n=he(8)),Ka(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function oN(e){var t=Rr(e),n=e.read_shift(4);return[t,n,"s"]}function lN(e,t,n){return n==null&&(n=he(12)),ja(t,n),n.write_shift(4,t.v),n}function uN(e){var t=qa(e),n=e.read_shift(4);return[t,n,"s"]}function cN(e,t,n){return n==null&&(n=he(8)),Ka(t,n),n.write_shift(4,t.v),n}function fN(e){var t=Rr(e),n=Mn(e);return[t,n,"n"]}function dN(e,t,n){return n==null&&(n=he(16)),ja(t,n),ba(e.v,n),n}function py(e){var t=qa(e),n=Mn(e);return[t,n,"n"]}function hN(e,t,n){return n==null&&(n=he(12)),Ka(t,n),ba(e.v,n),n}function pN(e){var t=Rr(e),n=Nd(e);return[t,n,"n"]}function mN(e,t,n){return n==null&&(n=he(12)),ja(t,n),cv(e.v,n),n}function gN(e){var t=qa(e),n=Nd(e);return[t,n,"n"]}function xN(e,t,n){return n==null&&(n=he(8)),Ka(t,n),cv(e.v,n),n}function vN(e){var t=Rr(e),n=Cd(e);return[t,n,"is"]}function yN(e){var t=Rr(e),n=Bn(e);return[t,n,"str"]}function wN(e,t,n){return n==null&&(n=he(12+4*e.v.length)),ja(t,n),vn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function _N(e){var t=qa(e),n=Bn(e);return[t,n,"str"]}function TN(e,t,n){return n==null&&(n=he(8+4*e.v.length)),Ka(t,n),vn(e.v,n),n.length>n.l?n.slice(0,n.l):n}function kN(e,t,n){var r=e.l+t,i=Rr(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(n.cellFormula){e.l+=2;var u=wc(e,r-e.l,n);o[3]=Dn(u,null,i,n.supbooks,n)}else e.l=r;return o}function SN(e,t,n){var r=e.l+t,i=Rr(e);i.r=n["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(n.cellFormula){e.l+=2;var u=wc(e,r-e.l,n);o[3]=Dn(u,null,i,n.supbooks,n)}else e.l=r;return o}function EN(e,t,n){var r=e.l+t,i=Rr(e);i.r=n["!row"];var s=Mn(e),o=[i,s,"n"];if(n.cellFormula){e.l+=2;var u=wc(e,r-e.l,n);o[3]=Dn(u,null,i,n.supbooks,n)}else e.l=r;return o}function CN(e,t,n){var r=e.l+t,i=Rr(e);i.r=n["!row"];var s=Bn(e),o=[i,s,"str"];if(n.cellFormula){e.l+=2;var u=wc(e,r-e.l,n);o[3]=Dn(u,null,i,n.supbooks,n)}else e.l=r;return o}var AN=Ja,IN=qs;function NN(e,t){return t==null&&(t=he(4)),t.write_shift(4,e),t}function FN(e,t){var n=e.l+t,r=Ja(e),i=Ad(e),s=Bn(e),o=Bn(e),u=Bn(e);e.l=n;var d={rfx:r,relId:i,loc:s,display:u};return o&&(d.Tooltip=o),d}function RN(e,t){var n=he(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));qs({s:Wt(e[0]),e:Wt(e[0])},n),Id("rId"+t,n);var r=e[1].Target.indexOf("#"),i=r==-1?"":e[1].Target.slice(r+1);return vn(i||"",n),vn(e[1].Tooltip||"",n),vn("",n),n.slice(0,n.l)}function DN(){}function PN(e,t,n){var r=e.l+t,i=fv(e),s=e.read_shift(1),o=[i];if(o[2]=s,n.cellFormula){var u=rI(e,r-e.l,n);o[1]=u}else e.l=r;return o}function MN(e,t,n){var r=e.l+t,i=Ja(e),s=[i];if(n.cellFormula){var o=aI(e,r-e.l,n);s[1]=o,e.l=r}else e.l=r;return s}function LN(e,t,n){n==null&&(n=he(18));var r=_c(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}var my=["left","right","top","bottom","header","footer"];function BN(e){var t={};return my.forEach(function(n){t[n]=Mn(e)}),t}function ON(e,t){return t==null&&(t=he(48)),La(e),my.forEach(function(n){ba(e[n],t)}),t}function UN(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function zN(e,t,n){n==null&&(n=he(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function bN(e){var t=he(24);return t.write_shift(4,4),t.write_shift(4,1),qs(e,t),t}function VN(e,t){return t==null&&(t=he(66)),t.write_shift(2,e.password?Ld(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function HN(){}function WN(){}function GN(e,t,n,r,i,s,o){if(!e)return e;var u=t||{};r||(r={"!id":{}});var d=u.dense?[]:{},h,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,v=!1,_,S,T,E,C,I,A,D,P,L=[];u.biff=12,u["!row"]=0;var R=0,J=!1,V=[],ne={},te=u.supbooks||i.supbooks||[[]];if(te.sharedf=ne,te.arrayf=V,te.SheetNames=i.SheetNames||i.Sheets.map(function(ke){return ke.name}),!u.supbooks&&(u.supbooks=te,i.Names))for(var Q=0;Q<i.Names.length;++Q)te[0][Q+1]=i.Names[Q];var me=[],Re=[],ye=!1;sl[16]={n:"BrtShortReal",f:py};var De;if(Ai(e,function(Z,H,ue){if(!v)switch(ue){case 148:h=Z;break;case 0:_=Z,u.sheetRows&&u.sheetRows<=_.r&&(v=!0),D=Qt(E=_.r),u["!row"]=_.r,(Z.hidden||Z.hpt||Z.level!=null)&&(Z.hpt&&(Z.hpx=Ws(Z.hpt)),Re[Z.r]=Z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(S={t:Z[2]},Z[2]){case"n":S.v=Z[1];break;case"s":A=Go[Z[1]],S.v=A.t,S.r=A.r;break;case"b":S.v=!!Z[1];break;case"e":S.v=Z[1],u.cellText!==!1&&(S.w=Ii[S.v]);break;case"str":S.t="s",S.v=Z[1];break;case"is":S.t="s",S.v=Z[1].t;break}if((T=o.CellXf[Z[0].iStyleRef])&&fy(S,T.numFmtId,null,u,s,o),C=Z[0].c==-1?C+1:Z[0].c,u.dense?(d[E]||(d[E]=[]),d[E][C]=S):d[Ht(C)+D]=S,u.cellFormula){for(J=!1,R=0;R<V.length;++R){var B=V[R];_.r>=B[0].s.r&&_.r<=B[0].e.r&&C>=B[0].s.c&&C<=B[0].e.c&&(S.F=nt(B[0]),J=!0)}!J&&Z.length>3&&(S.f=Z[3])}if(m.s.r>_.r&&(m.s.r=_.r),m.s.c>C&&(m.s.c=C),m.e.r<_.r&&(m.e.r=_.r),m.e.c<C&&(m.e.c=C),u.cellDates&&T&&S.t=="n"&&Gs(Ke[T.numFmtId])){var X=Ra(S.v);X&&(S.t="d",S.v=new Date(X.y,X.m-1,X.d,X.H,X.M,X.S,X.u))}De&&(De.type=="XLDAPR"&&(S.D=!0),De=void 0);break;case 1:case 12:if(!u.sheetStubs||x)break;S={t:"z",v:void 0},C=Z[0].c==-1?C+1:Z[0].c,u.dense?(d[E]||(d[E]=[]),d[E][C]=S):d[Ht(C)+D]=S,m.s.r>_.r&&(m.s.r=_.r),m.s.c>C&&(m.s.c=C),m.e.r<_.r&&(m.e.r=_.r),m.e.c<C&&(m.e.c=C),De&&(De.type=="XLDAPR"&&(S.D=!0),De=void 0);break;case 176:L.push(Z);break;case 49:De=((u.xlmeta||{}).Cell||[])[Z-1];break;case 494:var q=r["!id"][Z.relId];for(q?(Z.Target=q.Target,Z.loc&&(Z.Target+="#"+Z.loc),Z.Rel=q):Z.relId==""&&(Z.Target="#"+Z.loc),E=Z.rfx.s.r;E<=Z.rfx.e.r;++E)for(C=Z.rfx.s.c;C<=Z.rfx.e.c;++C)u.dense?(d[E]||(d[E]=[]),d[E][C]||(d[E][C]={t:"z",v:void 0}),d[E][C].l=Z):(I=Je({c:C,r:E}),d[I]||(d[I]={t:"z",v:void 0}),d[I].l=Z);break;case 426:if(!u.cellFormula)break;V.push(Z),P=u.dense?d[E][C]:d[Ht(C)+D],P.f=Dn(Z[1],m,{r:_.r,c:C},te,u),P.F=nt(Z[0]);break;case 427:if(!u.cellFormula)break;ne[Je(Z[0].s)]=Z[1],P=u.dense?d[E][C]:d[Ht(C)+D],P.f=Dn(Z[1],m,{r:_.r,c:C},te,u);break;case 60:if(!u.cellStyles)break;for(;Z.e>=Z.s;)me[Z.e--]={width:Z.w/256,hidden:!!(Z.flags&1),level:Z.level},ye||(ye=!0,Bd(Z.w/256)),aa(me[Z.e+1]);break;case 161:d["!autofilter"]={ref:nt(Z)};break;case 476:d["!margins"]=Z;break;case 147:i.Sheets[n]||(i.Sheets[n]={}),Z.name&&(i.Sheets[n].CodeName=Z.name),(Z.above||Z.left)&&(d["!outline"]={above:Z.above,left:Z.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),Z.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!H.T){if(!x||u.WTF)throw new Error("Unexpected record 0x"+ue.toString(16))}}},u),delete u.supbooks,delete u["!row"],!d["!ref"]&&(m.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(d["!ref"]=nt(h||m)),u.sheetRows&&d["!ref"]){var Ce=ct(d["!ref"]);u.sheetRows<=+Ce.e.r&&(Ce.e.r=u.sheetRows-1,Ce.e.r>m.e.r&&(Ce.e.r=m.e.r),Ce.e.r<Ce.s.r&&(Ce.s.r=Ce.e.r),Ce.e.c>m.e.c&&(Ce.e.c=m.e.c),Ce.e.c<Ce.s.c&&(Ce.s.c=Ce.e.c),d["!fullref"]=d["!ref"],d["!ref"]=nt(Ce))}return L.length>0&&(d["!merges"]=L),me.length>0&&(d["!cols"]=me),Re.length>0&&(d["!rows"]=Re),d}function $N(e,t,n,r,i,s,o){if(t.v===void 0)return!1;var u="";switch(t.t){case"b":u=t.v?"1":"0";break;case"d":t=Mt(t),t.z=t.z||Ke[14],t.v=fn(Pt(t.v)),t.t="n";break;case"n":case"e":u=""+t.v;break;default:u=t.v;break}var d={r:n,c:r};switch(d.s=ca(i.cellXfs,t,i),t.l&&s["!links"].push([Je(d),t.l]),t.c&&s["!comments"].push([Je(d),t.c]),t.t){case"s":case"str":return i.bookSST?(u=Vd(i.Strings,t.v,i.revStrings),d.t="s",d.v=u,o?Te(e,18,cN(t,d)):Te(e,7,lN(t,d))):(d.t="str",o?Te(e,17,TN(t,d)):Te(e,6,wN(t,d))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Te(e,13,xN(t,d)):Te(e,2,mN(t,d)):o?Te(e,16,hN(t,d)):Te(e,5,dN(t,d)),!0;case"b":return d.t="b",o?Te(e,15,nN(t,d)):Te(e,4,eN(t,d)),!0;case"e":return d.t="e",o?Te(e,14,sN(t,d)):Te(e,3,iN(t,d)),!0}return o?Te(e,12,ZI(t,d)):Te(e,1,XI(t,d)),!0}function jN(e,t,n,r){var i=ct(t["!ref"]||"A1"),s,o="",u=[];Te(e,145);var d=Array.isArray(t),h=i.e.r;t["!rows"]&&(h=Math.max(i.e.r,t["!rows"].length-1));for(var m=i.s.r;m<=h;++m){o=Qt(m),WI(e,t,i,m);var x=!1;if(m<=i.e.r)for(var v=i.s.c;v<=i.e.c;++v){m===i.s.r&&(u[v]=Ht(v)),s=u[v]+o;var _=d?(t[m]||[])[v]:t[s];if(!_){x=!1;continue}x=$N(e,_,m,v,r,t,x)}}Te(e,146)}function qN(e,t){!t||!t["!merges"]||(Te(e,177,NN(t["!merges"].length)),t["!merges"].forEach(function(n){Te(e,176,IN(n))}),Te(e,178))}function KN(e,t){!t||!t["!cols"]||(Te(e,390),t["!cols"].forEach(function(n,r){n&&Te(e,60,LN(r,n))}),Te(e,391))}function JN(e,t){!t||!t["!ref"]||(Te(e,648),Te(e,649,bN(ct(t["!ref"]))),Te(e,650))}function XN(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var i=Tt(n,-1,r[1].Target.replace(/#.*$/,""),at.HLINK);Te(e,494,RN(r,i))}}),delete t["!links"]}function YN(e,t,n,r){if(t["!comments"].length>0){var i=Tt(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",at.VML);Te(e,551,Id("rId"+i)),t["!legacy"]=i}}function ZN(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:nt(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,u=Qn(s);u.s.r==u.e.r&&(u.e.r=Qn(t["!ref"]).e.r,s=nt(u));for(var d=0;d<o.length;++d){var h=o[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==r){h.Ref="'"+n.SheetNames[r]+"'!"+s;break}}d==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),Te(e,161,qs(ct(s))),Te(e,162)}}function QN(e,t,n){Te(e,133),Te(e,137,zN(t,n)),Te(e,138),Te(e,134)}function eF(e,t){t["!protect"]&&Te(e,535,VN(t["!protect"]))}function tF(e,t,n,r){var i=Zn(),s=n.SheetNames[e],o=n.Sheets[s]||{},u=s;try{n&&n.Workbook&&(u=n.Workbook.Sheets[e].CodeName||u)}catch{}var d=ct(o["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Te(i,129),(n.vbaraw||o["!outline"])&&Te(i,147,KI(u,o["!outline"])),Te(i,148,$I(d)),QN(i,o,n.Workbook),KN(i,o),jN(i,o,e,t),eF(i,o),ZN(i,o,n,e),qN(i,o),XN(i,o,r),o["!margins"]&&Te(i,476,ON(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&JN(i,o),YN(i,o,e,r),Te(i,130),i.end()}function nF(e){var t=[],n=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=n?+o[2]:o[2])});var i=ut((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){r=s.replace(/<.*?>/g,"")}),[t,i,r]}function rF(e,t,n,r,i,s){var o=s||{"!type":"chart"};if(!e)return s;var u=0,d=0,h="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var v=nF(x);m.s.r=m.s.c=0,m.e.c=u,h=Ht(u),v[0].forEach(function(_,S){o[h+Qt(S)]={t:"n",v:_,z:v[1]},d=S}),m.e.r<d&&(m.e.r=d),++u}),u>0&&(o["!ref"]=nt(m)),o}function iF(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,u=e.match(dy);return u&&Hd(u[0],s,i,n),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function aF(e,t){e.l+=10;var n=Bn(e);return{name:n}}function sF(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Ai(e,function(d,h,m){switch(m){case 550:s["!rel"]=d;break;case 651:i.Sheets[n]||(i.Sheets[n]={}),d.name&&(i.Sheets[n].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var Wd=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],oF=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],lF=[],uF=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Vg(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],i=0;i!=t.length;++i){var s=t[i];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=Dt(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function Hg(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=Dt(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function gy(e){Hg(e.WBProps,Wd),Hg(e.CalcPr,uF),Vg(e.WBView,oF),Vg(e.Sheets,lF),Bs.date1904=Dt(e.WBProps.date1904)}function cF(e){return!e.Workbook||!e.Workbook.WBProps?"false":Dt(e.Workbook.WBProps.date1904)?"true":"false"}var fF="][*?/\\".split("");function xy(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return fF.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function dF(e,t,n){e.forEach(function(r,i){xy(r);for(var s=0;s<i;++s)if(r==e[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var o=t&&t[i]&&t[i].CodeName||r;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function hF(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];dF(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)cI(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var pF=/<\w+:workbook/;function mF(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",s={},o=0;if(e.replace(Un,function(d,h){var m=Ye(d);switch(ai(m[0])){case"<?xml":break;case"<workbook":d.match(pF)&&(i="xmlns"+d.match(/<(\w+):/)[1]),n.xmlns=m[i];break;case"</workbook>":break;case"<fileVersion":delete m[0],n.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Wd.forEach(function(x){if(m[x[0]]!=null)switch(x[2]){case"bool":n.WBProps[x[0]]=Dt(m[x[0]]);break;case"int":n.WBProps[x[0]]=parseInt(m[x[0]],10);break;default:n.WBProps[x[0]]=m[x[0]]}}),m.codeName&&(n.WBProps.CodeName=Et(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],n.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=ut(Et(m.name)),delete m[0],n.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=Et(m.name),m.comment&&(s.Comment=m.comment),m.localSheetId&&(s.Sheet=+m.localSheetId),Dt(m.hidden||"0")&&(s.Hidden=!0),o=h+d.length;break;case"</definedName>":s.Ref=ut(Et(e.slice(o,h))),n.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete m[0],n.CalcPr=m;break;case"<calcPr/>":delete m[0],n.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return d}),$a.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return gy(n),n}function vy(e){var t=[en];t[t.length]=Me("workbook",null,{xmlns:$a[0],"xmlns:r":cn.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Wd.forEach(function(u){e.Workbook.WBProps[u[0]]!=null&&e.Workbook.WBProps[u[0]]!=u[1]&&(r[u[0]]=e.Workbook.WBProps[u[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Me("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:kt(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Me("sheet",null,o)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(u){var d={name:u.Name};u.Comment&&(d.comment=u.Comment),u.Sheet!=null&&(d.localSheetId=""+u.Sheet),u.Hidden&&(d.hidden="1"),u.Ref&&(t[t.length]=Me("definedName",kt(u.Ref),d))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function gF(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=O0(e),n.name=Bn(e),n}function xF(e,t){return t||(t=he(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Id(e.strRelID,t),vn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function vF(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?Bn(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function yF(e,t){t||(t=he(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),uv(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function wF(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function _F(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=YT(e),o=iI(e,0,n),u=Ad(e);e.l=r;var d={Name:s,Ptg:o};return i<268435455&&(d.Sheet=i),u&&(d.Comment=u),d}function TF(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],sl[16]={n:"BrtFRTArchID$",f:wF},Ai(e,function(d,h,m){switch(m){case 156:o.SheetNames.push(d.name),n.Sheets.push(d);break;case 153:n.WBProps=d;break;case 39:d.Sheet!=null&&(t.SID=d.Sheet),d.Ref=Dn(d.Ptg,null,null,o,t),delete t.SID,delete d.Ptg,s.push(d);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([m,d]):o[0]=[m,d],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(d),o.XTI=o.XTI.concat(d);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(m),i=!0;break;case 36:r.pop(),i=!1;break;case 37:r.push(m),i=!0;break;case 38:r.pop(),i=!1;break;case 16:break;default:if(!h.T){if(!i||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),gy(n),n.Names=s,n.supbooks=o,n}function kF(e,t){Te(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};Te(e,156,xF(i))}Te(e,144)}function SF(e,t){t||(t=he(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return vn("SheetJS",t),vn(ju.version,t),vn(ju.version,t),vn("7262",t),t.length>t.l?t.slice(0,t.l):t}function EF(e,t){t||(t=he(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function CF(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(Te(e,135),Te(e,158,EF(i)),Te(e,136))}}function AF(e,t){var n=Zn();return Te(n,131),Te(n,128,SF()),Te(n,153,yF(e.Workbook&&e.Workbook.WBProps||null)),CF(n,e),kF(n,e),Te(n,132),n.end()}function IF(e,t,n){return t.slice(-4)===".bin"?TF(e,n):mF(e,n)}function NF(e,t,n,r,i,s,o,u){return t.slice(-4)===".bin"?GN(e,r,n,i,s,o,u):_I(e,r,n,i,s,o,u)}function FF(e,t,n,r,i,s,o,u){return t.slice(-4)===".bin"?sF(e,r,n,i,s):iF(e,r,n,i,s)}function RF(e,t,n,r,i,s,o,u){return t.slice(-4)===".bin"?PA():MA()}function DF(e,t,n,r,i,s,o,u){return t.slice(-4)===".bin"?RA():DA()}function PF(e,t,n,r){return t.slice(-4)===".bin"?IC(e,n,r):gC(e,n,r)}function MF(e,t,n){return Zv(e,n)}function LF(e,t,n){return t.slice(-4)===".bin"?LE(e,n):DE(e,n)}function BF(e,t,n){return t.slice(-4)===".bin"?CA(e,n):xA(e,n)}function OF(e,t,n){return t.slice(-4)===".bin"?pA(e):dA(e)}function UF(e,t,n,r){return n.slice(-4)===".bin"?mA(e,t,n,r):void 0}function zF(e,t,n){return t.slice(-4)===".bin"?uA(e,t,n):fA(e,t,n)}function bF(e,t,n){return(t.slice(-4)===".bin"?AF:vy)(e)}function VF(e,t,n,r,i){return(t.slice(-4)===".bin"?tF:hy)(e,n,r,i)}function HF(e,t,n){return(t.slice(-4)===".bin"?UC:Xv)(e,n)}function WF(e,t,n){return(t.slice(-4)===".bin"?UE:Hv)(e,n)}function GF(e,t,n){return(t.slice(-4)===".bin"?AA:ty)(e)}function $F(e){return(e.slice(-4)===".bin"?cA:Qv)()}var yy=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wy=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Vr(e,t){var n=e.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var i=e.match(yy),s,o,u,d;if(i)for(d=0;d!=i.length;++d)s=i[d].match(wy),(o=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?u="xmlns"+s[1].slice(6):u=s[1].slice(o+1),r[u]=s[2].slice(1,s[2].length-1));return r}function jF(e){var t=e.split(/\s+/),n={};if(t.length===1)return n;var r=e.match(yy),i,s,o,u;if(r)for(u=0;u!=r.length;++u)i=r[u].match(wy),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),n[o]=i[2].slice(1,i[2].length-1));return n}var jo;function qF(e,t){var n=jo[e]||ut(e);return n==="General"?Ua(t):Fr(n,t)}function KF(e,t,n,r){var i=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Dt(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=Pt(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[ut(t)]=i}function JF(e,t,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Ii[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yo(e.v):e.w=Ua(e.v):e.w=qF(t||"General",e.v)}catch(s){if(n.WTF)throw s}try{var r=jo[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&e.t=="n"&&Gs(r)){var i=Ra(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(n.WTF)throw s}}}function XF(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=lC[r.Pattern]||r.Pattern)}e[t.ID]=t}function YF(e,t,n,r,i,s,o,u,d,h){var m="General",x=r.StyleID,v={};h=h||{};var _=[],S=0;for(x===void 0&&u&&(x=u.StyleID),x===void 0&&o&&(x=o.StyleID);s[x]!==void 0&&(s[x].nf&&(m=s[x].nf),s[x].Interior&&_.push(s[x].Interior),!!s[x].Parent);)x=s[x].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=Dt(e);break;case"String":r.t="s",r.r=ag(ut(e)),r.v=e.indexOf("<")>-1?ut(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(Pt(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),r.v!==r.v?r.v=ut(e):r.v<60&&(r.v=r.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=pv[e],h.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=ag(t||e));break}if(JF(r,m,h),h.cellFormula!==!1)if(r.Formula){var T=ut(r.Formula);T.charCodeAt(0)==61&&(T=T.slice(1)),r.f=Ls(T,i),delete r.Formula,r.ArrayRange=="RC"?r.F=Ls("RC:RC",i):r.ArrayRange&&(r.F=Ls(r.ArrayRange,i),d.push([ct(r.F),r.F]))}else for(S=0;S<d.length;++S)i.r>=d[S][0].s.r&&i.r<=d[S][0].e.r&&i.c>=d[S][0].s.c&&i.c<=d[S][0].e.c&&(r.F=d[S][1]);h.cellStyles&&(_.forEach(function(E){!v.patternType&&E.patternType&&(v.patternType=E.patternType)}),r.s=v),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function ZF(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function k0(e,t){var n=t||{};$s();var r=Oo(_d(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=Et(r));var i=r.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Mt(n);return o.type="string",Hs.to_workbook(r,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(yt){i.indexOf("<"+yt)>=0&&(s=!0)}),s)return O3(r,n);jo={"General Number":"General","General Date":Ke[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ke[15],"Short Date":Ke[14],"Long Time":Ke[19],"Medium Time":Ke[18],"Short Time":Ke[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ke[2],Standard:Ke[4],Percent:Ke[10],Scientific:Ke[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,d=[],h,m={},x=[],v=n.dense?[]:{},_="",S={},T={},E=Vr('<Data ss:Type="String">'),C=0,I=0,A=0,D={s:{r:2e6,c:2e6},e:{r:0,c:0}},P={},L={},R="",J=0,V=[],ne={},te={},Q=0,me=[],Re=[],ye={},De=[],Ce,ke=!1,Z=[],H=[],ue={},B=0,X=0,q={Sheets:[],WBProps:{date1904:!1}},K={};el.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";u=el.exec(r);)switch(u[3]=(le=u[3]).toLowerCase()){case"data":if(le=="data"){if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break}if(d[d.length-1][1])break;u[1]==="/"?YF(r.slice(C,u.index),R,E,d[d.length-1][0]=="comment"?ye:S,{c:I,r:A},P,De[I],T,Z,n):(R="",E=Vr(u[0]),C=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Re.length>0&&(S.c=Re),(!n.sheetRows||n.sheetRows>A)&&S.v!==void 0&&(n.dense?(v[A]||(v[A]=[]),v[A][I]=S):v[Ht(I)+Qt(A)]=S),S.HRef&&(S.l={Target:ut(S.HRef)},S.HRefScreenTip&&(S.l.Tooltip=S.HRefScreenTip),delete S.HRef,delete S.HRefScreenTip),(S.MergeAcross||S.MergeDown)&&(B=I+(parseInt(S.MergeAcross,10)|0),X=A+(parseInt(S.MergeDown,10)|0),V.push({s:{c:I,r:A},e:{c:B,r:X}})),!n.sheetStubs)S.MergeAcross?I=B+1:++I;else if(S.MergeAcross||S.MergeDown){for(var xe=I;xe<=B;++xe)for(var ve=A;ve<=X;++ve)(xe>I||ve>A)&&(n.dense?(v[ve]||(v[ve]=[]),v[ve][xe]={t:"z"}):v[Ht(xe)+Qt(ve)]={t:"z"});I=B+1}else++I;else S=jF(u[0]),S.Index&&(I=+S.Index-1),I<D.s.c&&(D.s.c=I),I>D.e.c&&(D.e.c=I),u[0].slice(-2)==="/>"&&++I,Re=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(A<D.s.r&&(D.s.r=A),A>D.e.r&&(D.e.r=A),u[0].slice(-2)==="/>"&&(T=Vr(u[0]),T.Index&&(A=+T.Index-1)),I=0,++A):(T=Vr(u[0]),T.Index&&(A=+T.Index-1),ue={},(T.AutoFitHeight=="0"||T.Height)&&(ue.hpx=parseInt(T.Height,10),ue.hpt=al(ue.hpx),H[A]=ue),T.Hidden=="1"&&(ue.hidden=!0,H[A]=ue));break;case"worksheet":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));x.push(_),D.s.r<=D.e.r&&D.s.c<=D.e.c&&(v["!ref"]=nt(D),n.sheetRows&&n.sheetRows<=D.e.r&&(v["!fullref"]=v["!ref"],D.e.r=n.sheetRows-1,v["!ref"]=nt(D))),V.length&&(v["!merges"]=V),De.length>0&&(v["!cols"]=De),H.length>0&&(v["!rows"]=H),m[_]=v}else D={s:{r:2e6,c:2e6},e:{r:0,c:0}},A=I=0,d.push([u[3],!1]),h=Vr(u[0]),_=ut(h.Name),v=n.dense?[]:{},V=[],Z=[],H=[],K={name:_,Hidden:0},q.Sheets.push(K);break;case"table":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else{if(u[0].slice(-2)=="/>")break;d.push([u[3],!1]),De=[],ke=!1}break;case"style":u[1]==="/"?XF(P,L,n):L=Vr(u[0]);break;case"numberformat":L.nf=ut(Vr(u[0]).Format||"General"),jo[L.nf]&&(L.nf=jo[L.nf]);for(var we=0;we!=392&&Ke[we]!=L.nf;++we);if(we==392){for(we=57;we!=392;++we)if(Ke[we]==null){Ti(L.nf,we);break}}break;case"column":if(d[d.length-1][0]!=="table")break;if(Ce=Vr(u[0]),Ce.Hidden&&(Ce.hidden=!0,delete Ce.Hidden),Ce.Width&&(Ce.wpx=parseInt(Ce.Width,10)),!ke&&Ce.wpx>10){ke=!0,Pn=Kv;for(var Ae=0;Ae<De.length;++Ae)De[Ae]&&aa(De[Ae])}ke&&aa(Ce),De[Ce.Index-1||De.length]=Ce;for(var Xe=0;Xe<+Ce.Span;++Xe)De[De.length]=Mt(Ce);break;case"namedrange":if(u[1]==="/")break;q.Names||(q.Names=[]);var G=Ye(u[0]),ft={Name:G.Name,Ref:Ls(G.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(ft.Sheet=q.Sheets.length-1),q.Names.push(ft);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?R+=r.slice(J,u.index):J=u.index+u[0].length;break;case"interior":if(!n.cellStyles)break;L.Interior=Vr(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?Tk(ne,le,r.slice(Q,u.index)):Q=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else d.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"));ZF(ye),Re.push(ye)}else d.push([u[3],!1]),h=Vr(u[0]),ye={a:h.Author};break;case"autofilter":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var et=Vr(u[0]);v["!autofilter"]={ref:Ls(et.Range).replace(/\$/g,"")},d.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((h=d.pop())[0]!==u[3])throw new Error("Bad state: "+h.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&d.push([u[3],!0]);break;case"null":break;default:if(d.length==0&&u[3]=="document"||d.length==0&&u[3]=="uof")return qg(r,n);var dt=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:dt=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:dt=!1}break;case"excelworkbook":switch(u[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:dt=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:dt=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(r.slice(Q,u.index)){case"SheetHidden":K.Hidden=1;break;case"SheetVeryHidden":K.Hidden=2;break}else Q=u.index+u[0].length;break;case"header":v["!margins"]||La(v["!margins"]={},"xlml"),isNaN(+Ye(u[0]).Margin)||(v["!margins"].header=+Ye(u[0]).Margin);break;case"footer":v["!margins"]||La(v["!margins"]={},"xlml"),isNaN(+Ye(u[0]).Margin)||(v["!margins"].footer=+Ye(u[0]).Margin);break;case"pagemargins":var tt=Ye(u[0]);v["!margins"]||La(v["!margins"]={},"xlml"),isNaN(+tt.Top)||(v["!margins"].top=+tt.Top),isNaN(+tt.Left)||(v["!margins"].left=+tt.Left),isNaN(+tt.Right)||(v["!margins"].right=+tt.Right),isNaN(+tt.Bottom)||(v["!margins"].bottom=+tt.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:dt=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:dt=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:dt=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:dt=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:dt=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:dt=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:dt=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:dt=!1}break;case"smarttags":break;default:dt=!1;break}if(dt||u[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+d.join("|");if(d[d.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?KF(te,le,me,r.slice(Q,u.index)):(me=u,Q=u.index+u[0].length);break}if(n.WTF)throw"Unrecognized tag: "+u[3]+"|"+d.join("|")}var Be={};return!n.bookSheets&&!n.bookProps&&(Be.Sheets=m),Be.SheetNames=x,Be.Workbook=q,Be.SSF=Mt(Ke),Be.Props=ne,Be.Custprops=te,Be}function G0(e,t){switch($d(t=t||{}),t.type||"base64"){case"base64":return k0(hr(e),t);case"binary":case"buffer":case"file":return k0(e,t);case"array":return k0(la(e),t)}}function QF(e,t){var n=[];return e.Props&&n.push(kk(e.Props,t)),e.Custprops&&n.push(Sk(e.Props,e.Custprops)),n.join("")}function e3(){return""}function t3(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(Me("NumberFormat",null,{"ss:Format":kt(Ke[r.numFmtId])}));var o={"ss:ID":"s"+(21+i)};n.push(Me("Style",s.join(""),o))}),Me("Styles",n.join(""))}function _y(e){return Me("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+zd(e.Ref,{r:0,c:0})})}function n3(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(_y(i)))}return Me("Names",n.join(""))}function r3(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],o=0;o<i.length;++o){var u=i[o];u.Sheet==n&&(u.Name.match(/^_xlfn\./)||s.push(_y(u)))}return s.join("")}function i3(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Me("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Me("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Me("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(Me("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Sn("ProtectContents","True")),e["!protect"].objects&&i.push(Sn("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Sn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Sn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Sn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Me("WorksheetOptions",i.join(""),{xmlns:lr.x})}function a3(e){return e.map(function(t){var n=CT(t.t||""),r=Me("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Me("Comment",r,{"ss:Author":t.a})}).join("")}function s3(e,t,n,r,i,s,o){if(!e||e.v==null&&e.f==null)return"";var u={};if(e.f&&(u["ss:Formula"]="="+kt(zd(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var d=Wt(e.F.slice(t.length+1));u["ss:ArrayRange"]="RC:R"+(d.r==o.r?"":"["+(d.r-o.r)+"]")+"C"+(d.c==o.c?"":"["+(d.c-o.c)+"]")}if(e.l&&e.l.Target&&(u["ss:HRef"]=kt(e.l.Target),e.l.Tooltip&&(u["x:HRefScreenTip"]=kt(e.l.Tooltip))),n["!merges"])for(var h=n["!merges"],m=0;m!=h.length;++m)h[m].s.c!=o.c||h[m].s.r!=o.r||(h[m].e.c>h[m].s.c&&(u["ss:MergeAcross"]=h[m].e.c-h[m].s.c),h[m].e.r>h[m].s.r&&(u["ss:MergeDown"]=h[m].e.r-h[m].s.r));var x="",v="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":x="Number",v=String(e.v);break;case"b":x="Boolean",v=e.v?"1":"0";break;case"e":x="Error",v=Ii[e.v];break;case"d":x="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ke[14]);break;case"s":x="String",v=ET(e.v||"");break}var _=ca(r.cellXfs,e,r);u["ss:StyleID"]="s"+(21+_),u["ss:Index"]=o.c+1;var S=e.v!=null?v:"",T=e.t=="z"?"":'<Data ss:Type="'+x+'">'+S+"</Data>";return(e.c||[]).length>0&&(T+=a3(e.c)),Me("Cell",T,u)}function o3(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ws(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function l3(e,t,n,r){if(!e["!ref"])return"";var i=ct(e["!ref"]),s=e["!merges"]||[],o=0,u=[];e["!cols"]&&e["!cols"].forEach(function(E,C){aa(E);var I=!!E.width,A=_c(C,E),D={"ss:Index":C+1};I&&(D["ss:Width"]=rl(A.width)),E.hidden&&(D["ss:Hidden"]="1"),u.push(Me("Column",null,D))});for(var d=Array.isArray(e),h=i.s.r;h<=i.e.r;++h){for(var m=[o3(h,(e["!rows"]||[])[h])],x=i.s.c;x<=i.e.c;++x){var v=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>x)&&!(s[o].s.r>h)&&!(s[o].e.c<x)&&!(s[o].e.r<h)){(s[o].s.c!=x||s[o].s.r!=h)&&(v=!0);break}if(!v){var _={r:h,c:x},S=Je(_),T=d?(e[h]||[])[x]:e[S];m.push(s3(T,S,e,t,n,r,_))}}m.push("</Row>"),m.length>2&&u.push(m.join(""))}return u.join("")}function u3(e,t,n){var r=[],i=n.SheetNames[e],s=n.Sheets[i],o=s?r3(s,t,e,n):"";return o.length>0&&r.push("<Names>"+o+"</Names>"),o=s?l3(s,t,e,n):"",o.length>0&&r.push("<Table>"+o+"</Table>"),r.push(i3(s,t,e,n)),r.join("")}function c3(e,t){t||(t={}),e.SSF||(e.SSF=Mt(Ke)),e.SSF&&($s(),pc(e.SSF),t.revssf=gc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],ca(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(QF(e,t)),n.push(e3()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Me("Worksheet",u3(r,t,e),{"ss:Name":kt(e.SheetNames[r])}));return n[2]=t3(e,t),n[3]=n3(e),en+Me("Workbook",n.join(""),{xmlns:lr.ss,"xmlns:o":lr.o,"xmlns:x":lr.x,"xmlns:ss":lr.ss,"xmlns:dt":lr.dt,"xmlns:html":lr.html})}function f3(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=nk(n),n.length-n.l<=4)return t;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=rk(n),r=n.read_shift(4),r==0||r>40))return t;n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr")}var d3=[60,1084,2066,2165,2175];function h3(e,t,n,r,i){var s=r,o=[],u=n.slice(n.l,n.l+s);if(i&&i.enc&&i.enc.insitu&&u.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(u)}o.push(u),n.l+=s;for(var d=yi(n,n.l),h=$0[d],m=0;h!=null&&d3.indexOf(d)>-1;)s=yi(n,n.l+2),m=n.l+4,d==2066?m+=4:(d==2165||d==2175)&&(m+=12),u=n.slice(m,n.l+4+s),o.push(u),n.l+=4+s,h=$0[d=yi(n,n.l)];var x=gn(o);kn(x,0);var v=0;x.lens=[];for(var _=0;_<o.length;++_)x.lens.push(v),v+=o[_].length;if(x.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+r;return t.f(x,x.length,i)}function ei(e,t,n){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ke[r])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ii[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Yo(e.v):e.w=Ua(e.v):e.w=Fr(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&r&&e.t=="n"&&Gs(Ke[r]||String(r))){var i=Ra(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Lu(e,t,n){return{v:e,ixfe:t,t:n}}function p3(e,t){var n={opts:{}},r={},i=t.dense?[]:{},s={},o={},u=null,d=[],h="",m={},x,v="",_,S,T,E,C={},I=[],A,D,P=[],L=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},J={},V=function(Qe){return Qe<8?Da[Qe]:Qe<64&&L[Qe-8]||Da[Qe]},ne=function(Qe,gt,ot){var Ot=gt.XF.data;if(!(!Ot||!Ot.patternType||!ot||!ot.cellStyles)){gt.s={},gt.s.patternType=Ot.patternType;var rr;(rr=nl(V(Ot.icvFore)))&&(gt.s.fgColor={rgb:rr}),(rr=nl(V(Ot.icvBack)))&&(gt.s.bgColor={rgb:rr})}},te=function(Qe,gt,ot){if(!(ue>1)&&!(ot.sheetRows&&Qe.r>=ot.sheetRows)){if(ot.cellStyles&&gt.XF&&gt.XF.data&&ne(Qe,gt,ot),delete gt.ixfe,delete gt.XF,x=Qe,v=Je(Qe),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Qe.r<o.s.r&&(o.s.r=Qe.r),Qe.c<o.s.c&&(o.s.c=Qe.c),Qe.r+1>o.e.r&&(o.e.r=Qe.r+1),Qe.c+1>o.e.c&&(o.e.c=Qe.c+1),ot.cellFormula&&gt.f){for(var Ot=0;Ot<I.length;++Ot)if(!(I[Ot][0].s.c>Qe.c||I[Ot][0].s.r>Qe.r)&&!(I[Ot][0].e.c<Qe.c||I[Ot][0].e.r<Qe.r)){gt.F=nt(I[Ot][0]),(I[Ot][0].s.c!=Qe.c||I[Ot][0].s.r!=Qe.r)&&delete gt.f,gt.f&&(gt.f=""+Dn(I[Ot][1],o,Qe,Z,Q));break}}ot.dense?(i[Qe.r]||(i[Qe.r]=[]),i[Qe.r][Qe.c]=gt):i[v]=gt}},Q={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Q.password=t.password);var me,Re=[],ye=[],De=[],Ce=[],ke=!1,Z=[];Z.SheetNames=Q.snames,Z.sharedf=Q.sharedf,Z.arrayf=Q.arrayf,Z.names=[],Z.XTI=[];var H=0,ue=0,B=0,X=[],q=[],K;Q.codepage=1200,Hr(1200);for(var le=!1;e.l<e.length-1;){var xe=e.l,ve=e.read_shift(2);if(ve===0&&H===10)break;var we=e.l===e.length?0:e.read_shift(2),Ae=$0[ve];if(Ae&&Ae.f){if(t.bookSheets&&H===133&&ve!==133)break;if(H=ve,Ae.r===2||Ae.r==12){var Xe=e.read_shift(2);if(we-=2,!Q.enc&&Xe!==ve&&((Xe&255)<<8|Xe>>8)!==ve)throw new Error("rt mismatch: "+Xe+"!="+ve);Ae.r==12&&(e.l+=10,we-=10)}var G={};if(ve===10?G=Ae.f(e,we,Q):G=h3(ve,Ae,e,we,Q),ue==0&&[9,521,1033,2057].indexOf(H)===-1)continue;switch(ve){case 34:n.opts.Date1904=R.WBProps.date1904=G;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(Q.enc||(e.l=0),Q.enc=G,!t.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:Q.lastuser=G;break;case 66:var ft=Number(G);switch(ft){case 21010:ft=1200;break;case 32768:ft=1e4;break;case 32769:ft=1252;break}Hr(Q.codepage=ft),le=!0;break;case 317:Q.rrtabid=G;break;case 25:Q.winlocked=G;break;case 439:n.opts.RefreshAll=G;break;case 12:n.opts.CalcCount=G;break;case 16:n.opts.CalcDelta=G;break;case 17:n.opts.CalcIter=G;break;case 13:n.opts.CalcMode=G;break;case 14:n.opts.CalcPrecision=G;break;case 95:n.opts.CalcSaveRecalc=G;break;case 15:Q.CalcRefMode=G;break;case 2211:n.opts.FullCalc=G;break;case 129:G.fDialog&&(i["!type"]="dialog"),G.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),G.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:P.push(G);break;case 430:Z.push([G]),Z[Z.length-1].XTI=[];break;case 35:case 547:Z[Z.length-1].push(G);break;case 24:case 536:K={Name:G.Name,Ref:Dn(G.rgce,o,null,Z,Q)},G.itab>0&&(K.Sheet=G.itab-1),Z.names.push(K),Z[0]||(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(q[G.itab-1]={ref:nt(G.rgce[0][0][1][2])});break;case 22:Q.ExternCount=G;break;case 23:Z.length==0&&(Z[0]=[],Z[0].XTI=[]),Z[Z.length-1].XTI=Z[Z.length-1].XTI.concat(G),Z.XTI=Z.XTI.concat(G);break;case 2196:if(Q.biff<8)break;K!=null&&(K.Comment=G[1]);break;case 18:i["!protect"]=G;break;case 19:G!==0&&Q.WTF&&console.error("Password verifier: "+G);break;case 133:s[G.pos]=G,Q.snames.push(G.name);break;case 10:{if(--ue)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=nt(o),t.sheetRows&&t.sheetRows<=o.e.r){var et=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=nt(o),o.e.r=et}o.e.r++,o.e.c++}Re.length>0&&(i["!merges"]=Re),ye.length>0&&(i["!objects"]=ye),De.length>0&&(i["!cols"]=De),Ce.length>0&&(i["!rows"]=Ce),R.Sheets.push(J)}h===""?m=i:r[h]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Q.biff===8&&(Q.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),Q.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(Q.biff=5,le=!0,Hr(Q.codepage=28591)),Q.biff==8&&G.BIFFVer==0&&G.dt==16&&(Q.biff=2),ue++)break;if(i=t.dense?[]:{},Q.biff<8&&!le&&(le=!0,Hr(Q.codepage=t.codepage||1252)),Q.biff<5||G.BIFFVer==0&&G.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var dt={pos:e.l-we,name:h};s[dt.pos]=dt,Q.snames.push(h)}else h=(s[xe]||{name:""}).name;G.dt==32&&(i["!type"]="chart"),G.dt==64&&(i["!type"]="macro"),Re=[],ye=[],Q.arrayf=I=[],De=[],Ce=[],ke=!1,J={Hidden:(s[xe]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[G.r]||[])[G.c]:i[Je({c:G.c,r:G.r})])&&++G.c,A={ixfe:G.ixfe,XF:P[G.ixfe]||{},v:G.val,t:"n"},B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te({c:G.c,r:G.r},A,t);break;case 5:case 517:A={ixfe:G.ixfe,XF:P[G.ixfe],v:G.val,t:G.t},B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te({c:G.c,r:G.r},A,t);break;case 638:A={ixfe:G.ixfe,XF:P[G.ixfe],v:G.rknum,t:"n"},B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te({c:G.c,r:G.r},A,t);break;case 189:for(var tt=G.c;tt<=G.C;++tt){var Be=G.rkrec[tt-G.c][0];A={ixfe:Be,XF:P[Be],v:G.rkrec[tt-G.c][1],t:"n"},B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te({c:tt,r:G.r},A,t)}break;case 6:case 518:case 1030:{if(G.val=="String"){u=G;break}if(A=Lu(G.val,G.cell.ixfe,G.tt),A.XF=P[A.ixfe],t.cellFormula){var yt=G.formula;if(yt&&yt[0]&&yt[0][0]&&yt[0][0][0]=="PtgExp"){var At=yt[0][0][1][0],Lt=yt[0][0][1][1],on=Je({r:At,c:Lt});C[on]?A.f=""+Dn(G.formula,o,G.cell,Z,Q):A.F=((t.dense?(i[At]||[])[Lt]:i[on])||{}).F}else A.f=""+Dn(G.formula,o,G.cell,Z,Q)}B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te(G.cell,A,t),u=G}break;case 7:case 519:if(u)u.val=G,A=Lu(G,u.cell.ixfe,"s"),A.XF=P[A.ixfe],t.cellFormula&&(A.f=""+Dn(u.formula,o,u.cell,Z,Q)),B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te(u.cell,A,t),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(G);var Dr=Je(G[0].s);if(_=t.dense?(i[G[0].s.r]||[])[G[0].s.c]:i[Dr],t.cellFormula&&_){if(!u||!Dr||!_)break;_.f=""+Dn(G[1],o,G[0],Z,Q),_.F=nt(G[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!u)break;C[Je(u.cell)]=G[0],_=t.dense?(i[u.cell.r]||[])[u.cell.c]:i[Je(u.cell)],(_||{}).f=""+Dn(G[0],o,x,Z,Q)}}break;case 253:A=Lu(d[G.isst].t,G.ixfe,"s"),d[G.isst].h&&(A.h=d[G.isst].h),A.XF=P[A.ixfe],B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te({c:G.c,r:G.r},A,t);break;case 513:t.sheetStubs&&(A={ixfe:G.ixfe,XF:P[G.ixfe],t:"z"},B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te({c:G.c,r:G.r},A,t));break;case 190:if(t.sheetStubs)for(var tr=G.c;tr<=G.C;++tr){var Bt=G.ixfe[tr-G.c];A={ixfe:Bt,XF:P[Bt],t:"z"},B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te({c:tr,r:G.r},A,t)}break;case 214:case 516:case 4:A=Lu(G.val,G.ixfe,"s"),A.XF=P[A.ixfe],B>0&&(A.z=X[A.ixfe>>8&63]),ei(A,t,n.opts.Date1904),te({c:G.c,r:G.r},A,t);break;case 0:case 512:ue===1&&(o=G);break;case 252:d=G;break;case 1054:if(Q.biff==4){X[B++]=G[1];for(var yn=0;yn<B+163&&Ke[yn]!=G[1];++yn);yn>=163&&Ti(G[1],B+163)}else Ti(G[1],G[0]);break;case 30:{X[B++]=G;for(var Xt=0;Xt<B+163&&Ke[Xt]!=G;++Xt);Xt>=163&&Ti(G,B+163)}break;case 229:Re=Re.concat(G);break;case 93:ye[G.cmo[0]]=Q.lastobj=G;break;case 438:Q.lastobj.TxO=G;break;case 127:Q.lastobj.ImData=G;break;case 440:for(E=G[0].s.r;E<=G[0].e.r;++E)for(T=G[0].s.c;T<=G[0].e.c;++T)_=t.dense?(i[E]||[])[T]:i[Je({c:T,r:E})],_&&(_.l=G[1]);break;case 2048:for(E=G[0].s.r;E<=G[0].e.r;++E)for(T=G[0].s.c;T<=G[0].e.c;++T)_=t.dense?(i[E]||[])[T]:i[Je({c:T,r:E})],_&&_.l&&(_.l.Tooltip=G[1]);break;case 28:{if(Q.biff<=5&&Q.biff>=2)break;_=t.dense?(i[G[0].r]||[])[G[0].c]:i[Je(G[0])];var nr=ye[G[2]];_||(t.dense?(i[G[0].r]||(i[G[0].r]=[]),_=i[G[0].r][G[0].c]={t:"z"}):_=i[Je(G[0])]={t:"z"},o.e.r=Math.max(o.e.r,G[0].r),o.s.r=Math.min(o.s.r,G[0].r),o.e.c=Math.max(o.e.c,G[0].c),o.s.c=Math.min(o.s.c,G[0].c)),_.c||(_.c=[]),S={a:G[1],t:nr.TxO.t},_.c.push(S)}break;case 2173:tA(P[G.ixfe],G.ext);break;case 125:{if(!Q.cellStyles)break;for(;G.e>=G.s;)De[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},ke||(ke=!0,Bd(G.w/256)),aa(De[G.e+1])}break;case 520:{var Gt={};G.level!=null&&(Ce[G.r]=Gt,Gt.level=G.level),G.hidden&&(Ce[G.r]=Gt,Gt.hidden=!0),G.hpt&&(Ce[G.r]=Gt,Gt.hpt=G.hpt,Gt.hpx=Ws(G.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||La(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=G;break;case 161:i["!margins"]||La(i["!margins"]={}),i["!margins"].header=G.header,i["!margins"].footer=G.footer;break;case 574:G.RTL&&(R.Views[0].RTL=!0);break;case 146:L=G;break;case 2198:me=G;break;case 140:D=G;break;case 442:h?J.CodeName=G||J.name:R.WBProps.CodeName=G||"ThisWorkbook";break}}else Ae||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),e.l+=we}return n.SheetNames=Jt(s).sort(function(En,Qe){return Number(En)-Number(Qe)}).map(function(En){return s[En].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&m["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=m)):n.Preamble=m,n.Sheets&&q.forEach(function(En,Qe){n.Sheets[n.SheetNames[Qe]]["!autofilter"]=En}),n.Strings=d,n.SSF=Mt(Ke),Q.enc&&(n.Encryption=Q.enc),me&&(n.Themes=me),n.Metadata={},D!==void 0&&(n.Metadata.Country=D),Z.names.length>0&&(R.Names=Z.names),n.Workbook=R,n}var qo={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function m3(e,t,n){var r=We.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=kg(r,U0,qo.DSI);for(var s in i)t[s]=i[s]}catch(h){if(n.WTF)throw h}var o=We.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var u=kg(o,z0,qo.SI);for(var d in u)t[d]==null&&(t[d]=u[d])}catch(h){if(n.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(wv(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}function g3(e,t){var n=[],r=[],i=[],s=0,o,u=Qm(U0,"n"),d=Qm(z0,"n");if(e.Props)for(o=Jt(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(u,o[s])?n:Object.prototype.hasOwnProperty.call(d,o[s])?r:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=Jt(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(u,o[s])?n:Object.prototype.hasOwnProperty.call(d,o[s])?r:i).push([o[s],e.Custprops[o[s]]]);var h=[];for(s=0;s<i.length;++s)Av.indexOf(i[s][0])>-1||yv.indexOf(i[s][0])>-1||i[s][1]!=null&&h.push(i[s]);r.length&&We.utils.cfb_add(t,"/SummaryInformation",Sg(r,qo.SI,d,z0)),(n.length||h.length)&&We.utils.cfb_add(t,"/DocumentSummaryInformation",Sg(n,qo.DSI,u,U0,h.length?h:null,qo.UDI))}function Ty(e,t){t||(t={}),$d(t),dd(),t.codepage&&fd(t.codepage);var n,r;if(e.FullPaths){if(We.find(e,"/encryption"))throw new Error("File is password-protected");n=We.find(e,"!CompObj"),r=We.find(e,"/Workbook")||We.find(e,"/Book")}else{switch(t.type){case"base64":e=cr(hr(e));break;case"binary":e=cr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}kn(e,0),r={content:e}}var i,s;if(n&&f3(n),t.bookProps&&!t.bookSheets)i={};else{var o=it?"buffer":"array";if(r&&r.content)i=p3(r.content,t);else if((s=We.find(e,"PerfectOffice_MAIN"))&&s.content)i=Ma.to_workbook(s.content,(t.type=o,t));else if((s=We.find(e,"NativeContent_MAIN"))&&s.content)i=Ma.to_workbook(s.content,(t.type=o,t));else throw(s=We.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&We.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=NA(e))}var u={};return e.FullPaths&&m3(e,u,t),i.Props=i.Custprops=u,t.bookFiles&&(i.cfb=e),i}function x3(e,t){var n=t||{},r=We.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return We.utils.cfb_add(r,i,ky(e,n)),n.biff==8&&(e.Props||e.Custprops)&&g3(e,r),n.biff==8&&e.vbaraw&&FA(r,We.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var sl={0:{f:VI},1:{f:JI},2:{f:pN},3:{f:rN},4:{f:QI},5:{f:fN},6:{f:yN},7:{f:oN},8:{f:CN},9:{f:EN},10:{f:kN},11:{f:SN},12:{f:YI},13:{f:gN},14:{f:aN},15:{f:tN},16:{f:py},17:{f:_N},18:{f:uN},19:{f:Cd},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:_F},40:{},42:{},43:{f:yC},44:{f:xC},45:{f:TC},46:{f:SC},47:{f:kC},48:{},49:{f:GT},50:{},51:{f:iA},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Uv},62:{f:vN},63:{f:hA},64:{f:HN},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:On,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:UN},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:qI},148:{f:GI,p:16},151:{f:DN},152:{},153:{f:vF},154:{},155:{},156:{f:gF},157:{},158:{},159:{T:1,f:ME},160:{T:-1},161:{T:1,f:Ja},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:AN},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:nA},336:{T:-1},337:{f:oA,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:O0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ov},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:PN},427:{f:MN},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:BN},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:jI},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:FN},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:O0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:SA},633:{T:1},634:{T:-1},635:{T:1,f:TA},636:{T:-1},637:{f:KT},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:aF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:WN},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},$0={6:{f:_0},10:{f:Qi},12:{f:sn},13:{f:sn},14:{f:Zt},15:{f:Zt},16:{f:Mn},17:{f:Zt},18:{f:Zt},19:{f:sn},20:{f:Fg},21:{f:Fg},23:{f:Ov},24:{f:Dg},25:{f:Zt},26:{},27:{},28:{f:WS},29:{},34:{f:Zt},35:{f:Rg},38:{f:Mn},39:{f:Mn},40:{f:Mn},41:{f:Mn},42:{f:Zt},43:{f:Zt},47:{f:tC},49:{f:gS},51:{f:sn},60:{},61:{f:fS},64:{f:Zt},65:{f:mS},66:{f:sn},77:{},80:{},81:{},82:{},85:{f:sn},89:{},90:{},91:{},92:{f:eS},93:{f:jS},94:{},95:{f:Zt},96:{},97:{},99:{f:Zt},125:{f:Uv},128:{f:RS},129:{f:nS},130:{f:sn},131:{f:Zt},132:{f:Zt},133:{f:rS},134:{},140:{f:eE},141:{f:sn},144:{},146:{f:rE},151:{},152:{},153:{},154:{},155:{},156:{f:sn},157:{},158:{},160:{f:cE},161:{f:sE},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:AS},190:{f:IS},193:{f:Qi},197:{},198:{},199:{},200:{},201:{},202:{f:Zt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:sn},220:{},221:{f:Zt},222:{},224:{f:FS},225:{f:Qk},226:{f:Qi},227:{},229:{f:GS},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:aS},253:{f:vS},255:{f:oS},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Iv},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Zt},353:{f:Qi},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:BS},431:{f:Zt},432:{},433:{},434:{},437:{},438:{f:JS},439:{f:Zt},440:{f:XS},441:{},442:{f:dl},443:{},444:{f:sn},445:{},446:{},448:{f:Qi},449:{f:cS,r:2},450:{f:Qi},512:{f:Ag},513:{f:uE},515:{f:MS},516:{f:wS},517:{f:Ng},519:{f:fE},520:{f:lS},523:{},545:{f:Pg},549:{f:Cg},566:{},574:{f:hS},638:{f:CS},659:{},1048:{},1054:{f:TS},1084:{},1212:{f:bS},2048:{f:ZS},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Du},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Qi},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:iE,r:12},2173:{f:eA,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Zt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:zS,r:12},2197:{},2198:{f:KC,r:12},2199:{},2200:{},2201:{},2202:{f:VS,r:12},2203:{f:Qi},2204:{},2205:{},2206:{},2207:{},2211:{f:uS},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:sn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:oE},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:nE},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ag},1:{},2:{f:gE},3:{f:pE},4:{f:hE},5:{f:Ng},7:{f:vE},8:{},9:{f:Du},11:{},22:{f:sn},30:{f:SS},31:{},32:{},33:{f:Pg},36:{},37:{f:Cg},50:{f:yE},62:{},52:{},67:{},68:{f:sn},69:{},86:{},126:{},127:{f:dE},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:wE},223:{},234:{},354:{},421:{},518:{f:_0},521:{f:Du},536:{f:Dg},547:{f:Rg},561:{},579:{},1030:{f:_0},1033:{f:Du},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Le(e,t,n,r){var i=t;if(!isNaN(i)){var s=r||(n||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&kd(n)&&e.push(n)}}function v3(e,t,n,r){var i=(n||[]).length||0;if(i<=8224)return Le(e,t,n,i);var s=t;if(!isNaN(s)){for(var o=n.parts||[],u=0,d=0,h=0;h+(o[u]||8224)<=8224;)h+=o[u]||8224,u++;var m=e.next(4);for(m.write_shift(2,s),m.write_shift(2,h),e.push(n.slice(d,d+h)),d+=h;d<i;){for(m=e.next(4),m.write_shift(2,60),h=0;h+(o[u]||8224)<=8224;)h+=o[u]||8224,u++;m.write_shift(2,h),e.push(n.slice(d,d+h)),d+=h}}}function gl(e,t,n){return e||(e=he(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function y3(e,t,n,r){var i=he(9);return gl(i,e,t),Nv(n,r||"b",i),i}function w3(e,t,n){var r=he(8+2*n.length);return gl(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function _3(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?fn(Pt(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Le(e,2,xE(n,r,i)):Le(e,3,mE(n,r,i));return;case"b":case"e":Le(e,5,y3(n,r,t.v,t.t));return;case"s":case"str":Le(e,4,w3(n,r,(t.v||"").slice(0,255)));return}Le(e,1,gl(null,n,r))}function T3(e,t,n,r){var i=Array.isArray(t),s=ct(t["!ref"]||"A1"),o,u="",d=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=nt(s)}for(var h=s.s.r;h<=s.e.r;++h){u=Qt(h);for(var m=s.s.c;m<=s.e.c;++m){h===s.s.r&&(d[m]=Ht(m)),o=d[m]+u;var x=i?(t[h]||[])[m]:t[o];x&&_3(e,x,h,m)}}}function k3(e,t){for(var n=t||{},r=Zn(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Le(r,n.biff==4?1033:n.biff==3?521:9,Pd(e,16,n)),T3(r,e.Sheets[e.SheetNames[i]],i,n),Le(r,10),r.end()}function S3(e,t,n){Le(e,49,xS({sz:12,name:"Arial"},n))}function E3(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Le(e,1054,kS(i,t[i],n))})}function C3(e,t){var n=he(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Le(e,2151,n),n=he(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),Mv(ct(t["!ref"]||"A1"),n),n.write_shift(4,4),Le(e,2152,n)}function A3(e,t){for(var n=0;n<16;++n)Le(e,224,Ig({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){Le(e,224,Ig(r,0,t))})}function I3(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];Le(e,440,YS(r)),r[1].Tooltip&&Le(e,2048,QS(r))}delete t["!links"]}function N3(e,t){if(t){var n=0;t.forEach(function(r,i){++n<=256&&r&&Le(e,125,aE(_c(i,r),i))})}}function F3(e,t,n,r,i){var s=16+ca(i.cellXfs,t,i);if(t.v==null&&!t.bf){Le(e,513,Ha(n,r,s));return}if(t.bf)Le(e,6,nI(t,n,r,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?fn(Pt(t.v)):t.v;Le(e,515,LS(n,r,o,s));break;case"b":case"e":Le(e,517,PS(n,r,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var u=Vd(i.Strings,t.v,i.revStrings);Le(e,253,yS(n,r,u,s))}else Le(e,516,_S(n,r,(t.v||"").slice(0,255),s,i));break;default:Le(e,513,Ha(n,r,s))}}function R3(e,t,n){var r=Zn(),i=n.SheetNames[e],s=n.Sheets[i]||{},o=(n||{}).Workbook||{},u=(o.Sheets||[])[e]||{},d=Array.isArray(s),h=t.biff==8,m,x="",v=[],_=ct(s["!ref"]||"A1"),S=h?65536:16384;if(_.e.c>255||_.e.r>=S){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");_.e.c=Math.min(_.e.c,255),_.e.r=Math.min(_.e.c,S-1)}Le(r,2057,Pd(n,16,t)),Le(r,13,Cr(1)),Le(r,12,Cr(100)),Le(r,15,Hn(!0)),Le(r,17,Hn(!1)),Le(r,16,ba(.001)),Le(r,95,Hn(!0)),Le(r,42,Hn(!1)),Le(r,43,Hn(!1)),Le(r,130,Cr(1)),Le(r,128,DS()),Le(r,131,Hn(!1)),Le(r,132,Hn(!1)),h&&N3(r,s["!cols"]),Le(r,512,ES(_,t)),h&&(s["!links"]=[]);for(var T=_.s.r;T<=_.e.r;++T){x=Qt(T);for(var E=_.s.c;E<=_.e.c;++E){T===_.s.r&&(v[E]=Ht(E)),m=v[E]+x;var C=d?(s[T]||[])[E]:s[m];C&&(F3(r,C,T,E,t),h&&C.l&&s["!links"].push([m,C.l]))}}var I=u.CodeName||u.name||i;return h&&Le(r,574,pS((o.Views||[])[0])),h&&(s["!merges"]||[]).length&&Le(r,229,$S(s["!merges"])),h&&I3(r,s),Le(r,442,Fv(I)),h&&C3(r,s),Le(r,10),r.end()}function D3(e,t,n){var r=Zn(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},u=n.biff==8,d=n.biff==5;if(Le(r,2057,Pd(e,5,n)),n.bookType=="xla"&&Le(r,135),Le(r,225,u?Cr(1200):null),Le(r,193,Pk(2)),d&&Le(r,191),d&&Le(r,192),Le(r,226),Le(r,92,tS("SheetJS",n)),Le(r,66,Cr(u?1200:1252)),u&&Le(r,353,Cr(0)),u&&Le(r,448),Le(r,317,lE(e.SheetNames.length)),u&&e.vbaraw&&Le(r,211),u&&e.vbaraw){var h=o.CodeName||"ThisWorkbook";Le(r,442,Fv(h))}Le(r,156,Cr(17)),Le(r,25,Hn(!1)),Le(r,18,Hn(!1)),Le(r,19,Cr(0)),u&&Le(r,431,Hn(!1)),u&&Le(r,444,Cr(0)),Le(r,61,dS()),Le(r,64,Hn(!1)),Le(r,141,Cr(0)),Le(r,34,Hn(cF(e)=="true")),Le(r,14,Hn(!0)),u&&Le(r,439,Hn(!1)),Le(r,218,Cr(0)),S3(r,e,n),E3(r,e.SSF,n),A3(r,n),u&&Le(r,352,Hn(!1));var m=r.end(),x=Zn();u&&Le(x,140,tE()),u&&n.Strings&&v3(x,252,sS(n.Strings)),Le(x,10);var v=x.end(),_=Zn(),S=0,T=0;for(T=0;T<e.SheetNames.length;++T)S+=(u?12:11)+(u?2:1)*e.SheetNames[T].length;var E=m.length+S+v.length;for(T=0;T<e.SheetNames.length;++T){var C=s[T]||{};Le(_,133,iS({pos:E,hs:C.Hidden||0,dt:0,name:e.SheetNames[T]},n)),E+=t[T].length}var I=_.end();if(S!=I.length)throw new Error("BS8 "+S+" != "+I.length);var A=[];return m.length&&A.push(m),I.length&&A.push(I),v.length&&A.push(v),gn(A)}function P3(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=Mt(Ke)),e&&e.SSF&&($s(),pc(e.SSF),n.revssf=gc(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,jd(n),n.cellXfs=[],ca(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=R3(i,n,e);return r.unshift(D3(e,r,n)),gn(r)}function ky(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var i=Qn(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return P3(e,t);case 4:case 3:case 2:return k3(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function Wg(e,t){var n=t||{},r=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,u=s&&s.index||e.length,d=xT(e.slice(o,u),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,m=0,x=0,v=0,_={s:{r:1e7,c:1e7},e:{r:0,c:0}},S=[];for(o=0;o<d.length;++o){var T=d[o].trim(),E=T.slice(0,3).toLowerCase();if(E=="<tr"){if(++h,n.sheetRows&&n.sheetRows<=h){--h;break}m=0;continue}if(!(E!="<td"&&E!="<th")){var C=T.split(/<\/t[dh]>/i);for(u=0;u<C.length;++u){var I=C[u].trim();if(I.match(/<t[dh]/i)){for(var A=I,D=0;A.charAt(0)=="<"&&(D=A.indexOf(">"))>-1;)A=A.slice(D+1);for(var P=0;P<S.length;++P){var L=S[P];L.s.c==m&&L.s.r<h&&h<=L.e.r&&(m=L.e.c+1,P=-1)}var R=Ye(I.slice(0,I.indexOf(">")));v=R.colspan?+R.colspan:1,((x=+R.rowspan)>1||v>1)&&S.push({s:{r:h,c:m},e:{r:h+(x||1)-1,c:m+v-1}});var J=R.t||R["data-t"]||"";if(!A.length){m+=v;continue}if(A=q1(A),_.s.r>h&&(_.s.r=h),_.e.r<h&&(_.e.r=h),_.s.c>m&&(_.s.c=m),_.e.c<m&&(_.e.c=m),!A.length){m+=v;continue}var V={t:"s",v:A};n.raw||!A.trim().length||J=="s"||(A==="TRUE"?V={t:"b",v:!0}:A==="FALSE"?V={t:"b",v:!1}:isNaN(Gr(A))?isNaN(Vs(A).getDate())||(V={t:"d",v:Pt(A)},n.cellDates||(V={t:"n",v:fn(V.v)}),V.z=n.dateNF||Ke[14]):V={t:"n",v:Gr(A)}),n.dense?(r[h]||(r[h]=[]),r[h][m]=V):r[Je({r:h,c:m})]=V,m+=v}}}}return r["!ref"]=nt(_),S.length&&(r["!merges"]=S),r}function M3(e,t,n,r){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var u=0,d=0,h=0;h<i.length;++h)if(!(i[h].s.r>n||i[h].s.c>o)&&!(i[h].e.r<n||i[h].e.c<o)){if(i[h].s.r<n||i[h].s.c<o){u=-1;break}u=i[h].e.r-i[h].s.r+1,d=i[h].e.c-i[h].s.c+1;break}if(!(u<0)){var m=Je({r:n,c:o}),x=r.dense?(e[n]||[])[o]:e[m],v=x&&x.v!=null&&(x.h||wd(x.w||(Si(x),x.w)||""))||"",_={};u>1&&(_.rowspan=u),d>1&&(_.colspan=d),r.editable?v='<span contenteditable="true">'+v+"</span>":x&&(_["data-t"]=x&&x.t||"z",x.v!=null&&(_["data-v"]=x.v),x.z!=null&&(_["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+x.l.Target+'">'+v+"</a>")),_.id=(r.id||"sjs")+"-"+m,s.push(Me("td",v,_))}}var S="<tr>";return S+s.join("")+"</tr>"}var L3='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',B3="</body></html>";function O3(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return ua(Wg(n[0],t),t);var r=Jd();return n.forEach(function(i,s){Xd(r,Wg(i,t),"Sheet"+(s+1))}),r}function U3(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function Sy(e,t){var n=t||{},r=n.header!=null?n.header:L3,i=n.footer!=null?n.footer:B3,s=[r],o=Qn(e["!ref"]);n.dense=Array.isArray(e),s.push(U3(e,o,n));for(var u=o.s.r;u<=o.e.r;++u)s.push(M3(e,o,u,n));return s.push("</table>"+i),s.join("")}function Ey(e,t,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var o=typeof r.origin=="string"?Wt(r.origin):r.origin;i=o.r,s=o.c}var u=t.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,u.length),h={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var m=Qn(e["!ref"]);h.s.r=Math.min(h.s.r,m.s.r),h.s.c=Math.min(h.s.c,m.s.c),h.e.r=Math.max(h.e.r,m.e.r),h.e.c=Math.max(h.e.c,m.e.c),i==-1&&(h.e.r=i=m.e.r+1)}var x=[],v=0,_=e["!rows"]||(e["!rows"]=[]),S=0,T=0,E=0,C=0,I=0,A=0;for(e["!cols"]||(e["!cols"]=[]);S<u.length&&T<d;++S){var D=u[S];if(Gg(D)){if(r.display)continue;_[T]={hidden:!0}}var P=D.children;for(E=C=0;E<P.length;++E){var L=P[E];if(!(r.display&&Gg(L))){var R=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):q1(L.innerHTML),J=L.getAttribute("data-z")||L.getAttribute("z");for(v=0;v<x.length;++v){var V=x[v];V.s.c==C+s&&V.s.r<T+i&&T+i<=V.e.r&&(C=V.e.c+1-s,v=-1)}A=+L.getAttribute("colspan")||1,((I=+L.getAttribute("rowspan")||1)>1||A>1)&&x.push({s:{r:T+i,c:C+s},e:{r:T+i+(I||1)-1,c:C+s+(A||1)-1}});var ne={t:"s",v:R},te=L.getAttribute("data-t")||L.getAttribute("t")||"";R!=null&&(R.length==0?ne.t=te||"z":r.raw||R.trim().length==0||te=="s"||(R==="TRUE"?ne={t:"b",v:!0}:R==="FALSE"?ne={t:"b",v:!1}:isNaN(Gr(R))?isNaN(Vs(R).getDate())||(ne={t:"d",v:Pt(R)},r.cellDates||(ne={t:"n",v:fn(ne.v)}),ne.z=r.dateNF||Ke[14]):ne={t:"n",v:Gr(R)})),ne.z===void 0&&J!=null&&(ne.z=J);var Q="",me=L.getElementsByTagName("A");if(me&&me.length)for(var Re=0;Re<me.length&&!(me[Re].hasAttribute("href")&&(Q=me[Re].getAttribute("href"),Q.charAt(0)!="#"));++Re);Q&&Q.charAt(0)!="#"&&(ne.l={Target:Q}),r.dense?(e[T+i]||(e[T+i]=[]),e[T+i][C+s]=ne):e[Je({c:C+s,r:T+i})]=ne,h.e.c<C+s&&(h.e.c=C+s),C+=A}}++T}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,T-1+i),e["!ref"]=nt(h),T>=d&&(e["!fullref"]=nt((h.e.r=u.length-S+T-1+i,h))),e}function Cy(e,t){var n=t||{},r=n.dense?[]:{};return Ey(r,e,t)}function z3(e,t){return ua(Cy(e,t),t)}function Gg(e){var t="",n=b3(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function b3(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function V3(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=ut(t.replace(/<[^>]*>/g,""));return[n]}var $g={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ay(e,t){var n=t||{},r=_d(e),i=[],s,o,u={name:""},d="",h=0,m,x,v={},_=[],S=n.dense?[]:{},T,E,C={value:""},I="",A=0,D=[],P=-1,L=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},J=0,V={},ne=[],te={},Q=0,me=0,Re=[],ye=1,De=1,Ce=[],ke={Names:[]},Z={},H=["",""],ue=[],B={},X="",q=0,K=!1,le=!1,xe=0;for(el.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");T=el.exec(r);)switch(T[3]=T[3].replace(/_.*$/,"")){case"table":case"":T[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?S["!ref"]=nt(R):S["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=R.e.r&&(S["!fullref"]=S["!ref"],R.e.r=n.sheetRows-1,S["!ref"]=nt(R)),ne.length&&(S["!merges"]=ne),Re.length&&(S["!rows"]=Re),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),_.push(m.name),v[m.name]=S,le=!1):T[0].charAt(T[0].length-2)!=="/"&&(m=Ye(T[0],!1),P=L=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,S=n.dense?[]:{},ne=[],Re=[],le=!0);break;case"table-row-group":T[1]==="/"?--J:++J;break;case"table-row":case"":if(T[1]==="/"){P+=ye,ye=1;break}if(x=Ye(T[0],!1),x.?P=x.-1:P==-1&&(P=0),ye=+x["number-rows-repeated"]||1,ye<10)for(xe=0;xe<ye;++xe)J>0&&(Re[P+xe]={level:J});L=-1;break;case"covered-table-cell":T[1]!=="/"&&++L,n.sheetStubs&&(n.dense?(S[P]||(S[P]=[]),S[P][L]={t:"z"}):S[Je({r:P,c:L})]={t:"z"}),I="",D=[];break;case"table-cell":case"":if(T[0].charAt(T[0].length-2)==="/")++L,C=Ye(T[0],!1),De=parseInt(C["number-columns-repeated"]||"1",10),E={t:"z",v:null},C.formula&&n.cellFormula!=!1&&(E.f=bg(ut(C.formula))),(C.||C["value-type"])=="string"&&(E.t="s",E.v=ut(C["string-value"]||""),n.dense?(S[P]||(S[P]=[]),S[P][L]=E):S[Je({r:P,c:L})]=E),L+=De-1;else if(T[1]!=="/"){++L,I="",A=0,D=[],De=1;var ve=ye?P+ye-1:P;if(L>R.e.c&&(R.e.c=L),L<R.s.c&&(R.s.c=L),P<R.s.r&&(R.s.r=P),ve>R.e.r&&(R.e.r=ve),C=Ye(T[0],!1),ue=[],B={},E={t:C.||C["value-type"],v:null},n.cellFormula)if(C.formula&&(C.formula=ut(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(Q=parseInt(C["number-matrix-rows-spanned"],10)||0,me=parseInt(C["number-matrix-columns-spanned"],10)||0,te={s:{r:P,c:L},e:{r:P+Q-1,c:L+me-1}},E.F=nt(te),Ce.push([te,E.F])),C.formula)E.f=bg(C.formula);else for(xe=0;xe<Ce.length;++xe)P>=Ce[xe][0].s.r&&P<=Ce[xe][0].e.r&&L>=Ce[xe][0].s.c&&L<=Ce[xe][0].e.c&&(E.F=Ce[xe][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(Q=parseInt(C["number-rows-spanned"],10)||0,me=parseInt(C["number-columns-spanned"],10)||0,te={s:{r:P,c:L},e:{r:P+Q-1,c:L+me-1}},ne.push(te)),C["number-columns-repeated"]&&(De=parseInt(C["number-columns-repeated"],10)),E.t){case"boolean":E.t="b",E.v=Dt(C["boolean-value"]);break;case"float":E.t="n",E.v=parseFloat(C.value);break;case"percentage":E.t="n",E.v=parseFloat(C.value);break;case"currency":E.t="n",E.v=parseFloat(C.value);break;case"date":E.t="d",E.v=Pt(C["date-value"]),n.cellDates||(E.t="n",E.v=fn(E.v)),E.z="m/d/yy";break;case"time":E.t="n",E.v=pT(C["time-value"])/86400,n.cellDates&&(E.t="d",E.v=xc(E.v)),E.z="HH:MM:SS";break;case"number":E.t="n",E.v=parseFloat(C.);break;default:if(E.t==="string"||E.t==="text"||!E.t)E.t="s",C["string-value"]!=null&&(I=ut(C["string-value"]),D=[]);else throw new Error("Unsupported value type "+E.t)}}else{if(K=!1,E.t==="s"&&(E.v=I||"",D.length&&(E.R=D),K=A==0),Z.Target&&(E.l=Z),ue.length>0&&(E.c=ue,ue=[]),I&&n.cellText!==!1&&(E.w=I),K&&(E.t="z",delete E.v),(!K||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=P))for(var we=0;we<ye;++we){if(De=parseInt(C["number-columns-repeated"]||"1",10),n.dense)for(S[P+we]||(S[P+we]=[]),S[P+we][L]=we==0?E:Mt(E);--De>0;)S[P+we][L+De]=Mt(E);else for(S[Je({r:P+we,c:L})]=E;--De>0;)S[Je({r:P+we,c:L+De})]=Mt(E);R.e.c<=L&&(R.e.c=L)}De=parseInt(C["number-columns-repeated"]||"1",10),L+=De-1,De=0,E={},I="",D=[]}Z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(T[1]==="/"){if((s=i.pop())[0]!==T[3])throw"Bad state: "+s}else T[0].charAt(T[0].length-2)!=="/"&&i.push([T[3],!0]);break;case"annotation":if(T[1]==="/"){if((s=i.pop())[0]!==T[3])throw"Bad state: "+s;B.t=I,D.length&&(B.R=D),B.a=X,ue.push(B)}else T[0].charAt(T[0].length-2)!=="/"&&i.push([T[3],!1]);X="",q=0,I="",A=0,D=[];break;case"creator":T[1]==="/"?X=r.slice(q,T.index):q=T.index+T[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(T[1]==="/"){if((s=i.pop())[0]!==T[3])throw"Bad state: "+s}else T[0].charAt(T[0].length-2)!=="/"&&i.push([T[3],!1]);I="",A=0,D=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(T[1]==="/"){if(V[u.name]=d,(s=i.pop())[0]!==T[3])throw"Bad state: "+s}else T[0].charAt(T[0].length-2)!=="/"&&(d="",u=Ye(T[0],!1),i.push([T[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ye(T[0],!1),d+=$g[T[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Ye(T[0],!1),d+=$g[T[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(T[0].slice(-2)==="/>")break;if(T[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":d+=r.slice(h,T.index);break}else h=T.index+T[0].length;break;case"named-range":o=Ye(T[0],!1),H=T0(o["cell-range-address"]);var Ae={Name:o.name,Ref:H[0]+"!"+H[1]};le&&(Ae.Sheet=_.length),ke.Names.push(Ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(T[1]==="/"&&(!C||!C["string-value"])){var Xe=V3(r.slice(A,T.index));I=(I.length>0?I+`
`:"")+Xe[0]}else Ye(T[0],!1),A=T.index+T[0].length;break;case"s":break;case"database-range":if(T[1]==="/")break;try{H=T0(Ye(T[0])["target-range-address"]),v[H[0]]["!autofilter"]={ref:H[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(T[1]!=="/"){if(Z=Ye(T[0],!1),!Z.href)break;Z.Target=ut(Z.href),delete Z.href,Z.Target.charAt(0)=="#"&&Z.Target.indexOf(".")>-1?(H=T0(Z.Target.slice(1)),Z.Target="#"+H[0]+"!"+H[1]):Z.Target.match(/^\.\.[\\\/]/)&&(Z.Target=Z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(T[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(T)}}var G={Sheets:v,SheetNames:_,Workbook:ke};return n.bookSheets&&delete G.Sheets,G}function jg(e,t){t=t||{},Er(e,"META-INF/manifest.xml")&&pk(an(e,"META-INF/manifest.xml"),t);var n=fr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=Ay(Et(n),t);return Er(e,"meta.xml")&&(r.Props=xv(an(e,"meta.xml"))),r}function qg(e,t){return Ay(e,t)}var H3=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return en+t}}(),Kg=function(){var e=function(s){return kt(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,o,u){var d=[];d.push('      <table:table table:name="'+kt(o.SheetNames[u])+`" table:style-name="ta1">
`);var h=0,m=0,x=Qn(s["!ref"]||"A1"),v=s["!merges"]||[],_=0,S=Array.isArray(s);if(s["!cols"])for(m=0;m<=x.e.c;++m)d.push("        <table:table-column"+(s["!cols"][m]?' table:style-name="co'+s["!cols"][m].ods+'"':"")+`></table:table-column>
`);var T="",E=s["!rows"]||[];for(h=0;h<x.s.r;++h)T=E[h]?' table:style-name="ro'+E[h].ods+'"':"",d.push("        <table:table-row"+T+`></table:table-row>
`);for(;h<=x.e.r;++h){for(T=E[h]?' table:style-name="ro'+E[h].ods+'"':"",d.push("        <table:table-row"+T+`>
`),m=0;m<x.s.c;++m)d.push(t);for(;m<=x.e.c;++m){var C=!1,I={},A="";for(_=0;_!=v.length;++_)if(!(v[_].s.c>m)&&!(v[_].s.r>h)&&!(v[_].e.c<m)&&!(v[_].e.r<h)){(v[_].s.c!=m||v[_].s.r!=h)&&(C=!0),I["table:number-columns-spanned"]=v[_].e.c-v[_].s.c+1,I["table:number-rows-spanned"]=v[_].e.r-v[_].s.r+1;break}if(C){d.push(n);continue}var D=Je({r:h,c:m}),P=S?(s[h]||[])[m]:s[D];if(P&&P.f&&(I["table:formula"]=kt(lI(P.f)),P.F&&P.F.slice(0,D.length)==D)){var L=Qn(P.F);I["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,I["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!P){d.push(t);continue}switch(P.t){case"b":A=P.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=P.v?"true":"false";break;case"n":A=P.w||String(P.v||0),I["office:value-type"]="float",I["office:value"]=P.v||0;break;case"s":case"str":A=P.v==null?"":P.v,I["office:value-type"]="string";break;case"d":A=P.w||Pt(P.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=Pt(P.v).toISOString(),I["table:style-name"]="ce1";break;default:d.push(t);continue}var R=e(A);if(P.l&&P.l.Target){var J=P.l.Target;J=J.charAt(0)=="#"?"#"+uI(J.slice(1)):J,J.charAt(0)!="#"&&!J.match(/^\w+:/)&&(J="../"+J),R=Me("text:a",R,{"xlink:href":J.replace(/&/g,"&amp;")})}d.push("          "+Me("table:table-cell",Me("text:p",R,{}),I)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var m=0;m<h["!cols"].length;++m)if(h["!cols"][m]){var x=h["!cols"][m];if(x.width==null&&x.wpx==null&&x.wch==null)continue;aa(x),x.ods=u;var v=h["!cols"][m].wpx+"px";s.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),s.push(`  </style:style>
`),++u}}});var d=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var m=0;m<h["!rows"].length;++m)if(h["!rows"][m]){h["!rows"][m].ods=d;var x=h["!rows"][m].hpx+"px";s.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),s.push(`  </style:style>
`),++d}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,u){var d=[en],h=Qo({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=Qo({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(d.push("<office:document"+h+m+`>
`),d.push(gv().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+h+`>
`),i(d,o),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)d.push(r(o.Sheets[o.SheetNames[x]],o,x));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),u.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function Iy(e,t){if(t.bookType=="fods")return Kg(e,t);var n=xd(),r="",i=[],s=[];return r="mimetype",rt(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",rt(n,r,Kg(e,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",rt(n,r,H3(e,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",rt(n,r,en+gv()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",rt(n,r,xk(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",rt(n,r,mk(i)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Wa(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function j0(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Et(la(e))}function W3(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):cr(ri(e))}function G3(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function oa(e){var t=e.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(i,r),r+=i.length}),n}function Jg(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function $3(e,t){for(var n=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,i=t+13;i>=t;--i)r=r*256+e[i];return(e[t+15]&128?-r:r)*Math.pow(10,n-6176)}function j3(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=n>=0?0:128}function ol(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function _t(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function Kt(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function mt(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],i=ol(e,n),s=i&7;i=Math.floor(i/8);var o=0,u;if(i==0)break;switch(s){case 0:{for(var d=n[0];e[n[0]++]>=128;);u=e.slice(d,n[0])}break;case 5:o=4,u=e.slice(n[0],n[0]+o),n[0]+=o;break;case 1:o=8,u=e.slice(n[0],n[0]+o),n[0]+=o;break;case 2:o=ol(e,n),u=e.slice(n[0],n[0]+o),n[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var h={data:u,type:s};t[i]==null?t[i]=[h]:t[i].push(h)}return t}function Tn(e){var t=[];return e.forEach(function(n,r){n.forEach(function(i){i.data&&(t.push(_t(r*8+i.type)),i.type==2&&t.push(_t(i.data.length)),t.push(i.data))})}),oa(t)}function Gd(e,t){return(e==null?void 0:e.map(function(n){return t(n.data)}))||[]}function kr(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=ol(e,r),s=mt(e.slice(r[0],r[0]+i));r[0]+=i;var o={id:Kt(s[1][0].data),messages:[]};s[2].forEach(function(u){var d=mt(u.data),h=Kt(d[3][0].data);o.messages.push({meta:d,data:e.slice(r[0],r[0]+h)}),r[0]+=h}),(t=s[3])!=null&&t[0]&&(o.merge=Kt(s[3][0].data)>>>0>0),n.push(o)}return n}function Is(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:_t(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:_t(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:_t(o.data.length)}],r[2].push({data:Tn(o.meta),type:2})});var s=Tn(r);t.push(_t(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),oa(t)}function q3(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=ol(t,n),i=[];n[0]<t.length;){var s=t[n[0]]&3;if(s==0){var o=t[n[0]++]>>2;if(o<60)++o;else{var u=o-59;o=t[n[0]],u>1&&(o|=t[n[0]+1]<<8),u>2&&(o|=t[n[0]+2]<<16),u>3&&(o|=t[n[0]+3]<<24),o>>>=0,o++,n[0]+=u}i.push(t.slice(n[0],n[0]+o)),n[0]+=o;continue}else{var d=0,h=0;if(s==1?(h=(t[n[0]]>>2&7)+4,d=(t[n[0]++]&224)<<3,d|=t[n[0]++]):(h=(t[n[0]++]>>2)+1,s==2?(d=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(d=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[oa(i)],d==0)throw new Error("Invalid offset 0");if(d>i[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(i.push(i[0].slice(-d)),h-=d;h>=i[i.length-1].length;)i.push(i[i.length-1]),h-=i[i.length-1].length;i.push(i[0].slice(-d,-d+h))}}var m=oa(i);if(m.length!=r)throw new Error("Unexpected length: ".concat(m.length," != ").concat(r));return m}function Sr(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(q3(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return oa(t)}function Ns(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var s=_t(r),o=s.length;t.push(s),r<=60?(o++,t.push(new Uint8Array([r-1<<2]))):r<=256?(o+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(o+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(o+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(o+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),o+=r,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,n+=r}return oa(t)}function K3(e,t,n,r){var i=Wa(e),s=i.getUint32(4,!0),o=(r>1?12:8)+Jg(s&(r>1?3470:398))*4,u=-1,d=-1,h=NaN,m=new Date(2001,0,1);s&512&&(u=i.getUint32(o,!0),o+=4),o+=Jg(s&(r>1?12288:4096))*4,s&16&&(d=i.getUint32(o,!0),o+=4),s&32&&(h=i.getFloat64(o,!0),o+=8),s&64&&(m.setTime(m.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[d]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(u>-1)x={t:"s",v:n[u]};else if(d>-1)x={t:"s",v:t[d]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function J3(e,t,n){var r=Wa(e),i=r.getUint32(8,!0),s=12,o=-1,u=-1,d=NaN,h=NaN,m=new Date(2001,0,1);i&1&&(d=$3(e,s),s+=16),i&2&&(h=r.getFloat64(s,!0),s+=8),i&4&&(m.setTime(m.getTime()+r.getFloat64(s,!0)*1e3),s+=8),i&8&&(u=r.getUint32(s,!0),s+=4),i&16&&(o=r.getUint32(s,!0),s+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:d};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:m};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:n[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:d};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return x}function S0(e,t){var n=new Uint8Array(32),r=Wa(n),i=12,s=0;switch(n[0]=5,e.t){case"n":n[1]=2,j3(n,i,e.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),n.slice(0,i)}function E0(e,t){var n=new Uint8Array(32),r=Wa(n),i=12,s=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),n.slice(0,i)}function X3(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return K3(e,t,n,e[0]);case 5:return J3(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Rn(e){var t=mt(e);return ol(t[1][0].data)}function Xg(e,t){var n=mt(t.data),r=Kt(n[1][0].data),i=n[3],s=[];return(i||[]).forEach(function(o){var u=mt(o.data),d=Kt(u[1][0].data)>>>0;switch(r){case 1:s[d]=j0(u[3][0].data);break;case 8:{var h=e[Rn(u[9][0].data)][0],m=mt(h.data),x=e[Rn(m[1][0].data)][0],v=Kt(x.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var _=mt(x.data);s[d]=_[3].map(function(S){return j0(S.data)}).join("")}break}}),s}function Y3(e,t){var n,r,i,s,o,u,d,h,m,x,v,_,S,T,E=mt(e),C=Kt(E[1][0].data)>>>0,I=Kt(E[2][0].data)>>>0,A=((r=(n=E[8])==null?void 0:n[0])==null?void 0:r.data)&&Kt(E[8][0].data)>0||!1,D,P;if((s=(i=E[7])==null?void 0:i[0])!=null&&s.data&&t!=0)D=(u=(o=E[7])==null?void 0:o[0])==null?void 0:u.data,P=(h=(d=E[6])==null?void 0:d[0])==null?void 0:h.data;else if((x=(m=E[4])==null?void 0:m[0])!=null&&x.data&&t!=1)D=(_=(v=E[4])==null?void 0:v[0])==null?void 0:_.data,P=(T=(S=E[3])==null?void 0:S[0])==null?void 0:T.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var L=A?4:1,R=Wa(D),J=[],V=0;V<D.length/2;++V){var ne=R.getUint16(V*2,!0);ne<65535&&J.push([V,ne])}if(J.length!=I)throw"Expected ".concat(I," cells, found ").concat(J.length);var te=[];for(V=0;V<J.length-1;++V)te[J[V][0]]=P.subarray(J[V][1]*L,J[V+1][1]*L);return J.length>=1&&(te[J[J.length-1][0]]=P.subarray(J[J.length-1][1]*L)),{R:C,cells:te}}function Z3(e,t){var n,r=mt(t.data),i=(n=r==null?void 0:r[7])!=null&&n[0]?Kt(r[7][0].data)>>>0>0?1:0:-1,s=Gd(r[5],function(o){return Y3(o,i)});return{nrows:Kt(r[4][0].data)>>>0,data:s.reduce(function(o,u){return o[u.R]||(o[u.R]=[]),u.cells.forEach(function(d,h){if(o[u.R][h])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(h));o[u.R][h]=d}),o},[])}}function Q3(e,t,n){var r,i=mt(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Kt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Kt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));n["!ref"]=nt(s);var o=mt(i[4][0].data),u=Xg(e,e[Rn(o[4][0].data)][0]),d=(r=o[17])!=null&&r[0]?Xg(e,e[Rn(o[17][0].data)][0]):[],h=mt(o[3][0].data),m=0;h[1].forEach(function(x){var v=mt(x.data),_=e[Rn(v[2][0].data)][0],S=Kt(_.meta[1][0].data);if(S!=6002)throw new Error("6001 unexpected reference to ".concat(S));var T=Z3(e,_);T.data.forEach(function(E,C){E.forEach(function(I,A){var D=Je({r:m+C,c:A}),P=X3(I,u,d);P&&(n[D]=P)})}),m+=T.nrows})}function eR(e,t){var n=mt(t.data),r={"!ref":"A1"},i=e[Rn(n[2][0].data)],s=Kt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Q3(e,i[0],r),r}function tR(e,t){var n,r=mt(t.data),i={name:(n=r[1])!=null&&n[0]?j0(r[1][0].data):"",sheets:[]},s=Gd(r[2],Rn);return s.forEach(function(o){e[o].forEach(function(u){var d=Kt(u.meta[1][0].data);d==6e3&&i.sheets.push(eR(e,u))})}),i}function nR(e,t){var n=Jd(),r=mt(t.data),i=Gd(r[1],Rn);if(i.forEach(function(s){e[s].forEach(function(o){var u=Kt(o.meta[1][0].data);if(u==2){var d=tR(e,o);d.sheets.forEach(function(h,m){Xd(n,h,m==0?d.name:d.name+"_"+m,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function C0(e){var t,n,r,i,s={},o=[];if(e.FullPaths.forEach(function(d){if(d.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(d){if(d.name.match(/\.iwa$/)){var h;try{h=Sr(d.content)}catch(x){return console.log("?? "+d.content.length+" "+(x.message||x))}var m;try{m=kr(h)}catch(x){return console.log("## "+(x.message||x))}m.forEach(function(x){s[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var u=((i=(r=(n=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:i[0].data)&&Kt(s[1][0].meta[1][0].data)==1&&s[1][0];if(u||o.forEach(function(d){s[d].forEach(function(h){var m=Kt(h.meta[1][0].data)>>>0;if(m==1)if(!u)u=h;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return nR(s,u)}function rR(e,t,n){var r,i,s,o;if(!((r=e[6])!=null&&r[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var u=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&Kt(e[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var d=0,h=Wa(e[7][0].data),m=0,x=[],v=Wa(e[4][0].data),_=0,S=[],T=0;T<t.length;++T){if(t[T]==null){h.setUint16(T*2,65535,!0),v.setUint16(T*2,65535);continue}h.setUint16(T*2,m,!0),v.setUint16(T*2,_,!0);var E,C;switch(typeof t[T]){case"string":E=S0({t:"s",v:t[T]},n),C=E0({t:"s",v:t[T]},n);break;case"number":E=S0({t:"n",v:t[T]},n),C=E0({t:"n",v:t[T]},n);break;case"boolean":E=S0({t:"b",v:t[T]},n),C=E0({t:"b",v:t[T]},n);break;default:throw new Error("Unsupported value "+t[T])}x.push(E),m+=E.length,S.push(C),_+=C.length,++d}for(e[2][0].data=_t(d);T<e[7][0].data.length/2;++T)h.setUint16(T*2,65535,!0),v.setUint16(T*2,65535,!0);return e[6][0].data=oa(x),e[3][0].data=oa(S),d}function iR(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Qn(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(nt(r)));var s=ic(n,{range:r,header:1}),o=["~Sh33tJ5~"];s.forEach(function(X){return X.forEach(function(q){typeof q=="string"&&o.push(q)})});var u={},d=[],h=We.read(t.numbers,{type:"base64"});h.FileIndex.map(function(X,q){return[X,h.FullPaths[q]]}).forEach(function(X){var q=X[0],K=X[1];if(q.type==2&&q.name.match(/\.iwa/)){var le=q.content,xe=Sr(le),ve=kr(xe);ve.forEach(function(we){d.push(we.id),u[we.id]={deps:[],location:K,type:Kt(we.messages[0].meta[1][0].data)}})}}),d.sort(function(X,q){return X-q});var m=d.filter(function(X){return X>1}).map(function(X){return[X,_t(X)]});h.FileIndex.map(function(X,q){return[X,h.FullPaths[q]]}).forEach(function(X){var q=X[0];if(X[1],!!q.name.match(/\.iwa/)){var K=kr(Sr(q.content));K.forEach(function(le){le.messages.forEach(function(xe){m.forEach(function(ve){le.messages.some(function(we){return Kt(we.meta[1][0].data)!=11006&&G3(we.data,ve[1])})&&u[ve[0]].deps.push(le.id)})})})}});for(var x=We.find(h,u[1].location),v=kr(Sr(x.content)),_,S=0;S<v.length;++S){var T=v[S];T.id==1&&(_=T)}var E=Rn(mt(_.messages[0].data)[1][0].data);for(x=We.find(h,u[E].location),v=kr(Sr(x.content)),S=0;S<v.length;++S)T=v[S],T.id==E&&(_=T);for(E=Rn(mt(_.messages[0].data)[2][0].data),x=We.find(h,u[E].location),v=kr(Sr(x.content)),S=0;S<v.length;++S)T=v[S],T.id==E&&(_=T);for(E=Rn(mt(_.messages[0].data)[2][0].data),x=We.find(h,u[E].location),v=kr(Sr(x.content)),S=0;S<v.length;++S)T=v[S],T.id==E&&(_=T);var C=mt(_.messages[0].data);{C[6][0].data=_t(r.e.r+1),C[7][0].data=_t(r.e.c+1);var I=Rn(C[46][0].data),A=We.find(h,u[I].location),D=kr(Sr(A.content));{for(var P=0;P<D.length&&D[P].id!=I;++P);if(D[P].id!=I)throw"Bad ColumnRowUIDMapArchive";var L=mt(D[P].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var R=0;R<=r.e.c;++R){var J=[];J[1]=J[2]=[{type:0,data:_t(R+420690)}],L[1].push({type:2,data:Tn(J)}),L[2].push({type:0,data:_t(R)}),L[3].push({type:0,data:_t(R)})}L[4]=[],L[5]=[],L[6]=[];for(var V=0;V<=r.e.r;++V)J=[],J[1]=J[2]=[{type:0,data:_t(V+726270)}],L[4].push({type:2,data:Tn(J)}),L[5].push({type:0,data:_t(V)}),L[6].push({type:0,data:_t(V)});D[P].messages[0].data=Tn(L)}A.content=Ns(Is(D)),A.size=A.content.length,delete C[46];var ne=mt(C[4][0].data);{ne[7][0].data=_t(r.e.r+1);var te=mt(ne[1][0].data),Q=Rn(te[2][0].data);A=We.find(h,u[Q].location),D=kr(Sr(A.content));{if(D[0].id!=Q)throw"Bad HeaderStorageBucket";var me=mt(D[0].messages[0].data);for(V=0;V<s.length;++V){var Re=mt(me[2][0].data);Re[1][0].data=_t(V),Re[4][0].data=_t(s[V].length),me[2][V]={type:me[2][0].type,data:Tn(Re)}}D[0].messages[0].data=Tn(me)}A.content=Ns(Is(D)),A.size=A.content.length;var ye=Rn(ne[2][0].data);A=We.find(h,u[ye].location),D=kr(Sr(A.content));{if(D[0].id!=ye)throw"Bad HeaderStorageBucket";for(me=mt(D[0].messages[0].data),R=0;R<=r.e.c;++R)Re=mt(me[2][0].data),Re[1][0].data=_t(R),Re[4][0].data=_t(r.e.r+1),me[2][R]={type:me[2][0].type,data:Tn(Re)};D[0].messages[0].data=Tn(me)}A.content=Ns(Is(D)),A.size=A.content.length;var De=Rn(ne[4][0].data);(function(){for(var X=We.find(h,u[De].location),q=kr(Sr(X.content)),K,le=0;le<q.length;++le){var xe=q[le];xe.id==De&&(K=xe)}var ve=mt(K.messages[0].data);{ve[3]=[];var we=[];o.forEach(function(G,ft){we[1]=[{type:0,data:_t(ft)}],we[2]=[{type:0,data:_t(1)}],we[3]=[{type:2,data:W3(G)}],ve[3].push({type:2,data:Tn(we)})})}K.messages[0].data=Tn(ve);var Ae=Is(q),Xe=Ns(Ae);X.content=Xe,X.size=X.content.length})();var Ce=mt(ne[3][0].data);{var ke=Ce[1][0];delete Ce[2];var Z=mt(ke.data);{var H=Rn(Z[2][0].data);(function(){for(var X=We.find(h,u[H].location),q=kr(Sr(X.content)),K,le=0;le<q.length;++le){var xe=q[le];xe.id==H&&(K=xe)}var ve=mt(K.messages[0].data);{delete ve[6],delete Ce[7];var we=new Uint8Array(ve[5][0].data);ve[5]=[];for(var Ae=0,Xe=0;Xe<=r.e.r;++Xe){var G=mt(we);Ae+=rR(G,s[Xe],o),G[1][0].data=_t(Xe),ve[5].push({data:Tn(G),type:2})}ve[1]=[{type:0,data:_t(r.e.c+1)}],ve[2]=[{type:0,data:_t(r.e.r+1)}],ve[3]=[{type:0,data:_t(Ae)}],ve[4]=[{type:0,data:_t(r.e.r+1)}]}K.messages[0].data=Tn(ve);var ft=Is(q),et=Ns(ft);X.content=et,X.size=X.content.length})()}ke.data=Tn(Z)}ne[3][0].data=Tn(Ce)}C[4][0].data=Tn(ne)}_.messages[0].data=Tn(C);var ue=Is(v),B=Ns(ue);return x.content=B,x.size=x.content.length,h}function Ny(e){return function(n){for(var r=0;r!=e.length;++r){var i=e[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function $d(e){Ny([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function jd(e){Ny([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function aR(e){return at.WS.indexOf(e)>-1?"sheet":e==at.CS?"chart":e==at.DS?"dialog":e==at.MS?"macro":e&&e.length?e:"sheet"}function sR(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,aR(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function oR(e,t,n,r,i,s,o,u,d,h,m,x){try{s[r]=Wo(fr(e,n,!0),t);var v=an(e,t),_;switch(u){case"sheet":_=NF(v,t,i,d,s[r],h,m,x);break;case"chart":if(_=FF(v,t,i,d,s[r],h,m,x),!_||!_["!drawel"])break;var S=zo(_["!drawel"].Target,t),T=tl(S),E=gA(fr(e,S,!0),Wo(fr(e,T,!0),S)),C=zo(E,S),I=tl(C);_=rF(fr(e,C,!0),C,d,Wo(fr(e,I,!0),C),h,_);break;case"macro":_=RF(v,t,i,d,s[r],h,m,x);break;case"dialog":_=DF(v,t,i,d,s[r],h,m,x);break;default:throw new Error("Unrecognized sheet type "+u)}o[r]=_;var A=[];s&&s[r]&&Jt(s[r]).forEach(function(D){var P="";if(s[r][D].Type==at.CMNT){P=zo(s[r][D].Target,t);var L=BF(an(e,P,!0),P,d);if(!L||!L.length)return;Lg(_,L,!1)}s[r][D].Type==at.TCMNT&&(P=zo(s[r][D].Target,t),A=A.concat(vA(an(e,P,!0),d)))}),A&&A.length&&Lg(_,A,!0,d.people||[])}catch(D){if(d.WTF)throw D}}function _r(e){return e.charAt(0)=="/"?e.slice(1):e}function lR(e,t){if($s(),t=t||{},$d(t),Er(e,"META-INF/manifest.xml")||Er(e,"objectdata.xml"))return jg(e,t);if(Er(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof C0<"u"){if(e.FileIndex)return C0(e);var n=We.utils.cfb_new();return ng(e).forEach(function(Re){rt(n,Re,yT(e,Re))}),C0(n)}throw new Error("Unsupported NUMBERS file")}if(!Er(e,"[Content_Types].xml"))throw Er(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Er(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=ng(e),i=dk(fr(e,"[Content_Types].xml")),s=!1,o,u;if(i.workbooks.length===0&&(u="xl/workbook.xml",an(e,u,!0)&&i.workbooks.push(u)),i.workbooks.length===0){if(u="xl/workbook.bin",!an(e,u,!0))throw new Error("Could not find workbook");i.workbooks.push(u),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var d={},h={};if(!t.bookSheets&&!t.bookProps){if(Go=[],i.sst)try{Go=LF(an(e,_r(i.sst)),i.sst,t)}catch(Re){if(t.WTF)throw Re}t.cellStyles&&i.themes.length&&(d=MF(fr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(h=PF(an(e,_r(i.style)),i.style,d,t))}i.links.map(function(Re){try{var ye=Wo(fr(e,tl(_r(Re))),Re);return UF(an(e,_r(Re)),ye,Re,t)}catch{}});var m=IF(an(e,_r(i.workbooks[0])),i.workbooks[0],t),x={},v="";i.coreprops.length&&(v=an(e,_r(i.coreprops[0]),!0),v&&(x=xv(v)),i.extprops.length!==0&&(v=an(e,_r(i.extprops[0]),!0),v&&yk(v,x,t)));var _={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(v=fr(e,_r(i.custprops[0]),!0),v&&(_=_k(v,t)));var S={};if((t.bookSheets||t.bookProps)&&(m.Sheets?o=m.Sheets.map(function(ye){return ye.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),t.bookProps&&(S.Props=x,S.Custprops=_),t.bookSheets&&typeof o<"u"&&(S.SheetNames=o),t.bookSheets?S.SheetNames:t.bookProps))return S;o={};var T={};t.bookDeps&&i.calcchain&&(T=OF(an(e,_r(i.calcchain)),i.calcchain));var E=0,C={},I,A;{var D=m.Sheets;x.Worksheets=D.length,x.SheetNames=[];for(var P=0;P!=D.length;++P)x.SheetNames[P]=D[P].name}var L=s?"bin":"xml",R=i.workbooks[0].lastIndexOf("/"),J=(i.workbooks[0].slice(0,R+1)+"_rels/"+i.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");Er(e,J)||(J="xl/_rels/workbook."+L+".rels");var V=Wo(fr(e,J,!0),J.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=zF(an(e,_r(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=wA(an(e,_r(i.people[0])),t)),V&&(V=sR(V,m.Sheets));var ne=an(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(E=0;E!=x.Worksheets;++E){var te="sheet";if(V&&V[E]?(I="xl/"+V[E][1].replace(/[\/]?xl\//,""),Er(e,I)||(I=V[E][1]),Er(e,I)||(I=J.replace(/_rels\/.*$/,"")+V[E][1]),te=V[E][2]):(I="xl/worksheets/sheet"+(E+1-ne)+"."+L,I=I.replace(/sheet0\./,"sheet.")),A=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(E!=t.sheets)continue e;break;case"string":if(x.SheetNames[E].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Q=!1,me=0;me!=t.sheets.length;++me)typeof t.sheets[me]=="number"&&t.sheets[me]==E&&(Q=1),typeof t.sheets[me]=="string"&&t.sheets[me].toLowerCase()==x.SheetNames[E].toLowerCase()&&(Q=1);if(!Q)continue e}}oR(e,I,A,x.SheetNames[E],E,C,o,te,t,m,d,h)}return S={Directory:i,Workbook:m,Props:x,Custprops:_,Deps:T,Sheets:o,SheetNames:x.SheetNames,Strings:Go,Styles:h,Themes:d,SSF:Mt(Ke)},t&&t.bookFiles&&(e.files?(S.keys=r,S.files=e.files):(S.keys=[],S.files={},e.FullPaths.forEach(function(Re,ye){Re=Re.replace(/^Root Entry[\/]/,""),S.keys.push(Re),S.files[Re]=e.FileIndex[ye]}))),t&&t.bookVBA&&(i.vba.length>0?S.vbaraw=an(e,_r(i.vba[0]),!0):i.defaults&&i.defaults.bin===IA&&(S.vbaraw=an(e,"xl/vbaProject.bin",!0))),S}function uR(e,t){var n=t||{},r="Workbook",i=We.find(e,r);try{if(r="/!DataSpaces/Version",i=We.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(zE(i.content),r="/!DataSpaces/DataSpaceMap",i=We.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=VE(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=We.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=HE(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=We.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);GE(i.content)}catch{}if(r="/EncryptionInfo",i=We.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var u=$E(i.content);if(r="/EncryptedPackage",i=We.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],i.content,n.password||"",n);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],i.content,n.password||"",n);throw new Error("File is password-protected")}function cR(e,t){return t.bookType=="ods"?Iy(e,t):t.bookType=="numbers"?iR(e,t):t.bookType=="xlsb"?fR(e,t):dR(e,t)}function fR(e,t){Rs=1024,e&&!e.SSF&&(e.SSF=Mt(Ke)),e&&e.SSF&&($s(),pc(e.SSF),t.revssf=gc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,$o?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=ny.indexOf(t.bookType)>-1,i=Rd();jd(t=t||{});var s=xd(),o="",u=0;if(t.cellXfs=[],ca(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",rt(s,o,vv(e.Props,t)),i.coreprops.push(o),Tt(t.rels,2,o,at.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}for(e.Props.Worksheets=e.Props.SheetNames.length,rt(s,o,_v(e.Props)),i.extprops.push(o),Tt(t.rels,3,o,at.EXT_PROPS),e.Custprops!==e.Props&&Jt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",rt(s,o,Tv(e.Custprops)),i.custprops.push(o),Tt(t.rels,4,o,at.CUST_PROPS)),u=1;u<=e.SheetNames.length;++u){var m={"!id":{}},x=e.Sheets[e.SheetNames[u-1]],v=(x||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+u+"."+n,rt(s,o,VF(u-1,o,t,e,m)),i.sheets.push(o),Tt(t.wbrels,-1,"worksheets/sheet"+u+"."+n,at.WS[0])}if(x){var _=x["!comments"],S=!1,T="";_&&_.length>0&&(T="xl/comments"+u+"."+n,rt(s,T,GF(_,T)),i.comments.push(T),Tt(m,-1,"../comments"+u+"."+n,at.CMNT),S=!0),x["!legacy"]&&S&&rt(s,"xl/drawings/vmlDrawing"+u+".vml",ey(u,x["!comments"])),delete x["!comments"],delete x["!legacy"]}m["!id"].rId1&&rt(s,tl(o),Ms(m))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,rt(s,o,WF(t.Strings,o,t)),i.strs.push(o),Tt(t.wbrels,-1,"sharedStrings."+n,at.SST)),o="xl/workbook."+n,rt(s,o,bF(e,o)),i.workbooks.push(o),Tt(t.rels,1,o,at.WB),o="xl/theme/theme1.xml",rt(s,o,Od(e.Themes,t)),i.themes.push(o),Tt(t.wbrels,-1,"theme/theme1.xml",at.THEME),o="xl/styles."+n,rt(s,o,HF(e,o,t)),i.styles.push(o),Tt(t.wbrels,-1,"styles."+n,at.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",rt(s,o,e.vbaraw),i.vba.push(o),Tt(t.wbrels,-1,"vbaProject.bin",at.VBA)),o="xl/metadata."+n,rt(s,o,$F(o)),i.metadata.push(o),Tt(t.wbrels,-1,"metadata."+n,at.XLMETA),rt(s,"[Content_Types].xml",mv(i,t)),rt(s,"_rels/.rels",Ms(t.rels)),rt(s,"xl/_rels/workbook."+n+".rels",Ms(t.wbrels)),delete t.revssf,delete t.ssf,s}function dR(e,t){Rs=1024,e&&!e.SSF&&(e.SSF=Mt(Ke)),e&&e.SSF&&($s(),pc(e.SSF),t.revssf=gc(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,$o?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=ny.indexOf(t.bookType)>-1,i=Rd();jd(t=t||{});var s=xd(),o="",u=0;if(t.cellXfs=[],ca(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",rt(s,o,vv(e.Props,t)),i.coreprops.push(o),Tt(t.rels,2,o,at.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var d=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(e.SheetNames[h]);e.Props.SheetNames=d}e.Props.Worksheets=e.Props.SheetNames.length,rt(s,o,_v(e.Props)),i.extprops.push(o),Tt(t.rels,3,o,at.EXT_PROPS),e.Custprops!==e.Props&&Jt(e.Custprops||{}).length>0&&(o="docProps/custom.xml",rt(s,o,Tv(e.Custprops)),i.custprops.push(o),Tt(t.rels,4,o,at.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,u=1;u<=e.SheetNames.length;++u){var x={"!id":{}},v=e.Sheets[e.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:o="xl/worksheets/sheet"+u+"."+n,rt(s,o,hy(u-1,t,e,x)),i.sheets.push(o),Tt(t.wbrels,-1,"worksheets/sheet"+u+"."+n,at.WS[0])}if(v){var S=v["!comments"],T=!1,E="";if(S&&S.length>0){var C=!1;S.forEach(function(I){I[1].forEach(function(A){A.T==!0&&(C=!0)})}),C&&(E="xl/threadedComments/threadedComment"+u+"."+n,rt(s,E,yA(S,m,t)),i.threadedcomments.push(E),Tt(x,-1,"../threadedComments/threadedComment"+u+"."+n,at.TCMNT)),E="xl/comments"+u+"."+n,rt(s,E,ty(S)),i.comments.push(E),Tt(x,-1,"../comments"+u+"."+n,at.CMNT),T=!0}v["!legacy"]&&T&&rt(s,"xl/drawings/vmlDrawing"+u+".vml",ey(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&rt(s,tl(o),Ms(x))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+n,rt(s,o,Hv(t.Strings,t)),i.strs.push(o),Tt(t.wbrels,-1,"sharedStrings."+n,at.SST)),o="xl/workbook."+n,rt(s,o,vy(e)),i.workbooks.push(o),Tt(t.rels,1,o,at.WB),o="xl/theme/theme1.xml",rt(s,o,Od(e.Themes,t)),i.themes.push(o),Tt(t.wbrels,-1,"theme/theme1.xml",at.THEME),o="xl/styles."+n,rt(s,o,Xv(e,t)),i.styles.push(o),Tt(t.wbrels,-1,"styles."+n,at.STY),e.vbaraw&&r&&(o="xl/vbaProject.bin",rt(s,o,e.vbaraw),i.vba.push(o),Tt(t.wbrels,-1,"vbaProject.bin",at.VBA)),o="xl/metadata."+n,rt(s,o,Qv()),i.metadata.push(o),Tt(t.wbrels,-1,"metadata."+n,at.XLMETA),m.length>1&&(o="xl/persons/person.xml",rt(s,o,_A(m)),i.people.push(o),Tt(t.wbrels,-1,"persons/person.xml",at.PEOPLE)),rt(s,"[Content_Types].xml",mv(i,t)),rt(s,"_rels/.rels",Ms(t.rels)),rt(s,"xl/_rels/workbook."+n+".rels",Ms(t.wbrels)),delete t.revssf,delete t.ssf,s}function qd(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=hr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function hR(e,t){return We.find(e,"EncryptedPackage")?uR(e,t):Ty(e,t)}function pR(e,t){var n,r=e,i=t||{};return i.type||(i.type=it&&Buffer.isBuffer(e)?"buffer":"base64"),n=G1(r,i),lR(n,i)}function Fy(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return G0(e.slice(n),t);default:break e}return Hs.to_workbook(e,t)}function mR(e,t){var n="",r=qd(e,t);switch(t.type){case"base64":n=hr(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=za(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=Et(n)),t.type="binary",Fy(n,t)}function gR(e,t){var n=e;return t.type=="base64"&&(n=hr(n)),n=Jo.utils.decode(1200,n.slice(2),"str"),t.type="binary",Fy(n,t)}function xR(e){return e.match(/[^\x00-\x7F]/)?ri(e):e}function A0(e,t,n,r){return r?(n.type="string",Hs.to_workbook(e,n)):Hs.to_workbook(t,n)}function q0(e,t){dd();var n=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return q0(new Uint8Array(e),(n=Mt(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=e,i=[0,0,0,0],s=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),Bs={},n.dateNF&&(Bs.dateNF=n.dateNF),n.type||(n.type=it&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=it?"buffer":"binary",r=fT(e),typeof Uint8Array<"u"&&!it&&(n.type="array")),n.type=="string"&&(s=!0,n.type="binary",n.codepage=65001,r=xR(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),u=new Uint8Array(o);if(u.foo="bar",!u.foo)return n=Mt(n),n.type="array",q0(hd(r),n)}switch((i=qd(r,n))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return hR(We.read(r,n),n);break;case 9:if(i[1]<=8)return Ty(r,n);break;case 60:return G0(r,n);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return TE(r,n);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return bv.to_workbook(r,n);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?pR(r,n):A0(e,r,n,s);case 239:return i[3]===60?G0(r,n):A0(e,r,n,s);case 255:if(i[1]===254)return gR(r,n);if(i[1]===0&&i[2]===2&&i[3]===0)return Ma.to_workbook(r,n);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ma.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return W0.to_workbook(r,n);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return qv.to_workbook(r,n);break;case 10:case 13:case 32:return mR(r,n);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _E.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?W0.to_workbook(r,n):A0(e,r,n,s)}function Ry(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return ul(t.file,We.write(e,{type:it?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return We.write(e,t)}function vR(e,t){var n=Mt(t||{}),r=cR(e,n);return yR(r,n)}function yR(e,t){var n={},r=it?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?We.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(hc(i))}return t.password&&typeof encrypt_agile<"u"?Ry(encrypt_agile(i,t.password),t):t.type==="file"?ul(t.file,i):t.type=="string"?Et(i):i}function wR(e,t){var n=t||{},r=x3(e,n);return Ry(r,n)}function ni(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return Xo(ri(r));case"binary":return ri(r);case"string":return e;case"file":return ul(t.file,r,"utf8");case"buffer":return it?Ci(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):ni(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function _R(e,t){switch(t.type){case"base64":return Xo(e);case"binary":return e;case"string":return e;case"file":return ul(t.file,e,"binary");case"buffer":return it?Ci(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Bu(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?Xo(n):t.type=="string"?Et(n):n;case"file":return ul(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function Dy(e,t){dd(),hF(e);var n=Mt(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=Dy(e,n);return n.type="array",hc(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return ni(c3(e,n),n);case"slk":case"sylk":return ni(zv.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return ni(Sy(e.Sheets[e.SheetNames[i]],n),n);case"txt":return _R(Py(e.Sheets[e.SheetNames[i]],n),n);case"csv":return ni(Kd(e.Sheets[e.SheetNames[i]],n),n,"\uFEFF");case"dif":return ni(bv.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return Bu(W0.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return ni(Hs.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return ni(qv.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return ni(Vv.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return ni(Iy(e,n),n);case"wk1":return Bu(Ma.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return Bu(Ma.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Bu(ky(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),wR(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vR(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function TR(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function kR(e,t,n){var r={};return r.type="file",r.file=t,TR(r),Dy(e,r)}function SR(e,t,n,r,i,s,o,u){var d=Qt(n),h=u.defval,m=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),x=!0,v=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:n,enumerable:!1})}catch{v.__rowNum__=n}else v.__rowNum__=n;if(!o||e[n])for(var _=t.s.c;_<=t.e.c;++_){var S=o?e[n][_]:e[r[_]+d];if(S===void 0||S.t===void 0){if(h===void 0)continue;s[_]!=null&&(v[s[_]]=h);continue}var T=S.v;switch(S.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+S.t)}if(s[_]!=null){if(T==null)if(S.t=="e"&&T===null)v[s[_]]=null;else if(h!==void 0)v[s[_]]=h;else if(m&&T===null)v[s[_]]=null;else continue;else v[s[_]]=m&&(S.t!=="n"||S.t==="n"&&u.rawNumbers!==!1)?T:Si(S,T,u);T!=null&&(x=!1)}}return{row:v,isempty:x}}function ic(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],o=0,u="",d={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},m=h.range!=null?h.range:e["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof m){case"string":d=ct(m);break;case"number":d=ct(e["!ref"]),d.s.r=m;break;default:d=m}r>0&&(i=0);var x=Qt(d.s.r),v=[],_=[],S=0,T=0,E=Array.isArray(e),C=d.s.r,I=0,A={};E&&!e[C]&&(e[C]=[]);var D=h.skipHidden&&e["!cols"]||[],P=h.skipHidden&&e["!rows"]||[];for(I=d.s.c;I<=d.e.c;++I)if(!(D[I]||{}).hidden)switch(v[I]=Ht(I),n=E?e[C][I]:e[v[I]+x],r){case 1:s[I]=I-d.s.c;break;case 2:s[I]=v[I];break;case 3:s[I]=h.header[I-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),u=o=Si(n,null,h),T=A[o]||0,!T)A[o]=1;else{do u=o+"_"+T++;while(A[u]);A[o]=T,A[u]=1}s[I]=u}for(C=d.s.r+i;C<=d.e.r;++C)if(!(P[C]||{}).hidden){var L=SR(e,d,C,v,r,s,E,h);(L.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(_[S++]=L.row)}return _.length=S,_}var Yg=/"/g;function ER(e,t,n,r,i,s,o,u){for(var d=!0,h=[],m="",x=Qt(n),v=t.s.c;v<=t.e.c;++v)if(r[v]){var _=u.dense?(e[n]||[])[v]:e[r[v]+x];if(_==null)m="";else if(_.v!=null){d=!1,m=""+(u.rawNumbers&&_.t=="n"?_.v:Si(_,null,u));for(var S=0,T=0;S!==m.length;++S)if((T=m.charCodeAt(S))===i||T===s||T===34||u.forceQuotes){m='"'+m.replace(Yg,'""')+'"';break}m=="ID"&&(m='"ID"')}else _.f!=null&&!_.F?(d=!1,m="="+_.f,m.indexOf(",")>=0&&(m='"'+m.replace(Yg,'""')+'"')):m="";h.push(m)}return u.blankrows===!1&&d?null:h.join(o)}function Kd(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var i=ct(e["!ref"]),s=r.FS!==void 0?r.FS:",",o=s.charCodeAt(0),u=r.RS!==void 0?r.RS:`
`,d=u.charCodeAt(0),h=new RegExp((s=="|"?"\\|":s)+"+$"),m="",x=[];r.dense=Array.isArray(e);for(var v=r.skipHidden&&e["!cols"]||[],_=r.skipHidden&&e["!rows"]||[],S=i.s.c;S<=i.e.c;++S)(v[S]||{}).hidden||(x[S]=Ht(S));for(var T=0,E=i.s.r;E<=i.e.r;++E)(_[E]||{}).hidden||(m=ER(e,i,E,x,o,d,s,r),m!=null&&(r.strip&&(m=m.replace(h,"")),(m||r.blankrows!==!1)&&n.push((T++?u:"")+m)));return delete r.dense,n.join("")}function Py(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=Kd(e,t);return n}function CR(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var i=ct(e["!ref"]),s="",o=[],u,d=[],h=Array.isArray(e);for(u=i.s.c;u<=i.e.c;++u)o[u]=Ht(u);for(var m=i.s.r;m<=i.e.r;++m)for(s=Qt(m),u=i.s.c;u<=i.e.c;++u)if(t=o[u]+s,n=h?(e[m]||[])[u]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=t+"="+r}return d}function My(e,t,n){var r=n||{},i=+!r.skipHeader,s=e||{},o=0,u=0;if(s&&r.origin!=null)if(typeof r.origin=="number")o=r.origin;else{var d=typeof r.origin=="string"?Wt(r.origin):r.origin;o=d.r,u=d.c}var h,m={s:{c:0,r:0},e:{c:u,r:o+t.length-1+i}};if(s["!ref"]){var x=ct(s["!ref"]);m.e.c=Math.max(m.e.c,x.e.c),m.e.r=Math.max(m.e.r,x.e.r),o==-1&&(o=x.e.r+1,m.e.r=o+t.length-1+i)}else o==-1&&(o=0,m.e.r=t.length-1+i);var v=r.header||[],_=0;t.forEach(function(T,E){Jt(T).forEach(function(C){(_=v.indexOf(C))==-1&&(v[_=v.length]=C);var I=T[C],A="z",D="",P=Je({c:u+_,r:o+E+i});h=ll(s,P),I&&typeof I=="object"&&!(I instanceof Date)?s[P]=I:(typeof I=="number"?A="n":typeof I=="boolean"?A="b":typeof I=="string"?A="s":I instanceof Date?(A="d",r.cellDates||(A="n",I=fn(I)),D=r.dateNF||Ke[14]):I===null&&r.nullError&&(A="e",I=0),h?(h.t=A,h.v=I,delete h.w,delete h.R,D&&(h.z=D)):s[P]=h={t:A,v:I},D&&(h.z=D))})}),m.e.c=Math.max(m.e.c,u+v.length-1);var S=Qt(o);if(i)for(_=0;_<v.length;++_)s[Ht(_+u)+S]={t:"s",v:v[_]};return s["!ref"]=nt(m),s}function AR(e,t){return My(null,e,t)}function ll(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=Wt(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ll(e,Je(t)):ll(e,Je({r:t,c:n||0}))}function IR(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function Jd(){return{SheetNames:[],Sheets:{}}}function Xd(e,t,n,r){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=o+i)!=-1;++i);}if(xy(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function NR(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=IR(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function FR(e,t){return e.z=t,e}function Ly(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function RR(e,t,n){return Ly(e,"#"+t,n)}function DR(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function PR(e,t,n,r){for(var i=typeof t!="string"?t:ct(t),s=typeof t=="string"?t:nt(t),o=i.s.r;o<=i.e.r;++o)for(var u=i.s.c;u<=i.e.c;++u){var d=ll(e,o,u);d.t="n",d.F=s,delete d.v,o==i.s.r&&u==i.s.c&&(d.f=n,r&&(d.D=!0))}return e}var Vu={encode_col:Ht,encode_row:Qt,encode_cell:Je,encode_range:nt,decode_col:Ed,decode_row:Sd,split_cell:WT,decode_cell:Wt,decode_range:Qn,format_cell:Si,sheet_add_aoa:lv,sheet_add_json:My,sheet_add_dom:Ey,aoa_to_sheet:js,json_to_sheet:AR,table_to_sheet:Cy,table_to_book:z3,sheet_to_csv:Kd,sheet_to_txt:Py,sheet_to_json:ic,sheet_to_html:Sy,sheet_to_formulae:CR,sheet_to_row_object_array:ic,sheet_get_cell:ll,book_new:Jd,book_append_sheet:Xd,book_set_sheet_visibility:NR,cell_set_number_format:FR,cell_set_hyperlink:Ly,cell_set_internal_link:RR,cell_add_comment:DR,sheet_set_array_formula:PR,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const MR={releases:["name","details"],roadmap:["jira","orderName","packageName","analysisHours","devITHours","devLFHours","testingHours","deploymentHours","stabilizationLFHours","totalITHoursWithBuffer","workLFHours","totalHours","comment"],backlog:["ticketId","description","foz","plannedDate","analyst","status","decision","comment"]},LR=e=>{const t=Math.floor(e-25569),n=new Date(t*86400*1e3),r=e-Math.floor(e)+1e-7;let i=Math.floor(86400*r);const s=i%60;i-=s;const o=Math.floor(i/3600),u=Math.floor(i/60)%60;return new Date(n.getFullYear(),n.getMonth(),n.getDate(),o,u,s)},BR=(e,t)=>new Promise((n,r)=>{const i=new FileReader;i.onload=s=>{var o;try{if(!((o=s.target)!=null&&o.result))return r(new Error("Nie mona odczyta pliku."));const u=new Uint8Array(s.target.result),d=q0(u,{type:"array"}),h=d.SheetNames[0];if(!h)return r(new Error("Plik Excel jest pusty lub nie zawiera arkuszy."));const m=d.Sheets[h],x=Vu.sheet_to_json(m,{header:1});if(x.length<2)return r(new Error("Plik Excel musi zawiera co najmniej wiersz nagwka i jeden wiersz danych."));const v=MR[t],_=x[0].map(I=>String(I).trim()),S=v.filter(I=>!_.includes(I));if(S.length>0)return r(new Error(`Brakujce nagwki w pliku Excel: ${S.join(", ")}.
Oczekiwano: ${v.join(", ")}`));const T=_.reduce((I,A,D)=>(I[A]=D,I),{}),C=x.slice(1).map((I,A)=>{const D={};if(v.forEach(P=>{const L=T[P];let R=I[L];if(R==null){D[P]=void 0;return}if(P.toLowerCase().includes("date")&&typeof R=="number")try{D[P]=LR(R).toISOString()}catch{D[P]=new Date(R).toISOString()}else if(P.toLowerCase().includes("date")&&typeof R=="string"){const J=new Date(R);isNaN(J.getTime())?D[P]=void 0:D[P]=J.toISOString()}else D[P]=R}),t==="releases"&&!D.name)throw new Error(`Brak wymaganej wartoci 'name' w wierszu ${A+2}.`);if(t==="backlog"&&!D.description)throw new Error(`Brak wymaganej wartoci 'description' w wierszu ${A+2}.`);return D});n(C)}catch(u){console.error("Bd podczas parsowania pliku XLSX:",u),r(u)}},i.onerror=s=>{r(new Error("Nie udao si odczyta pliku."))},i.readAsArrayBuffer(e)}),I0=e=>{const{filename:t,headers:n,data:r}=e,i=n.map(m=>m.label),s=r.map(m=>n.map(x=>{const v=m[x.key];if(x.key.toString().toLowerCase().includes("date")&&v){const _=new Date(v);if(!isNaN(_.getTime()))return _}return v})),o=[i,...s],u=Vu.aoa_to_sheet(o),d=i.map((m,x)=>({wch:Math.max(m.length,...s.map(v=>v[x]?String(v[x]).length:0))+2}));u["!cols"]=d;const h=Vu.book_new();Vu.book_append_sheet(h,u,"Dane"),kR(h,t)};var K0=(e=>(e.DELAYED_STAGE="DELAYED_STAGE",e.GO_LIVE_SHIFT="GO_LIVE_SHIFT",e))(K0||{});const OR=(e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+t),n},UR=(e,t)=>e.reduce((n,r)=>{const i=ld.reduce((s,o)=>{const u=r.plannedTime[o]||0,d=r.actualTime[o]||0;return s+Math.max(u,d)},0);return n+i},0),zR=async()=>{const e=[],t=await v2("inProgress");for(const n of t){if(!n.id)continue;const r=await w2(n.id);r.forEach(d=>{ld.forEach(h=>{d.actualTime[h]>d.plannedTime[h]&&e.push({id:`task-${d.id}-stage-${h}-delay`,packageId:n.id,taskId:d.id,type:K0.DELAYED_STAGE,message:`Zadanie "${d.name}": Etap "${h}" jest opniony o ${d.actualTime[h]-d.plannedTime[h]} dni.`,timestamp:new Date().toISOString()})})});const i=new Date(n.createdAt),s=UR(r),o=OR(i,s),u=new Date(n.currentGoLiveDate);if(o.getTime()>u.getTime()){const d=Math.ceil((o.getTime()-u.getTime())/864e5);e.push({id:`package-${n.id}-golive-shift`,packageId:n.id,type:K0.GO_LIVE_SHIFT,message:`Data Go Live dla paczki "${n.name}" przesuna si o ${d} dni. Nowa prognozowana data: ${o.toLocaleDateString()}.`,timestamp:new Date().toISOString()})}}return e},bR=7,Ou=(e,t)=>{let n=new Date(e.getTime()),r=t;for(;r>0;)n.setDate(n.getDate()-1),n.getDay()!==0&&n.getDay()!==6&&r--;return n},VR=(e,t)=>{let n=new Date(e.getTime()),r=t;for(;r>0;)n.setDate(n.getDate()+1),n.getDay()!==0&&n.getDay()!==6&&r--;return n},ea=e=>!e||e<=0?0:Math.ceil(e/bR),ac=(e,t)=>{const n=ea(e);return ea(t)-n},sc=(e,t)=>{if(!t)return{schedule:[],overallStartDate:null,overallEndDate:null};const n=[],r=new Date(e.currentGoLiveDate);r.setHours(0,0,0,0);const i=t.stabilizationLFHours||0,s=ea(i);if(s>0){const L=new Date(r),R=VR(new Date(L),s-1);n.push({key:"stabilization",name:ta.stabilization,startDate:L,stopDate:R,durationDays:s,durationHours:i})}let o=new Date(r);const u=t.deploymentHours||0,d=ea(u);if(d>0){const L=new Date(o),R=Ou(new Date(L),d-1);n.push({key:"deployment",name:ta.deployment,startDate:R,stopDate:L,durationDays:d,durationHours:u}),o=new Date(R),o.setDate(o.getDate()-1)}const h=t.testingHours||0,m=ea(h);if(m>0){const L=new Date(o),R=Ou(new Date(L),m-1);n.push({key:"testing",name:ta.testing,startDate:R,stopDate:L,durationDays:m,durationHours:h}),o=new Date(R),o.setDate(o.getDate()-1)}const x=t.devITHours||0,v=t.devLFHours||0,_=ea(x),S=ea(v),T=Math.max(_,S);if(T>0){const L=new Date(o),R=Ou(new Date(L),T-1);n.push({key:"development",name:`${ta.development} (IT/LF)`,startDate:R,stopDate:L,durationDays:T,itHours:x,lfHours:v}),o=new Date(R),o.setDate(o.getDate()-1)}const E=t.analysisHours||0,C=ea(E);if(C>0){const L=new Date(o),R=Ou(new Date(L),C-1);n.push({key:"analysis",name:ta.analysis,startDate:R,stopDate:L,durationDays:C,durationHours:E})}if(n.sort((L,R)=>L.startDate.getTime()-R.startDate.getTime()),n.length===0)return{schedule:[],overallStartDate:null,overallEndDate:null};const I=n.map(L=>L.startDate.getTime()),A=n.map(L=>L.stopDate.getTime()),D=new Date(Math.min(...I)),P=new Date(Math.max(...A));return{schedule:n,overallStartDate:D,overallEndDate:P}},jt=(e,t)=>{const n={type:e,description:t,timestamp:new Date().toISOString()};return R2(n)},qe=({children:e,variant:t="primary",size:n="md",className:r="",...i})=>{const s="rounded-md font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",o={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-200 text-gray-800 hover:bg-gray-300 focus:ring-gray-500 border border-gray-300",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"},u={sm:"px-3 py-1 text-sm",md:"px-4 py-2",lg:"px-6 py-3"};return y.jsx("button",{className:`${s} ${u[n]} ${o[t]} ${r}`,...i,children:e})},St=({label:e,className:t,...n})=>y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),y.jsx("input",{className:`w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-gray-900 focus:ring-blue-500 focus:border-blue-500 placeholder-gray-400 read-only:bg-gray-100 read-only:cursor-not-allowed ${t||""}`,...n})]}),er=({isOpen:e,onClose:t,title:n,children:r})=>e?y.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 transition-opacity",children:y.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl m-4",onClick:i=>i.stopPropagation(),children:[y.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200",children:[y.jsx("h2",{className:"text-xl font-bold text-gray-900",children:n}),y.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-700 text-2xl leading-none",children:""})]}),y.jsx("div",{className:"p-6 text-gray-700",children:r})]})}):null,dr=({label:e,children:t,...n})=>y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),y.jsx("select",{className:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-gray-900 focus:ring-blue-500 focus:border-blue-500 transition",...n,children:t})]}),HR=({isOpen:e,onClose:t,onSave:n,releases:r,targetReleaseId:i})=>{const[s,o]=ge.useState(""),[u,d]=ge.useState(""),[h,m]=ge.useState("");ge.useEffect(()=>{e&&(o(""),m(""),d(i?String(i):""))},[e,i]);const x=()=>{if(s.trim()&&h){const v=u===""?null:Number(u);n(v,s,new Date(h).toISOString()),t()}};return y.jsx(er,{isOpen:e,onClose:t,title:"Dodaj now paczk releasow",children:y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsx(St,{label:"Nazwa paczki",value:s,onChange:v=>o(v.target.value),placeholder:"np. Paczka Q3 2024",required:!0}),y.jsxs(dr,{label:"Wydanie (opcjonalnie)",value:u,onChange:v=>d(v.target.value),disabled:r.length===0,children:[y.jsx("option",{value:"",children:"(Brak przypisania)"}),r.map(v=>y.jsx("option",{value:v.id,children:v.name},v.id))]})]}),y.jsx(St,{label:"Data Go-Live",type:"date",value:h,onChange:v=>m(v.target.value),required:!0}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:x,disabled:!s||!h,children:"Zapisz paczk"})]})]})})},Ei=({label:e,...t})=>y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e}),y.jsx("textarea",{className:"w-full bg-white border border-gray-300 rounded-md px-3 py-2 text-gray-900 focus:ring-blue-500 focus:border-blue-500 transition placeholder-gray-400",rows:3,...t})]}),WR=({isOpen:e,onClose:t,onSave:n})=>{const[r,i]=ge.useState(""),[s,o]=ge.useState(""),u=()=>{r.trim()&&s.trim()&&(n(r,s),i(""),o(""),t())};return y.jsx(er,{isOpen:e,onClose:t,title:"Dodaj nowe wydanie",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(St,{label:"Nazwa wydania",value:r,onChange:d=>i(d.target.value),placeholder:"np. Q4 2024"}),y.jsx(Ei,{label:"Szczegy wydania",value:s,onChange:d=>o(d.target.value),placeholder:"np. Zmiany DPD, Formalno-prawne, tylko NSKM, lub SAP",required:!0}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:u,disabled:!r.trim()||!s.trim(),children:"Zapisz wydanie"})]})]})})},GR=({isOpen:e,onClose:t,onSave:n,releaseToEdit:r})=>{const[i,s]=ge.useState(""),[o,u]=ge.useState("");ge.useEffect(()=>{r&&(s(r.name),u(r.details||""))},[r]);const d=()=>{if(i.trim()&&o.trim()&&r){const h={...r,name:i,details:o};n(h),t()}};return r?y.jsx(er,{isOpen:e,onClose:t,title:"Edytuj wydanie",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(St,{label:"Nazwa wydania",value:i,onChange:h=>s(h.target.value),placeholder:"np. Q4 2024"}),y.jsx(Ei,{label:"Szczegy wydania",value:o,onChange:h=>u(h.target.value),placeholder:"np. Zmiany DPD, Formalno-prawne, tylko NSKM, lub SAP",required:!0}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:d,disabled:!i.trim()||!o.trim(),children:"Zapisz zmiany"})]})]})}):null},$R=({isOpen:e,onClose:t,onSave:n,packageToEdit:r,releases:i,roadmapItems:s})=>{const[o,u]=ge.useState(""),[d,h]=ge.useState("planning"),[m,x]=ge.useState(""),[v,_]=ge.useState(""),S=ge.useMemo(()=>{if(!r)return[];const E=s.some(A=>A.packageName===r.name),C=$u.indexOf(r.status),I=["ready","inProgress","completed"];return $u.filter((A,D)=>A===r.status||D<C?!0:D===C+1?!(I.includes(A)&&!E):!1)},[r,s]);ge.useEffect(()=>{r&&(u(r.name),h(r.status),x(r.releaseId===null?"":String(r.releaseId)),_(new Date(r.currentGoLiveDate).toISOString().split("T")[0]))},[r]);const T=()=>{if(o.trim()&&r){const E={...r,name:o,status:d,releaseId:m===""?null:Number(m),currentGoLiveDate:new Date(v).toISOString()};n(E)}};return r?y.jsx(er,{isOpen:e,onClose:t,title:"Edytuj paczk",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(St,{label:"Nazwa paczki",value:o,onChange:E=>u(E.target.value),placeholder:"np. Paczka Q3 2024"}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsx(dr,{label:"Status paczki",value:d,onChange:E=>h(E.target.value),children:S.map(E=>y.jsx("option",{value:E,children:wi[E]},E))}),y.jsxs(dr,{label:"Wydanie",value:m,onChange:E=>x(E.target.value),children:[y.jsx("option",{value:"",children:"(Brak wydania)"}),i.map(E=>y.jsx("option",{value:E.id,children:E.name},E.id))]})]}),y.jsx(St,{label:"Prognozowane Go-Live",type:"date",value:v,onChange:E=>_(E.target.value)}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:T,children:"Zapisz zmiany"})]})]})}):null},Wn=({children:e,className:t=""})=>y.jsx("div",{className:`bg-white border border-gray-200 rounded-lg shadow-sm p-6 ${t}`,children:e}),jR=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})}),Yd=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),qR=({packages:e,releases:t,backlogItems:n,roadmapItems:r,alerts:i,setView:s})=>{const o=e.reduce((m,x)=>(m[x.status]=(m[x.status]||0)+1,m),{}),u=o.inProgress||0,d=e.length,h=({title:m,value:x,description:v,onClick:_})=>y.jsxs("div",{className:`bg-gray-50 p-4 rounded-lg flex-1 transition-colors ${_?"cursor-pointer hover:bg-gray-100":""}`,onClick:_,children:[y.jsx("p",{className:"text-sm text-gray-500",children:m}),y.jsx("p",{className:"text-3xl font-bold text-gray-900",children:x}),y.jsx("p",{className:"text-xs text-gray-500",children:v})]});return y.jsxs("div",{className:"h-full overflow-y-auto",children:[y.jsxs("div",{className:"mb-8",children:[y.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Pulpit"}),y.jsx("p",{className:"text-gray-500 mt-1",children:"Oto przegld biecego stanu prac i kluczowych wskanikw."})]}),y.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[y.jsxs(Wn,{className:"lg:col-span-4",children:[y.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-900",children:"W skrcie"}),y.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[y.jsx(h,{title:"Aktywne Wydania",value:t.length,description:"Wszystkie zdefiniowane wydania",onClick:()=>s("releases")}),y.jsx(h,{title:"Paczki w toku",value:u,description:`z ${d} wszystkich paczek`,onClick:()=>s("releases")}),y.jsx(h,{title:"Elementy w Backlogu",value:n.length,description:"Oczekujce na analiz i decyzj",onClick:()=>s("backlog")}),y.jsx(h,{title:"Pozycje na Roadmapie",value:r.length,description:"Zaplanowane prace i estymacje",onClick:()=>s("roadmap")})]})]}),y.jsxs(Wn,{className:`lg:col-span-3 ${i.length>0?"border-yellow-300 bg-yellow-50":"border-green-300 bg-green-50"}`,children:[y.jsxs("div",{className:"flex items-center mb-4",children:[i.length>0?y.jsx(jR,{className:"w-6 h-6 mr-3 text-yellow-500 flex-shrink-0"}):y.jsx(Yd,{className:"w-6 h-6 mr-3 text-green-500 flex-shrink-0"}),y.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Powiadomienia i Alerty"})]}),i.length>0?y.jsxs("ul",{className:"space-y-2 max-h-40 overflow-y-auto",children:[i.slice(0,5).map(m=>y.jsx("li",{className:"text-sm text-gray-700 bg-white/50 p-2 rounded-md border border-gray-200",children:m.message},m.id)),i.length>5&&y.jsxs("li",{className:"text-xs text-center text-gray-500 pt-2",children:["... i ",i.length-5," wicej."]})]}):y.jsx("p",{className:"text-gray-500",children:"Brak alertw. Wszystko jest w porzdku!"})]}),y.jsxs(Wn,{className:"lg:col-span-1",children:[y.jsx("h3",{className:"text-xl font-semibold mb-4 text-gray-900",children:"Status Paczek"}),y.jsxs("div",{className:"space-y-3",children:[(Object.keys(o).length>0?$u:[]).map(m=>{const x=o[m]||0;if(x===0&&m!=="inProgress")return null;const v=d>0?x/d*100:0;return y.jsxs("div",{children:[y.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[y.jsx("span",{className:"text-sm font-medium text-gray-600",children:wi[m]}),y.jsx("span",{className:"text-sm font-semibold text-gray-900",children:x})]}),y.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:y.jsx("div",{className:`${_1[m].split(" ")[0]} h-2 rounded-full`,style:{width:`${v}%`}})})]},m)}),d===0&&y.jsx("p",{className:"text-gray-500 text-sm",children:"Brak paczek do wywietlenia."})]})]}),y.jsxs(Wn,{className:"lg:col-span-2",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Ostatnie w Backlogu"}),y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>s("backlog"),children:"Zobacz cay"})]}),n.length>0?y.jsx("ul",{className:"space-y-2",children:n.slice(-4).reverse().map(m=>y.jsxs("li",{className:"flex justify-between items-center p-2 bg-gray-50 rounded-md transition hover:bg-gray-100 border border-gray-200",children:[y.jsx("span",{className:"truncate pr-4 text-gray-700",title:m.description,children:m.description||"Brak opisu"}),y.jsx("span",{className:"text-xs text-gray-600 flex-shrink-0 px-2 py-1 bg-gray-200 rounded",children:m.status||"Brak statusu"})]},m.internalId))}):y.jsx("p",{className:"text-gray-500",children:"Backlog jest pusty."})]}),y.jsxs(Wn,{className:"lg:col-span-2",children:[y.jsxs("div",{className:"flex justify-between items-center mb-4",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Ostatnie na Roadmapie"}),y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>s("roadmap"),children:"Zobacz ca"})]}),r.length>0?y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"w-full text-sm",children:[y.jsx("thead",{className:"text-left text-gray-500",children:y.jsxs("tr",{className:"border-b border-gray-200",children:[y.jsx("th",{className:"p-2 font-semibold",children:"Jira"}),y.jsx("th",{className:"p-2 font-semibold",children:"Nazwa"}),y.jsx("th",{className:"p-2 font-semibold",children:"Paczka"}),y.jsx("th",{className:"p-2 font-semibold text-right",children:"Suma (h)"})]})}),y.jsx("tbody",{children:r.slice(-4).reverse().map(m=>y.jsxs("tr",{className:"border-b border-gray-100 last:border-0 hover:bg-gray-50",children:[y.jsx("td",{className:"p-2 font-semibold text-gray-800",children:m.jira||"-"}),y.jsx("td",{className:"p-2 truncate text-gray-700",title:m.orderName,children:m.orderName||"Brak nazwy"}),y.jsx("td",{className:"p-2 text-gray-500",children:m.packageName||"Brak paczki"}),y.jsxs("td",{className:"p-2 text-right font-bold text-gray-800",children:[m.totalHours||"0","h"]})]},m.id))})]})}):y.jsx("p",{className:"text-gray-500",children:"Roadmapa jest pusta."})]})]})]})},xl=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"})}),vl=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 19.07a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.862 4.487zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"})}),yl=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),Tc=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),KR=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3c2.755 0 5.455.232 8.083.678.533.09.917.556.917 1.096v1.044a2.25 2.25 0 01-.659 1.591l-5.432 5.432a2.25 2.25 0 00-.659 1.591v2.927a2.25 2.25 0 01-1.244 2.013L9.75 21v-6.572a2.25 2.25 0 00-.659-1.591L3.659 7.409A2.25 2.25 0 013 5.818V4.774c0-.54.384-1.006.917-1.096A48.32 48.32 0 0112 3z"})}),Os=({options:e,selectedOptions:t,onSelectionChange:n,title:r})=>{const[i,s]=ge.useState(!1),o=ge.useRef(null);ge.useEffect(()=>{const x=v=>{o.current&&!o.current.contains(v.target)&&s(!1)};return document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[o]);const u=x=>{const v=t.includes(x)?t.filter(_=>_!==x):[...t,x];n(v)},d=()=>{t.length===e.length?n([]):n([...e])},h=()=>{n([])},m=t.length>0;return y.jsxs("div",{ref:o,className:"relative inline-block ml-2",children:[y.jsx("button",{onClick:()=>s(!i),className:"p-1 rounded-md hover:bg-gray-200",children:y.jsx(KR,{className:`w-5 h-5 transition-colors ${m?"text-blue-600":"text-gray-500 hover:text-gray-700"}`})}),i&&y.jsx("div",{className:"absolute z-20 mt-2 w-64 bg-white border border-gray-200 rounded-lg shadow-xl right-0 origin-top-right",children:y.jsxs("div",{className:"p-3",children:[y.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:r}),y.jsxs("div",{className:"flex justify-between items-center mb-2",children:[y.jsx("button",{onClick:d,className:"text-xs text-blue-600 hover:underline",children:t.length===e.length?"Odznacz wszystko":"Zaznacz wszystko"}),y.jsx("button",{onClick:h,disabled:!m,className:"text-xs text-red-600 hover:underline disabled:opacity-50 disabled:cursor-not-allowed",children:"Wyczy"})]}),y.jsx("div",{className:"max-h-60 overflow-y-auto space-y-1 pr-2",children:e.map(x=>y.jsxs("label",{className:"flex items-center p-1 rounded-md hover:bg-gray-100 cursor-pointer",children:[y.jsx("input",{type:"checkbox",checked:t.includes(x),onChange:()=>u(x),className:"h-4 w-4 rounded bg-gray-100 border-gray-300 text-blue-600 focus:ring-blue-500"}),y.jsx("span",{className:"ml-3 text-sm text-gray-700 truncate",children:x})]},x))})]})})]})},By=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})}),Oy=({pkg:e,onEdit:t,onDelete:n,onOpenApproveModal:r,onStartRealization:i})=>{const s=wi[e.status],o=_1[e.status],u=e.status==="ready"&&!e.isScheduleApproved,d=e.status==="ready"&&e.isScheduleApproved;return y.jsxs("div",{className:`bg-white border ${u?"border-yellow-300":"border-gray-200"} rounded-lg transition-shadow hover:shadow-md`,children:[y.jsxs("div",{className:"p-3 flex justify-between items-center",children:[y.jsxs("div",{className:"flex-grow min-w-0",children:[y.jsx("p",{className:"font-bold text-gray-800 truncate",children:e.name}),y.jsxs("div",{className:"flex items-center mt-1",children:[y.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${o}`,children:s}),e.isScheduleApproved&&y.jsxs("span",{className:"ml-2 flex items-center text-xs text-green-600 font-semibold",title:`Zatwierdzony przez ${e.scheduleApprover} dnia ${new Date(e.scheduleApprovedAt).toLocaleDateString()}`,children:[y.jsx(Yd,{className:"w-4 h-4 mr-1"}),"Harmonogram Zatwierdzony"]})]})]}),y.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0 ml-4",children:[d&&y.jsx(qe,{size:"sm",onClick:()=>i(e.id),className:"bg-green-600 hover:bg-green-700",children:"Rozpocznij realizacj"}),y.jsx(qe,{size:"sm",variant:"secondary",onClick:()=>t(e),title:"Edytuj paczk",children:y.jsx(vl,{className:"w-4 h-4"})}),y.jsx(qe,{size:"sm",variant:"danger",onClick:()=>n(e.id),title:"Usu paczk",children:y.jsx(yl,{className:"w-4 h-4"})})]})]}),u&&y.jsxs("div",{className:"bg-yellow-50 border-t border-yellow-200 px-3 py-4",children:[y.jsx("h4",{className:"font-semibold text-yellow-800",children:"Oczekiwanie na akceptacj"}),y.jsx("p",{className:"text-sm text-yellow-700 mt-1 mb-3",children:'Harmonogram bazowy zosta utworzony. Zatwierd go, aby umoliwi rozpoczcie prac i zmian statusu na "W realizacji".'}),y.jsx(qe,{size:"sm",onClick:()=>r(e),className:"bg-yellow-400 hover:bg-yellow-500 text-yellow-900 font-semibold",children:"Podejrzyj i zatwierd harmonogram"})]})]})},JR=({release:e,packages:t,onAddPackage:n,onEditRelease:r,onDeleteRelease:i,onEditPackage:s,onDeletePackage:o,onOpenApproveModal:u,onStartRealization:d})=>{const[h,m]=ge.useState(!0);return y.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg mb-4",children:[y.jsxs("div",{className:"flex justify-between items-center p-4 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>m(!h),children:[y.jsxs("div",{className:"flex items-center flex-grow min-w-0",children:[y.jsx(By,{className:`w-5 h-5 mr-3 text-gray-500 transition-transform flex-shrink-0 ${h?"":"transform -rotate-90"}`}),y.jsx("h3",{className:"text-xl font-bold text-gray-800 truncate",title:e.name,children:e.name}),y.jsxs("span",{className:"ml-3 bg-gray-200 text-gray-700 text-xs font-semibold px-2 py-1 rounded-full flex-shrink-0",children:[t.length," pacz."]})]}),y.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0 pl-4",onClick:x=>x.stopPropagation(),children:[y.jsxs(qe,{size:"sm",variant:"secondary",onClick:()=>n(e.id),children:[y.jsx(xl,{className:"w-4 h-4 mr-1"})," Dodaj paczk"]}),y.jsx(qe,{size:"sm",variant:"secondary",onClick:()=>r(e),title:"Edytuj wydanie",children:y.jsx(vl,{className:"w-4 h-4"})}),y.jsx(qe,{size:"sm",variant:"danger",onClick:()=>i(e.id),title:"Usu wydanie",children:y.jsx(yl,{className:"w-4 h-4"})})]})]}),h&&y.jsx("div",{className:"p-4 border-t border-gray-200 space-y-3",children:t.length>0?t.map(x=>y.jsx(Oy,{pkg:x,onEdit:s,onDelete:o,onOpenApproveModal:u,onStartRealization:d},x.id)):y.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Brak paczek w tym wydaniu."})})]})},XR=e=>{const{releases:t,packages:n,onAddRelease:r,...i}=e,[s,o]=ge.useState(""),[u,d]=ge.useState([]),h=ge.useMemo(()=>$u.map(E=>wi[E]),[]),m=ge.useMemo(()=>wi,[]),x=ge.useMemo(()=>Object.entries(wi).reduce((E,[C,I])=>(E[I]=C,E),{}),[]),v=E=>{const C=E.map(I=>x[I]);d(C)},_=ge.useMemo(()=>{let E=[...n];u.length>0&&(E=E.filter(I=>u.includes(I.status)));const C=s.toLowerCase();return C&&(E=E.filter(I=>I.name.toLowerCase().includes(C))),E},[n,s,u]),S=ge.useMemo(()=>_.filter(E=>E.releaseId===null),[_]),T=ge.useMemo(()=>_.reduce((E,C)=>(C.releaseId&&(E[C.releaseId]||(E[C.releaseId]=[]),E[C.releaseId].push(C)),E),{}),[_]);return y.jsxs("div",{className:"h-full flex flex-col overflow-y-auto",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4 flex-shrink-0",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Zarzdzanie Wydaniami"}),y.jsxs("div",{className:"flex items-center gap-4",children:[y.jsxs("div",{className:"relative",children:[y.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:y.jsx(Tc,{className:"w-5 h-5 text-gray-400"})}),y.jsx("input",{type:"text",placeholder:"Filtruj paczki po nazwie...",value:s,onChange:E=>o(E.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:ring-blue-500 focus:border-blue-500"})]}),y.jsx(Os,{title:"Filtruj po statusie",options:h,selectedOptions:u.map(E=>m[E]),onSelectionChange:v}),y.jsxs(qe,{onClick:r,children:[y.jsx(xl,{className:"w-5 h-5 mr-2 inline"}),"Nowe Wydanie"]})]})]}),y.jsxs("div",{className:"flex-grow",children:[S.length>0&&y.jsxs("div",{className:"mb-8 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("h3",{className:"text-lg font-semibold mb-3 text-gray-700",children:"Paczki bez przypisania"}),y.jsx("div",{className:"space-y-3",children:S.map(E=>y.jsx(Oy,{pkg:E,onEdit:i.onEditPackage,onDelete:i.onDeletePackage,onOpenApproveModal:i.onOpenApproveModal,onStartRealization:i.onStartRealization},E.id))})]}),y.jsx("div",{children:t.map(E=>{const C=T[E.id]||[];return C.length===0&&(s||u.length>0)?null:y.jsx(JR,{release:E,packages:C,...i},E.id)})}),t.length===0&&S.length===0&&y.jsxs("div",{className:"text-center py-16 text-gray-500",children:[y.jsx("p",{children:"Brak wyda i paczek."}),y.jsx("p",{children:"Zacznij od dodania nowego wydania."})]})]})]})},Uy=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 15.75l7.5-7.5 7.5 7.5"})}),zy=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 8.25l-7.5 7.5-7.5-7.5"})}),by=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 7.5L7.5 3m0 0L12 7.5M7.5 3v13.5m13.5 0L16.5 21m0 0L12 16.5m4.5 4.5V7.5"})}),YR=({items:e,onAddItem:t,onEditItem:n,onDeleteItem:r,onAddToRoadmap:i})=>{const[s,o]=ge.useState(""),[u,d]=ge.useState([]),[h,m]=ge.useState([]),[x,v]=ge.useState([]),[_,S]=ge.useState({key:"internalId",direction:"descending"}),T=ge.useMemo(()=>{let A=[...e];u.length>0&&(A=A.filter(P=>P.status&&u.includes(P.status))),h.length>0&&(A=A.filter(P=>P.foz&&h.includes(P.foz))),x.length>0&&(A=A.filter(P=>P.decision&&x.includes(P.decision)));const D=s.toLowerCase();return D&&(A=A.filter(P=>{var L,R,J,V,ne,te;return((L=P.ticketId)==null?void 0:L.toLowerCase().includes(D))||P.description.toLowerCase().includes(D)||((R=P.foz)==null?void 0:R.toLowerCase().includes(D))||((J=P.analyst)==null?void 0:J.toLowerCase().includes(D))||((V=P.status)==null?void 0:V.toLowerCase().includes(D))||((ne=P.decision)==null?void 0:ne.toLowerCase().includes(D))||((te=P.comment)==null?void 0:te.toLowerCase().includes(D))})),_!==null&&A.sort((P,L)=>{const R=P[_.key],J=L[_.key];if(R==null&&J==null)return 0;if(R==null)return 1;if(J==null)return-1;let V=0;return _.key==="plannedDate"?V=new Date(R).getTime()-new Date(J).getTime():_.key==="internalId"?V=R-J:typeof R=="string"&&typeof J=="string"?V=R.localeCompare(J):(R<J&&(V=-1),R>J&&(V=1)),_.direction==="ascending"?V:-V}),A},[e,s,_,u,h,x]),E=A=>{let D="ascending";_&&_.key===A&&_.direction==="ascending"&&(D="descending"),S({key:A,direction:D})},C=A=>!_||_.key!==A?y.jsx(by,{className:"w-4 h-4 ml-1 text-gray-400 group-hover:text-gray-600"}):_.direction==="ascending"?y.jsx(Uy,{className:"w-4 h-4 ml-1 text-blue-600"}):y.jsx(zy,{className:"w-4 h-4 ml-1 text-blue-600"}),I=({sortKey:A,children:D,filterComponent:P})=>y.jsx("th",{className:"p-2 text-left",children:y.jsxs("div",{className:"flex items-center",children:[y.jsxs("button",{onClick:()=>E(A),className:"group flex items-center font-semibold text-gray-600 hover:text-gray-900 transition-colors",children:[D,C(A)]}),P]})});return y.jsx("div",{className:"h-full overflow-y-auto",children:y.jsxs(Wn,{className:"h-full flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Backlog"}),y.jsxs("div",{className:"flex items-center gap-4 flex-grow justify-end",children:[y.jsxs("div",{className:"relative flex-grow max-w-xs",children:[y.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:y.jsx(Tc,{className:"w-5 h-5 text-gray-400"})}),y.jsx("input",{type:"text",placeholder:"Wyszukaj w backlogu...",value:s,onChange:A=>o(A.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:ring-blue-500 focus:border-blue-500"})]}),y.jsxs(qe,{onClick:t,children:[y.jsx(xl,{className:"w-5 h-5 mr-2 inline"}),"Dodaj wpis"]})]})]}),y.jsx("div",{className:"overflow-x-auto flex-grow",children:y.jsxs("table",{className:"min-w-full text-sm",children:[y.jsx("thead",{className:"text-left bg-gray-50 sticky top-0",children:y.jsxs("tr",{children:[y.jsx(I,{sortKey:"ticketId",children:"ID Zgoszenia"}),y.jsx(I,{sortKey:"description",children:"Opis"}),y.jsx(I,{sortKey:"foz",filterComponent:y.jsx(Os,{title:"Filtruj FOZ",options:k1,selectedOptions:h,onSelectionChange:A=>m(A)}),children:"FOZ"}),y.jsx(I,{sortKey:"plannedDate",children:"Data"}),y.jsx(I,{sortKey:"analyst",children:"Analityk"}),y.jsx(I,{sortKey:"status",filterComponent:y.jsx(Os,{title:"Filtruj Status",options:S1,selectedOptions:u,onSelectionChange:A=>d(A)}),children:"Status"}),y.jsx(I,{sortKey:"decision",filterComponent:y.jsx(Os,{title:"Filtruj Decyzj",options:E1,selectedOptions:x,onSelectionChange:A=>v(A)}),children:"Decyzja"}),y.jsx("th",{className:"p-2 font-semibold text-gray-600 text-left",children:"Komentarz"}),y.jsx("th",{className:"p-2 text-right font-semibold text-gray-600",children:"Akcje"})]})}),y.jsx("tbody",{children:T.map(A=>y.jsxs("tr",{className:"hover:bg-gray-50 border-b border-gray-200",children:[y.jsx("td",{className:"p-2 font-medium text-gray-800",children:A.ticketId||"-"}),y.jsx("td",{className:"p-2 whitespace-pre-wrap text-gray-700",children:A.description}),y.jsx("td",{className:"p-2 text-gray-700",children:A.foz}),y.jsx("td",{className:"p-2 whitespace-nowrap text-gray-700",children:A.plannedDate?new Date(A.plannedDate).toLocaleDateString("pl-PL"):""}),y.jsx("td",{className:"p-2 text-gray-700",children:A.analyst}),y.jsx("td",{className:"p-2 text-gray-700",children:A.status}),y.jsx("td",{className:"p-2 text-gray-700",children:A.decision}),y.jsx("td",{className:"p-2 whitespace-pre-wrap text-gray-700",children:A.comment}),y.jsx("td",{className:"p-2 text-right",children:y.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[A.decision==="GO"&&y.jsx(qe,{variant:"primary",size:"sm",onClick:()=>i(A),title:"Dodaj do roadmapy",className:"bg-green-600 hover:bg-green-700 focus:ring-green-500",children:"Dodaj do roadmapy"}),y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>n(A),title:"Edytuj wpis",children:y.jsx(vl,{className:"w-4 h-4"})}),y.jsx(qe,{variant:"danger",size:"sm",onClick:()=>r(A.internalId),title:"Usu wpis",children:y.jsx(yl,{className:"w-4 h-4"})})]})})]},A.internalId))})]})}),T.length===0&&y.jsx("div",{className:"text-center py-10 text-gray-500",children:s||u.length>0||h.length>0||x.length>0?y.jsx("p",{children:"Nie znaleziono wpisw pasujcych do wybranych kryteriw."}):y.jsxs(y.Fragment,{children:[y.jsx("p",{children:"Brak wpisw w backlogu."}),y.jsx("p",{children:"Zacznij od dodania nowego wpisu."})]})})]})})},ZR=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 12.75a.75.75 0 110-1.5.75.75 0 010 1.5zM12 18.75a.75.75 0 110-1.5.75.75 0 010 1.5z"})}),QR=({item:e,onOpenReEstimation:t,onOpenWithdrawal:n})=>{const[r,i]=ge.useState(!1),s=R0.useRef(null);return R0.useEffect(()=>{const o=u=>{s.current&&!s.current.contains(u.target)&&i(!1)};return document.addEventListener("mousedown",o),()=>{document.removeEventListener("mousedown",o)}},[s]),y.jsxs("div",{className:"relative",ref:s,children:[y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>i(!r),title:"Akcje",children:y.jsx(ZR,{className:"w-4 h-4"})}),r&&y.jsx("div",{className:"absolute z-10 right-0 mt-2 w-56 origin-top-right bg-white rounded-md shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none",children:y.jsxs("div",{className:"py-1",children:[y.jsx("button",{onClick:()=>{t(e),i(!1)},className:"w-full text-left block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Wniosek o zmian estymat"}),y.jsx("button",{onClick:()=>{n(e),i(!1)},className:"w-full text-left block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Wniosek o wycofanie z wersji"})]})})]})},eD=({items:e,packages:t,onAddItem:n,onEditItem:r,onDeleteItem:i,onOpenReEstimationModal:s,onOpenWithdrawalModal:o})=>{const[u,d]=ge.useState(""),[h,m]=ge.useState([]),[x,v]=ge.useState({key:"id",direction:"descending"}),_=ge.useMemo(()=>{const I=new Set(e.map(A=>A.packageName).filter(Boolean));return Array.from(I).sort()},[e]),S=ge.useMemo(()=>{let I=[...e];h.length>0&&(I=I.filter(D=>D.packageName&&h.includes(D.packageName)));const A=u.toLowerCase();return A&&(I=I.filter(D=>{var P,L,R,J;return String(D.id||"").toLowerCase().includes(A)||((P=D.jira)==null?void 0:P.toLowerCase().includes(A))||((L=D.orderName)==null?void 0:L.toLowerCase().includes(A))||((R=D.packageName)==null?void 0:R.toLowerCase().includes(A))||((J=D.comment)==null?void 0:J.toLowerCase().includes(A))})),x!==null&&I.sort((D,P)=>{const L=D[x.key],R=P[x.key];if(L==null&&R==null)return 0;if(L==null)return 1;if(R==null)return-1;let J=0;return typeof L=="number"&&typeof R=="number"?J=L-R:typeof L=="string"&&typeof R=="string"?J=L.localeCompare(R):(L<R&&(J=-1),L>R&&(J=1)),x.direction==="ascending"?J:-J}),I},[e,u,x,h]),T=I=>{let A="ascending";x&&x.key===I&&x.direction==="ascending"&&(A="descending"),v({key:I,direction:A})},E=I=>!x||x.key!==I?y.jsx(by,{className:"w-4 h-4 ml-1 text-gray-400 group-hover:text-gray-600"}):x.direction==="ascending"?y.jsx(Uy,{className:"w-4 h-4 ml-1 text-blue-600"}):y.jsx(zy,{className:"w-4 h-4 ml-1 text-blue-600"}),C=({sortKey:I,children:A,filterComponent:D})=>y.jsx("th",{className:"p-2 text-left",children:y.jsxs("div",{className:"flex items-center",children:[y.jsxs("button",{onClick:()=>T(I),className:"group flex items-center font-semibold text-gray-600 hover:text-gray-900 transition-colors",children:[A,E(I)]}),D]})});return y.jsx("div",{className:"h-full overflow-y-auto",children:y.jsxs(Wn,{className:"h-full flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Roadmapa"}),y.jsxs("div",{className:"flex items-center gap-4 flex-grow justify-end",children:[y.jsxs("div",{className:"relative flex-grow max-w-xs",children:[y.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:y.jsx(Tc,{className:"w-5 h-5 text-gray-400"})}),y.jsx("input",{type:"text",placeholder:"Wyszukaj w roadmapie...",value:u,onChange:I=>d(I.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:ring-blue-500 focus:border-blue-500"})]}),y.jsxs(qe,{onClick:n,children:[y.jsx(xl,{className:"w-5 h-5 mr-2 inline"}),"Dodaj wpis"]})]})]}),y.jsx("div",{className:"overflow-x-auto flex-grow",children:y.jsxs("table",{className:"min-w-full text-sm whitespace-nowrap",children:[y.jsx("thead",{className:"text-left bg-gray-50 sticky top-0",children:y.jsxs("tr",{children:[y.jsx(C,{sortKey:"id",children:"ID"}),y.jsx(C,{sortKey:"jira",children:"Jira"}),y.jsx(C,{sortKey:"orderName",children:"Nazwa Zlecenia"}),y.jsx(C,{sortKey:"packageName",filterComponent:y.jsx(Os,{title:"Filtruj po paczce",options:_,selectedOptions:h,onSelectionChange:m}),children:"Paczka"}),y.jsx(C,{sortKey:"analysisHours",children:"Analiza (h)"}),y.jsx(C,{sortKey:"devITHours",children:"PROGR. IT (h)"}),y.jsx(C,{sortKey:"devLFHours",children:"PROGR. LF (h)"}),y.jsx(C,{sortKey:"testingHours",children:"Testy (h)"}),y.jsx(C,{sortKey:"deploymentHours",children:"Wdroenie (h)"}),y.jsx(C,{sortKey:"stabilizationLFHours",children:"STAB. LF (h)"}),y.jsx(C,{sortKey:"totalITHoursWithBuffer",children:"CZAS. IT+Buff (h)"}),y.jsx(C,{sortKey:"workLFHours",children:"PRACE LF (h)"}),y.jsx(C,{sortKey:"totalHours",children:"Suma (h)"}),y.jsx("th",{className:"p-2 font-semibold text-gray-600 text-left",children:"Komentarz"}),y.jsx("th",{className:"p-2 text-right font-semibold text-gray-600",children:"Akcje"})]})}),y.jsx("tbody",{children:S.map(I=>{const A=t.find(P=>P.name===I.packageName),D=A&&(A.status==="inProgress"||A.status==="completed");return y.jsxs("tr",{className:"hover:bg-gray-50 border-b border-gray-200",children:[y.jsx("td",{className:"p-2 font-medium",children:I.id}),y.jsx("td",{className:"p-2",children:I.jira}),y.jsx("td",{className:"p-2",children:I.orderName}),y.jsx("td",{className:"p-2",children:I.packageName}),y.jsx("td",{className:"p-2",children:I.analysisHours}),y.jsx("td",{className:"p-2",children:I.devITHours}),y.jsx("td",{className:"p-2",children:I.devLFHours}),y.jsx("td",{className:"p-2",children:I.testingHours}),y.jsx("td",{className:"p-2",children:I.deploymentHours}),y.jsx("td",{className:"p-2",children:I.stabilizationLFHours}),y.jsx("td",{className:"p-2",children:I.totalITHoursWithBuffer}),y.jsx("td",{className:"p-2",children:I.workLFHours}),y.jsx("td",{className:"p-2",children:I.totalHours}),y.jsx("td",{className:"p-2 whitespace-pre-wrap",children:I.comment}),y.jsx("td",{className:"p-2 text-right",children:y.jsx("div",{className:"flex items-center justify-end space-x-2",children:D?y.jsx(QR,{item:I,onOpenReEstimation:s,onOpenWithdrawal:o}):y.jsxs(y.Fragment,{children:[y.jsx(qe,{variant:"secondary",size:"sm",onClick:()=>r(I),title:"Edytuj wpis",children:y.jsx(vl,{className:"w-4 h-4"})}),y.jsx(qe,{variant:"danger",size:"sm",onClick:()=>i(I.id),title:"Usu wpis",children:y.jsx(yl,{className:"w-4 h-4"})})]})})})]},I.id)})})]})}),S.length===0&&y.jsx("div",{className:"text-center py-10 text-gray-500",children:u||h.length>0?y.jsx("p",{children:"Nie znaleziono wpisw pasujcych do wybranych kryteriw."}):y.jsxs(y.Fragment,{children:[y.jsx("p",{children:"Brak wpisw w roadmapie."}),y.jsx("p",{children:"Zacznij od dodania nowego wpisu."})]})})]})})},Zg=()=>({description:"",status:"Nowy",ticketId:""}),tD=({isOpen:e,onClose:t,onSave:n,itemToEdit:r})=>{var d;const[i,s]=ge.useState(Zg());ge.useEffect(()=>{if(e)if(r){const h=r.plannedDate?new Date(r.plannedDate).toISOString().slice(0,10):"";s({...r,plannedDate:h})}else s(Zg())},[r,e]);const o=(h,m)=>{s(x=>({...x,[h]:m}))},u=()=>{var m;if(!((m=i.description)!=null&&m.trim())){alert('Pole "Opis" jest wymagane.');return}const h={...i,plannedDate:i.plannedDate?new Date(i.plannedDate).toISOString():void 0};n(h)};return y.jsx(er,{isOpen:e,onClose:t,title:r?"Edytuj wpis w backlogu":"Dodaj wpis do backlogu",children:y.jsxs("div",{className:"space-y-4",children:[y.jsx(St,{label:"ID Zgoszenia (opcjonalne)",type:"text",value:i.ticketId||"",onChange:h=>o("ticketId",h.target.value),placeholder:"np. JIRA-123"}),y.jsx(Ei,{label:"Opis (wymagane)",value:i.description||"",onChange:h=>o("description",h.target.value),required:!0,rows:4}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsx(dr,{label:"FOZ",value:i.foz||"brak",onChange:h=>o("foz",h.target.value),children:k1.map(h=>y.jsx("option",{value:h,children:h},h))}),y.jsx(St,{label:"Data",type:"date",value:i.plannedDate||"",onChange:h=>o("plannedDate",h.target.value)})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[y.jsx(St,{label:"Analityk",value:i.analyst||"",onChange:h=>o("analyst",h.target.value)}),y.jsx(dr,{label:"Status",value:i.status||"Nowy",onChange:h=>o("status",h.target.value),children:S1.map(h=>y.jsx("option",{value:h,children:h},h))}),y.jsxs(dr,{label:"Decyzja",value:i.decision||"",onChange:h=>o("decision",h.target.value),children:[y.jsx("option",{value:"",children:"(Brak decyzji)"}),E1.map(h=>y.jsx("option",{value:h,children:h},h))]})]}),y.jsx(Ei,{label:"Komentarz",value:i.comment||"",onChange:h=>o("comment",h.target.value)}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:u,disabled:!((d=i.description)!=null&&d.trim()),children:"Zapisz"})]})]})})},nD=e=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:[y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),rD=({isOpen:e,onClose:t,onSave:n,itemToEdit:r,packages:i,reEstimations:s,onViewHistory:o})=>{const[u,d]=ge.useState({}),[h,m]=ge.useState(!1),x=ge.useMemo(()=>{if(!r||!r.packageName)return!1;const C=i.find(I=>I.name===r.packageName);return C?C.status==="inProgress"||C.status==="completed":!1},[r,i]),v=ge.useMemo(()=>!r||!r.id?[]:s.filter(C=>C.roadmapItemId===r.id).sort((C,I)=>new Date(I.createdAt).getTime()-new Date(C.createdAt).getTime()),[r,s]);ge.useEffect(()=>{d(r||{})},[r,e]),ge.useEffect(()=>{if(x)return;const C=u.analysisHours||0,I=u.devITHours||0,A=u.testingHours||0,D=u.deploymentHours||0,P=C+I+A+D,L=P*.1,R=Math.round(P+L);R!==u.totalITHoursWithBuffer&&d(J=>({...J,totalITHoursWithBuffer:R}))},[u.analysisHours,u.devITHours,u.testingHours,u.deploymentHours,u.totalITHoursWithBuffer,x]),ge.useEffect(()=>{if(x)return;const C=u.totalITHoursWithBuffer||0,I=u.workLFHours||0,A=C+I;A!==u.totalHours&&d(D=>({...D,totalHours:A}))},[u.totalITHoursWithBuffer,u.workLFHours,u.totalHours,x]);const _=ge.useMemo(()=>i.map(C=>{const I=C.status==="todo"||C.status==="planning",A=(r==null?void 0:r.packageName)===C.name,D=!I&&!A,P=D?`${C.name} (${wi[C.status]})`:C.name;return{value:C.name,label:P,disabled:D,key:C.id}}),[i,r]),S=(C,I)=>{d(A=>({...A,[C]:I}))},T=(C,I)=>{const A=I===""?void 0:parseFloat(I);d(D=>{const P={...D,[C]:A};return C==="workLFHours"&&!x&&(A!==void 0&&!isNaN(A)?(P.devLFHours=Math.round(A*.8718),P.stabilizationLFHours=Math.round(A*.1282)):(P.devLFHours=void 0,P.stabilizationLFHours=void 0)),P})},E=()=>{x||n(u)};return y.jsx(er,{isOpen:e,onClose:t,title:r?"Edytuj wpis w roadmapie":"Dodaj wpis do roadmapy",children:y.jsxs("div",{className:"space-y-4",children:[x&&y.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-md text-sm",children:[y.jsx("strong",{children:"Informacja:"}),' To zlecenie jest czci paczki, ktra jest w realizacji. Edycja estymat jest zablokowana. Uyj menu "Akcje" w widoku roadmapy, aby zawnioskowa o zmian.']}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[y.jsx(St,{label:"Jira",value:u.jira||"",onChange:C=>S("jira",C.target.value),readOnly:x}),y.jsxs(dr,{label:"Paczka",value:u.packageName||"",onChange:C=>S("packageName",C.target.value),disabled:x,children:[y.jsx("option",{value:"",children:"(Brak przypisania)"}),_.map(C=>y.jsx("option",{value:C.value,disabled:C.disabled,children:C.label},C.key))]})]}),y.jsx(Ei,{label:"Nazwa Zlecenia",value:u.orderName||"",onChange:C=>S("orderName",C.target.value),rows:2,readOnly:x}),y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[y.jsx(St,{label:"Analiza (h)",type:"number",value:u.analysisHours||"",onChange:C=>T("analysisHours",C.target.value),readOnly:x}),y.jsx(St,{label:"PROGR. IT (h)",type:"number",value:u.devITHours||"",onChange:C=>T("devITHours",C.target.value),readOnly:x}),y.jsx(St,{label:"Testy (h)",type:"number",value:u.testingHours||"",onChange:C=>T("testingHours",C.target.value),readOnly:x}),y.jsx(St,{label:"Wdroenie (h)",type:"number",value:u.deploymentHours||"",onChange:C=>T("deploymentHours",C.target.value),readOnly:x}),y.jsx(St,{label:"PRACE LF (h)",type:"number",value:u.workLFHours||"",onChange:C=>T("workLFHours",C.target.value),readOnly:x}),y.jsx(St,{label:"PROGR. LF (h)",readOnly:!0,value:u.devLFHours||""}),y.jsx(St,{label:"STAB. LF (h)",readOnly:!0,value:u.stabilizationLFHours||""})]}),y.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[y.jsx(St,{label:"CZAS. IT+Buff (h)",readOnly:!0,value:u.totalITHoursWithBuffer||""}),y.jsx("div",{className:"md:col-start-4",children:y.jsx(St,{label:"Suma (h)",type:"number",readOnly:!0,value:u.totalHours||""})})]}),y.jsx(Ei,{label:"Komentarz",value:u.comment||"",onChange:C=>S("comment",C.target.value),readOnly:x}),v.length>0&&y.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[y.jsxs("button",{onClick:()=>m(!h),className:"flex justify-between items-center w-full text-left font-semibold text-gray-700 hover:text-gray-900",children:["Historia Zmian Estymat (",v.length,")",y.jsx(By,{className:`w-5 h-5 transition-transform ${h?"rotate-180":""}`})]}),h&&y.jsx("div",{className:"mt-2 space-y-2",children:v.map(C=>y.jsxs("div",{className:"p-3 bg-gray-50 border border-gray-200 rounded-md flex justify-between items-center",children:[y.jsxs("div",{children:[y.jsxs("p",{className:"text-sm font-medium text-gray-800",children:["Zmiana z dnia: ",new Date(C.createdAt).toLocaleString("pl-PL")]}),y.jsxs("p",{className:"text-xs text-gray-500",children:["Powd: ",C.reason," | Zatwierdzi(a): ",C.approver]})]}),y.jsxs(qe,{size:"sm",variant:"secondary",onClick:()=>o(C),children:[y.jsx(nD,{className:"w-4 h-4 mr-1"}),"Zobacz podgld"]})]},C.id))})]}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:x?"Zamknij":"Anuluj"}),!x&&y.jsx(qe,{onClick:E,children:"Zapisz"})]})]})})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let iD,aD;function sD(){return{geminiUrl:iD,vertexUrl:aD}}function oD(e,t,n,r){var i,s;if(!(e!=null&&e.baseUrl)){const o=sD();return t?(i=o.vertexUrl)!==null&&i!==void 0?i:n:(s=o.geminiUrl)!==null&&s!==void 0?s:r}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ya{}function He(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const s=t[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function f(e,t,n){for(let s=0;s<t.length-1;s++){const o=t[s];if(o.endsWith("[]")){const u=o.slice(0,-2);if(!(u in e))if(Array.isArray(n))e[u]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(e[u])){const d=e[u];if(Array.isArray(n))for(let h=0;h<d.length;h++){const m=d[h];f(m,t.slice(s+1),n[h])}else for(const h of d)f(h,t.slice(s+1),n)}return}else if(o.endsWith("[0]")){const u=o.slice(0,-3);u in e||(e[u]=[{}]);const d=e[u];f(d[0],t.slice(s+1),n);return}(!e[o]||typeof e[o]!="object")&&(e[o]={}),e=e[o]}const r=t[t.length-1],i=e[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=n}function c(e,t){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return;const r=t[n];if(r.endsWith("[]")){const i=r.slice(0,-2);if(i in e){const s=e[i];return Array.isArray(s)?s.map(o=>c(o,t.slice(n+1))):void 0}else return}else e=e[r]}return e}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function J0(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Qg;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Qg||(Qg={}));var ex;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(ex||(ex={}));var Ar;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(Ar||(Ar={}));var tx;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(tx||(tx={}));var nx;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(nx||(nx={}));var rx;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(rx||(rx={}));var ix;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(ix||(ix={}));var ax;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(ax||(ax={}));var sx;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(sx||(sx={}));var ox;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(ox||(ox={}));var lx;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",e.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",e.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(lx||(lx={}));var ux;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(ux||(ux={}));var cx;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(cx||(cx={}));var fx;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(fx||(fx={}));var dx;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"})(dx||(dx={}));var hx;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(hx||(hx={}));var oc;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(oc||(oc={}));var px;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(px||(px={}));var X0;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(X0||(X0={}));var mx;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(mx||(mx={}));var gx;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(gx||(gx={}));var xx;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(xx||(xx={}));var vx;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(vx||(vx={}));var yx;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(yx||(yx={}));var wx;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(wx||(wx={}));var _x;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(_x||(_x={}));var Tx;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(Tx||(Tx={}));var kx;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(kx||(kx={}));var Sx;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Sx||(Sx={}));var Ex;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Ex||(Ex={}));var Cx;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Cx||(Cx={}));var Ax;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(Ax||(Ax={}));var Ix;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(Ix||(Ix={}));var Nx;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(Nx||(Nx={}));var Fx;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(Fx||(Fx={}));var Rx;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Rx||(Rx={}));var Dx;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Dx||(Dx={}));var Px;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(Px||(Px={}));var Mx;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Mx||(Mx={}));var Lx;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(Lx||(Lx={}));var Bx;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(Bx||(Bx={}));var Ox;(function(e){e.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",e.QUALITY="QUALITY",e.DIVERSITY="DIVERSITY",e.VOCALIZATION="VOCALIZATION"})(Ox||(Ox={}));var Ds;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Ds||(Ds={}));class Y0{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class Bo{get text(){var t,n,r,i,s,o,u,d;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let h="",m=!1;const x=[];for(const v of(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[_,S]of Object.entries(v))_!=="text"&&_!=="thought"&&(S!==null||S!==void 0)&&x.push(_);if(typeof v.text=="string"){if(typeof v.thought=="boolean"&&v.thought)continue;m=!0,h+=v.text}}return x.length>0&&console.warn(`there are non-text parts ${x} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),m?h:void 0}get data(){var t,n,r,i,s,o,u,d;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let h="";const m=[];for(const x of(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)!==null&&d!==void 0?d:[]){for(const[v,_]of Object.entries(x))v!=="inlineData"&&(_!==null||_!==void 0)&&m.push(v);x.inlineData&&typeof x.inlineData.data=="string"&&(h+=atob(x.inlineData.data))}return m.length>0&&console.warn(`there are non-data parts ${m} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),h.length>0?btoa(h):void 0}get functionCalls(){var t,n,r,i,s,o,u,d;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const h=(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(m=>m.functionCall).map(m=>m.functionCall).filter(m=>m!==void 0);if((h==null?void 0:h.length)!==0)return h}get executableCode(){var t,n,r,i,s,o,u,d,h;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const m=(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(x=>x.executableCode).map(x=>x.executableCode).filter(x=>x!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.code}get codeExecutionResult(){var t,n,r,i,s,o,u,d,h;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const m=(d=(u=(o=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content)===null||u===void 0?void 0:u.parts)===null||d===void 0?void 0:d.filter(x=>x.codeExecutionResult).map(x=>x.codeExecutionResult).filter(x=>x!==void 0);if((m==null?void 0:m.length)!==0)return(h=m==null?void 0:m[0])===null||h===void 0?void 0:h.output}}class Ux{}class zx{}class lD{}class uD{}class cD{}class bx{}class Vx{}class Hx{}class fD{}class Wx{}class Gx{}class $x{}class jx{}class dD{}class hD{}class pD{}class qx{}class mD{get text(){var t,n,r;let i="",s=!1;const o=[];for(const u of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[d,h]of Object.entries(u))d!=="text"&&d!=="thought"&&h!==null&&o.push(d);if(typeof u.text=="string"){if(typeof u.thought=="boolean"&&u.thought)continue;s=!0,i+=u.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var t,n,r;let i="";const s=[];for(const o of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[u,d]of Object.entries(o))u!=="inlineData"&&d!==null&&s.push(u);o.inlineData&&typeof o.inlineData.data=="string"&&(i+=atob(o.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class lc{_fromAPIResponse({apiResponse:t,isVertexAI:n}){const r=new lc;if(r.name=t.name,r.metadata=t.metadata,r.done=t.done,r.error=t.error,n){const i=t.response;if(i){const s=new Wx,o=i.videos;s.generatedVideos=o==null?void 0:o.map(u=>({video:{uri:u.gcsUri,videoBytes:u.bytesBase64Encoded?J0(u.bytesBase64Encoded):void 0,mimeType:u.mimeType}})),s.raiMediaFilteredCount=i.raiMediaFilteredCount,s.raiMediaFilteredReasons=i.raiMediaFilteredReasons,r.response=s}}else{const i=t.response;if(i){const s=new Wx,o=i.generateVideoResponse,u=o==null?void 0:o.generatedSamples;s.generatedVideos=u==null?void 0:u.map(d=>{const h=d.video;return{video:{uri:h==null?void 0:h.uri,videoBytes:h!=null&&h.encodedVideo?J0(h==null?void 0:h.encodedVideo):void 0,mimeType:d.encoding}}}),s.raiMediaFilteredCount=o==null?void 0:o.raiMediaFilteredCount,s.raiMediaFilteredReasons=o==null?void 0:o.raiMediaFilteredReasons,r.response=s}}return r}}class gD{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function vt(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function Vy(e,t){const n=vt(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function Hy(e){return Array.isArray(e)?e.map(t=>uc(t)):[uc(e)]}function uc(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Wy(e){const t=uc(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Gy(e){const t=uc(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Kx(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function $y(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>Kx(t)):[Kx(e)]}function Z0(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function Jx(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function Xx(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function Ln(e){if(e==null)throw new Error("ContentUnion is required");return Z0(e)?e:{role:"user",parts:$y(e)}}function jy(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=Ln(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=Ln(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>Ln(n)):[Ln(t)]}function Nr(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(Jx(e)||Xx(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ln(e)]}const t=[],n=[],r=Z0(e[0]);for(const i of e){const s=Z0(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(i);else{if(Jx(i)||Xx(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||t.push({role:"user",parts:$y(n)}),t}function xD(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(Ar).includes(n[0].toUpperCase())?n[0].toUpperCase():Ar.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(Ar).includes(r.toUpperCase())?r.toUpperCase():Ar.TYPE_UNSPECIFIED})}}function Us(e){const t={},n=["items"],r=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&xD(e.type,t);for(const[o,u]of Object.entries(e))if(u!=null)if(o=="type"){if(u==="null")throw new Error("type: null can not be the only possible type for the field.");if(u instanceof Array)continue;t.type=Object.values(Ar).includes(u.toUpperCase())?u.toUpperCase():Ar.TYPE_UNSPECIFIED}else if(n.includes(o))t[o]=Us(u);else if(r.includes(o)){const d=[];for(const h of u){if(h.type=="null"){t.nullable=!0;continue}d.push(Us(h))}t[o]=d}else if(i.includes(o)){const d={};for(const[h,m]of Object.entries(u))d[h]=Us(m);t[o]=d}else{if(o==="additionalProperties")continue;t[o]=u}return t}function Zd(e){return Us(e)}function Qd(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function eh(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Ks(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=Us(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=Us(t.response));return e}function Js(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function vD(e,t,n,r=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}function Ni(e,t){if(typeof t!="string")throw new Error("name must be a string");return vD(e,t,"cachedContents")}function qy(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Za(e){return J0(e)}function yD(e){return e!=null&&typeof e=="object"&&"name"in e}function wD(e){return e!=null&&typeof e=="object"&&"video"in e}function _D(e){return e!=null&&typeof e=="object"&&"uri"in e}function Ky(e){var t;let n;if(yD(e)&&(n=e.name),!(_D(e)&&(n=e.uri,n===void 0))&&!(wD(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function Jy(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function Xy(e){for(const t of["models","tunedModels","publisherModels"])if(TD(e,t))return e[t];return[]}function TD(e,t){return e!==null&&typeof e=="object"&&t in e}function kD(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function SD(e,t={}){const n=[],r=new Set;for(const i of e){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const o=kD(i,t);o.functionDeclarations&&n.push(...o.functionDeclarations)}return{functionDeclarations:n}}function Yy(e,t){if(typeof t!="string"&&!Array.isArray(t)){if(e&&e.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}else{if(Array.isArray(t))return{inlinedRequests:t};if(typeof t=="string"){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}}throw new Error(`Unsupported source: ${t}`)}function ED(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function Xs(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function Zy(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function CD(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function AD(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function ID(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function ND(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],CD(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],AD(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],ID(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function Qy(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ND(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function FD(e){const t={},n=c(e,["anyOf"]);n!=null&&f(t,["anyOf"],n);const r=c(e,["default"]);r!=null&&f(t,["default"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["enum"]);s!=null&&f(t,["enum"],s);const o=c(e,["example"]);o!=null&&f(t,["example"],o);const u=c(e,["format"]);u!=null&&f(t,["format"],u);const d=c(e,["items"]);d!=null&&f(t,["items"],d);const h=c(e,["maxItems"]);h!=null&&f(t,["maxItems"],h);const m=c(e,["maxLength"]);m!=null&&f(t,["maxLength"],m);const x=c(e,["maxProperties"]);x!=null&&f(t,["maxProperties"],x);const v=c(e,["maximum"]);v!=null&&f(t,["maximum"],v);const _=c(e,["minItems"]);_!=null&&f(t,["minItems"],_);const S=c(e,["minLength"]);S!=null&&f(t,["minLength"],S);const T=c(e,["minProperties"]);T!=null&&f(t,["minProperties"],T);const E=c(e,["minimum"]);E!=null&&f(t,["minimum"],E);const C=c(e,["nullable"]);C!=null&&f(t,["nullable"],C);const I=c(e,["pattern"]);I!=null&&f(t,["pattern"],I);const A=c(e,["properties"]);A!=null&&f(t,["properties"],A);const D=c(e,["propertyOrdering"]);D!=null&&f(t,["propertyOrdering"],D);const P=c(e,["required"]);P!=null&&f(t,["required"],P);const L=c(e,["title"]);L!=null&&f(t,["title"],L);const R=c(e,["type"]);return R!=null&&f(t,["type"],R),t}function RD(e){const t={};if(c(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(e,["category"]);n!=null&&f(t,["category"],n);const r=c(e,["threshold"]);return r!=null&&f(t,["threshold"],r),t}function DD(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function PD(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function MD(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],PD(n)),t}function LD(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function BD(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],LD(n)),t}function OD(){return{}}function UD(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>DD(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],MD(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],BD(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],OD());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function zD(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function bD(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function VD(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],bD(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function HD(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],zD(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],VD(r)),t}function WD(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function ew(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],WD(n)),t}function GD(e){const t={},n=c(e,["speaker"]);n!=null&&f(t,["speaker"],n);const r=c(e,["voiceConfig"]);return r!=null&&f(t,["voiceConfig"],ew(r)),t}function $D(e){const t={},n=c(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>GD(i))),f(t,["speakerVoiceConfigs"],r)}return t}function jD(e){const t={},n=c(e,["voiceConfig"]);n!=null&&f(t,["voiceConfig"],ew(n));const r=c(e,["multiSpeakerVoiceConfig"]);r!=null&&f(t,["multiSpeakerVoiceConfig"],$D(r));const i=c(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function qD(e){const t={},n=c(e,["includeThoughts"]);n!=null&&f(t,["includeThoughts"],n);const r=c(e,["thinkingBudget"]);return r!=null&&f(t,["thinkingBudget"],r),t}function KD(e,t,n){const r={},i=c(t,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Qy(Ln(i)));const s=c(t,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(t,["topP"]);o!=null&&f(r,["topP"],o);const u=c(t,["topK"]);u!=null&&f(r,["topK"],u);const d=c(t,["candidateCount"]);d!=null&&f(r,["candidateCount"],d);const h=c(t,["maxOutputTokens"]);h!=null&&f(r,["maxOutputTokens"],h);const m=c(t,["stopSequences"]);m!=null&&f(r,["stopSequences"],m);const x=c(t,["responseLogprobs"]);x!=null&&f(r,["responseLogprobs"],x);const v=c(t,["logprobs"]);v!=null&&f(r,["logprobs"],v);const _=c(t,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const S=c(t,["frequencyPenalty"]);S!=null&&f(r,["frequencyPenalty"],S);const T=c(t,["seed"]);T!=null&&f(r,["seed"],T);const E=c(t,["responseMimeType"]);E!=null&&f(r,["responseMimeType"],E);const C=c(t,["responseSchema"]);C!=null&&f(r,["responseSchema"],FD(Zd(C)));const I=c(t,["responseJsonSchema"]);if(I!=null&&f(r,["responseJsonSchema"],I),c(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=c(t,["safetySettings"]);if(n!==void 0&&A!=null){let te=A;Array.isArray(te)&&(te=te.map(Q=>RD(Q))),f(n,["safetySettings"],te)}const D=c(t,["tools"]);if(n!==void 0&&D!=null){let te=Js(D);Array.isArray(te)&&(te=te.map(Q=>UD(Ks(Q)))),f(n,["tools"],te)}const P=c(t,["toolConfig"]);if(n!==void 0&&P!=null&&f(n,["toolConfig"],HD(P)),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const L=c(t,["cachedContent"]);n!==void 0&&L!=null&&f(n,["cachedContent"],Ni(e,L));const R=c(t,["responseModalities"]);R!=null&&f(r,["responseModalities"],R);const J=c(t,["mediaResolution"]);J!=null&&f(r,["mediaResolution"],J);const V=c(t,["speechConfig"]);if(V!=null&&f(r,["speechConfig"],jD(Qd(V))),c(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ne=c(t,["thinkingConfig"]);return ne!=null&&f(r,["thinkingConfig"],qD(ne)),r}function JD(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["request","model"],vt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nr(i);Array.isArray(o)&&(o=o.map(u=>Qy(u))),f(n,["request","contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["request","generationConfig"],KD(e,s,n)),n}function XD(e,t){const n={};if(c(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(c(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=c(t,["fileName"]);r!=null&&f(n,["fileName"],r);const i=c(t,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>JD(e,o))),f(n,["requests","requests"],s)}return n}function YD(e,t){const n={},r=c(e,["displayName"]);if(t!==void 0&&r!=null&&f(t,["batch","displayName"],r),c(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function ZD(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["src"]);i!=null&&f(n,["batch","inputConfig"],XD(e,Yy(e,i)));const s=c(t,["config"]);return s!=null&&f(n,["config"],YD(s,n)),n}function QD(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Xs(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function eP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Xs(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function tP(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);if(t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),c(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function nP(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],tP(n,t)),t}function rP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Xs(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function iP(e){const t={},n=c(e,["format"]);n!=null&&f(t,["instancesFormat"],n);const r=c(e,["gcsUri"]);r!=null&&f(t,["gcsSource","uris"],r);const i=c(e,["bigqueryUri"]);if(i!=null&&f(t,["bigquerySource","inputUri"],i),c(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function aP(e){const t={},n=c(e,["format"]);n!=null&&f(t,["predictionsFormat"],n);const r=c(e,["gcsUri"]);r!=null&&f(t,["gcsDestination","outputUriPrefix"],r);const i=c(e,["bigqueryUri"]);if(i!=null&&f(t,["bigqueryDestination","outputUri"],i),c(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(c(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}function sP(e,t){const n={},r=c(e,["displayName"]);t!==void 0&&r!=null&&f(t,["displayName"],r);const i=c(e,["dest"]);return t!==void 0&&i!=null&&f(t,["outputConfig"],aP(ED(i))),n}function oP(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["model"],vt(e,r));const i=c(t,["src"]);i!=null&&f(n,["inputConfig"],iP(Yy(e,i)));const s=c(t,["config"]);return s!=null&&f(n,["config"],sP(s,n)),n}function lP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Xs(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function uP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Xs(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function cP(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);t!==void 0&&i!=null&&f(t,["_query","pageToken"],i);const s=c(e,["filter"]);return t!==void 0&&s!=null&&f(t,["_query","filter"],s),n}function fP(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],cP(n,t)),t}function dP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Xs(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function hP(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function pP(e){const t={},n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function mP(e){const t={},n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function gP(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],hP(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],pP(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],mP(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function xP(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>gP(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function vP(e){const t={},n=c(e,["citationSources"]);return n!=null&&f(t,["citations"],n),t}function yP(e){const t={},n=c(e,["retrievedUrl"]);n!=null&&f(t,["retrievedUrl"],n);const r=c(e,["urlRetrievalStatus"]);return r!=null&&f(t,["urlRetrievalStatus"],r),t}function wP(e){const t={},n=c(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>yP(i))),f(t,["urlMetadata"],r)}return t}function _P(e){const t={},n=c(e,["content"]);n!=null&&f(t,["content"],xP(n));const r=c(e,["citationMetadata"]);r!=null&&f(t,["citationMetadata"],vP(r));const i=c(e,["tokenCount"]);i!=null&&f(t,["tokenCount"],i);const s=c(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const o=c(e,["urlContextMetadata"]);o!=null&&f(t,["urlContextMetadata"],wP(o));const u=c(e,["avgLogprobs"]);u!=null&&f(t,["avgLogprobs"],u);const d=c(e,["groundingMetadata"]);d!=null&&f(t,["groundingMetadata"],d);const h=c(e,["index"]);h!=null&&f(t,["index"],h);const m=c(e,["logprobsResult"]);m!=null&&f(t,["logprobsResult"],m);const x=c(e,["safetyRatings"]);return x!=null&&f(t,["safetyRatings"],x),t}function TP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>_P(h))),f(t,["candidates"],d)}const i=c(e,["modelVersion"]);i!=null&&f(t,["modelVersion"],i);const s=c(e,["promptFeedback"]);s!=null&&f(t,["promptFeedback"],s);const o=c(e,["responseId"]);o!=null&&f(t,["responseId"],o);const u=c(e,["usageMetadata"]);return u!=null&&f(t,["usageMetadata"],u),t}function tw(e){const t={},n=c(e,["details"]);n!=null&&f(t,["details"],n);const r=c(e,["code"]);r!=null&&f(t,["code"],r);const i=c(e,["message"]);return i!=null&&f(t,["message"],i),t}function kP(e){const t={},n=c(e,["response"]);n!=null&&f(t,["response"],TP(n));const r=c(e,["error"]);return r!=null&&f(t,["error"],tw(r)),t}function SP(e){const t={},n=c(e,["responsesFile"]);n!=null&&f(t,["fileName"],n);const r=c(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>kP(s))),f(t,["inlinedResponses"],i)}return t}function Q0(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata","displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["metadata","state"]);i!=null&&f(t,["state"],Zy(i));const s=c(e,["metadata","createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["metadata","endTime"]);o!=null&&f(t,["endTime"],o);const u=c(e,["metadata","updateTime"]);u!=null&&f(t,["updateTime"],u);const d=c(e,["metadata","model"]);d!=null&&f(t,["model"],d);const h=c(e,["metadata","output"]);return h!=null&&f(t,["dest"],SP(h)),t}function EP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Q0(o))),f(t,["batchJobs"],s)}return t}function CP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);return s!=null&&f(t,["error"],tw(s)),t}function nw(e){const t={},n=c(e,["details"]);n!=null&&f(t,["details"],n);const r=c(e,["code"]);r!=null&&f(t,["code"],r);const i=c(e,["message"]);return i!=null&&f(t,["message"],i),t}function AP(e){const t={},n=c(e,["instancesFormat"]);n!=null&&f(t,["format"],n);const r=c(e,["gcsSource","uris"]);r!=null&&f(t,["gcsUri"],r);const i=c(e,["bigquerySource","inputUri"]);return i!=null&&f(t,["bigqueryUri"],i),t}function IP(e){const t={},n=c(e,["predictionsFormat"]);n!=null&&f(t,["format"],n);const r=c(e,["gcsDestination","outputUriPrefix"]);r!=null&&f(t,["gcsUri"],r);const i=c(e,["bigqueryDestination","outputUri"]);return i!=null&&f(t,["bigqueryUri"],i),t}function ed(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["state"]);i!=null&&f(t,["state"],Zy(i));const s=c(e,["error"]);s!=null&&f(t,["error"],nw(s));const o=c(e,["createTime"]);o!=null&&f(t,["createTime"],o);const u=c(e,["startTime"]);u!=null&&f(t,["startTime"],u);const d=c(e,["endTime"]);d!=null&&f(t,["endTime"],d);const h=c(e,["updateTime"]);h!=null&&f(t,["updateTime"],h);const m=c(e,["model"]);m!=null&&f(t,["model"],m);const x=c(e,["inputConfig"]);x!=null&&f(t,["src"],AP(x));const v=c(e,["outputConfig"]);return v!=null&&f(t,["dest"],IP(v)),t}function NP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>ed(o))),f(t,["batchJobs"],s)}return t}function FP(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);return s!=null&&f(t,["error"],nw(s)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Ga;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Ga||(Ga={}));class wl{constructor(t,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,i)}init(t,n,r){var i,s;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!r||Object.keys(r).length===0?o={config:{}}:typeof r=="object"?o=Object.assign({},r):o=r,o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(s=(i=o.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RP extends Ya{constructor(t){super(),this.apiClient=t,this.create=async n=>{if(this.apiClient.isVertexAI()){const i=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${i}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new wl(Ga.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=oP(this.apiClient,t);return u=He("batchPredictionJobs",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>ed(m))}else{const h=ZD(this.apiClient,t);return u=He("{model}:batchGenerateContent",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>Q0(m))}}async get(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=lP(this.apiClient,t);return u=He("batchPredictionJobs/{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>ed(m))}else{const h=QD(this.apiClient,t);return u=He("batches/{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>Q0(m))}}async cancel(t){var n,r,i,s;let o="",u={};if(this.apiClient.isVertexAI()){const d=uP(this.apiClient,t);o=He("batchPredictionJobs/{name}:cancel",d._url),u=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const d=eP(this.apiClient,t);o=He("batches/{name}:cancel",d._url),u=d._query,delete d.config,delete d._url,delete d._query,await this.apiClient.request({path:o,queryParams:u,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=fP(t);return u=He("batchPredictionJobs",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=NP(m),v=new qx;return Object.assign(v,x),v})}else{const h=nP(t);return u=He("batches",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=EP(m),v=new qx;return Object.assign(v,x),v})}}async delete(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=dP(this.apiClient,t);return u=He("batchPredictionJobs/{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>FP(m))}else{const h=rP(this.apiClient,t);return u=He("batches/{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>CP(m))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DP(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function PP(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function MP(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function LP(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],DP(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],PP(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],MP(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function Yx(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>LP(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function BP(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function OP(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function UP(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],OP(n)),t}function zP(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function bP(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],zP(n)),t}function VP(){return{}}function HP(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>BP(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],UP(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],bP(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],VP());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function WP(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function GP(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function $P(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],GP(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function jP(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],WP(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],$P(r)),t}function qP(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);t!==void 0&&i!=null&&f(t,["expireTime"],i);const s=c(e,["displayName"]);t!==void 0&&s!=null&&f(t,["displayName"],s);const o=c(e,["contents"]);if(t!==void 0&&o!=null){let m=Nr(o);Array.isArray(m)&&(m=m.map(x=>Yx(x))),f(t,["contents"],m)}const u=c(e,["systemInstruction"]);t!==void 0&&u!=null&&f(t,["systemInstruction"],Yx(Ln(u)));const d=c(e,["tools"]);if(t!==void 0&&d!=null){let m=d;Array.isArray(m)&&(m=m.map(x=>HP(x))),f(t,["tools"],m)}const h=c(e,["toolConfig"]);if(t!==void 0&&h!=null&&f(t,["toolConfig"],jP(h)),c(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function KP(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["model"],Vy(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],qP(i,n)),n}function JP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function XP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function YP(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);return t!==void 0&&i!=null&&f(t,["expireTime"],i),n}function ZP(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],YP(i,n)),n}function QP(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function eM(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],QP(n,t)),t}function tM(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function nM(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function rM(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function iM(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],tM(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],nM(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],rM(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function Zx(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>iM(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function aM(e){const t={};if(c(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(e,["description"]);n!=null&&f(t,["description"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["parameters"]);i!=null&&f(t,["parameters"],i);const s=c(e,["parametersJsonSchema"]);s!=null&&f(t,["parametersJsonSchema"],s);const o=c(e,["response"]);o!=null&&f(t,["response"],o);const u=c(e,["responseJsonSchema"]);return u!=null&&f(t,["responseJsonSchema"],u),t}function sM(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function oM(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],sM(n)),t}function lM(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function uM(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],lM(n)),t}function cM(){return{}}function fM(e){const t={},n=c(e,["apiKeyString"]);return n!=null&&f(t,["apiKeyString"],n),t}function dM(e){const t={},n=c(e,["apiKeyConfig"]);n!=null&&f(t,["apiKeyConfig"],fM(n));const r=c(e,["authType"]);r!=null&&f(t,["authType"],r);const i=c(e,["googleServiceAccountConfig"]);i!=null&&f(t,["googleServiceAccountConfig"],i);const s=c(e,["httpBasicAuthConfig"]);s!=null&&f(t,["httpBasicAuthConfig"],s);const o=c(e,["oauthConfig"]);o!=null&&f(t,["oauthConfig"],o);const u=c(e,["oidcConfig"]);return u!=null&&f(t,["oidcConfig"],u),t}function hM(e){const t={},n=c(e,["authConfig"]);return n!=null&&f(t,["authConfig"],dM(n)),t}function pM(){return{}}function mM(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(v=>aM(v))),f(t,["functionDeclarations"],x)}const r=c(e,["retrieval"]);r!=null&&f(t,["retrieval"],r);const i=c(e,["googleSearch"]);i!=null&&f(t,["googleSearch"],oM(i));const s=c(e,["googleSearchRetrieval"]);s!=null&&f(t,["googleSearchRetrieval"],uM(s)),c(e,["enterpriseWebSearch"])!=null&&f(t,["enterpriseWebSearch"],cM());const u=c(e,["googleMaps"]);u!=null&&f(t,["googleMaps"],hM(u)),c(e,["urlContext"])!=null&&f(t,["urlContext"],pM());const h=c(e,["codeExecution"]);h!=null&&f(t,["codeExecution"],h);const m=c(e,["computerUse"]);return m!=null&&f(t,["computerUse"],m),t}function gM(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function xM(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function vM(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],xM(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function yM(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],gM(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],vM(r)),t}function wM(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);t!==void 0&&i!=null&&f(t,["expireTime"],i);const s=c(e,["displayName"]);t!==void 0&&s!=null&&f(t,["displayName"],s);const o=c(e,["contents"]);if(t!==void 0&&o!=null){let x=Nr(o);Array.isArray(x)&&(x=x.map(v=>Zx(v))),f(t,["contents"],x)}const u=c(e,["systemInstruction"]);t!==void 0&&u!=null&&f(t,["systemInstruction"],Zx(Ln(u)));const d=c(e,["tools"]);if(t!==void 0&&d!=null){let x=d;Array.isArray(x)&&(x=x.map(v=>mM(v))),f(t,["tools"],x)}const h=c(e,["toolConfig"]);t!==void 0&&h!=null&&f(t,["toolConfig"],yM(h));const m=c(e,["kmsKeyName"]);return t!==void 0&&m!=null&&f(t,["encryption_spec","kmsKeyName"],m),n}function _M(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["model"],Vy(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],wM(i,n)),n}function TM(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function kM(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function SM(e,t){const n={},r=c(e,["ttl"]);t!==void 0&&r!=null&&f(t,["ttl"],r);const i=c(e,["expireTime"]);return t!==void 0&&i!=null&&f(t,["expireTime"],i),n}function EM(e,t){const n={},r=c(t,["name"]);r!=null&&f(n,["_url","name"],Ni(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],SM(i,n)),n}function CM(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function AM(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],CM(n,t)),t}function Hu(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["model"]);i!=null&&f(t,["model"],i);const s=c(e,["createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["updateTime"]);o!=null&&f(t,["updateTime"],o);const u=c(e,["expireTime"]);u!=null&&f(t,["expireTime"],u);const d=c(e,["usageMetadata"]);return d!=null&&f(t,["usageMetadata"],d),t}function IM(){return{}}function NM(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Hu(o))),f(t,["cachedContents"],s)}return t}function Wu(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["model"]);i!=null&&f(t,["model"],i);const s=c(e,["createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["updateTime"]);o!=null&&f(t,["updateTime"],o);const u=c(e,["expireTime"]);u!=null&&f(t,["expireTime"],u);const d=c(e,["usageMetadata"]);return d!=null&&f(t,["usageMetadata"],d),t}function FM(){return{}}function RM(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>Wu(o))),f(t,["cachedContents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DM extends Ya{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new wl(Ga.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=_M(this.apiClient,t);return u=He("cachedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Wu(m))}else{const h=KP(this.apiClient,t);return u=He("cachedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>Hu(m))}}async get(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=TM(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Wu(m))}else{const h=JP(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>Hu(m))}}async delete(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=kM(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(()=>{const m=FM(),x=new $x;return Object.assign(x,m),x})}else{const h=XP(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(()=>{const m=IM(),x=new $x;return Object.assign(x,m),x})}}async update(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=EM(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>Wu(m))}else{const h=ZP(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>Hu(m))}}async listInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=AM(t);return u=He("cachedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=RM(m),v=new jx;return Object.assign(v,x),v})}else{const h=eM(t);return u=He("cachedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=NM(m),v=new jx;return Object.assign(v,x),v})}}}function Qx(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Rt(e){return this instanceof Rt?(this.v=e,this):new Rt(e)}function zs(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),u("next"),u("throw"),u("return",o),i[Symbol.asyncIterator]=function(){return this},i;function o(_){return function(S){return Promise.resolve(S).then(_,x)}}function u(_,S){r[_]&&(i[_]=function(T){return new Promise(function(E,C){s.push([_,T,E,C])>1||d(_,T)})},S&&(i[_]=S(i[_])))}function d(_,S){try{h(r[_](S))}catch(T){v(s[0][3],T)}}function h(_){_.value instanceof Rt?Promise.resolve(_.value.v).then(m,x):v(s[0][2],_)}function m(_){d("next",_)}function x(_){d("throw",_)}function v(_,S){_(S),s.shift(),s.length&&d(s[0][0],s[0][1])}}function Ko(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof Qx=="function"?Qx(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(o){return new Promise(function(u,d){o=e[s](o),i(u,d,o.done,o.value)})}}function i(s,o,u,d){Promise.resolve(d).then(function(h){s({value:h,done:u})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function PM(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:rw(n)}function rw(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0||!t.thought&&t.text!==void 0&&t.text==="")return!1;return!0}function MM(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function e1(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const i=[];let s=!0;for(;r<n&&e[r].role==="model";)i.push(e[r]),s&&!rw(e[r])&&(s=!1),r++;s?t.push(...i):t.pop()}return t}class LM{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new BM(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class BM{constructor(t,n,r,i={},s=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),MM(s)}async sendMessage(t){var n;await this.sendPromise;const r=Ln(t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,o,u;const d=await i,h=(o=(s=d.candidates)===null||s===void 0?void 0:s[0])===null||o===void 0?void 0:o.content,m=d.automaticFunctionCallingHistory,x=this.getHistory(!0).length;let v=[];m!=null&&(v=(u=m.slice(x))!==null&&u!==void 0?u:[]);const _=h?[h]:[];this.recordHistory(r,_,v)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(t){var n;await this.sendPromise;const r=Ln(t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(t=!1){const n=t?e1(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,i;return zs(this,arguments,function*(){var o,u,d,h;const m=[];try{for(var x=!0,v=Ko(t),_;_=yield Rt(v.next()),o=_.done,!o;x=!0){h=_.value,x=!1;const S=h;if(PM(S)){const T=(i=(r=S.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;T!==void 0&&m.push(T)}yield yield Rt(S)}}catch(S){u={error:S}}finally{try{!x&&!o&&(d=v.return)&&(yield Rt(d.call(v)))}finally{if(u)throw u.error}}this.recordHistory(n,m)})}recordHistory(t,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...e1(r)):this.history.push(t),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class kc extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,kc.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OM(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);return t!==void 0&&i!=null&&f(t,["_query","pageToken"],i),n}function UM(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],OM(n,t)),t}function zM(e){const t={},n=c(e,["details"]);n!=null&&f(t,["details"],n);const r=c(e,["message"]);r!=null&&f(t,["message"],r);const i=c(e,["code"]);return i!=null&&f(t,["code"],i),t}function bM(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["mimeType"]);i!=null&&f(t,["mimeType"],i);const s=c(e,["sizeBytes"]);s!=null&&f(t,["sizeBytes"],s);const o=c(e,["createTime"]);o!=null&&f(t,["createTime"],o);const u=c(e,["expirationTime"]);u!=null&&f(t,["expirationTime"],u);const d=c(e,["updateTime"]);d!=null&&f(t,["updateTime"],d);const h=c(e,["sha256Hash"]);h!=null&&f(t,["sha256Hash"],h);const m=c(e,["uri"]);m!=null&&f(t,["uri"],m);const x=c(e,["downloadUri"]);x!=null&&f(t,["downloadUri"],x);const v=c(e,["state"]);v!=null&&f(t,["state"],v);const _=c(e,["source"]);_!=null&&f(t,["source"],_);const S=c(e,["videoMetadata"]);S!=null&&f(t,["videoMetadata"],S);const T=c(e,["error"]);return T!=null&&f(t,["error"],zM(T)),t}function VM(e){const t={},n=c(e,["file"]);n!=null&&f(t,["file"],bM(n));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function HM(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","file"],Ky(n));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function WM(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","file"],Ky(n));const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function GM(e){const t={},n=c(e,["details"]);n!=null&&f(t,["details"],n);const r=c(e,["message"]);r!=null&&f(t,["message"],r);const i=c(e,["code"]);return i!=null&&f(t,["code"],i),t}function td(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["mimeType"]);i!=null&&f(t,["mimeType"],i);const s=c(e,["sizeBytes"]);s!=null&&f(t,["sizeBytes"],s);const o=c(e,["createTime"]);o!=null&&f(t,["createTime"],o);const u=c(e,["expirationTime"]);u!=null&&f(t,["expirationTime"],u);const d=c(e,["updateTime"]);d!=null&&f(t,["updateTime"],d);const h=c(e,["sha256Hash"]);h!=null&&f(t,["sha256Hash"],h);const m=c(e,["uri"]);m!=null&&f(t,["uri"],m);const x=c(e,["downloadUri"]);x!=null&&f(t,["downloadUri"],x);const v=c(e,["state"]);v!=null&&f(t,["state"],v);const _=c(e,["source"]);_!=null&&f(t,["source"],_);const S=c(e,["videoMetadata"]);S!=null&&f(t,["videoMetadata"],S);const T=c(e,["error"]);return T!=null&&f(t,["error"],GM(T)),t}function $M(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>td(o))),f(t,["files"],s)}return t}function jM(e){const t={},n=c(e,["sdkHttpResponse"]);return n!=null&&f(t,["sdkHttpResponse"],n),t}function qM(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KM extends Ya{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new wl(Ga.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>td(n))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=UM(t);return s=He("files",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>{const h=$M(d),m=new dD;return Object.assign(m,h),m})}}async createInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=VM(t);return s=He("upload/v1beta/files",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const h=jM(d),m=new hD;return Object.assign(m,h),m})}}async get(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=HM(t);return s=He("files/{file}",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>td(d))}}async delete(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=WM(t);return s=He("files/{file}",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(()=>{const d=qM(),h=new pD;return Object.assign(h,d),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function JM(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function iw(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],JM(n)),t}function XM(e){const t={},n=c(e,["speaker"]);n!=null&&f(t,["speaker"],n);const r=c(e,["voiceConfig"]);return r!=null&&f(t,["voiceConfig"],iw(r)),t}function YM(e){const t={},n=c(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>XM(i))),f(t,["speakerVoiceConfigs"],r)}return t}function ZM(e){const t={},n=c(e,["voiceConfig"]);n!=null&&f(t,["voiceConfig"],iw(n));const r=c(e,["multiSpeakerVoiceConfig"]);r!=null&&f(t,["multiSpeakerVoiceConfig"],YM(r));const i=c(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function QM(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function e8(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function t8(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function n8(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],QM(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],e8(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],t8(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function r8(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>n8(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function i8(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function a8(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function s8(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],a8(n)),t}function o8(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function l8(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],o8(n)),t}function u8(){return{}}function c8(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>i8(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],s8(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],l8(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],u8());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function f8(e){const t={},n=c(e,["handle"]);if(n!=null&&f(t,["handle"],n),c(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function t1(){return{}}function d8(e){const t={},n=c(e,["disabled"]);n!=null&&f(t,["disabled"],n);const r=c(e,["startOfSpeechSensitivity"]);r!=null&&f(t,["startOfSpeechSensitivity"],r);const i=c(e,["endOfSpeechSensitivity"]);i!=null&&f(t,["endOfSpeechSensitivity"],i);const s=c(e,["prefixPaddingMs"]);s!=null&&f(t,["prefixPaddingMs"],s);const o=c(e,["silenceDurationMs"]);return o!=null&&f(t,["silenceDurationMs"],o),t}function h8(e){const t={},n=c(e,["automaticActivityDetection"]);n!=null&&f(t,["automaticActivityDetection"],d8(n));const r=c(e,["activityHandling"]);r!=null&&f(t,["activityHandling"],r);const i=c(e,["turnCoverage"]);return i!=null&&f(t,["turnCoverage"],i),t}function p8(e){const t={},n=c(e,["targetTokens"]);return n!=null&&f(t,["targetTokens"],n),t}function m8(e){const t={},n=c(e,["triggerTokens"]);n!=null&&f(t,["triggerTokens"],n);const r=c(e,["slidingWindow"]);return r!=null&&f(t,["slidingWindow"],p8(r)),t}function g8(e){const t={},n=c(e,["proactiveAudio"]);return n!=null&&f(t,["proactiveAudio"],n),t}function x8(e,t){const n={},r=c(e,["generationConfig"]);t!==void 0&&r!=null&&f(t,["setup","generationConfig"],r);const i=c(e,["responseModalities"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig","responseModalities"],i);const s=c(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const o=c(e,["topP"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","topP"],o);const u=c(e,["topK"]);t!==void 0&&u!=null&&f(t,["setup","generationConfig","topK"],u);const d=c(e,["maxOutputTokens"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","maxOutputTokens"],d);const h=c(e,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const m=c(e,["seed"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","seed"],m);const x=c(e,["speechConfig"]);t!==void 0&&x!=null&&f(t,["setup","generationConfig","speechConfig"],ZM(eh(x)));const v=c(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=c(e,["systemInstruction"]);t!==void 0&&_!=null&&f(t,["setup","systemInstruction"],r8(Ln(_)));const S=c(e,["tools"]);if(t!==void 0&&S!=null){let P=Js(S);Array.isArray(P)&&(P=P.map(L=>c8(Ks(L)))),f(t,["setup","tools"],P)}const T=c(e,["sessionResumption"]);t!==void 0&&T!=null&&f(t,["setup","sessionResumption"],f8(T));const E=c(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&f(t,["setup","inputAudioTranscription"],t1());const C=c(e,["outputAudioTranscription"]);t!==void 0&&C!=null&&f(t,["setup","outputAudioTranscription"],t1());const I=c(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&f(t,["setup","realtimeInputConfig"],h8(I));const A=c(e,["contextWindowCompression"]);t!==void 0&&A!=null&&f(t,["setup","contextWindowCompression"],m8(A));const D=c(e,["proactivity"]);return t!==void 0&&D!=null&&f(t,["setup","proactivity"],g8(D)),n}function v8(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["setup","model"],vt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],x8(i,n)),n}function y8(){return{}}function w8(){return{}}function _8(e){const t={},n=c(e,["media"]);n!=null&&f(t,["mediaChunks"],Hy(n));const r=c(e,["audio"]);r!=null&&f(t,["audio"],Gy(r));const i=c(e,["audioStreamEnd"]);i!=null&&f(t,["audioStreamEnd"],i);const s=c(e,["video"]);s!=null&&f(t,["video"],Wy(s));const o=c(e,["text"]);return o!=null&&f(t,["text"],o),c(e,["activityStart"])!=null&&f(t,["activityStart"],y8()),c(e,["activityEnd"])!=null&&f(t,["activityEnd"],w8()),t}function aw(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["weight"]);return r!=null&&f(t,["weight"],r),t}function T8(e){const t={},n=c(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>aw(i))),f(t,["weightedPrompts"],r)}return t}function sw(e){const t={},n=c(e,["temperature"]);n!=null&&f(t,["temperature"],n);const r=c(e,["topK"]);r!=null&&f(t,["topK"],r);const i=c(e,["seed"]);i!=null&&f(t,["seed"],i);const s=c(e,["guidance"]);s!=null&&f(t,["guidance"],s);const o=c(e,["bpm"]);o!=null&&f(t,["bpm"],o);const u=c(e,["density"]);u!=null&&f(t,["density"],u);const d=c(e,["brightness"]);d!=null&&f(t,["brightness"],d);const h=c(e,["scale"]);h!=null&&f(t,["scale"],h);const m=c(e,["muteBass"]);m!=null&&f(t,["muteBass"],m);const x=c(e,["muteDrums"]);x!=null&&f(t,["muteDrums"],x);const v=c(e,["onlyBassAndDrums"]);v!=null&&f(t,["onlyBassAndDrums"],v);const _=c(e,["musicGenerationMode"]);return _!=null&&f(t,["musicGenerationMode"],_),t}function k8(e){const t={},n=c(e,["musicGenerationConfig"]);return n!=null&&f(t,["musicGenerationConfig"],sw(n)),t}function ow(e){const t={},n=c(e,["model"]);return n!=null&&f(t,["model"],n),t}function lw(e){const t={},n=c(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>aw(i))),f(t,["weightedPrompts"],r)}return t}function nd(e){const t={},n=c(e,["setup"]);n!=null&&f(t,["setup"],ow(n));const r=c(e,["clientContent"]);r!=null&&f(t,["clientContent"],lw(r));const i=c(e,["musicGenerationConfig"]);i!=null&&f(t,["musicGenerationConfig"],sw(i));const s=c(e,["playbackControl"]);return s!=null&&f(t,["playbackControl"],s),t}function S8(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function E8(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],S8(n)),t}function C8(e){const t={},n=c(e,["voiceConfig"]);if(n!=null&&f(t,["voiceConfig"],E8(n)),c(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function A8(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function I8(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function N8(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function F8(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],A8(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],I8(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],N8(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function R8(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>F8(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function D8(e){const t={};if(c(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(e,["description"]);n!=null&&f(t,["description"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["parameters"]);i!=null&&f(t,["parameters"],i);const s=c(e,["parametersJsonSchema"]);s!=null&&f(t,["parametersJsonSchema"],s);const o=c(e,["response"]);o!=null&&f(t,["response"],o);const u=c(e,["responseJsonSchema"]);return u!=null&&f(t,["responseJsonSchema"],u),t}function P8(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function M8(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],P8(n)),t}function L8(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function B8(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],L8(n)),t}function O8(){return{}}function U8(e){const t={},n=c(e,["apiKeyString"]);return n!=null&&f(t,["apiKeyString"],n),t}function z8(e){const t={},n=c(e,["apiKeyConfig"]);n!=null&&f(t,["apiKeyConfig"],U8(n));const r=c(e,["authType"]);r!=null&&f(t,["authType"],r);const i=c(e,["googleServiceAccountConfig"]);i!=null&&f(t,["googleServiceAccountConfig"],i);const s=c(e,["httpBasicAuthConfig"]);s!=null&&f(t,["httpBasicAuthConfig"],s);const o=c(e,["oauthConfig"]);o!=null&&f(t,["oauthConfig"],o);const u=c(e,["oidcConfig"]);return u!=null&&f(t,["oidcConfig"],u),t}function b8(e){const t={},n=c(e,["authConfig"]);return n!=null&&f(t,["authConfig"],z8(n)),t}function V8(){return{}}function H8(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(v=>D8(v))),f(t,["functionDeclarations"],x)}const r=c(e,["retrieval"]);r!=null&&f(t,["retrieval"],r);const i=c(e,["googleSearch"]);i!=null&&f(t,["googleSearch"],M8(i));const s=c(e,["googleSearchRetrieval"]);s!=null&&f(t,["googleSearchRetrieval"],B8(s)),c(e,["enterpriseWebSearch"])!=null&&f(t,["enterpriseWebSearch"],O8());const u=c(e,["googleMaps"]);u!=null&&f(t,["googleMaps"],b8(u)),c(e,["urlContext"])!=null&&f(t,["urlContext"],V8());const h=c(e,["codeExecution"]);h!=null&&f(t,["codeExecution"],h);const m=c(e,["computerUse"]);return m!=null&&f(t,["computerUse"],m),t}function W8(e){const t={},n=c(e,["handle"]);n!=null&&f(t,["handle"],n);const r=c(e,["transparent"]);return r!=null&&f(t,["transparent"],r),t}function n1(){return{}}function G8(e){const t={},n=c(e,["disabled"]);n!=null&&f(t,["disabled"],n);const r=c(e,["startOfSpeechSensitivity"]);r!=null&&f(t,["startOfSpeechSensitivity"],r);const i=c(e,["endOfSpeechSensitivity"]);i!=null&&f(t,["endOfSpeechSensitivity"],i);const s=c(e,["prefixPaddingMs"]);s!=null&&f(t,["prefixPaddingMs"],s);const o=c(e,["silenceDurationMs"]);return o!=null&&f(t,["silenceDurationMs"],o),t}function $8(e){const t={},n=c(e,["automaticActivityDetection"]);n!=null&&f(t,["automaticActivityDetection"],G8(n));const r=c(e,["activityHandling"]);r!=null&&f(t,["activityHandling"],r);const i=c(e,["turnCoverage"]);return i!=null&&f(t,["turnCoverage"],i),t}function j8(e){const t={},n=c(e,["targetTokens"]);return n!=null&&f(t,["targetTokens"],n),t}function q8(e){const t={},n=c(e,["triggerTokens"]);n!=null&&f(t,["triggerTokens"],n);const r=c(e,["slidingWindow"]);return r!=null&&f(t,["slidingWindow"],j8(r)),t}function K8(e){const t={},n=c(e,["proactiveAudio"]);return n!=null&&f(t,["proactiveAudio"],n),t}function J8(e,t){const n={},r=c(e,["generationConfig"]);t!==void 0&&r!=null&&f(t,["setup","generationConfig"],r);const i=c(e,["responseModalities"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig","responseModalities"],i);const s=c(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const o=c(e,["topP"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","topP"],o);const u=c(e,["topK"]);t!==void 0&&u!=null&&f(t,["setup","generationConfig","topK"],u);const d=c(e,["maxOutputTokens"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","maxOutputTokens"],d);const h=c(e,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const m=c(e,["seed"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","seed"],m);const x=c(e,["speechConfig"]);t!==void 0&&x!=null&&f(t,["setup","generationConfig","speechConfig"],C8(eh(x)));const v=c(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=c(e,["systemInstruction"]);t!==void 0&&_!=null&&f(t,["setup","systemInstruction"],R8(Ln(_)));const S=c(e,["tools"]);if(t!==void 0&&S!=null){let P=Js(S);Array.isArray(P)&&(P=P.map(L=>H8(Ks(L)))),f(t,["setup","tools"],P)}const T=c(e,["sessionResumption"]);t!==void 0&&T!=null&&f(t,["setup","sessionResumption"],W8(T));const E=c(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&f(t,["setup","inputAudioTranscription"],n1());const C=c(e,["outputAudioTranscription"]);t!==void 0&&C!=null&&f(t,["setup","outputAudioTranscription"],n1());const I=c(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&f(t,["setup","realtimeInputConfig"],$8(I));const A=c(e,["contextWindowCompression"]);t!==void 0&&A!=null&&f(t,["setup","contextWindowCompression"],q8(A));const D=c(e,["proactivity"]);return t!==void 0&&D!=null&&f(t,["setup","proactivity"],K8(D)),n}function X8(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["setup","model"],vt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],J8(i,n)),n}function Y8(){return{}}function Z8(){return{}}function Q8(e){const t={},n=c(e,["media"]);n!=null&&f(t,["mediaChunks"],Hy(n));const r=c(e,["audio"]);r!=null&&f(t,["audio"],Gy(r));const i=c(e,["audioStreamEnd"]);i!=null&&f(t,["audioStreamEnd"],i);const s=c(e,["video"]);s!=null&&f(t,["video"],Wy(s));const o=c(e,["text"]);return o!=null&&f(t,["text"],o),c(e,["activityStart"])!=null&&f(t,["activityStart"],Y8()),c(e,["activityEnd"])!=null&&f(t,["activityEnd"],Z8()),t}function e6(){return{}}function t6(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function n6(e){const t={},n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function r6(e){const t={},n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function i6(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],t6(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],n6(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],r6(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function a6(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>i6(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function r1(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["finished"]);return r!=null&&f(t,["finished"],r),t}function s6(e){const t={},n=c(e,["retrievedUrl"]);n!=null&&f(t,["retrievedUrl"],n);const r=c(e,["urlRetrievalStatus"]);return r!=null&&f(t,["urlRetrievalStatus"],r),t}function o6(e){const t={},n=c(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>s6(i))),f(t,["urlMetadata"],r)}return t}function l6(e){const t={},n=c(e,["modelTurn"]);n!=null&&f(t,["modelTurn"],a6(n));const r=c(e,["turnComplete"]);r!=null&&f(t,["turnComplete"],r);const i=c(e,["interrupted"]);i!=null&&f(t,["interrupted"],i);const s=c(e,["groundingMetadata"]);s!=null&&f(t,["groundingMetadata"],s);const o=c(e,["generationComplete"]);o!=null&&f(t,["generationComplete"],o);const u=c(e,["inputTranscription"]);u!=null&&f(t,["inputTranscription"],r1(u));const d=c(e,["outputTranscription"]);d!=null&&f(t,["outputTranscription"],r1(d));const h=c(e,["urlContextMetadata"]);return h!=null&&f(t,["urlContextMetadata"],o6(h)),t}function u6(e){const t={},n=c(e,["id"]);n!=null&&f(t,["id"],n);const r=c(e,["args"]);r!=null&&f(t,["args"],r);const i=c(e,["name"]);return i!=null&&f(t,["name"],i),t}function c6(e){const t={},n=c(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>u6(i))),f(t,["functionCalls"],r)}return t}function f6(e){const t={},n=c(e,["ids"]);return n!=null&&f(t,["ids"],n),t}function Uu(e){const t={},n=c(e,["modality"]);n!=null&&f(t,["modality"],n);const r=c(e,["tokenCount"]);return r!=null&&f(t,["tokenCount"],r),t}function d6(e){const t={},n=c(e,["promptTokenCount"]);n!=null&&f(t,["promptTokenCount"],n);const r=c(e,["cachedContentTokenCount"]);r!=null&&f(t,["cachedContentTokenCount"],r);const i=c(e,["responseTokenCount"]);i!=null&&f(t,["responseTokenCount"],i);const s=c(e,["toolUsePromptTokenCount"]);s!=null&&f(t,["toolUsePromptTokenCount"],s);const o=c(e,["thoughtsTokenCount"]);o!=null&&f(t,["thoughtsTokenCount"],o);const u=c(e,["totalTokenCount"]);u!=null&&f(t,["totalTokenCount"],u);const d=c(e,["promptTokensDetails"]);if(d!=null){let v=d;Array.isArray(v)&&(v=v.map(_=>Uu(_))),f(t,["promptTokensDetails"],v)}const h=c(e,["cacheTokensDetails"]);if(h!=null){let v=h;Array.isArray(v)&&(v=v.map(_=>Uu(_))),f(t,["cacheTokensDetails"],v)}const m=c(e,["responseTokensDetails"]);if(m!=null){let v=m;Array.isArray(v)&&(v=v.map(_=>Uu(_))),f(t,["responseTokensDetails"],v)}const x=c(e,["toolUsePromptTokensDetails"]);if(x!=null){let v=x;Array.isArray(v)&&(v=v.map(_=>Uu(_))),f(t,["toolUsePromptTokensDetails"],v)}return t}function h6(e){const t={},n=c(e,["timeLeft"]);return n!=null&&f(t,["timeLeft"],n),t}function p6(e){const t={},n=c(e,["newHandle"]);n!=null&&f(t,["newHandle"],n);const r=c(e,["resumable"]);r!=null&&f(t,["resumable"],r);const i=c(e,["lastConsumedClientMessageIndex"]);return i!=null&&f(t,["lastConsumedClientMessageIndex"],i),t}function m6(e){const t={};c(e,["setupComplete"])!=null&&f(t,["setupComplete"],e6());const r=c(e,["serverContent"]);r!=null&&f(t,["serverContent"],l6(r));const i=c(e,["toolCall"]);i!=null&&f(t,["toolCall"],c6(i));const s=c(e,["toolCallCancellation"]);s!=null&&f(t,["toolCallCancellation"],f6(s));const o=c(e,["usageMetadata"]);o!=null&&f(t,["usageMetadata"],d6(o));const u=c(e,["goAway"]);u!=null&&f(t,["goAway"],h6(u));const d=c(e,["sessionResumptionUpdate"]);return d!=null&&f(t,["sessionResumptionUpdate"],p6(d)),t}function g6(){return{}}function x6(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["weight"]);return r!=null&&f(t,["weight"],r),t}function v6(e){const t={},n=c(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>x6(i))),f(t,["weightedPrompts"],r)}return t}function y6(e){const t={},n=c(e,["temperature"]);n!=null&&f(t,["temperature"],n);const r=c(e,["topK"]);r!=null&&f(t,["topK"],r);const i=c(e,["seed"]);i!=null&&f(t,["seed"],i);const s=c(e,["guidance"]);s!=null&&f(t,["guidance"],s);const o=c(e,["bpm"]);o!=null&&f(t,["bpm"],o);const u=c(e,["density"]);u!=null&&f(t,["density"],u);const d=c(e,["brightness"]);d!=null&&f(t,["brightness"],d);const h=c(e,["scale"]);h!=null&&f(t,["scale"],h);const m=c(e,["muteBass"]);m!=null&&f(t,["muteBass"],m);const x=c(e,["muteDrums"]);x!=null&&f(t,["muteDrums"],x);const v=c(e,["onlyBassAndDrums"]);v!=null&&f(t,["onlyBassAndDrums"],v);const _=c(e,["musicGenerationMode"]);return _!=null&&f(t,["musicGenerationMode"],_),t}function w6(e){const t={},n=c(e,["clientContent"]);n!=null&&f(t,["clientContent"],v6(n));const r=c(e,["musicGenerationConfig"]);return r!=null&&f(t,["musicGenerationConfig"],y6(r)),t}function _6(e){const t={},n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);r!=null&&f(t,["mimeType"],r);const i=c(e,["sourceMetadata"]);return i!=null&&f(t,["sourceMetadata"],w6(i)),t}function T6(e){const t={},n=c(e,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>_6(i))),f(t,["audioChunks"],r)}return t}function k6(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["filteredReason"]);return r!=null&&f(t,["filteredReason"],r),t}function S6(e){const t={};c(e,["setupComplete"])!=null&&f(t,["setupComplete"],g6());const r=c(e,["serverContent"]);r!=null&&f(t,["serverContent"],T6(r));const i=c(e,["filteredPrompt"]);return i!=null&&f(t,["filteredPrompt"],k6(i)),t}function E6(e){const t={},n=c(e,["sessionId"]);return n!=null&&f(t,["sessionId"],n),t}function C6(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function A6(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function I6(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function N6(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],C6(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],A6(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],I6(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function F6(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>N6(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function i1(e){const t={},n=c(e,["text"]);n!=null&&f(t,["text"],n);const r=c(e,["finished"]);return r!=null&&f(t,["finished"],r),t}function R6(e){const t={},n=c(e,["modelTurn"]);n!=null&&f(t,["modelTurn"],F6(n));const r=c(e,["turnComplete"]);r!=null&&f(t,["turnComplete"],r);const i=c(e,["interrupted"]);i!=null&&f(t,["interrupted"],i);const s=c(e,["groundingMetadata"]);s!=null&&f(t,["groundingMetadata"],s);const o=c(e,["generationComplete"]);o!=null&&f(t,["generationComplete"],o);const u=c(e,["inputTranscription"]);u!=null&&f(t,["inputTranscription"],i1(u));const d=c(e,["outputTranscription"]);return d!=null&&f(t,["outputTranscription"],i1(d)),t}function D6(e){const t={},n=c(e,["args"]);n!=null&&f(t,["args"],n);const r=c(e,["name"]);return r!=null&&f(t,["name"],r),t}function P6(e){const t={},n=c(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>D6(i))),f(t,["functionCalls"],r)}return t}function M6(e){const t={},n=c(e,["ids"]);return n!=null&&f(t,["ids"],n),t}function zu(e){const t={},n=c(e,["modality"]);n!=null&&f(t,["modality"],n);const r=c(e,["tokenCount"]);return r!=null&&f(t,["tokenCount"],r),t}function L6(e){const t={},n=c(e,["promptTokenCount"]);n!=null&&f(t,["promptTokenCount"],n);const r=c(e,["cachedContentTokenCount"]);r!=null&&f(t,["cachedContentTokenCount"],r);const i=c(e,["candidatesTokenCount"]);i!=null&&f(t,["responseTokenCount"],i);const s=c(e,["toolUsePromptTokenCount"]);s!=null&&f(t,["toolUsePromptTokenCount"],s);const o=c(e,["thoughtsTokenCount"]);o!=null&&f(t,["thoughtsTokenCount"],o);const u=c(e,["totalTokenCount"]);u!=null&&f(t,["totalTokenCount"],u);const d=c(e,["promptTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(S=>zu(S))),f(t,["promptTokensDetails"],_)}const h=c(e,["cacheTokensDetails"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(S=>zu(S))),f(t,["cacheTokensDetails"],_)}const m=c(e,["candidatesTokensDetails"]);if(m!=null){let _=m;Array.isArray(_)&&(_=_.map(S=>zu(S))),f(t,["responseTokensDetails"],_)}const x=c(e,["toolUsePromptTokensDetails"]);if(x!=null){let _=x;Array.isArray(_)&&(_=_.map(S=>zu(S))),f(t,["toolUsePromptTokensDetails"],_)}const v=c(e,["trafficType"]);return v!=null&&f(t,["trafficType"],v),t}function B6(e){const t={},n=c(e,["timeLeft"]);return n!=null&&f(t,["timeLeft"],n),t}function O6(e){const t={},n=c(e,["newHandle"]);n!=null&&f(t,["newHandle"],n);const r=c(e,["resumable"]);r!=null&&f(t,["resumable"],r);const i=c(e,["lastConsumedClientMessageIndex"]);return i!=null&&f(t,["lastConsumedClientMessageIndex"],i),t}function U6(e){const t={},n=c(e,["setupComplete"]);n!=null&&f(t,["setupComplete"],E6(n));const r=c(e,["serverContent"]);r!=null&&f(t,["serverContent"],R6(r));const i=c(e,["toolCall"]);i!=null&&f(t,["toolCall"],P6(i));const s=c(e,["toolCallCancellation"]);s!=null&&f(t,["toolCallCancellation"],M6(s));const o=c(e,["usageMetadata"]);o!=null&&f(t,["usageMetadata"],L6(o));const u=c(e,["goAway"]);u!=null&&f(t,["goAway"],B6(u));const d=c(e,["sessionResumptionUpdate"]);return d!=null&&f(t,["sessionResumptionUpdate"],O6(d)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function z6(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function b6(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function V6(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function H6(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],z6(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],b6(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],V6(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function Sc(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>H6(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function W6(e){const t={},n=c(e,["anyOf"]);n!=null&&f(t,["anyOf"],n);const r=c(e,["default"]);r!=null&&f(t,["default"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["enum"]);s!=null&&f(t,["enum"],s);const o=c(e,["example"]);o!=null&&f(t,["example"],o);const u=c(e,["format"]);u!=null&&f(t,["format"],u);const d=c(e,["items"]);d!=null&&f(t,["items"],d);const h=c(e,["maxItems"]);h!=null&&f(t,["maxItems"],h);const m=c(e,["maxLength"]);m!=null&&f(t,["maxLength"],m);const x=c(e,["maxProperties"]);x!=null&&f(t,["maxProperties"],x);const v=c(e,["maximum"]);v!=null&&f(t,["maximum"],v);const _=c(e,["minItems"]);_!=null&&f(t,["minItems"],_);const S=c(e,["minLength"]);S!=null&&f(t,["minLength"],S);const T=c(e,["minProperties"]);T!=null&&f(t,["minProperties"],T);const E=c(e,["minimum"]);E!=null&&f(t,["minimum"],E);const C=c(e,["nullable"]);C!=null&&f(t,["nullable"],C);const I=c(e,["pattern"]);I!=null&&f(t,["pattern"],I);const A=c(e,["properties"]);A!=null&&f(t,["properties"],A);const D=c(e,["propertyOrdering"]);D!=null&&f(t,["propertyOrdering"],D);const P=c(e,["required"]);P!=null&&f(t,["required"],P);const L=c(e,["title"]);L!=null&&f(t,["title"],L);const R=c(e,["type"]);return R!=null&&f(t,["type"],R),t}function G6(e){const t={};if(c(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=c(e,["category"]);n!=null&&f(t,["category"],n);const r=c(e,["threshold"]);return r!=null&&f(t,["threshold"],r),t}function $6(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function j6(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function q6(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],j6(n)),t}function K6(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function J6(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],K6(n)),t}function X6(){return{}}function Y6(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>$6(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],q6(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],J6(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],X6());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function Z6(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function Q6(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function eL(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],Q6(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function tL(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],Z6(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],eL(r)),t}function nL(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function uw(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],nL(n)),t}function rL(e){const t={},n=c(e,["speaker"]);n!=null&&f(t,["speaker"],n);const r=c(e,["voiceConfig"]);return r!=null&&f(t,["voiceConfig"],uw(r)),t}function iL(e){const t={},n=c(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>rL(i))),f(t,["speakerVoiceConfigs"],r)}return t}function aL(e){const t={},n=c(e,["voiceConfig"]);n!=null&&f(t,["voiceConfig"],uw(n));const r=c(e,["multiSpeakerVoiceConfig"]);r!=null&&f(t,["multiSpeakerVoiceConfig"],iL(r));const i=c(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function sL(e){const t={},n=c(e,["includeThoughts"]);n!=null&&f(t,["includeThoughts"],n);const r=c(e,["thinkingBudget"]);return r!=null&&f(t,["thinkingBudget"],r),t}function oL(e,t,n){const r={},i=c(t,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Sc(Ln(i)));const s=c(t,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(t,["topP"]);o!=null&&f(r,["topP"],o);const u=c(t,["topK"]);u!=null&&f(r,["topK"],u);const d=c(t,["candidateCount"]);d!=null&&f(r,["candidateCount"],d);const h=c(t,["maxOutputTokens"]);h!=null&&f(r,["maxOutputTokens"],h);const m=c(t,["stopSequences"]);m!=null&&f(r,["stopSequences"],m);const x=c(t,["responseLogprobs"]);x!=null&&f(r,["responseLogprobs"],x);const v=c(t,["logprobs"]);v!=null&&f(r,["logprobs"],v);const _=c(t,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const S=c(t,["frequencyPenalty"]);S!=null&&f(r,["frequencyPenalty"],S);const T=c(t,["seed"]);T!=null&&f(r,["seed"],T);const E=c(t,["responseMimeType"]);E!=null&&f(r,["responseMimeType"],E);const C=c(t,["responseSchema"]);C!=null&&f(r,["responseSchema"],W6(Zd(C)));const I=c(t,["responseJsonSchema"]);if(I!=null&&f(r,["responseJsonSchema"],I),c(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(c(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const A=c(t,["safetySettings"]);if(n!==void 0&&A!=null){let te=A;Array.isArray(te)&&(te=te.map(Q=>G6(Q))),f(n,["safetySettings"],te)}const D=c(t,["tools"]);if(n!==void 0&&D!=null){let te=Js(D);Array.isArray(te)&&(te=te.map(Q=>Y6(Ks(Q)))),f(n,["tools"],te)}const P=c(t,["toolConfig"]);if(n!==void 0&&P!=null&&f(n,["toolConfig"],tL(P)),c(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const L=c(t,["cachedContent"]);n!==void 0&&L!=null&&f(n,["cachedContent"],Ni(e,L));const R=c(t,["responseModalities"]);R!=null&&f(r,["responseModalities"],R);const J=c(t,["mediaResolution"]);J!=null&&f(r,["mediaResolution"],J);const V=c(t,["speechConfig"]);if(V!=null&&f(r,["speechConfig"],aL(Qd(V))),c(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const ne=c(t,["thinkingConfig"]);return ne!=null&&f(r,["thinkingConfig"],sL(ne)),r}function a1(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nr(i);Array.isArray(o)&&(o=o.map(u=>Sc(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["generationConfig"],oL(e,s,n)),n}function lL(e,t){const n={},r=c(e,["taskType"]);t!==void 0&&r!=null&&f(t,["requests[]","taskType"],r);const i=c(e,["title"]);t!==void 0&&i!=null&&f(t,["requests[]","title"],i);const s=c(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&f(t,["requests[]","outputDimensionality"],s),c(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(c(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function uL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["contents"]);i!=null&&f(n,["requests[]","content"],jy(e,i));const s=c(t,["config"]);s!=null&&f(n,["config"],lL(s,n));const o=c(t,["model"]);return o!==void 0&&f(n,["requests[]","model"],vt(e,o)),n}function cL(e,t){const n={};if(c(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=c(e,["numberOfImages"]);t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r);const i=c(e,["aspectRatio"]);t!==void 0&&i!=null&&f(t,["parameters","aspectRatio"],i);const s=c(e,["guidanceScale"]);if(t!==void 0&&s!=null&&f(t,["parameters","guidanceScale"],s),c(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=c(e,["safetyFilterLevel"]);t!==void 0&&o!=null&&f(t,["parameters","safetySetting"],o);const u=c(e,["personGeneration"]);t!==void 0&&u!=null&&f(t,["parameters","personGeneration"],u);const d=c(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&f(t,["parameters","includeSafetyAttributes"],d);const h=c(e,["includeRaiReason"]);t!==void 0&&h!=null&&f(t,["parameters","includeRaiReason"],h);const m=c(e,["language"]);t!==void 0&&m!=null&&f(t,["parameters","language"],m);const x=c(e,["outputMimeType"]);t!==void 0&&x!=null&&f(t,["parameters","outputOptions","mimeType"],x);const v=c(e,["outputCompressionQuality"]);if(t!==void 0&&v!=null&&f(t,["parameters","outputOptions","compressionQuality"],v),c(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const _=c(e,["imageSize"]);if(t!==void 0&&_!=null&&f(t,["parameters","sampleImageSize"],_),c(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function fL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["config"]);return s!=null&&f(n,["config"],cL(s,n)),n}function dL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],vt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function hL(e,t,n){const r={},i=c(t,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=c(t,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=c(t,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const u=c(t,["queryBase"]);return n!==void 0&&u!=null&&f(n,["_url","models_url"],Jy(e,u)),r}function pL(e,t){const n={},r=c(t,["config"]);return r!=null&&f(n,["config"],hL(e,r,n)),n}function mL(e,t){const n={},r=c(e,["displayName"]);t!==void 0&&r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);t!==void 0&&i!=null&&f(t,["description"],i);const s=c(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&f(t,["defaultCheckpointId"],s),n}function gL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],vt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],mL(i,n)),n}function xL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],vt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function vL(e){const t={};if(c(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(c(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(c(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function yL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nr(i);Array.isArray(o)&&(o=o.map(u=>Sc(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["config"],vL(s)),n}function wL(e){const t={};if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=c(e,["imageBytes"]);n!=null&&f(t,["bytesBase64Encoded"],Za(n));const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function _L(e,t){const n={},r=c(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r),c(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(c(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=c(e,["durationSeconds"]);if(t!==void 0&&i!=null&&f(t,["parameters","durationSeconds"],i),c(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=c(e,["aspectRatio"]);if(t!==void 0&&s!=null&&f(t,["parameters","aspectRatio"],s),c(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const o=c(e,["personGeneration"]);if(t!==void 0&&o!=null&&f(t,["parameters","personGeneration"],o),c(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const u=c(e,["negativePrompt"]);t!==void 0&&u!=null&&f(t,["parameters","negativePrompt"],u);const d=c(e,["enhancePrompt"]);if(t!==void 0&&d!=null&&f(t,["parameters","enhancePrompt"],d),c(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(c(e,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(c(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function TL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["image"]);if(s!=null&&f(n,["instances[0]","image"],wL(s)),c(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const o=c(t,["config"]);return o!=null&&f(n,["config"],_L(o,n)),n}function kL(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function SL(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function EL(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function CL(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],kL(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],SL(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],EL(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function Ys(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>CL(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function AL(e){const t={},n=c(e,["anyOf"]);n!=null&&f(t,["anyOf"],n);const r=c(e,["default"]);r!=null&&f(t,["default"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["enum"]);s!=null&&f(t,["enum"],s);const o=c(e,["example"]);o!=null&&f(t,["example"],o);const u=c(e,["format"]);u!=null&&f(t,["format"],u);const d=c(e,["items"]);d!=null&&f(t,["items"],d);const h=c(e,["maxItems"]);h!=null&&f(t,["maxItems"],h);const m=c(e,["maxLength"]);m!=null&&f(t,["maxLength"],m);const x=c(e,["maxProperties"]);x!=null&&f(t,["maxProperties"],x);const v=c(e,["maximum"]);v!=null&&f(t,["maximum"],v);const _=c(e,["minItems"]);_!=null&&f(t,["minItems"],_);const S=c(e,["minLength"]);S!=null&&f(t,["minLength"],S);const T=c(e,["minProperties"]);T!=null&&f(t,["minProperties"],T);const E=c(e,["minimum"]);E!=null&&f(t,["minimum"],E);const C=c(e,["nullable"]);C!=null&&f(t,["nullable"],C);const I=c(e,["pattern"]);I!=null&&f(t,["pattern"],I);const A=c(e,["properties"]);A!=null&&f(t,["properties"],A);const D=c(e,["propertyOrdering"]);D!=null&&f(t,["propertyOrdering"],D);const P=c(e,["required"]);P!=null&&f(t,["required"],P);const L=c(e,["title"]);L!=null&&f(t,["title"],L);const R=c(e,["type"]);return R!=null&&f(t,["type"],R),t}function IL(e){const t={},n=c(e,["featureSelectionPreference"]);return n!=null&&f(t,["featureSelectionPreference"],n),t}function NL(e){const t={},n=c(e,["method"]);n!=null&&f(t,["method"],n);const r=c(e,["category"]);r!=null&&f(t,["category"],r);const i=c(e,["threshold"]);return i!=null&&f(t,["threshold"],i),t}function FL(e){const t={};if(c(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=c(e,["description"]);n!=null&&f(t,["description"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["parameters"]);i!=null&&f(t,["parameters"],i);const s=c(e,["parametersJsonSchema"]);s!=null&&f(t,["parametersJsonSchema"],s);const o=c(e,["response"]);o!=null&&f(t,["response"],o);const u=c(e,["responseJsonSchema"]);return u!=null&&f(t,["responseJsonSchema"],u),t}function RL(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function DL(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],RL(n)),t}function PL(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function ML(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],PL(n)),t}function LL(){return{}}function BL(e){const t={},n=c(e,["apiKeyString"]);return n!=null&&f(t,["apiKeyString"],n),t}function OL(e){const t={},n=c(e,["apiKeyConfig"]);n!=null&&f(t,["apiKeyConfig"],BL(n));const r=c(e,["authType"]);r!=null&&f(t,["authType"],r);const i=c(e,["googleServiceAccountConfig"]);i!=null&&f(t,["googleServiceAccountConfig"],i);const s=c(e,["httpBasicAuthConfig"]);s!=null&&f(t,["httpBasicAuthConfig"],s);const o=c(e,["oauthConfig"]);o!=null&&f(t,["oauthConfig"],o);const u=c(e,["oidcConfig"]);return u!=null&&f(t,["oidcConfig"],u),t}function UL(e){const t={},n=c(e,["authConfig"]);return n!=null&&f(t,["authConfig"],OL(n)),t}function zL(){return{}}function cw(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let x=n;Array.isArray(x)&&(x=x.map(v=>FL(v))),f(t,["functionDeclarations"],x)}const r=c(e,["retrieval"]);r!=null&&f(t,["retrieval"],r);const i=c(e,["googleSearch"]);i!=null&&f(t,["googleSearch"],DL(i));const s=c(e,["googleSearchRetrieval"]);s!=null&&f(t,["googleSearchRetrieval"],ML(s)),c(e,["enterpriseWebSearch"])!=null&&f(t,["enterpriseWebSearch"],LL());const u=c(e,["googleMaps"]);u!=null&&f(t,["googleMaps"],UL(u)),c(e,["urlContext"])!=null&&f(t,["urlContext"],zL());const h=c(e,["codeExecution"]);h!=null&&f(t,["codeExecution"],h);const m=c(e,["computerUse"]);return m!=null&&f(t,["computerUse"],m),t}function bL(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["allowedFunctionNames"]);return r!=null&&f(t,["allowedFunctionNames"],r),t}function VL(e){const t={},n=c(e,["latitude"]);n!=null&&f(t,["latitude"],n);const r=c(e,["longitude"]);return r!=null&&f(t,["longitude"],r),t}function HL(e){const t={},n=c(e,["latLng"]);n!=null&&f(t,["latLng"],VL(n));const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function WL(e){const t={},n=c(e,["functionCallingConfig"]);n!=null&&f(t,["functionCallingConfig"],bL(n));const r=c(e,["retrievalConfig"]);return r!=null&&f(t,["retrievalConfig"],HL(r)),t}function GL(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function $L(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],GL(n)),t}function jL(e){const t={},n=c(e,["voiceConfig"]);if(n!=null&&f(t,["voiceConfig"],$L(n)),c(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=c(e,["languageCode"]);return r!=null&&f(t,["languageCode"],r),t}function qL(e){const t={},n=c(e,["includeThoughts"]);n!=null&&f(t,["includeThoughts"],n);const r=c(e,["thinkingBudget"]);return r!=null&&f(t,["thinkingBudget"],r),t}function KL(e,t,n){const r={},i=c(t,["systemInstruction"]);n!==void 0&&i!=null&&f(n,["systemInstruction"],Ys(Ln(i)));const s=c(t,["temperature"]);s!=null&&f(r,["temperature"],s);const o=c(t,["topP"]);o!=null&&f(r,["topP"],o);const u=c(t,["topK"]);u!=null&&f(r,["topK"],u);const d=c(t,["candidateCount"]);d!=null&&f(r,["candidateCount"],d);const h=c(t,["maxOutputTokens"]);h!=null&&f(r,["maxOutputTokens"],h);const m=c(t,["stopSequences"]);m!=null&&f(r,["stopSequences"],m);const x=c(t,["responseLogprobs"]);x!=null&&f(r,["responseLogprobs"],x);const v=c(t,["logprobs"]);v!=null&&f(r,["logprobs"],v);const _=c(t,["presencePenalty"]);_!=null&&f(r,["presencePenalty"],_);const S=c(t,["frequencyPenalty"]);S!=null&&f(r,["frequencyPenalty"],S);const T=c(t,["seed"]);T!=null&&f(r,["seed"],T);const E=c(t,["responseMimeType"]);E!=null&&f(r,["responseMimeType"],E);const C=c(t,["responseSchema"]);C!=null&&f(r,["responseSchema"],AL(Zd(C)));const I=c(t,["responseJsonSchema"]);I!=null&&f(r,["responseJsonSchema"],I);const A=c(t,["routingConfig"]);A!=null&&f(r,["routingConfig"],A);const D=c(t,["modelSelectionConfig"]);D!=null&&f(r,["modelConfig"],IL(D));const P=c(t,["safetySettings"]);if(n!==void 0&&P!=null){let ye=P;Array.isArray(ye)&&(ye=ye.map(De=>NL(De))),f(n,["safetySettings"],ye)}const L=c(t,["tools"]);if(n!==void 0&&L!=null){let ye=Js(L);Array.isArray(ye)&&(ye=ye.map(De=>cw(Ks(De)))),f(n,["tools"],ye)}const R=c(t,["toolConfig"]);n!==void 0&&R!=null&&f(n,["toolConfig"],WL(R));const J=c(t,["labels"]);n!==void 0&&J!=null&&f(n,["labels"],J);const V=c(t,["cachedContent"]);n!==void 0&&V!=null&&f(n,["cachedContent"],Ni(e,V));const ne=c(t,["responseModalities"]);ne!=null&&f(r,["responseModalities"],ne);const te=c(t,["mediaResolution"]);te!=null&&f(r,["mediaResolution"],te);const Q=c(t,["speechConfig"]);Q!=null&&f(r,["speechConfig"],jL(Qd(Q)));const me=c(t,["audioTimestamp"]);me!=null&&f(r,["audioTimestamp"],me);const Re=c(t,["thinkingConfig"]);return Re!=null&&f(r,["thinkingConfig"],qL(Re)),r}function s1(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nr(i);Array.isArray(o)&&(o=o.map(u=>Ys(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["generationConfig"],KL(e,s,n)),n}function JL(e,t){const n={},r=c(e,["taskType"]);t!==void 0&&r!=null&&f(t,["instances[]","task_type"],r);const i=c(e,["title"]);t!==void 0&&i!=null&&f(t,["instances[]","title"],i);const s=c(e,["outputDimensionality"]);t!==void 0&&s!=null&&f(t,["parameters","outputDimensionality"],s);const o=c(e,["mimeType"]);t!==void 0&&o!=null&&f(t,["instances[]","mimeType"],o);const u=c(e,["autoTruncate"]);return t!==void 0&&u!=null&&f(t,["parameters","autoTruncate"],u),n}function XL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["contents"]);i!=null&&f(n,["instances[]","content"],jy(e,i));const s=c(t,["config"]);return s!=null&&f(n,["config"],JL(s,n)),n}function YL(e,t){const n={},r=c(e,["outputGcsUri"]);t!==void 0&&r!=null&&f(t,["parameters","storageUri"],r);const i=c(e,["negativePrompt"]);t!==void 0&&i!=null&&f(t,["parameters","negativePrompt"],i);const s=c(e,["numberOfImages"]);t!==void 0&&s!=null&&f(t,["parameters","sampleCount"],s);const o=c(e,["aspectRatio"]);t!==void 0&&o!=null&&f(t,["parameters","aspectRatio"],o);const u=c(e,["guidanceScale"]);t!==void 0&&u!=null&&f(t,["parameters","guidanceScale"],u);const d=c(e,["seed"]);t!==void 0&&d!=null&&f(t,["parameters","seed"],d);const h=c(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&f(t,["parameters","safetySetting"],h);const m=c(e,["personGeneration"]);t!==void 0&&m!=null&&f(t,["parameters","personGeneration"],m);const x=c(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&f(t,["parameters","includeSafetyAttributes"],x);const v=c(e,["includeRaiReason"]);t!==void 0&&v!=null&&f(t,["parameters","includeRaiReason"],v);const _=c(e,["language"]);t!==void 0&&_!=null&&f(t,["parameters","language"],_);const S=c(e,["outputMimeType"]);t!==void 0&&S!=null&&f(t,["parameters","outputOptions","mimeType"],S);const T=c(e,["outputCompressionQuality"]);t!==void 0&&T!=null&&f(t,["parameters","outputOptions","compressionQuality"],T);const E=c(e,["addWatermark"]);t!==void 0&&E!=null&&f(t,["parameters","addWatermark"],E);const C=c(e,["imageSize"]);t!==void 0&&C!=null&&f(t,["parameters","sampleImageSize"],C);const I=c(e,["enhancePrompt"]);return t!==void 0&&I!=null&&f(t,["parameters","enhancePrompt"],I),n}function ZL(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["config"]);return s!=null&&f(n,["config"],YL(s,n)),n}function Zs(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["gcsUri"],n);const r=c(e,["imageBytes"]);r!=null&&f(t,["bytesBase64Encoded"],Za(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function QL(e){const t={},n=c(e,["maskMode"]);n!=null&&f(t,["maskMode"],n);const r=c(e,["segmentationClasses"]);r!=null&&f(t,["maskClasses"],r);const i=c(e,["maskDilation"]);return i!=null&&f(t,["dilation"],i),t}function e5(e){const t={},n=c(e,["controlType"]);n!=null&&f(t,["controlType"],n);const r=c(e,["enableControlImageComputation"]);return r!=null&&f(t,["computeControl"],r),t}function t5(e){const t={},n=c(e,["styleDescription"]);return n!=null&&f(t,["styleDescription"],n),t}function n5(e){const t={},n=c(e,["subjectType"]);n!=null&&f(t,["subjectType"],n);const r=c(e,["subjectDescription"]);return r!=null&&f(t,["subjectDescription"],r),t}function r5(e){const t={},n=c(e,["referenceImage"]);n!=null&&f(t,["referenceImage"],Zs(n));const r=c(e,["referenceId"]);r!=null&&f(t,["referenceId"],r);const i=c(e,["referenceType"]);i!=null&&f(t,["referenceType"],i);const s=c(e,["maskImageConfig"]);s!=null&&f(t,["maskImageConfig"],QL(s));const o=c(e,["controlImageConfig"]);o!=null&&f(t,["controlImageConfig"],e5(o));const u=c(e,["styleImageConfig"]);u!=null&&f(t,["styleImageConfig"],t5(u));const d=c(e,["subjectImageConfig"]);return d!=null&&f(t,["subjectImageConfig"],n5(d)),t}function i5(e,t){const n={},r=c(e,["outputGcsUri"]);t!==void 0&&r!=null&&f(t,["parameters","storageUri"],r);const i=c(e,["negativePrompt"]);t!==void 0&&i!=null&&f(t,["parameters","negativePrompt"],i);const s=c(e,["numberOfImages"]);t!==void 0&&s!=null&&f(t,["parameters","sampleCount"],s);const o=c(e,["aspectRatio"]);t!==void 0&&o!=null&&f(t,["parameters","aspectRatio"],o);const u=c(e,["guidanceScale"]);t!==void 0&&u!=null&&f(t,["parameters","guidanceScale"],u);const d=c(e,["seed"]);t!==void 0&&d!=null&&f(t,["parameters","seed"],d);const h=c(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&f(t,["parameters","safetySetting"],h);const m=c(e,["personGeneration"]);t!==void 0&&m!=null&&f(t,["parameters","personGeneration"],m);const x=c(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&f(t,["parameters","includeSafetyAttributes"],x);const v=c(e,["includeRaiReason"]);t!==void 0&&v!=null&&f(t,["parameters","includeRaiReason"],v);const _=c(e,["language"]);t!==void 0&&_!=null&&f(t,["parameters","language"],_);const S=c(e,["outputMimeType"]);t!==void 0&&S!=null&&f(t,["parameters","outputOptions","mimeType"],S);const T=c(e,["outputCompressionQuality"]);t!==void 0&&T!=null&&f(t,["parameters","outputOptions","compressionQuality"],T);const E=c(e,["addWatermark"]);t!==void 0&&E!=null&&f(t,["parameters","addWatermark"],E);const C=c(e,["editMode"]);t!==void 0&&C!=null&&f(t,["parameters","editMode"],C);const I=c(e,["baseSteps"]);return t!==void 0&&I!=null&&f(t,["parameters","editConfig","baseSteps"],I),n}function a5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["referenceImages"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>r5(d))),f(n,["instances[0]","referenceImages"],u)}const o=c(t,["config"]);return o!=null&&f(n,["config"],i5(o,n)),n}function s5(e,t){const n={},r=c(e,["includeRaiReason"]);t!==void 0&&r!=null&&f(t,["parameters","includeRaiReason"],r);const i=c(e,["outputMimeType"]);t!==void 0&&i!=null&&f(t,["parameters","outputOptions","mimeType"],i);const s=c(e,["outputCompressionQuality"]);t!==void 0&&s!=null&&f(t,["parameters","outputOptions","compressionQuality"],s);const o=c(e,["enhanceInputImage"]);t!==void 0&&o!=null&&f(t,["parameters","upscaleConfig","enhanceInputImage"],o);const u=c(e,["imagePreservationFactor"]);t!==void 0&&u!=null&&f(t,["parameters","upscaleConfig","imagePreservationFactor"],u);const d=c(e,["numberOfImages"]);t!==void 0&&d!=null&&f(t,["parameters","sampleCount"],d);const h=c(e,["mode"]);return t!==void 0&&h!=null&&f(t,["parameters","mode"],h),n}function o5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["image"]);i!=null&&f(n,["instances[0]","image"],Zs(i));const s=c(t,["upscaleFactor"]);s!=null&&f(n,["parameters","upscaleConfig","upscaleFactor"],s);const o=c(t,["config"]);return o!=null&&f(n,["config"],s5(o,n)),n}function l5(e){const t={},n=c(e,["productImage"]);return n!=null&&f(t,["image"],Zs(n)),t}function u5(e,t){const n={},r=c(e,["prompt"]);t!==void 0&&r!=null&&f(t,["instances[0]","prompt"],r);const i=c(e,["personImage"]);t!==void 0&&i!=null&&f(t,["instances[0]","personImage","image"],Zs(i));const s=c(e,["productImages"]);if(t!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(u=>l5(u))),f(t,["instances[0]","productImages"],o)}return n}function c5(e,t){const n={},r=c(e,["numberOfImages"]);t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r);const i=c(e,["baseSteps"]);t!==void 0&&i!=null&&f(t,["parameters","editConfig","baseSteps"],i);const s=c(e,["outputGcsUri"]);t!==void 0&&s!=null&&f(t,["parameters","storageUri"],s);const o=c(e,["seed"]);t!==void 0&&o!=null&&f(t,["parameters","seed"],o);const u=c(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&f(t,["parameters","safetySetting"],u);const d=c(e,["personGeneration"]);t!==void 0&&d!=null&&f(t,["parameters","personGeneration"],d);const h=c(e,["outputMimeType"]);t!==void 0&&h!=null&&f(t,["parameters","outputOptions","mimeType"],h);const m=c(e,["outputCompressionQuality"]);t!==void 0&&m!=null&&f(t,["parameters","outputOptions","compressionQuality"],m);const x=c(e,["enhancePrompt"]);return t!==void 0&&x!=null&&f(t,["parameters","enhancePrompt"],x),n}function f5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["source"]);i!=null&&f(n,["config"],u5(i,n));const s=c(t,["config"]);return s!=null&&f(n,["config"],c5(s,n)),n}function d5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],vt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function h5(e,t,n){const r={},i=c(t,["pageSize"]);n!==void 0&&i!=null&&f(n,["_query","pageSize"],i);const s=c(t,["pageToken"]);n!==void 0&&s!=null&&f(n,["_query","pageToken"],s);const o=c(t,["filter"]);n!==void 0&&o!=null&&f(n,["_query","filter"],o);const u=c(t,["queryBase"]);return n!==void 0&&u!=null&&f(n,["_url","models_url"],Jy(e,u)),r}function p5(e,t){const n={},r=c(t,["config"]);return r!=null&&f(n,["config"],h5(e,r,n)),n}function m5(e,t){const n={},r=c(e,["displayName"]);t!==void 0&&r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);t!==void 0&&i!=null&&f(t,["description"],i);const s=c(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&f(t,["defaultCheckpointId"],s),n}function g5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],m5(i,n)),n}function x5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","name"],vt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],i),n}function v5(e,t){const n={},r=c(e,["systemInstruction"]);t!==void 0&&r!=null&&f(t,["systemInstruction"],Ys(Ln(r)));const i=c(e,["tools"]);if(t!==void 0&&i!=null){let o=i;Array.isArray(o)&&(o=o.map(u=>cw(u))),f(t,["tools"],o)}const s=c(e,["generationConfig"]);return t!==void 0&&s!=null&&f(t,["generationConfig"],s),n}function y5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nr(i);Array.isArray(o)&&(o=o.map(u=>Ys(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["config"],v5(s,n)),n}function w5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["contents"]);if(i!=null){let o=Nr(i);Array.isArray(o)&&(o=o.map(u=>Ys(u))),f(n,["contents"],o)}const s=c(t,["config"]);return s!=null&&f(n,["config"],s),n}function _5(e){const t={},n=c(e,["uri"]);n!=null&&f(t,["gcsUri"],n);const r=c(e,["videoBytes"]);r!=null&&f(t,["bytesBase64Encoded"],Za(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function T5(e,t){const n={},r=c(e,["numberOfVideos"]);t!==void 0&&r!=null&&f(t,["parameters","sampleCount"],r);const i=c(e,["outputGcsUri"]);t!==void 0&&i!=null&&f(t,["parameters","storageUri"],i);const s=c(e,["fps"]);t!==void 0&&s!=null&&f(t,["parameters","fps"],s);const o=c(e,["durationSeconds"]);t!==void 0&&o!=null&&f(t,["parameters","durationSeconds"],o);const u=c(e,["seed"]);t!==void 0&&u!=null&&f(t,["parameters","seed"],u);const d=c(e,["aspectRatio"]);t!==void 0&&d!=null&&f(t,["parameters","aspectRatio"],d);const h=c(e,["resolution"]);t!==void 0&&h!=null&&f(t,["parameters","resolution"],h);const m=c(e,["personGeneration"]);t!==void 0&&m!=null&&f(t,["parameters","personGeneration"],m);const x=c(e,["pubsubTopic"]);t!==void 0&&x!=null&&f(t,["parameters","pubsubTopic"],x);const v=c(e,["negativePrompt"]);t!==void 0&&v!=null&&f(t,["parameters","negativePrompt"],v);const _=c(e,["enhancePrompt"]);t!==void 0&&_!=null&&f(t,["parameters","enhancePrompt"],_);const S=c(e,["generateAudio"]);t!==void 0&&S!=null&&f(t,["parameters","generateAudio"],S);const T=c(e,["lastFrame"]);t!==void 0&&T!=null&&f(t,["instances[0]","lastFrame"],Zs(T));const E=c(e,["compressionQuality"]);return t!==void 0&&E!=null&&f(t,["parameters","compressionQuality"],E),n}function k5(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["_url","model"],vt(e,r));const i=c(t,["prompt"]);i!=null&&f(n,["instances[0]","prompt"],i);const s=c(t,["image"]);s!=null&&f(n,["instances[0]","image"],Zs(s));const o=c(t,["video"]);o!=null&&f(n,["instances[0]","video"],_5(o));const u=c(t,["config"]);return u!=null&&f(n,["config"],T5(u,n)),n}function S5(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function E5(e){const t={},n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function C5(e){const t={},n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function A5(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],S5(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],E5(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],C5(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function I5(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>A5(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function N5(e){const t={},n=c(e,["citationSources"]);return n!=null&&f(t,["citations"],n),t}function F5(e){const t={},n=c(e,["retrievedUrl"]);n!=null&&f(t,["retrievedUrl"],n);const r=c(e,["urlRetrievalStatus"]);return r!=null&&f(t,["urlRetrievalStatus"],r),t}function R5(e){const t={},n=c(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>F5(i))),f(t,["urlMetadata"],r)}return t}function D5(e){const t={},n=c(e,["content"]);n!=null&&f(t,["content"],I5(n));const r=c(e,["citationMetadata"]);r!=null&&f(t,["citationMetadata"],N5(r));const i=c(e,["tokenCount"]);i!=null&&f(t,["tokenCount"],i);const s=c(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const o=c(e,["urlContextMetadata"]);o!=null&&f(t,["urlContextMetadata"],R5(o));const u=c(e,["avgLogprobs"]);u!=null&&f(t,["avgLogprobs"],u);const d=c(e,["groundingMetadata"]);d!=null&&f(t,["groundingMetadata"],d);const h=c(e,["index"]);h!=null&&f(t,["index"],h);const m=c(e,["logprobsResult"]);m!=null&&f(t,["logprobsResult"],m);const x=c(e,["safetyRatings"]);return x!=null&&f(t,["safetyRatings"],x),t}function o1(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>D5(h))),f(t,["candidates"],d)}const i=c(e,["modelVersion"]);i!=null&&f(t,["modelVersion"],i);const s=c(e,["promptFeedback"]);s!=null&&f(t,["promptFeedback"],s);const o=c(e,["responseId"]);o!=null&&f(t,["responseId"],o);const u=c(e,["usageMetadata"]);return u!=null&&f(t,["usageMetadata"],u),t}function P5(e){const t={},n=c(e,["values"]);return n!=null&&f(t,["values"],n),t}function M5(){return{}}function L5(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>P5(o))),f(t,["embeddings"],s)}return c(e,["metadata"])!=null&&f(t,["metadata"],M5()),t}function B5(e){const t={},n=c(e,["bytesBase64Encoded"]);n!=null&&f(t,["imageBytes"],Za(n));const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function fw(e){const t={},n=c(e,["safetyAttributes","categories"]);n!=null&&f(t,["categories"],n);const r=c(e,["safetyAttributes","scores"]);r!=null&&f(t,["scores"],r);const i=c(e,["contentType"]);return i!=null&&f(t,["contentType"],i),t}function O5(e){const t={},n=c(e,["_self"]);n!=null&&f(t,["image"],B5(n));const r=c(e,["raiFilteredReason"]);r!=null&&f(t,["raiFilteredReason"],r);const i=c(e,["_self"]);return i!=null&&f(t,["safetyAttributes"],fw(i)),t}function U5(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>O5(o))),f(t,["generatedImages"],s)}const i=c(e,["positivePromptSafetyAttributes"]);return i!=null&&f(t,["positivePromptSafetyAttributes"],fw(i)),t}function z5(e){const t={},n=c(e,["baseModel"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["createTime"]);r!=null&&f(t,["createTime"],r);const i=c(e,["updateTime"]);return i!=null&&f(t,["updateTime"],i),t}function rd(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["version"]);s!=null&&f(t,["version"],s);const o=c(e,["_self"]);o!=null&&f(t,["tunedModelInfo"],z5(o));const u=c(e,["inputTokenLimit"]);u!=null&&f(t,["inputTokenLimit"],u);const d=c(e,["outputTokenLimit"]);d!=null&&f(t,["outputTokenLimit"],d);const h=c(e,["supportedGenerationMethods"]);return h!=null&&f(t,["supportedActions"],h),t}function b5(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["_self"]);if(i!=null){let s=Xy(i);Array.isArray(s)&&(s=s.map(o=>rd(o))),f(t,["models"],s)}return t}function V5(){return{}}function H5(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["totalTokens"]);r!=null&&f(t,["totalTokens"],r);const i=c(e,["cachedContentTokenCount"]);return i!=null&&f(t,["cachedContentTokenCount"],i),t}function W5(e){const t={},n=c(e,["video","uri"]);n!=null&&f(t,["uri"],n);const r=c(e,["video","encodedVideo"]);r!=null&&f(t,["videoBytes"],Za(r));const i=c(e,["encoding"]);return i!=null&&f(t,["mimeType"],i),t}function G5(e){const t={},n=c(e,["_self"]);return n!=null&&f(t,["video"],W5(n)),t}function $5(e){const t={},n=c(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>G5(o))),f(t,["generatedVideos"],s)}const r=c(e,["raiMediaFilteredCount"]);r!=null&&f(t,["raiMediaFilteredCount"],r);const i=c(e,["raiMediaFilteredReasons"]);return i!=null&&f(t,["raiMediaFilteredReasons"],i),t}function j5(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response","generateVideoResponse"]);return o!=null&&f(t,["response"],$5(o)),t}function q5(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function K5(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["data"]);r!=null&&f(t,["data"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function J5(e){const t={},n=c(e,["displayName"]);n!=null&&f(t,["displayName"],n);const r=c(e,["fileUri"]);r!=null&&f(t,["fileUri"],r);const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function X5(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],q5(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],K5(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],J5(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function Y5(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>X5(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function Z5(e){const t={},n=c(e,["citations"]);return n!=null&&f(t,["citations"],n),t}function Q5(e){const t={},n=c(e,["retrievedUrl"]);n!=null&&f(t,["retrievedUrl"],n);const r=c(e,["urlRetrievalStatus"]);return r!=null&&f(t,["urlRetrievalStatus"],r),t}function eB(e){const t={},n=c(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Q5(i))),f(t,["urlMetadata"],r)}return t}function tB(e){const t={},n=c(e,["content"]);n!=null&&f(t,["content"],Y5(n));const r=c(e,["citationMetadata"]);r!=null&&f(t,["citationMetadata"],Z5(r));const i=c(e,["finishMessage"]);i!=null&&f(t,["finishMessage"],i);const s=c(e,["finishReason"]);s!=null&&f(t,["finishReason"],s);const o=c(e,["urlContextMetadata"]);o!=null&&f(t,["urlContextMetadata"],eB(o));const u=c(e,["avgLogprobs"]);u!=null&&f(t,["avgLogprobs"],u);const d=c(e,["groundingMetadata"]);d!=null&&f(t,["groundingMetadata"],d);const h=c(e,["index"]);h!=null&&f(t,["index"],h);const m=c(e,["logprobsResult"]);m!=null&&f(t,["logprobsResult"],m);const x=c(e,["safetyRatings"]);return x!=null&&f(t,["safetyRatings"],x),t}function l1(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["candidates"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(m=>tB(m))),f(t,["candidates"],h)}const i=c(e,["createTime"]);i!=null&&f(t,["createTime"],i);const s=c(e,["modelVersion"]);s!=null&&f(t,["modelVersion"],s);const o=c(e,["promptFeedback"]);o!=null&&f(t,["promptFeedback"],o);const u=c(e,["responseId"]);u!=null&&f(t,["responseId"],u);const d=c(e,["usageMetadata"]);return d!=null&&f(t,["usageMetadata"],d),t}function nB(e){const t={},n=c(e,["truncated"]);n!=null&&f(t,["truncated"],n);const r=c(e,["token_count"]);return r!=null&&f(t,["tokenCount"],r),t}function rB(e){const t={},n=c(e,["values"]);n!=null&&f(t,["values"],n);const r=c(e,["statistics"]);return r!=null&&f(t,["statistics"],nB(r)),t}function iB(e){const t={},n=c(e,["billableCharacterCount"]);return n!=null&&f(t,["billableCharacterCount"],n),t}function aB(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>rB(o))),f(t,["embeddings"],s)}const i=c(e,["metadata"]);return i!=null&&f(t,["metadata"],iB(i)),t}function sB(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["gcsUri"],n);const r=c(e,["bytesBase64Encoded"]);r!=null&&f(t,["imageBytes"],Za(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function dw(e){const t={},n=c(e,["safetyAttributes","categories"]);n!=null&&f(t,["categories"],n);const r=c(e,["safetyAttributes","scores"]);r!=null&&f(t,["scores"],r);const i=c(e,["contentType"]);return i!=null&&f(t,["contentType"],i),t}function Ec(e){const t={},n=c(e,["_self"]);n!=null&&f(t,["image"],sB(n));const r=c(e,["raiFilteredReason"]);r!=null&&f(t,["raiFilteredReason"],r);const i=c(e,["_self"]);i!=null&&f(t,["safetyAttributes"],dw(i));const s=c(e,["prompt"]);return s!=null&&f(t,["enhancedPrompt"],s),t}function oB(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(o=>Ec(o))),f(t,["generatedImages"],s)}const i=c(e,["positivePromptSafetyAttributes"]);return i!=null&&f(t,["positivePromptSafetyAttributes"],dw(i)),t}function lB(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Ec(s))),f(t,["generatedImages"],i)}return t}function uB(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>Ec(s))),f(t,["generatedImages"],i)}return t}function cB(e){const t={},n=c(e,["predictions"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Ec(i))),f(t,["generatedImages"],r)}return t}function fB(e){const t={},n=c(e,["endpoint"]);n!=null&&f(t,["name"],n);const r=c(e,["deployedModelId"]);return r!=null&&f(t,["deployedModelId"],r),t}function dB(e){const t={},n=c(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["createTime"]);r!=null&&f(t,["createTime"],r);const i=c(e,["updateTime"]);return i!=null&&f(t,["updateTime"],i),t}function hB(e){const t={},n=c(e,["checkpointId"]);n!=null&&f(t,["checkpointId"],n);const r=c(e,["epoch"]);r!=null&&f(t,["epoch"],r);const i=c(e,["step"]);return i!=null&&f(t,["step"],i),t}function id(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["displayName"]);r!=null&&f(t,["displayName"],r);const i=c(e,["description"]);i!=null&&f(t,["description"],i);const s=c(e,["versionId"]);s!=null&&f(t,["version"],s);const o=c(e,["deployedModels"]);if(o!=null){let x=o;Array.isArray(x)&&(x=x.map(v=>fB(v))),f(t,["endpoints"],x)}const u=c(e,["labels"]);u!=null&&f(t,["labels"],u);const d=c(e,["_self"]);d!=null&&f(t,["tunedModelInfo"],dB(d));const h=c(e,["defaultCheckpointId"]);h!=null&&f(t,["defaultCheckpointId"],h);const m=c(e,["checkpoints"]);if(m!=null){let x=m;Array.isArray(x)&&(x=x.map(v=>hB(v))),f(t,["checkpoints"],x)}return t}function pB(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["_self"]);if(i!=null){let s=Xy(i);Array.isArray(s)&&(s=s.map(o=>id(o))),f(t,["models"],s)}return t}function mB(){return{}}function gB(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["totalTokens"]);return r!=null&&f(t,["totalTokens"],r),t}function xB(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["tokensInfo"]);return r!=null&&f(t,["tokensInfo"],r),t}function vB(e){const t={},n=c(e,["gcsUri"]);n!=null&&f(t,["uri"],n);const r=c(e,["bytesBase64Encoded"]);r!=null&&f(t,["videoBytes"],Za(r));const i=c(e,["mimeType"]);return i!=null&&f(t,["mimeType"],i),t}function yB(e){const t={},n=c(e,["_self"]);return n!=null&&f(t,["video"],vB(n)),t}function wB(e){const t={},n=c(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(o=>yB(o))),f(t,["generatedVideos"],s)}const r=c(e,["raiMediaFilteredCount"]);r!=null&&f(t,["raiMediaFilteredCount"],r);const i=c(e,["raiMediaFilteredReasons"]);return i!=null&&f(t,["raiMediaFilteredReasons"],i),t}function _B(e){const t={},n=c(e,["name"]);n!=null&&f(t,["name"],n);const r=c(e,["metadata"]);r!=null&&f(t,["metadata"],r);const i=c(e,["done"]);i!=null&&f(t,["done"],i);const s=c(e,["error"]);s!=null&&f(t,["error"],s);const o=c(e,["response"]);return o!=null&&f(t,["response"],wB(o)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const TB="Content-Type",kB="X-Server-Timeout",SB="User-Agent",ad="x-goog-api-client",EB="1.13.0",CB=`google-genai-sdk/${EB}`,AB="v1beta1",IB="v1beta",u1=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class NB{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:AB,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:IB,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[o,u]of Object.entries(t.queryParams))i.searchParams.append(o,String(u));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,t.abortSignal),this.unaryApiCall(i,s,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,t.abortSignal),this.streamApiCall(i,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r){if(n&&n.timeout||r){const i=new AbortController,s=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const o=setTimeout(()=>i.abort(),n.timeout);o&&typeof o.unref=="function"&&o.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),t.signal=s}return n&&n.extraBody!==null&&FB(t,n.extraBody),t.headers=await this.getHeadersInternal(n),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await c1(i),new Y0(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await c1(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var n;return zs(this,arguments,function*(){const i=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let o="";for(;;){const{done:u,value:d}=yield Rt(i.read());if(u){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const h=s.decode(d,{stream:!0});try{const x=JSON.parse(h);if("error"in x){const v=JSON.parse(JSON.stringify(x.error)),_=v.status,S=v.code,T=`got status: ${_}. ${JSON.stringify(x)}`;if(S>=400&&S<600)throw new kc({message:T,status:S})}}catch(x){if(x.name==="ApiError")throw x}o+=h;let m=o.match(u1);for(;m;){const x=m[1];try{const v=new Response(x,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Rt(new Y0(v)),o=o.slice(m[0].length),m=o.match(u1)}catch(v){throw new Error(`exception parsing stream chunk ${x}. ${v}`)}}}}finally{i.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=CB+" "+this.clientOptions.userAgentExtra;return t[SB]=n,t[ad]=n,t[TB]="application/json",t}async getHeadersInternal(t){const n=new Headers;if(t&&t.headers){for(const[r,i]of Object.entries(t.headers))n.append(r,i);t.timeout&&t.timeout>0&&n.append(kB,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(t,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,o=await s.stat(t);i.sizeBytes=String(o.size);const u=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(u===void 0||u==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=u;const d=await this.fetchUploadUrl(i,n);return s.upload(t,d,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const s={file:t},o=await this.request({path:He("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const u=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(u===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return u}}async function c1(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new kc({message:i,status:n}):new Error(i)}}function FB(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,o){const u=Object.assign({},s);for(const d in o)if(Object.prototype.hasOwnProperty.call(o,d)){const h=o[d],m=u[d];h&&typeof h=="object"&&!Array.isArray(h)&&m&&typeof m=="object"&&!Array.isArray(m)?u[d]=r(m,h):(m&&h&&typeof m!=typeof h&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${d}". Original type: ${typeof m}, New type: ${typeof h}. Overwriting.`),u[d]=h)}return u}const i=r(n,t);e.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const RB="mcp_used/unknown";let DB=!1;function hw(e){for(const t of e)if(PB(t)||typeof t=="object"&&"inputSchema"in t)return!0;return DB}function pw(e){var t;const n=(t=e[ad])!==null&&t!==void 0?t:"";e[ad]=(n+` ${RB}`).trimStart()}function PB(e){return e!==null&&typeof e=="object"&&e instanceof th}function MB(e,t=100){return zs(this,arguments,function*(){let r,i=0;for(;i<t;){const s=yield Rt(e.listTools({cursor:r}));for(const o of s.tools)yield yield Rt(o),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class th{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new th(t,n)}async initialize(){var t,n,r,i;if(this.mcpTools.length>0)return;const s={},o=[];for(const m of this.mcpClients)try{for(var u=!0,d=(n=void 0,Ko(MB(m))),h;h=await d.next(),t=h.done,!t;u=!0){i=h.value,u=!1;const x=i;o.push(x);const v=x.name;if(s[v])throw new Error(`Duplicate function name ${v} found in MCP tools. Please ensure function names are unique.`);s[v]=m}}catch(x){n={error:x}}finally{try{!u&&!t&&(r=d.return)&&await r.call(d)}finally{if(n)throw n.error}}this.mcpTools=o,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),SD(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const o=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:o.isError?{error:o}:o}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function LB(e,t,n){const r=new gD;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data);const s=S6(i);Object.assign(r,s),t(r)}class BB{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),o=zB(this.apiClient.getDefaultHeaders()),u=this.apiClient.getApiKey(),d=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${u}`;let h=()=>{};const m=new Promise(A=>{h=A}),x=t.callbacks,v=function(){h({})},_=this.apiClient,S={onopen:v,onmessage:A=>{LB(_,x.onmessage,A)},onerror:(n=x==null?void 0:x.onerror)!==null&&n!==void 0?n:function(A){},onclose:(r=x==null?void 0:x.onclose)!==null&&r!==void 0?r:function(A){}},T=this.webSocketFactory.create(d,UB(o),S);T.connect(),await m;const E=vt(this.apiClient,t.model),C=ow({model:E}),I=nd({setup:C});return T.send(JSON.stringify(I)),new OB(T,this.apiClient)}}class OB{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=T8(t),r=lw(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=k8(t),r=nd(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const n=nd({playbackControl:t});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Ds.PLAY)}pause(){this.sendPlaybackControl(Ds.PAUSE)}stop(){this.sendPlaybackControl(Ds.STOP)}resetContext(){this.sendPlaybackControl(Ds.RESET_CONTEXT)}close(){this.conn.close()}}function UB(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function zB(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bB="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function VB(e,t,n){const r=new mD;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(e.isVertexAI()){const o=U6(s);Object.assign(r,o)}else{const o=m6(s);Object.assign(r,o)}t(r)}class HB{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new BB(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,i,s,o,u;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const d=this.apiClient.getWebsocketBaseUrl(),h=this.apiClient.getApiVersion();let m;const x=this.apiClient.getHeaders();t.config&&t.config.tools&&hw(t.config.tools)&&pw(x);const v=jB(x);if(this.apiClient.isVertexAI())m=`${d}/ws/google.cloud.aiplatform.${h}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(v);else{const V=this.apiClient.getApiKey();let ne="BidiGenerateContent",te="key";V!=null&&V.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),h!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),ne="BidiGenerateContentConstrained",te="access_token"),m=`${d}/ws/google.ai.generativelanguage.${h}.GenerativeService.${ne}?${te}=${V}`}let _=()=>{};const S=new Promise(V=>{_=V}),T=t.callbacks,E=function(){var V;(V=T==null?void 0:T.onopen)===null||V===void 0||V.call(T),_({})},C=this.apiClient,I={onopen:E,onmessage:V=>{VB(C,T.onmessage,V)},onerror:(n=T==null?void 0:T.onerror)!==null&&n!==void 0?n:function(V){},onclose:(r=T==null?void 0:T.onclose)!==null&&r!==void 0?r:function(V){}},A=this.webSocketFactory.create(m,$B(v),I);A.connect(),await S;let D=vt(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&D.startsWith("publishers/")){const V=this.apiClient.getProject(),ne=this.apiClient.getLocation();D=`projects/${V}/locations/${ne}/`+D}let P={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[oc.AUDIO]}:t.config.responseModalities=[oc.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const L=(u=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&u!==void 0?u:[],R=[];for(const V of L)if(this.isCallableTool(V)){const ne=V;R.push(await ne.tool())}else R.push(V);R.length>0&&(t.config.tools=R);const J={model:D,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?P=X8(this.apiClient,J):P=v8(this.apiClient,J),delete P.config,A.send(JSON.stringify(P)),new GB(A,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const WB={turnComplete:!0};class GB{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Nr(n.turns),t.isVertexAI()?r=r.map(i=>Ys(i)):r=r.map(i=>Sc(i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(bB)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},WB),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Q8(t)}:n={realtimeInput:_8(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function $B(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function jB(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const f1=10;function d1(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let i=!1;for(const o of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(bs(o)){i=!0;break}if(!i)return!0;const s=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function bs(e){return"callTool"in e&&typeof e.callTool=="function"}function qB(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>bs(i)))!==null&&r!==void 0?r:!1}function KB(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>!bs(i)))!==null&&r!==void 0?r:!1}function h1(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JB extends Ya{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,i,s,o,u;const d=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!qB(n)||d1(n.config))return await this.generateContentInternal(d);if(KB(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let h,m;const x=Nr(d.contents),v=(s=(i=(r=d.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:f1;let _=0;for(;_<v&&(h=await this.generateContentInternal(d),!(!h.functionCalls||h.functionCalls.length===0));){const S=h.candidates[0].content,T=[];for(const E of(u=(o=n.config)===null||o===void 0?void 0:o.tools)!==null&&u!==void 0?u:[])if(bs(E)){const I=await E.callTool(h.functionCalls);T.push(...I)}_++,m={role:"user",parts:T},d.contents=Nr(d.contents),d.contents.push(S),d.contents.push(m),h1(d.config)&&(x.push(S),x.push(m))}return h1(d.config)&&(h.automaticFunctionCallingHistory=x),h},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),d1(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const o=[];if(r!=null&&r.generatedImages)for(const d of r.generatedImages)d&&(d!=null&&d.safetyAttributes)&&((i=d==null?void 0:d.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=d==null?void 0:d.safetyAttributes:o.push(d);let u;return s?u={generatedImages:o,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:u={generatedImages:o,sdkHttpResponse:r.sdkHttpResponse},u}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new wl(Ga.PAGED_ITEM_MODELS,u=>this.listInternal(u),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>await this.generateVideosInternal(n)}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,r,i;const s=(n=t.config)===null||n===void 0?void 0:n.tools;if(!s)return t;const o=await Promise.all(s.map(async d=>bs(d)?await d.tool():d)),u={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:o})};if(u.config.tools=o,t.config&&t.config.tools&&hw(t.config.tools)){const d=(i=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let h=Object.assign({},d);Object.keys(h).length===0&&(h=this.apiClient.getDefaultHeaders()),pw(h),u.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:h})}return u}async initAfcToolsMap(t){var n,r,i;const s=new Map;for(const o of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(bs(o)){const u=o,d=await u.tool();for(const h of(i=d.functionDeclarations)!==null&&i!==void 0?i:[]){if(!h.name)throw new Error("Function declaration name is required.");if(s.has(h.name))throw new Error(`Duplicate tool declaration name: ${h.name}`);s.set(h.name,u)}}return s}async processAfcStream(t){var n,r,i;const s=(i=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:f1;let o=!1,u=0;const d=await this.initAfcToolsMap(t);return function(h,m,x){var v,_;return zs(this,arguments,function*(){for(var S,T,E,C;u<s;){o&&(u++,o=!1);const P=yield Rt(h.processParamsMaybeAddMcpUsage(x)),L=yield Rt(h.generateContentStreamInternal(P)),R=[],J=[];try{for(var I=!0,A=(T=void 0,Ko(L)),D;D=yield Rt(A.next()),S=D.done,!S;I=!0){C=D.value,I=!1;const V=C;if(yield yield Rt(V),V.candidates&&(!((v=V.candidates[0])===null||v===void 0)&&v.content)){J.push(V.candidates[0].content);for(const ne of(_=V.candidates[0].content.parts)!==null&&_!==void 0?_:[])if(u<s&&ne.functionCall){if(!ne.functionCall.name)throw new Error("Function call name was not returned by the model.");if(m.has(ne.functionCall.name)){const te=yield Rt(m.get(ne.functionCall.name).callTool([ne.functionCall]));R.push(...te)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${m.keys()}, mising tool: ${ne.functionCall.name}`)}}}}catch(V){T={error:V}}finally{try{!I&&!S&&(E=A.return)&&(yield Rt(E.call(A)))}finally{if(T)throw T.error}}if(R.length>0){o=!0;const V=new Bo;V.candidates=[{content:{role:"user",parts:R}}],yield yield Rt(V);const ne=[];ne.push(...J),ne.push({role:"user",parts:R});const te=Nr(x.contents).concat(ne);x.contents=te}else break}})}(this,d,t)}async generateContentInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=s1(this.apiClient,t);return u=He("{model}:generateContent",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=l1(m),v=new Bo;return Object.assign(v,x),v})}else{const h=a1(this.apiClient,t);return u=He("{model}:generateContent",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=o1(m),v=new Bo;return Object.assign(v,x),v})}}async generateContentStreamInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=s1(this.apiClient,t);return u=He("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(x){return zs(this,arguments,function*(){var v,_,S,T;try{for(var E=!0,C=Ko(x),I;I=yield Rt(C.next()),v=I.done,!v;E=!0){T=I.value,E=!1;const A=T,D=l1(yield Rt(A.json()));D.sdkHttpResponse={headers:A.headers};const P=new Bo;Object.assign(P,D),yield yield Rt(P)}}catch(A){_={error:A}}finally{try{!E&&!v&&(S=C.return)&&(yield Rt(S.call(C)))}finally{if(_)throw _.error}}})})}else{const h=a1(this.apiClient,t);return u=He("{model}:streamGenerateContent?alt=sse",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.requestStream({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(x){return zs(this,arguments,function*(){var v,_,S,T;try{for(var E=!0,C=Ko(x),I;I=yield Rt(C.next()),v=I.done,!v;E=!0){T=I.value,E=!1;const A=T,D=o1(yield Rt(A.json()));D.sdkHttpResponse={headers:A.headers};const P=new Bo;Object.assign(P,D),yield yield Rt(P)}}catch(A){_={error:A}}finally{try{!E&&!v&&(S=C.return)&&(yield Rt(S.call(C)))}finally{if(_)throw _.error}}})})}}async embedContent(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=XL(this.apiClient,t);return u=He("{model}:predict",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=aB(m),v=new Ux;return Object.assign(v,x),v})}else{const h=uL(this.apiClient,t);return u=He("{model}:batchEmbedContents",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=L5(m),v=new Ux;return Object.assign(v,x),v})}}async generateImagesInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=ZL(this.apiClient,t);return u=He("{model}:predict",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=oB(m),v=new zx;return Object.assign(v,x),v})}else{const h=fL(this.apiClient,t);return u=He("{model}:predict",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=U5(m),v=new zx;return Object.assign(v,x),v})}}async editImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=a5(this.apiClient,t);return s=He("{model}:predict",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>{const h=lB(d),m=new lD;return Object.assign(m,h),m})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=o5(this.apiClient,t);return s=He("{model}:predict",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>{const h=uB(d),m=new uD;return Object.assign(m,h),m})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=f5(this.apiClient,t);return s=He("{model}:predict",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i.then(d=>{const h=cB(d),m=new cD;return Object.assign(m,h),m})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=d5(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>id(m))}else{const h=dL(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>rd(m))}}async listInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=p5(this.apiClient,t);return u=He("{models_url}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=pB(m),v=new bx;return Object.assign(v,x),v})}else{const h=pL(this.apiClient,t);return u=He("{models_url}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=b5(m),v=new bx;return Object.assign(v,x),v})}}async update(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=g5(this.apiClient,t);return u=He("{model}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>id(m))}else{const h=gL(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>rd(m))}}async delete(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=x5(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(()=>{const m=mB(),x=new Vx;return Object.assign(x,m),x})}else{const h=xL(this.apiClient,t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(()=>{const m=V5(),x=new Vx;return Object.assign(x,m),x})}}async countTokens(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=y5(this.apiClient,t);return u=He("{model}:countTokens",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=gB(m),v=new Hx;return Object.assign(v,x),v})}else{const h=yL(this.apiClient,t);return u=He("{model}:countTokens",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=H5(m),v=new Hx;return Object.assign(v,x),v})}}async computeTokens(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=w5(this.apiClient,t);return s=He("{model}:computeTokens",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>{const h=xB(d),m=new fD;return Object.assign(m,h),m})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=k5(this.apiClient,t);return u=He("{model}:predictLongRunning",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o.then(m=>{const x=_B(m),v=new lc;return Object.assign(v,x),v})}else{const h=TL(this.apiClient,t);return u=He("{model}:predictLongRunning",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o.then(m=>{const x=j5(m),v=new lc;return Object.assign(v,x),v})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function XB(e){const t={},n=c(e,["operationName"]);n!=null&&f(t,["_url","operationName"],n);const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function YB(e){const t={},n=c(e,["operationName"]);n!=null&&f(t,["_url","operationName"],n);const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function ZB(e){const t={},n=c(e,["operationName"]);n!=null&&f(t,["operationName"],n);const r=c(e,["resourceName"]);r!=null&&f(t,["_url","resourceName"],r);const i=c(e,["config"]);return i!=null&&f(t,["config"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class QB extends Ya{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:o,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=YB(t);return u=He("{operationName}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json()),o}else{const h=XB(t);return u=He("{operationName}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json()),o}}async fetchPredictVideosOperationInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=ZB(t);return s=He("{resourceName}:fetchPredictOperation",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eO(e){const t={},n=c(e,["voiceName"]);return n!=null&&f(t,["voiceName"],n),t}function mw(e){const t={},n=c(e,["prebuiltVoiceConfig"]);return n!=null&&f(t,["prebuiltVoiceConfig"],eO(n)),t}function tO(e){const t={},n=c(e,["speaker"]);n!=null&&f(t,["speaker"],n);const r=c(e,["voiceConfig"]);return r!=null&&f(t,["voiceConfig"],mw(r)),t}function nO(e){const t={},n=c(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>tO(i))),f(t,["speakerVoiceConfigs"],r)}return t}function rO(e){const t={},n=c(e,["voiceConfig"]);n!=null&&f(t,["voiceConfig"],mw(n));const r=c(e,["multiSpeakerVoiceConfig"]);r!=null&&f(t,["multiSpeakerVoiceConfig"],nO(r));const i=c(e,["languageCode"]);return i!=null&&f(t,["languageCode"],i),t}function iO(e){const t={},n=c(e,["fps"]);n!=null&&f(t,["fps"],n);const r=c(e,["endOffset"]);r!=null&&f(t,["endOffset"],r);const i=c(e,["startOffset"]);return i!=null&&f(t,["startOffset"],i),t}function aO(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["data"]);n!=null&&f(t,["data"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function sO(e){const t={};if(c(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=c(e,["fileUri"]);n!=null&&f(t,["fileUri"],n);const r=c(e,["mimeType"]);return r!=null&&f(t,["mimeType"],r),t}function oO(e){const t={},n=c(e,["videoMetadata"]);n!=null&&f(t,["videoMetadata"],iO(n));const r=c(e,["thought"]);r!=null&&f(t,["thought"],r);const i=c(e,["inlineData"]);i!=null&&f(t,["inlineData"],aO(i));const s=c(e,["fileData"]);s!=null&&f(t,["fileData"],sO(s));const o=c(e,["thoughtSignature"]);o!=null&&f(t,["thoughtSignature"],o);const u=c(e,["codeExecutionResult"]);u!=null&&f(t,["codeExecutionResult"],u);const d=c(e,["executableCode"]);d!=null&&f(t,["executableCode"],d);const h=c(e,["functionCall"]);h!=null&&f(t,["functionCall"],h);const m=c(e,["functionResponse"]);m!=null&&f(t,["functionResponse"],m);const x=c(e,["text"]);return x!=null&&f(t,["text"],x),t}function lO(e){const t={},n=c(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>oO(s))),f(t,["parts"],i)}const r=c(e,["role"]);return r!=null&&f(t,["role"],r),t}function uO(e){const t={},n=c(e,["behavior"]);n!=null&&f(t,["behavior"],n);const r=c(e,["description"]);r!=null&&f(t,["description"],r);const i=c(e,["name"]);i!=null&&f(t,["name"],i);const s=c(e,["parameters"]);s!=null&&f(t,["parameters"],s);const o=c(e,["parametersJsonSchema"]);o!=null&&f(t,["parametersJsonSchema"],o);const u=c(e,["response"]);u!=null&&f(t,["response"],u);const d=c(e,["responseJsonSchema"]);return d!=null&&f(t,["responseJsonSchema"],d),t}function cO(e){const t={},n=c(e,["startTime"]);n!=null&&f(t,["startTime"],n);const r=c(e,["endTime"]);return r!=null&&f(t,["endTime"],r),t}function fO(e){const t={},n=c(e,["timeRangeFilter"]);return n!=null&&f(t,["timeRangeFilter"],cO(n)),t}function dO(e){const t={},n=c(e,["mode"]);n!=null&&f(t,["mode"],n);const r=c(e,["dynamicThreshold"]);return r!=null&&f(t,["dynamicThreshold"],r),t}function hO(e){const t={},n=c(e,["dynamicRetrievalConfig"]);return n!=null&&f(t,["dynamicRetrievalConfig"],dO(n)),t}function pO(){return{}}function mO(e){const t={},n=c(e,["functionDeclarations"]);if(n!=null){let d=n;Array.isArray(d)&&(d=d.map(h=>uO(h))),f(t,["functionDeclarations"],d)}if(c(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=c(e,["googleSearch"]);r!=null&&f(t,["googleSearch"],fO(r));const i=c(e,["googleSearchRetrieval"]);if(i!=null&&f(t,["googleSearchRetrieval"],hO(i)),c(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(c(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");c(e,["urlContext"])!=null&&f(t,["urlContext"],pO());const o=c(e,["codeExecution"]);o!=null&&f(t,["codeExecution"],o);const u=c(e,["computerUse"]);return u!=null&&f(t,["computerUse"],u),t}function gO(e){const t={},n=c(e,["handle"]);if(n!=null&&f(t,["handle"],n),c(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function p1(){return{}}function xO(e){const t={},n=c(e,["disabled"]);n!=null&&f(t,["disabled"],n);const r=c(e,["startOfSpeechSensitivity"]);r!=null&&f(t,["startOfSpeechSensitivity"],r);const i=c(e,["endOfSpeechSensitivity"]);i!=null&&f(t,["endOfSpeechSensitivity"],i);const s=c(e,["prefixPaddingMs"]);s!=null&&f(t,["prefixPaddingMs"],s);const o=c(e,["silenceDurationMs"]);return o!=null&&f(t,["silenceDurationMs"],o),t}function vO(e){const t={},n=c(e,["automaticActivityDetection"]);n!=null&&f(t,["automaticActivityDetection"],xO(n));const r=c(e,["activityHandling"]);r!=null&&f(t,["activityHandling"],r);const i=c(e,["turnCoverage"]);return i!=null&&f(t,["turnCoverage"],i),t}function yO(e){const t={},n=c(e,["targetTokens"]);return n!=null&&f(t,["targetTokens"],n),t}function wO(e){const t={},n=c(e,["triggerTokens"]);n!=null&&f(t,["triggerTokens"],n);const r=c(e,["slidingWindow"]);return r!=null&&f(t,["slidingWindow"],yO(r)),t}function _O(e){const t={},n=c(e,["proactiveAudio"]);return n!=null&&f(t,["proactiveAudio"],n),t}function TO(e,t){const n={},r=c(e,["generationConfig"]);t!==void 0&&r!=null&&f(t,["setup","generationConfig"],r);const i=c(e,["responseModalities"]);t!==void 0&&i!=null&&f(t,["setup","generationConfig","responseModalities"],i);const s=c(e,["temperature"]);t!==void 0&&s!=null&&f(t,["setup","generationConfig","temperature"],s);const o=c(e,["topP"]);t!==void 0&&o!=null&&f(t,["setup","generationConfig","topP"],o);const u=c(e,["topK"]);t!==void 0&&u!=null&&f(t,["setup","generationConfig","topK"],u);const d=c(e,["maxOutputTokens"]);t!==void 0&&d!=null&&f(t,["setup","generationConfig","maxOutputTokens"],d);const h=c(e,["mediaResolution"]);t!==void 0&&h!=null&&f(t,["setup","generationConfig","mediaResolution"],h);const m=c(e,["seed"]);t!==void 0&&m!=null&&f(t,["setup","generationConfig","seed"],m);const x=c(e,["speechConfig"]);t!==void 0&&x!=null&&f(t,["setup","generationConfig","speechConfig"],rO(eh(x)));const v=c(e,["enableAffectiveDialog"]);t!==void 0&&v!=null&&f(t,["setup","generationConfig","enableAffectiveDialog"],v);const _=c(e,["systemInstruction"]);t!==void 0&&_!=null&&f(t,["setup","systemInstruction"],lO(Ln(_)));const S=c(e,["tools"]);if(t!==void 0&&S!=null){let P=Js(S);Array.isArray(P)&&(P=P.map(L=>mO(Ks(L)))),f(t,["setup","tools"],P)}const T=c(e,["sessionResumption"]);t!==void 0&&T!=null&&f(t,["setup","sessionResumption"],gO(T));const E=c(e,["inputAudioTranscription"]);t!==void 0&&E!=null&&f(t,["setup","inputAudioTranscription"],p1());const C=c(e,["outputAudioTranscription"]);t!==void 0&&C!=null&&f(t,["setup","outputAudioTranscription"],p1());const I=c(e,["realtimeInputConfig"]);t!==void 0&&I!=null&&f(t,["setup","realtimeInputConfig"],vO(I));const A=c(e,["contextWindowCompression"]);t!==void 0&&A!=null&&f(t,["setup","contextWindowCompression"],wO(A));const D=c(e,["proactivity"]);return t!==void 0&&D!=null&&f(t,["setup","proactivity"],_O(D)),n}function kO(e,t){const n={},r=c(t,["model"]);r!=null&&f(n,["setup","model"],vt(e,r));const i=c(t,["config"]);return i!=null&&f(n,["config"],TO(i,n)),n}function SO(e,t,n){const r={},i=c(t,["expireTime"]);n!==void 0&&i!=null&&f(n,["expireTime"],i);const s=c(t,["newSessionExpireTime"]);n!==void 0&&s!=null&&f(n,["newSessionExpireTime"],s);const o=c(t,["uses"]);n!==void 0&&o!=null&&f(n,["uses"],o);const u=c(t,["liveConnectConstraints"]);n!==void 0&&u!=null&&f(n,["bidiGenerateContentSetup"],kO(e,u));const d=c(t,["lockAdditionalFields"]);return n!==void 0&&d!=null&&f(n,["fieldMask"],d),r}function EO(e,t){const n={},r=c(t,["config"]);return r!=null&&f(n,["config"],SO(e,r,n)),n}function CO(e){const t={},n=c(e,["name"]);return n!=null&&f(t,["name"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function AO(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);t.push(...i)}else t.push(n)}return t.join(",")}function IO(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,n=s):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const s=AO(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let u=[];i.length>0&&(u=i.map(h=>o.includes(h)?`generationConfig.${h}`:h));const d=[];s&&d.push(s),u.length>0&&d.push(...u),d.length>0?e.fieldMask=d.join(","):delete e.fieldMask}else delete e.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class NO extends Ya{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const u=EO(this.apiClient,t);s=He("auth_tokens",u._url),o=u._query,delete u.config,delete u._url,delete u._query;const d=IO(u,t.config);return i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),i.then(h=>CO(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function FO(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","name"],n);const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function RO(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);t!==void 0&&i!=null&&f(t,["_query","pageToken"],i);const s=c(e,["filter"]);return t!==void 0&&s!=null&&f(t,["_query","filter"],s),n}function DO(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],RO(n,t)),t}function PO(e){const t={},n=c(e,["textInput"]);n!=null&&f(t,["textInput"],n);const r=c(e,["output"]);return r!=null&&f(t,["output"],r),t}function MO(e){const t={};if(c(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(c(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=c(e,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>PO(i))),f(t,["examples","examples"],r)}return t}function LO(e,t){const n={};if(c(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=c(e,["tunedModelDisplayName"]);if(t!==void 0&&r!=null&&f(t,["displayName"],r),c(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=c(e,["epochCount"]);t!==void 0&&i!=null&&f(t,["tuningTask","hyperparameters","epochCount"],i);const s=c(e,["learningRateMultiplier"]);if(s!=null&&f(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),c(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(c(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const o=c(e,["batchSize"]);t!==void 0&&o!=null&&f(t,["tuningTask","hyperparameters","batchSize"],o);const u=c(e,["learningRate"]);return t!==void 0&&u!=null&&f(t,["tuningTask","hyperparameters","learningRate"],u),n}function BO(e){const t={},n=c(e,["baseModel"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["trainingDataset"]);r!=null&&f(t,["tuningTask","trainingData"],MO(r));const i=c(e,["config"]);return i!=null&&f(t,["config"],LO(i,t)),t}function OO(e){const t={},n=c(e,["name"]);n!=null&&f(t,["_url","name"],n);const r=c(e,["config"]);return r!=null&&f(t,["config"],r),t}function UO(e,t){const n={},r=c(e,["pageSize"]);t!==void 0&&r!=null&&f(t,["_query","pageSize"],r);const i=c(e,["pageToken"]);t!==void 0&&i!=null&&f(t,["_query","pageToken"],i);const s=c(e,["filter"]);return t!==void 0&&s!=null&&f(t,["_query","filter"],s),n}function zO(e){const t={},n=c(e,["config"]);return n!=null&&f(t,["config"],UO(n,t)),t}function bO(e,t){const n={},r=c(e,["gcsUri"]);t!==void 0&&r!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],r);const i=c(e,["vertexDatasetResource"]);if(t!==void 0&&i!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],i),c(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function VO(e,t){const n={},r=c(e,["gcsUri"]);r!=null&&f(n,["validationDatasetUri"],r);const i=c(e,["vertexDatasetResource"]);return t!==void 0&&i!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],i),n}function HO(e,t){const n={},r=c(e,["validationDataset"]);t!==void 0&&r!=null&&f(t,["supervisedTuningSpec"],VO(r,n));const i=c(e,["tunedModelDisplayName"]);t!==void 0&&i!=null&&f(t,["tunedModelDisplayName"],i);const s=c(e,["description"]);t!==void 0&&s!=null&&f(t,["description"],s);const o=c(e,["epochCount"]);t!==void 0&&o!=null&&f(t,["supervisedTuningSpec","hyperParameters","epochCount"],o);const u=c(e,["learningRateMultiplier"]);t!==void 0&&u!=null&&f(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],u);const d=c(e,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&f(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=c(e,["adapterSize"]);if(t!==void 0&&h!=null&&f(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),c(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(c(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function WO(e){const t={},n=c(e,["baseModel"]);n!=null&&f(t,["baseModel"],n);const r=c(e,["trainingDataset"]);r!=null&&f(t,["supervisedTuningSpec","trainingDatasetUri"],bO(r,t));const i=c(e,["config"]);return i!=null&&f(t,["config"],HO(i,t)),t}function GO(e){const t={},n=c(e,["name"]);n!=null&&f(t,["model"],n);const r=c(e,["name"]);return r!=null&&f(t,["endpoint"],r),t}function gw(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["state"]);i!=null&&f(t,["state"],qy(i));const s=c(e,["createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["tuningTask","startTime"]);o!=null&&f(t,["startTime"],o);const u=c(e,["tuningTask","completeTime"]);u!=null&&f(t,["endTime"],u);const d=c(e,["updateTime"]);d!=null&&f(t,["updateTime"],d);const h=c(e,["description"]);h!=null&&f(t,["description"],h);const m=c(e,["baseModel"]);m!=null&&f(t,["baseModel"],m);const x=c(e,["_self"]);x!=null&&f(t,["tunedModel"],GO(x));const v=c(e,["distillationSpec"]);v!=null&&f(t,["distillationSpec"],v);const _=c(e,["experiment"]);_!=null&&f(t,["experiment"],_);const S=c(e,["labels"]);S!=null&&f(t,["labels"],S);const T=c(e,["pipelineJob"]);T!=null&&f(t,["pipelineJob"],T);const E=c(e,["satisfiesPzi"]);E!=null&&f(t,["satisfiesPzi"],E);const C=c(e,["satisfiesPzs"]);C!=null&&f(t,["satisfiesPzs"],C);const I=c(e,["serviceAccount"]);I!=null&&f(t,["serviceAccount"],I);const A=c(e,["tunedModelDisplayName"]);return A!=null&&f(t,["tunedModelDisplayName"],A),t}function $O(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>gw(o))),f(t,["tuningJobs"],s)}return t}function jO(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["metadata"]);i!=null&&f(t,["metadata"],i);const s=c(e,["done"]);s!=null&&f(t,["done"],s);const o=c(e,["error"]);return o!=null&&f(t,["error"],o),t}function qO(e){const t={},n=c(e,["checkpointId"]);n!=null&&f(t,["checkpointId"],n);const r=c(e,["epoch"]);r!=null&&f(t,["epoch"],r);const i=c(e,["step"]);i!=null&&f(t,["step"],i);const s=c(e,["endpoint"]);return s!=null&&f(t,["endpoint"],s),t}function KO(e){const t={},n=c(e,["model"]);n!=null&&f(t,["model"],n);const r=c(e,["endpoint"]);r!=null&&f(t,["endpoint"],r);const i=c(e,["checkpoints"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>qO(o))),f(t,["checkpoints"],s)}return t}function sd(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["name"]);r!=null&&f(t,["name"],r);const i=c(e,["state"]);i!=null&&f(t,["state"],qy(i));const s=c(e,["createTime"]);s!=null&&f(t,["createTime"],s);const o=c(e,["startTime"]);o!=null&&f(t,["startTime"],o);const u=c(e,["endTime"]);u!=null&&f(t,["endTime"],u);const d=c(e,["updateTime"]);d!=null&&f(t,["updateTime"],d);const h=c(e,["error"]);h!=null&&f(t,["error"],h);const m=c(e,["description"]);m!=null&&f(t,["description"],m);const x=c(e,["baseModel"]);x!=null&&f(t,["baseModel"],x);const v=c(e,["tunedModel"]);v!=null&&f(t,["tunedModel"],KO(v));const _=c(e,["supervisedTuningSpec"]);_!=null&&f(t,["supervisedTuningSpec"],_);const S=c(e,["tuningDataStats"]);S!=null&&f(t,["tuningDataStats"],S);const T=c(e,["encryptionSpec"]);T!=null&&f(t,["encryptionSpec"],T);const E=c(e,["partnerModelTuningSpec"]);E!=null&&f(t,["partnerModelTuningSpec"],E);const C=c(e,["distillationSpec"]);C!=null&&f(t,["distillationSpec"],C);const I=c(e,["experiment"]);I!=null&&f(t,["experiment"],I);const A=c(e,["labels"]);A!=null&&f(t,["labels"],A);const D=c(e,["pipelineJob"]);D!=null&&f(t,["pipelineJob"],D);const P=c(e,["satisfiesPzi"]);P!=null&&f(t,["satisfiesPzi"],P);const L=c(e,["satisfiesPzs"]);L!=null&&f(t,["satisfiesPzs"],L);const R=c(e,["serviceAccount"]);R!=null&&f(t,["serviceAccount"],R);const J=c(e,["tunedModelDisplayName"]);return J!=null&&f(t,["tunedModelDisplayName"],J),t}function JO(e){const t={},n=c(e,["sdkHttpResponse"]);n!=null&&f(t,["sdkHttpResponse"],n);const r=c(e,["nextPageToken"]);r!=null&&f(t,["nextPageToken"],r);const i=c(e,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(o=>sd(o))),f(t,["tuningJobs"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class XO extends Ya{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new wl(Ga.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let i="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?i=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(i=r.name.split("/operations/")[0]),{name:i,state:X0.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=OO(t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>sd(m))}else{const h=FO(t);return u=He("{name}",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>gw(m))}}async listInternal(t){var n,r,i,s;let o,u="",d={};if(this.apiClient.isVertexAI()){const h=zO(t);return u=He("tuningJobs",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=JO(m),v=new Gx;return Object.assign(v,x),v})}else{const h=DO(t);return u=He("tunedModels",h._url),d=h._query,delete h.config,delete h._url,delete h._query,o=this.apiClient.request({path:u,queryParams:d,body:JSON.stringify(h),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(m=>m.json().then(x=>{const v=x;return v.sdkHttpResponse={headers:m.headers},v})),o.then(m=>{const x=$O(m),v=new Gx;return Object.assign(v,x),v})}}async tuneInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI()){const u=WO(t);return s=He("tuningJobs",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>sd(d))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let i,s="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const u=BO(t);return s=He("tunedModels",u._url),o=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:s,queryParams:o,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json().then(h=>{const m=h;return m.sdkHttpResponse={headers:d.headers},m})),i.then(d=>jO(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class YO{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const ZO=1024*1024*8,QO=3,e7=1e3,t7=2,N0="x-goog-upload-status";async function n7(e,t,n){var r,i,s;let o=0,u=0,d=new Y0(new Response),h="upload";for(o=e.size;u<o;){const x=Math.min(ZO,o-u),v=e.slice(u,u+x);u+x>=o&&(h+=", finalize");let _=0,S=e7;for(;_<QO&&(d=await n.request({path:"",body:v,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":h,"X-Goog-Upload-Offset":String(u),"Content-Length":String(x)}}}),!(!((r=d==null?void 0:d.headers)===null||r===void 0)&&r[N0]));)_++,await i7(S),S=S*t7;if(u+=x,((i=d==null?void 0:d.headers)===null||i===void 0?void 0:i[N0])!=="active")break;if(o<=u)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const m=await(d==null?void 0:d.json());if(((s=d==null?void 0:d.headers)===null||s===void 0?void 0:s[N0])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return m.file}async function r7(e){return{size:e.size,type:e.type}}function i7(e){return new Promise(t=>setTimeout(t,e))}class a7{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await n7(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await r7(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class s7{create(t,n,r){return new o7(t,n,r)}}class o7{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const m1="x-goog-api-key";class l7{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(t.get(m1)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(m1,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const u7="gl-node/";class c7{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=oD(t.httpOptions,t.vertexai,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const i=new l7(this.apiKey);this.apiClient=new NB({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:u7+"web",uploader:new a7,downloader:new YO}),this.models=new JB(this.apiClient),this.live=new HB(this.apiClient,i,new s7),this.batches=new RP(this.apiClient),this.chats=new LM(this.models,this.apiClient),this.caches=new DM(this.apiClient),this.files=new KM(this.apiClient),this.operations=new QB(this.apiClient),this.authTokens=new NO(this.apiClient),this.tunings=new XO(this.apiClient)}}const f7=new c7({apiKey:"PLACEHOLDER_API_KEY"}),d7=async(e,t)=>{const r=`Dziaajc jako starszy kierownik projektu, wygeneruj zwiz list kontroln (checklist) do przegldu etapu (gate review) dla fazy "${ta[t]}" w projekcie o nazwie "${e}". Lista powinna by w jzyku polskim. Skup si na kluczowych rezultatach i kryteriach akceptacji dla tej fazy. Zwr maksymalnie 10 najwaniejszych punktw.`;try{const s=(await f7.models.generateContent({model:"gemini-2.5-flash",contents:r,config:{responseMimeType:"application/json",responseSchema:{type:Ar.OBJECT,properties:{checklist:{type:Ar.ARRAY,description:"Lista punktw kontrolnych do przegldu etapu.",items:{type:Ar.OBJECT,properties:{text:{type:Ar.STRING,description:"Pojedynczy punkt kontrolny na licie."}},required:["text"]}}},required:["checklist"]}}})).text.trim(),o=JSON.parse(s);return o.checklist&&Array.isArray(o.checklist)?o.checklist.map(u=>({text:u.text,checked:!1})):[]}catch(i){return console.error("Error generating checklist with Gemini API:",i),[{text:"Weryfikacja celu etapu.",checked:!1},{text:"Sprawdzenie zgodnoci z wymaganiami.",checked:!1},{text:"Ocena zidentyfikowanych ryzyk.",checked:!1}]}},h7=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456zM16.898 20.572L16.5 21.75l-.398-1.178a3.375 3.375 0 00-2.31-2.31L12.602 18l1.178-.398a3.375 3.375 0 002.31-2.31L16.5 14.25l.398 1.178a3.375 3.375 0 002.31 2.31L20.398 18l-1.178.398a3.375 3.375 0 00-2.31 2.31z"})}),p7=({isOpen:e,onClose:t,onSave:n,pkg:r,stage:i,existingReview:s})=>{const[o,u]=ge.useState([]),[d,h]=ge.useState(""),[m,x]=ge.useState("Not Reviewed"),[v,_]=ge.useState(!1);ge.useEffect(()=>{e&&(s?(u(s.checklist),h(s.comments),x(s.status)):(u([]),h(""),x("Not Reviewed")))},[s,e]);const S=async()=>{_(!0);const C=await d7(r.name,i);u(C),_(!1)},T=C=>{const I=[...o];I[C].checked=!I[C].checked,u(I)},E=async()=>{if(m==="Not Reviewed"){alert("Prosz wybra status przegldu (Zaliczony, Niezaliczony, etc.).");return}const C={id:s==null?void 0:s.id,packageId:r.id,stage:i,status:m,checklist:o,comments:d,createdAt:(s==null?void 0:s.createdAt)||new Date().toISOString()};await n(C),t()};return y.jsx(er,{isOpen:e,onClose:t,title:`Przegld: ${ta[i]}`,children:y.jsxs("div",{className:"space-y-6",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"text-xl font-bold text-gray-900",children:r.name}),y.jsx("p",{className:"text-gray-500",children:"Prosz przej przez list kontroln, doda komentarze i ustawi status kocowy."})]}),y.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[y.jsxs("div",{className:"flex justify-between items-center",children:[y.jsx("h4",{className:"font-semibold text-lg text-gray-900",children:"Lista kontrolna"}),y.jsxs(qe,{onClick:S,disabled:v,variant:"primary",children:[y.jsx(h7,{className:"w-5 h-5 mr-2 inline"}),v?"Generowanie...":"Generuj list z AI"]})]}),v&&y.jsx("div",{className:"text-center text-gray-500 py-4",children:"Chwileczk, AI przygotowuje punkty..."}),o.length>0?y.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:o.map((C,I)=>y.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-gray-100 cursor-pointer transition-colors",children:[y.jsx("input",{type:"checkbox",checked:C.checked,onChange:()=>T(I),className:"h-4 w-4 rounded bg-gray-200 border-gray-300 text-blue-600 focus:ring-blue-500"}),y.jsx("span",{className:`ml-3 text-sm text-gray-700 ${C.checked?"line-through text-gray-400":""}`,children:C.text})]},I))}):!v&&y.jsx("div",{className:"text-center text-gray-500 text-sm py-4",children:'Kliknij "Generuj list z AI", aby rozpocz.'})]}),y.jsx(Ei,{label:"Komentarze",value:d,onChange:C=>h(C.target.value),rows:4,placeholder:"Dodaj oglne uwagi, warunki, lub uzasadnienie decyzji."}),y.jsx(dr,{label:"Status kocowy przegldu",value:m,onChange:C=>x(C.target.value),children:d2.map(C=>y.jsx("option",{value:C,children:T1[C]},C))}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:E,disabled:v,children:"Zapisz przegld"})]})]})})},g1=e=>e.toLocaleDateString("pl-PL",{year:"numeric",month:"2-digit",day:"2-digit"}),xw=({schedule:e})=>e.length===0?y.jsxs("div",{className:"mt-6 bg-gray-50 p-4 rounded-lg border border-dashed border-gray-300 text-center text-gray-500",children:[y.jsx("p",{children:"Brak danych z roadmapy do wygenerowania harmonogramu."}),y.jsx("p",{className:"text-sm",children:"Upewnij si, e ta paczka jest powizana z pozycj na roadmapie i ma zdefiniowane estymacje godzinowe."})]}):y.jsxs(Wn,{className:"mt-6 bg-white",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Planowany Harmonogram (wg estymat)"}),y.jsx("div",{className:"overflow-x-auto",children:y.jsxs("table",{className:"min-w-full text-sm text-left",children:[y.jsx("thead",{className:"text-gray-600 bg-gray-50",children:y.jsxs("tr",{className:"border-b border-gray-200",children:[y.jsx("th",{className:"p-3 font-semibold",children:"Etap"}),y.jsx("th",{className:"p-3 font-semibold",children:"Planowany Start"}),y.jsx("th",{className:"p-3 font-semibold",children:"Planowany Stop"}),y.jsx("th",{className:"p-3 font-semibold text-center",children:"Dni Robocze"}),y.jsx("th",{className:"p-3 font-semibold text-center",children:"Godziny"})]})}),y.jsx("tbody",{className:"text-gray-700",children:e.map(t=>y.jsxs("tr",{className:"border-b border-gray-100 last:border-0 hover:bg-gray-50",children:[y.jsx("td",{className:"p-3 font-medium text-gray-800",children:t.name}),y.jsx("td",{className:"p-3",children:g1(t.startDate)}),y.jsx("td",{className:"p-3",children:g1(t.stopDate)}),y.jsx("td",{className:"p-3 text-center font-semibold",children:t.durationDays}),y.jsx("td",{className:"p-3 text-center",children:t.key==="development"?y.jsxs("span",{className:"text-xs",children:["IT: ",t.itHours,"h / LF: ",t.lfHours,"h"]}):`${t.durationHours}h`})]},t.name))})]})})]}),x1=e=>{const t=new Date(e),n=t.getDay()||7;return n!==1&&t.setHours(-24*(n-1)),t.setHours(0,0,0,0),t},F0=(e,t)=>{const n=new Date(e);return n.setDate(n.getDate()+t),n},bu=(e,t)=>{const n=e.getTime()-t.getTime();return Math.round(n/(1e3*60*60*24))},v1=e=>e.toLocaleDateString("pl-PL",{day:"2-digit",month:"2-digit",year:"numeric"}),nh=({scheduleData:e,proposedScheduleData:t=null,goLiveDate:n})=>{const r=[e.schedule,t==null?void 0:t.schedule].filter(Boolean);if(r.length===0||r.every(P=>P.length===0))return null;const i=r.flat().map(P=>P.startDate),s=r.flat().map(P=>P.stopDate),o=new Date(Math.min(...i.map(P=>P.getTime()))),u=new Date(Math.max(...s.map(P=>P.getTime()))),d=x1(o),h=F0(x1(u),6),m=bu(h,d)+1,x=[],v=[];let _=new Date(d),S=-1;for(;_<=h;){x.push(new Date(_));const P=_.getMonth();P!==S?(v.push({name:_.toLocaleString("pl-PL",{month:"long"}),year:_.getFullYear().toString().slice(-2),weekSpan:1}),S=P):v[v.length-1].weekSpan++,_=F0(_,7)}const T=x.length,E=new Date,C=x.findIndex(P=>E>=P&&E<F0(P,7)),I=n?new Date(n):null,A=I?bu(I,d)/m*100:null,D=(P,L)=>y.jsx("div",{className:`relative ${L?"mt-2":""}`,children:P.map((R,J)=>{const V=bu(R.startDate,d),ne=bu(R.stopDate,R.startDate)+1,te=V/m*100,Q=ne/m*100,me=R.key.startsWith("development")?"development":R.key,Re=f2[me],ye=`Etap: ${R.name}
Start: ${v1(R.startDate)}
Stop: ${v1(R.stopDate)}
Dni: ${R.durationDays}`;return y.jsxs("div",{className:"absolute top-0 h-8 flex items-center group",style:{left:`${te}%`,width:`${Q}%`},children:[y.jsx("div",{className:`w-full h-full ${Re} rounded transition-opacity group-hover:opacity-100 ${L?"opacity-60 border-2 border-dashed border-white":"opacity-90"}`,title:ye,children:y.jsx("span",{className:"absolute left-2 top-1/2 -translate-y-1/2 text-xs font-semibold text-white truncate pr-2 pointer-events-none",children:R.name})}),y.jsxs("div",{className:"absolute bottom-full mb-2 left-1/2 -translate-x-1/2 w-max px-3 py-2 bg-gray-800 text-white text-xs rounded-md shadow-lg opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-30 whitespace-pre-line text-center",children:[ye,y.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 w-0 h-0 border-x-8 border-x-transparent border-t-8 border-t-gray-800"})]})]},`${L?"prop":"base"}-${J}`)})});return y.jsxs(Wn,{className:"mt-6 bg-white",children:[y.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"O Czasu Projektu"}),y.jsx("div",{className:"overflow-x-auto pb-4",children:y.jsxs("div",{style:{minWidth:`${T*60}px`},children:[y.jsx("div",{className:"grid border-b-2 border-gray-300",style:{gridTemplateColumns:`repeat(${T}, minmax(0, 1fr))`},children:v.map((P,L)=>y.jsxs("div",{className:"text-center py-1 border-b border-gray-200",style:{gridColumn:`span ${P.weekSpan} / span ${P.weekSpan}`},children:[y.jsx("span",{className:"font-bold text-gray-700 capitalize",children:P.name}),y.jsxs("span",{className:"text-gray-500",children:[" '",P.year]})]},L))}),y.jsx("div",{className:"grid -mt-px",style:{gridTemplateColumns:`repeat(${T}, minmax(0, 1fr))`},children:x.map((P,L)=>y.jsx("div",{className:"text-center text-xs text-gray-500 border-r border-gray-200 py-1",children:P.getDate().toString().padStart(2,"0")},L))}),y.jsxs("div",{className:"relative mt-12",style:{height:`${r.length*5}rem`},children:[y.jsx("div",{className:"absolute inset-0 grid",style:{gridTemplateColumns:`repeat(${T}, minmax(0, 1fr))`},children:x.map((P,L)=>y.jsx("div",{className:`h-full border-r border-gray-200 ${L===C?"bg-blue-50":""}`},L))}),A!==null&&A>=0&&A<=100&&y.jsxs("div",{className:"absolute top-0 h-full",style:{left:`${A}%`},children:[y.jsx("div",{className:"h-full w-0.5 bg-green-500"}),y.jsx("span",{className:"absolute -top-10 -translate-x-1/2 bg-green-500 text-white text-xs font-bold px-2 py-1 rounded",children:"GO LIVE"})]}),D(e.schedule,!1),t&&y.jsx("div",{className:"pt-10 h-8",children:D(t.schedule,!0)})]})]})})]})},m7=({packages:e,reviews:t,onSaveReview:n,roadmapItems:r})=>{const[i,s]=ge.useState(""),[o,u]=ge.useState(!1),[d,h]=ge.useState(null),m=ge.useMemo(()=>e.map(C=>({value:C.id,label:C.name})),[e]),x=ge.useMemo(()=>i&&e.find(C=>C.id===i)||null,[i,e]),v=ge.useMemo(()=>i?t.filter(C=>C.packageId===i):[],[t,i]),_=ge.useMemo(()=>{if(!x)return{schedule:[],overallStartDate:null,overallEndDate:null};const C=r.find(I=>I.packageName===x.name);return sc(x,C)},[x,r]),S=(C,I)=>{h({pkg:C,stage:I}),u(!0)},T=()=>{u(!1),h(null)},E=C=>{const I=v.slice().sort((A,D)=>new Date(D.createdAt).getTime()-new Date(A.createdAt).getTime()).find(A=>A.stage===C);return I?I.status:"Not Reviewed"};return y.jsxs("div",{className:"h-full overflow-y-auto",children:[y.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Przegldy Paczek"}),y.jsx(Wn,{className:"mb-6",children:y.jsx("div",{className:"max-w-md",children:y.jsxs(dr,{label:"Wybierz paczk do przegldu",value:i,onChange:C=>s(C.target.value?Number(C.target.value):""),children:[y.jsx("option",{value:"",children:"-- Wybierz paczk --"}),m.map(C=>y.jsx("option",{value:C.value,children:C.label},C.value))]})})}),x?y.jsxs(Wn,{children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:x.name}),y.jsx("p",{className:"text-gray-500 mb-1",children:"Status przegldw dla poszczeglnych etapw."}),y.jsx(xw,{schedule:_.schedule}),y.jsx(nh,{scheduleData:_,goLiveDate:x.currentGoLiveDate}),y.jsx("h3",{className:"text-xl font-semibold text-gray-900 mt-8 mb-4",children:"Bramki Przegldowe"}),y.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4",children:ld.map(C=>{const I=E(C),A=h2[I],D=T1[I];return y.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm flex flex-col justify-between",children:[y.jsxs("div",{children:[y.jsx("h3",{className:"font-bold text-lg text-gray-900",children:ta[C]}),y.jsx("span",{className:`mt-2 inline-block px-2 py-1 text-xs font-semibold rounded-full ${A}`,children:D})]}),y.jsx(qe,{className:"mt-4 w-full",onClick:()=>S(x,C),variant:"secondary",children:I==="Not Reviewed"?"Rozpocznij przegld":"Zobacz / Edytuj"})]},C)})})]}):y.jsx("div",{className:"flex items-center justify-center h-full -mt-24",children:y.jsxs("div",{className:"text-center",children:[y.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:y.jsx("path",{vectorEffect:"non-scaling-stroke",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),y.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-800",children:"Brak wybranej paczki"}),y.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Wybierz paczk, aby zobaczy status jej przegldw."})]})}),d&&y.jsx(p7,{isOpen:o,onClose:T,onSave:n,pkg:d.pkg,stage:d.stage,existingReview:v.slice().sort((C,I)=>new Date(I.createdAt).getTime()-new Date(C.createdAt).getTime()).find(C=>C.stage===d.stage)||null})]})},g7=()=>{const e=({title:t,children:n})=>y.jsxs("div",{className:"mb-8",children:[y.jsx("h3",{className:"text-xl font-bold text-blue-600 mb-3 border-b border-gray-200 pb-2",children:t}),y.jsx("div",{className:"space-y-3 text-gray-700 leading-relaxed",children:n})]});return y.jsx("div",{className:"h-full overflow-y-auto",children:y.jsxs(Wn,{children:[y.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Centrum Pomocy"}),y.jsx("p",{className:"mb-10 text-gray-500",children:"W tej sekcji znajdziesz wszystkie potrzebne informacje dotyczce uruchamiania, udostpniania i technicznych aspektw dziaania aplikacji."}),y.jsxs("div",{className:"mb-12",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b-2 border-blue-500",children:"Instrukcja Uruchomienia Aplikacji na Innym Komputerze"}),y.jsx("p",{className:"mb-8 text-gray-500",children:'Ten przewodnik krok po kroku wyjania, jak uruchomi aplikacj "Meneder Releasw" na innym komputerze. Aplikacja dziaa w caoci w przegldarce internetowej i nie wymaga skomplikowanego procesu instalacyjnego.'}),y.jsxs(e,{title:"Krok 1: Przygotowanie plikw do przeniesienia",children:[y.jsx("p",{children:"Pierwszym krokiem jest spakowanie wszystkich plikw aplikacji do jednego archiwum."}),y.jsxs("ol",{className:"list-decimal list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Zlokalizuj folder, w ktrym znajduj si pliki tej aplikacji na Twoim komputerze."}),y.jsx("li",{children:'Kliknij prawym przyciskiem myszy na ten folder, a nastpnie z menu kontekstowego wybierz opcj "Wylij do" > "Folder skompresowany (zip)".'}),y.jsxs("li",{children:["System utworzy nowy plik z rozszerzeniem `.zip`. Moesz nada mu dowoln nazw, np. ",y.jsx("strong",{children:"Menedzer-Releasow.zip"}),"."]})]})]}),y.jsxs(e,{title:"Krok 2: Przeniesienie plikw na nowy komputer",children:[y.jsx("p",{children:"Przenie utworzony plik `.zip` na docelowy komputer. Moesz do tego uy dowolnej, wygodnej dla Ciebie metody:"}),y.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Pami USB (pendrive)."}),y.jsx("li",{children:"Wysanie pliku jako zacznik w wiadomoci e-mail."}),y.jsx("li",{children:"Umieszczenie pliku w chmurze (np. Dysk Google, Dropbox, OneDrive) i pobranie go na drugim komputerze."})]})]}),y.jsxs(e,{title:"Krok 3: Rozpakowanie plikw na nowym komputerze",children:[y.jsx("p",{children:"Gdy plik `.zip` znajdzie si na nowym komputerze, naley go rozpakowa."}),y.jsxs("ol",{className:"list-decimal list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Znajd przeniesiony plik `.zip`."}),y.jsx("li",{children:'Kliknij na niego prawym przyciskiem myszy i wybierz opcj "Wyodrbnij wszystkie..." lub "Rozpakuj tutaj".'}),y.jsx("li",{children:"Wybierz miejsce, gdzie chcesz zapisa pliki aplikacji, na przykad na Pulpicie lub w folderze Moje Dokumenty."})]})]}),y.jsxs(e,{title:"Krok 4: Uruchomienie aplikacji",children:[y.jsx("p",{children:"To ostatni i najwaniejszy krok."}),y.jsxs("ol",{className:"list-decimal list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Otwrz folder, do ktrego przed chwil zostay wypakowane wszystkie pliki."}),y.jsxs("li",{children:["Znajd w nim plik o nazwie ",y.jsx("strong",{children:"index.html"}),"."]}),y.jsxs("li",{className:"font-semibold text-yellow-700 bg-yellow-50 p-2 rounded-md",children:['Wane: Kliknij prawym przyciskiem myszy na plik `index.html`, wybierz opcj "Otwrz za pomoc", a nastpnie wska nowoczesn przegldark internetow, tak jak ',y.jsx("strong",{children:"Google Chrome"})," lub ",y.jsx("strong",{children:"Mozilla Firefox"}),". Zwyke dwukrotne kliknicie moe nie zadziaa poprawnie."]}),y.jsx("li",{children:"Aplikacja powinna otworzy si w nowej karcie przegldarki i by gotowa do uycia."})]})]})]}),y.jsx("hr",{className:"my-12 border-gray-200"}),y.jsxs("div",{className:"mb-12",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b-2 border-blue-500",children:"Instrukcja Przygotowania Wersji Produkcyjnej"}),y.jsx("p",{className:"mb-8 text-gray-500",children:'"Wersja produkcyjna" w kontekcie tej aplikacji to po prostu paczka ze wszystkimi jej plikami, gotowa do przekazania innej osobie. Ten przewodnik pokazuje, jak j przygotowa.'}),y.jsxs(e,{title:"Krok 1: Zlokalizuj i spakuj pliki aplikacji",children:[y.jsx("p",{children:"Aby przekaza aplikacj, musisz najpierw zebra wszystkie jej pliki w jedno archiwum `.zip`."}),y.jsxs("ol",{className:"list-decimal list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Odszukaj na swoim komputerze gwny folder zawierajcy pliki aplikacji (np. `index.html`, `App.tsx` itd.)."}),y.jsx("li",{children:"Kliknij prawym przyciskiem myszy na ten folder."}),y.jsx("li",{children:'Z menu kontekstowego wybierz opcj, ktra pozwoli Ci skompresowa folder. Zazwyczaj nazywa si ona "Wylij do" > "Folder skompresowany (zip)" w systemie Windows lub "Kompresuj" w systemie macOS.'}),y.jsxs("li",{children:["Po wykonaniu tej czynnoci powstanie nowy plik z rozszerzeniem `.zip`, np. ",y.jsx("strong",{children:"Menedzer-Releasow.zip"}),'. Ten plik to Twoja "wersja produkcyjna".']})]})]}),y.jsxs(e,{title:"Krok 2: Przeka paczk nowemu uytkownikowi",children:[y.jsx("p",{children:"Utworzony plik `.zip` moesz teraz przekaza innej osobie. Moesz to zrobi na wiele sposobw:"}),y.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[y.jsx("li",{children:"Wysyajc go jako zacznik e-mail."}),y.jsx("li",{children:"Kopiujc na nonik USB (pendrive)."}),y.jsx("li",{children:"Udostpniajc przez dysk chmurowy (np. Dysk Google, OneDrive)."})]})]}),y.jsxs("div",{className:"mt-8 border-t-2 border-red-500 pt-6",children:[y.jsx("h3",{className:"text-2xl font-bold text-red-600 mb-3",children:"Bardzo Wane: Kwestia Danych"}),y.jsxs("ul",{className:"list-disc list-inside space-y-3 pl-4",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Dane nie s przenoszone!"}),' Przygotowany plik `.zip` zawiera wycznie pliki aplikacji (jej "silnik" i wygld), ale ',y.jsx("strong",{children:"NIE ZAWIERA adnych danych"}),", ktre wprowadzie/a (wyda, paczek, zada itp.)."]}),y.jsxs("li",{children:["Nowy uytkownik po otwarciu aplikacji zobaczy ",y.jsx("strong",{children:"czysty program"})," z domylnymi danymi startowymi, a nie Twoje wpisy."]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Dlaczego tak si dzieje?"})," Aplikacja zapisuje wszystkie dane lokalnie, w pamici przegldarki (technologia IndexedDB) na Twoim komputerze. Dane te nie s czci plikw aplikacji i nie mona ich w ten sposb skopiowa."]})]})]})]}),y.jsx("hr",{className:"my-12 border-gray-200"}),y.jsxs("div",{className:"mb-12",children:[y.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6 pb-3 border-b-2 border-blue-500",children:'Przewodnik po "Buildzie" Aplikacji'}),y.jsx("p",{className:"mb-8 text-gray-500",children:'Zadae/a wietne pytanie o "build". To fundamentalny koncept w tworzeniu nowoczesnych stron internetowych. Ten przewodnik wyjani, czym jest "build", dlaczego ta aplikacja go nie potrzebuje i jak mimo to mona j udostpnia.'}),y.jsxs(e,{title:"1. Czym jest proces 'buildu' w tworzeniu aplikacji?",children:[y.jsxs("p",{children:["W wikszoci profesjonalnych projektw kod pisany przez deweloperw (np. pliki `.tsx` z Reactem) nie jest bezporednio uruchamiany w przegldarce. Zamiast tego przechodzi przez proces zwany ",y.jsx("strong",{children:'"buildem"'})," (budowaniem)."]}),y.jsx("p",{children:"Proces ten, realizowany przez narzdzia takie jak Vite, Webpack czy Parcel, wykonuje kilka kluczowych zada:"}),y.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"Kompilacja:"})," Zamienia nowoczesny kod (JSX, TypeScript) na standardowy JavaScript, zrozumiay dla wszystkich przegldarek."]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Bundling (czenie):"})," czy dziesitki, a nawet setki maych plikw JavaScript w jeden lub kilka wikszych, zoptymalizowanych plikw. Redukuje to liczb zapyta do serwera i przyspiesza adowanie strony."]}),y.jsxs("li",{children:[y.jsx("strong",{children:"Minifikacja:"})," Usuwa z kodu wszystkie niepotrzebne znaki (spacje, komentarze) i skraca nazwy zmiennych, aby pliki wynikowe byy jak najmniejsze."]})]}),y.jsxs("p",{className:"mt-2 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("strong",{children:"W skrcie:"}),' "Build" to proces tworzenia zoptymalizowanej, produkcyjnej wersji aplikacji z kodu rdowego.']})]}),y.jsxs(e,{title:"2. Dlaczego ta aplikacja NIE MA tradycyjnego procesu 'buildu'?",children:[y.jsxs("p",{children:["Ta aplikacja zostaa stworzona z myl o ",y.jsx("strong",{children:"maksymalnej prostocie"})," i transparentnoci. Zamiast uywa skomplikowanych narzdzi do budowania, wykorzystuje nowoczesne funkcje samych przegldarek:"]}),y.jsxs("ul",{className:"list-disc list-inside space-y-2 pl-4",children:[y.jsxs("li",{children:[y.jsx("strong",{children:"ES Modules (ESM):"}),' Plik `index.html` wczytuje bezporednio plik `index.tsx` za pomoc `type="module"`. Przegldarka sama potrafi analizowa zalenoci (`import`) i wczytywa kolejne pliki.']}),y.jsxs("li",{children:[y.jsx("strong",{children:"CDN (Content Delivery Network):"})," Biblioteka React nie jest doczona do plikw aplikacji, ale jest adowana dynamicznie z szybkiej, zewntrznej sieci (esm.sh)."]})]}),y.jsxs("p",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-yellow-800",children:[y.jsx("strong",{children:"Zaleta tego podejcia:"})," Nie musisz instalowa adnych dodatkowych narzdzi (Node.js, npm) ani uruchamia adnych komend, aby zobaczy dziaajc aplikacj lub wprowadzi w niej zmiany. Wystarczy edytowa pliki i odwiey przegldark."]})]})]})]})})},x7=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),y1={releases:{name:"Wydania (Releasy)",headers:["name","details","releaseDate"]},roadmap:{name:"Roadmapa",headers:["jira","orderName","packageName","analysisHours","devITHours","devLFHours","testingHours","deploymentHours","stabilizationLFHours","totalITHoursWithBuffer","workLFHours","totalHours","comment"]},backlog:{name:"Backlog",headers:["ticketId","description","foz","plannedDate","analyst","status","decision","comment"]}},v7=({isOpen:e,onClose:t,onImport:n,isLoading:r,error:i})=>{const[s,o]=ge.useState("releases"),[u,d]=ge.useState(null),h=ge.useMemo(()=>y1[s],[s]),m=v=>{v.target.files&&v.target.files.length>0?d(v.target.files[0]):d(null)},x=async()=>{if(!u){alert("Prosz wybra plik do importu.");return}await n(s,u)};return ge.useEffect(()=>{e||d(null)},[e]),y.jsx(er,{isOpen:e,onClose:t,title:"Importuj dane z pliku Excel (.xlsx)",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(dr,{label:"Co chcesz zaimportowa?",value:s,onChange:v=>o(v.target.value),disabled:r,children:Object.entries(y1).map(([v,_])=>y.jsx("option",{value:v,children:_.name},v))}),y.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Instrukcja formatowania pliku Excel"}),y.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Wybierz plik `.xlsx`. Upewnij si, e pierwszy arkusz zawiera dane, pierwszy wiersz to nagwki, a kolumny s w nastpujcej kolejnoci:"}),y.jsx("code",{className:"block text-xs bg-gray-100 p-2 rounded-md text-blue-800 overflow-x-auto",children:h.headers.join(", ")}),y.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Komrki z datami (`releaseDate`, `plannedDate`) powinny by sformatowane jako data w Excelu."})]}),y.jsxs("div",{children:[y.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Wybierz plik .xlsx"}),y.jsx("div",{className:"mt-2 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:y.jsxs("div",{className:"space-y-1 text-center",children:[y.jsx(x7,{className:"mx-auto h-12 w-12 text-gray-400"}),y.jsxs("div",{className:"flex text-sm text-gray-600",children:[y.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-offset-gray-100 focus-within:ring-blue-500 px-1",children:[y.jsx("span",{children:"Przelij plik"}),y.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:".xlsx, .xls",onChange:m,disabled:r})]}),y.jsx("p",{className:"pl-1",children:"lub przecignij i upu"})]}),u?y.jsx("p",{className:"text-sm text-green-600",children:u.name}):y.jsx("p",{className:"text-xs text-gray-500",children:"Tylko pliki .xlsx i .xls"})]})})]}),i&&y.jsxs("div",{className:"p-3 bg-red-100 border border-red-300 text-red-800 rounded-md text-sm",children:[y.jsx("p",{className:"font-semibold mb-1",children:"Bd importu:"}),y.jsx("p",{className:"whitespace-pre-wrap",children:i})]}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,disabled:r,children:"Anuluj"}),y.jsx(qe,{onClick:x,disabled:r||!u,children:r?"Importowanie...":"Rozpocznij Import"})]})]})})},y7={releases:{name:"Wydania (Releasy)"},roadmap:{name:"Roadmapa"},backlog:{name:"Backlog"}},w7=({isOpen:e,onClose:t,onExport:n})=>{const[r,i]=ge.useState("releases"),s=()=>{n(r)};return y.jsx(er,{isOpen:e,onClose:t,title:"Eksportuj dane do pliku Excel (.xlsx)",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx(dr,{label:"Co chcesz wyeksportowa?",value:r,onChange:o=>i(o.target.value),children:Object.entries(y7).map(([o,u])=>y.jsx("option",{value:o,children:u.name},o))}),y.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Informacje"}),y.jsxs("p",{className:"text-sm text-gray-600",children:["Ta operacja wyeksportuje ",y.jsx("strong",{children:"wszystkie"})," dane z wybranej kategorii do pliku Excela (`.xlsx`). Format pliku bdzie zgodny z wymaganiami dla funkcji importu."]})]}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:s,children:"Eksportuj"})]})]})})},_7=e=>y.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 105 28",height:"28",...e,children:[y.jsx("style",{children:`
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        .grupa-text { font-family: 'Inter', sans-serif; font-size: 14px; fill: #6b7280; letter-spacing: 0.5px; }
        .neuca-text { font-family: 'Inter', sans-serif; font-size: 14px; fill: #374151; font-weight: 700; letter-spacing: 0.5px;}
      `}),y.jsx("text",{x:"0",y:"19",className:"grupa-text",children:"GRUPA"}),y.jsx("text",{x:"48",y:"19",className:"neuca-text",children:"NEUCA"})]}),T7=({isOpen:e,onClose:t,onAssign:n,packages:r})=>{const[i,s]=ge.useState(""),o=ge.useMemo(()=>r.filter(d=>d.status==="todo"||d.status==="planning"),[r]);ge.useEffect(()=>{e&&(o.length>0?s(o[0].name):s(""))},[e,o]);const u=()=>{i?n(i):alert("Prosz wybra paczk.")};return y.jsx(er,{isOpen:e,onClose:t,title:"Przypisz do paczki",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx("p",{className:"text-gray-600",children:"Wybierz paczk, do ktrej chcesz przypisa to zlecenie. Spowoduje to otwarcie formularza estymacji na roadmapie."}),o.length>0?y.jsx(dr,{label:"Dostpne paczki",value:i,onChange:d=>s(d.target.value),children:o.map(d=>y.jsx("option",{value:d.name,children:d.name},d.id))}):y.jsx("div",{className:"p-4 bg-yellow-50 border border-yellow-200 rounded-lg text-center text-yellow-800",children:'Brak dostpnych paczek w statusie "Do zaplanowania" lub "W planowaniu".'}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:u,disabled:!i,children:"Dalej"})]})]})})},k7=({isOpen:e,onClose:t,onApprove:n,pkg:r,roadmapItems:i})=>{const[s,o]=ge.useState(""),u=ge.useMemo(()=>{if(!r)return{schedule:[],overallStartDate:null,overallEndDate:null};const h=i.find(m=>m.packageName===r.name);return sc(r,h)},[r,i]),d=()=>{if(!s.trim()){alert("Prosz poda imi i nazwisko osoby zatwierdzajcej.");return}r!=null&&r.id&&n(r.id,s.trim())};return!e||!r?null:y.jsx(er,{isOpen:e,onClose:t,title:`Zatwierdzenie Harmonogramu: ${r.name}`,children:y.jsx("div",{className:"max-h-[85vh] overflow-y-auto pr-2",children:y.jsxs("div",{className:"space-y-6",children:[y.jsx("p",{className:"text-gray-600",children:"Poniej znajduje si harmonogram bazowy wyliczony na podstawie estymat. Zweryfikuj go, a nastpnie podpisz, aby zatwierdzi i umoliwi rozpoczcie prac."}),y.jsx(xw,{schedule:u.schedule}),y.jsx(nh,{scheduleData:u,goLiveDate:r.currentGoLiveDate}),y.jsx("div",{className:"pt-6 border-t border-gray-200",children:y.jsx(St,{label:"Podpis (Imi i Nazwisko)",value:s,onChange:h=>o(h.target.value),placeholder:"Wpisz swoje imi i nazwisko",required:!0})}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:d,disabled:!s.trim(),children:"Zatwierd i podpisz"})]})]})})})},S7=({isOpen:e,onClose:t,onSave:n,itemToReEstimate:r})=>{const[i,s]=ge.useState("Niedoszacowane"),[o,u]=ge.useState(""),[d,h]=ge.useState({});ge.useEffect(()=>{e&&r&&(h({analysisHours:r.analysisHours,devITHours:r.devITHours,workLFHours:r.workLFHours,testingHours:r.testingHours,deploymentHours:r.deploymentHours}),u(""),s("Niedoszacowane"))},[e,r]);const m=(v,_)=>{const S=_===""?void 0:parseFloat(_);h(T=>({...T,[v]:S}))},x=()=>{if(!o.trim()){alert("Uzasadnienie jest wymagane.");return}n(i,o,d)};return r?y.jsx(er,{isOpen:e,onClose:t,title:`Wniosek o reestymacj: ${r.orderName||"Zlecenie"}`,children:y.jsxs("div",{className:"max-h-[85vh] overflow-y-auto pr-2 space-y-6",children:[y.jsxs("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg",children:[y.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Oryginalne estymaty (h)"}),y.jsxs("div",{className:"grid grid-cols-3 gap-x-6 gap-y-2 text-sm",children:[y.jsxs("span",{children:["Analiza: ",y.jsx("strong",{className:"text-gray-900",children:r.analysisHours||0})]}),y.jsxs("span",{children:["Progr. IT: ",y.jsx("strong",{className:"text-gray-900",children:r.devITHours||0})]}),y.jsxs("span",{children:["Testy: ",y.jsx("strong",{className:"text-gray-900",children:r.testingHours||0})]}),y.jsxs("span",{children:["Wdroenie: ",y.jsx("strong",{className:"text-gray-900",children:r.deploymentHours||0})]}),y.jsxs("span",{children:["Prace LF: ",y.jsx("strong",{className:"text-gray-900",children:r.workLFHours||0})]})]})]}),y.jsx(dr,{label:"Powd zmiany estymaty",value:i,onChange:v=>s(v.target.value),children:p2.map(v=>y.jsx("option",{value:v,children:v},v))}),y.jsx(Ei,{label:"Uzasadnienie (w tym analiza wpywu na inne paczki)",value:o,onChange:v=>u(v.target.value),rows:4,required:!0}),y.jsxs("div",{children:[y.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Nowe estymaty (h)"}),y.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[y.jsx(St,{label:"Nowa Analiza",type:"number",value:d.analysisHours||"",onChange:v=>m("analysisHours",v.target.value)}),y.jsx(St,{label:"Nowe Progr. IT",type:"number",value:d.devITHours||"",onChange:v=>m("devITHours",v.target.value)}),y.jsx(St,{label:"Nowe Testy",type:"number",value:d.testingHours||"",onChange:v=>m("testingHours",v.target.value)}),y.jsx(St,{label:"Nowe Wdroenie",type:"number",value:d.deploymentHours||"",onChange:v=>m("deploymentHours",v.target.value)}),y.jsx(St,{label:"Nowe Prace LF",type:"number",value:d.workLFHours||"",onChange:v=>m("workLFHours",v.target.value)})]})]}),y.jsxs("div",{className:"p-3 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-md text-sm",children:[y.jsx("strong",{children:"Uwaga:"})," Zmiana estymat spowoduje automatyczne przeliczenie harmonogramu i moe wpyn na dat Go-Live paczki."]}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{onClick:x,disabled:!o.trim(),children:"Zobacz podgld i zatwierd"})]})]})}):null},E7=({isOpen:e,onClose:t,onApprove:n,context:r,packages:i,isReadOnly:s=!1})=>{const[o,u]=ge.useState("");ge.useEffect(()=>{var C;e&&u(((C=r==null?void 0:r.historicalReEstimation)==null?void 0:C.approver)||"")},[e,r]);const{originalSchedule:d,proposedSchedule:h,oldGoLive:m,newGoLive:x,goLiveShiftDays:v}=ge.useMemo(()=>{const C={originalSchedule:null,proposedSchedule:null,oldGoLive:null,newGoLive:null,goLiveShiftDays:0};if(!r)return C;const I=i.find(H=>H.name===r.roadmapItem.packageName);if(!I)return C;const A=r.roadmapItem,D=sc(I,A),P={...A,...r.newEstimates},L=A.totalITHoursWithBuffer||0,R=A.workLFHours||0,J=(P.analysisHours||0)+(P.devITHours||0)+(P.testingHours||0)+(P.deploymentHours||0),V=Math.round(J*1.1),ne=P.workLFHours||0,te=ac(L,V),Q=ac(R,ne),me=Math.max(te,Q),Re=new Date(I.currentGoLiveDate);let ye=new Date(Re),De=Math.abs(me);const Ce=me>0?1:-1;for(;De>0;)ye.setDate(ye.getDate()+Ce),ye.getDay()!==0&&ye.getDay()!==6&&De--;const ke={...I,currentGoLiveDate:ye.toISOString()},Z=sc(ke,P);return{originalSchedule:D,proposedSchedule:Z,oldGoLive:Re,newGoLive:ye,goLiveShiftDays:me}},[r,i]),_=()=>{if(!o.trim()){alert("Prosz poda imi i nazwisko osoby zatwierdzajcej.");return}n(o.trim())};if(!e||!r)return null;const S=v>0?`Opnienie o ${v} dni`:v<0?`Przyspieszenie o ${Math.abs(v)} dni`:"Brak zmiany",T=v>0?"text-red-600":v<0?"text-green-600":"text-gray-600",E=s?"Podgld Historycznej Zmiany":`Podgld wpywu reestymacji: ${r.roadmapItem.orderName}`;return y.jsx(er,{isOpen:e,onClose:t,title:E,children:y.jsxs("div",{className:"max-h-[85vh] overflow-y-auto pr-2 space-y-6",children:[y.jsx("p",{className:"text-gray-600",children:s?"Poniej znajduje si archiwalny zapis wpywu zmiany na harmonogram.":"Poniej znajduje si wizualizacja wpywu proponowanej zmiany na harmonogram. Sprawd prognoz i podpisz, aby ostatecznie zatwierdzi zmian."}),r.historicalReEstimation&&y.jsxs(Wn,{children:[y.jsx("h4",{className:"font-semibold text-lg text-gray-800 mb-3",children:"Szczegy historycznej zmiany"}),y.jsxs("div",{className:"text-sm space-y-1",children:[y.jsxs("p",{children:[y.jsx("span",{className:"font-semibold text-gray-600",children:"Data zmiany:"})," ",new Date(r.historicalReEstimation.createdAt).toLocaleString("pl-PL")]}),y.jsxs("p",{children:[y.jsx("span",{className:"font-semibold text-gray-600",children:"Powd:"})," ",r.historicalReEstimation.reason]}),y.jsxs("p",{children:[y.jsx("span",{className:"font-semibold text-gray-600",children:"Uzasadnienie:"})," ",r.historicalReEstimation.justification]})]})]}),y.jsxs(Wn,{children:[y.jsx("h4",{className:"font-semibold text-lg text-gray-800 mb-3",children:"Podsumowanie zmiany Go-Live"}),y.jsxs("div",{className:"flex justify-around items-center text-center",children:[y.jsxs("div",{children:[y.jsx("p",{className:"text-sm text-gray-500",children:"Poprzednia data"}),y.jsx("p",{className:"font-bold text-lg text-gray-800",children:m==null?void 0:m.toLocaleDateString("pl-PL")})]}),y.jsx("div",{className:"text-xl font-light text-gray-400",children:""}),y.jsxs("div",{children:[y.jsx("p",{className:"text-sm text-gray-500",children:"Nowa prognozowana data"}),y.jsx("p",{className:"font-bold text-lg text-gray-800",children:x==null?void 0:x.toLocaleDateString("pl-PL")})]}),y.jsxs("div",{className:"pl-4 ml-4 border-l border-gray-200",children:[y.jsx("p",{className:"text-sm text-gray-500",children:"Wpyw na termin"}),y.jsx("p",{className:`font-bold text-lg ${T}`,children:S})]})]})]}),d&&y.jsx(nh,{scheduleData:d,proposedScheduleData:h,goLiveDate:m==null?void 0:m.toISOString()}),!s&&y.jsx("div",{className:"pt-6 border-t border-gray-200",children:y.jsx(St,{label:"Podpis zatwierdzajcy (Imi i Nazwisko)",value:o,onChange:C=>u(C.target.value),placeholder:"Wpisz swoje imi i nazwisko",required:!0})}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:s?"Zamknij":"Anuluj"}),!s&&y.jsx(qe,{onClick:_,disabled:!o.trim(),children:"Zatwierd zmian"})]})]})})},C7=({isOpen:e,onClose:t,onConfirm:n,itemToWithdraw:r})=>{const[i,s]=ge.useState(""),o=()=>{if(!i.trim()){alert("Prosz poda powd wycofania zlecenia.");return}n(i)};return r?y.jsx(er,{isOpen:e,onClose:t,title:`Wycofanie zlecenia: ${r.orderName}`,children:y.jsxs("div",{className:"space-y-6",children:[y.jsx("p",{className:"text-gray-600",children:'Ta operacja usunie zlecenie z roadmapy i przeniesie je z powrotem do backlogu ze statusem "z roadmapy". Operacja zostanie zarejestrowana w historii.'}),y.jsx(Ei,{label:"Powd wycofania (wymagany)",value:i,onChange:u=>s(u.target.value),rows:4,required:!0}),y.jsxs("div",{className:"flex justify-end space-x-4 pt-4 border-t border-gray-200",children:[y.jsx(qe,{variant:"secondary",onClick:t,children:"Anuluj"}),y.jsx(qe,{variant:"danger",onClick:o,disabled:!i.trim(),children:"Potwierd wycofanie"})]})]})}):null},A7=e=>y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...e,children:y.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853l.041-.021M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9-3.75h.008v.008H12V8.25z"})}),I7=e=>{switch(e){case"create":return y.jsx(xl,{className:"w-5 h-5 text-green-500"});case"update":return y.jsx(vl,{className:"w-5 h-5 text-blue-500"});case"delete":return y.jsx(yl,{className:"w-5 h-5 text-red-500"});case"approve":case"start":return y.jsx(Yd,{className:"w-5 h-5 text-green-600"});default:return y.jsx(A7,{className:"w-5 h-5 text-gray-500"})}},N7=({events:e})=>{const[t,n]=ge.useState(""),[r,i]=ge.useState([]),[s,o]=ge.useState(""),[u,d]=ge.useState(""),h=ge.useMemo(()=>Object.values(f0),[]),m=ge.useMemo(()=>Object.entries(f0).reduce((v,[_,S])=>(v[S]=_,v),{}),[]),x=ge.useMemo(()=>{let v=[...e];const _=t.toLowerCase();if(_&&(v=v.filter(E=>E.description.toLowerCase().includes(_))),r.length>0){const E=r.map(C=>m[C]);v=v.filter(C=>E.includes(C.type))}const S=s?new Date(s).getTime():0,T=u?new Date(u).getTime()+(1440*60*1e3-1):1/0;return(S||T!==1/0)&&(v=v.filter(E=>{const C=new Date(E.timestamp).getTime();return C>=S&&C<=T})),v},[e,t,r,s,u,m]);return y.jsxs(Wn,{className:"h-full flex flex-col",children:[y.jsxs("div",{className:"flex justify-between items-center mb-6 flex-wrap gap-4",children:[y.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Dziennik Zdarze"}),y.jsxs("div",{className:"flex items-center gap-4 flex-grow justify-end",children:[y.jsxs("div",{className:"relative flex-grow max-w-xs",children:[y.jsx("span",{className:"absolute inset-y-0 left-0 flex items-center pl-3",children:y.jsx(Tc,{className:"w-5 h-5 text-gray-400"})}),y.jsx("input",{type:"text",placeholder:"Wyszukaj w opisie...",value:t,onChange:v=>n(v.target.value),className:"w-full pl-10 pr-4 py-2 bg-white border border-gray-300 rounded-md text-gray-900 focus:ring-blue-500 focus:border-blue-500"})]}),y.jsx(Os,{title:"Filtruj po typie",options:h,selectedOptions:r,onSelectionChange:i}),y.jsxs("div",{className:"flex items-center gap-2",children:[y.jsx(St,{label:"Od",type:"date",value:s,onChange:v=>o(v.target.value),className:"py-1.5"}),y.jsx(St,{label:"Do",type:"date",value:u,onChange:v=>d(v.target.value),className:"py-1.5"})]})]})]}),y.jsxs("div",{className:"overflow-y-auto flex-grow",children:[y.jsxs("table",{className:"min-w-full text-sm",children:[y.jsx("thead",{className:"bg-gray-50 sticky top-0",children:y.jsxs("tr",{children:[y.jsx("th",{className:"p-3 text-left font-semibold text-gray-600 w-12",children:"Typ"}),y.jsx("th",{className:"p-3 text-left font-semibold text-gray-600",children:"Opis Zdarzenia"}),y.jsx("th",{className:"p-3 text-left font-semibold text-gray-600 whitespace-nowrap",children:"Data i Czas"})]})}),y.jsx("tbody",{className:"divide-y divide-gray-200",children:x.map(v=>y.jsxs("tr",{className:"hover:bg-gray-50",children:[y.jsx("td",{className:"p-3",children:y.jsx("div",{title:f0[v.type],children:I7(v.type)})}),y.jsx("td",{className:"p-3 text-gray-800",children:v.description}),y.jsx("td",{className:"p-3 text-gray-500 whitespace-nowrap",children:new Date(v.timestamp).toLocaleString("pl-PL")})]},v.id))})]}),x.length===0&&y.jsx("div",{className:"text-center py-16 text-gray-500",children:y.jsx("p",{children:"Brak zdarze pasujcych do kryteriw."})})]})]})},F7={dashboard:"Pulpit",releases:"Wydania",backlog:"Backlog",roadmap:"Roadmapa",reviews:"Przegldy",help:"Pomoc",eventLog:"Dziennik Zdarze"},R7=()=>{const[e,t]=ge.useState("dashboard"),[n,r]=ge.useState([]),[i,s]=ge.useState([]),[o,u]=ge.useState([]),[d,h]=ge.useState([]),[m,x]=ge.useState([]),[v,_]=ge.useState([]),[S,T]=ge.useState([]),[E,C]=ge.useState([]),[I,A]=ge.useState(!0),[D,P]=ge.useState(!1),[L,R]=ge.useState(!1),[J,V]=ge.useState(!1),[ne,te]=ge.useState(!1),[Q,me]=ge.useState(!1),[Re,ye]=ge.useState(!1),[De,Ce]=ge.useState(!1),[ke,Z]=ge.useState(!1),[H,ue]=ge.useState(!1),[B,X]=ge.useState(!1),[q,K]=ge.useState(!1),[le,xe]=ge.useState(!1),[ve,we]=ge.useState(!1),[Ae,Xe]=ge.useState(null),[G,ft]=ge.useState(null),[et,dt]=ge.useState(null),[tt,Be]=ge.useState(null),[yt,At]=ge.useState(null),[Lt,on]=ge.useState(null),[Dr,tr]=ge.useState(null),[Bt,yn]=ge.useState(null),[Xt,nr]=ge.useState(null),[Gt,En]=ge.useState(!1),[Qe,gt]=ge.useState(null),ot=ge.useCallback(async()=>{const[j,re,de,Fe,Ie,_e,je,xt]=await Promise.all([Bm(),Um(),S2(),C2(),_2(),I2(),D2(),zR()]);r(j),s(re),h(de),x(Fe),u(Ie),_(_e),T(je.sort((ht,It)=>new Date(It.timestamp).getTime()-new Date(ht.timestamp).getTime())),C(xt)},[]),Ot=ge.useCallback(async(j,re,de,Fe=!0)=>{const _e={releaseId:j,name:re,status:"todo",createdAt:new Date().toISOString(),baselineGoLiveDate:de,currentGoLiveDate:de,isScheduleApproved:!1};await Om(_e),await jt("create",`Utworzono now paczk: "${re}".`),Fe&&await ot()},[ot]),rr=ge.useCallback(async()=>{A(!0),await m2();const[j,re]=await Promise.all([Bm(),Um()]);if(re.length===0&&j.length===0){const de=await d0({name:"Q4 2024",details:"Wdroenie nowego interfejsu uytkownika oraz moduu raportowego."});await jt("create",'Utworzono wydanie startowe: "Q4 2024".');const Fe=new Date("2024-10-31").toISOString(),Ie={releaseId:de,name:"Wdroenie nowego UI",status:"planning",createdAt:new Date().toISOString(),baselineGoLiveDate:Fe,currentGoLiveDate:Fe,isScheduleApproved:!1};await Om(Ie),await jt("create",'Utworzono paczk startow: "Wdroenie nowego UI".')}await ot(),A(!1)},[ot]);ge.useEffect(()=>{rr()},[rr]);const Qa=async(j,re)=>{await d0({name:j,details:re}),await jt("create",`Utworzono wydanie: "${j}".`),await ot()},fa=j=>{ft(j),V(!0)},da=async j=>{await g2(j),await jt("update",`Zaktualizowano wydanie: "${j.name}".`),await ot()},Fi=async j=>{const re=n.find(de=>de.id===j);re&&window.confirm("Czy na pewno chcesz usun to wydanie? Spowoduje to rwnie usunicie wszystkich powizanych z nim paczek. Tej operacji nie mona cofn.")&&(await x2(j),await jt("delete",`Usunito wydanie: "${re.name}".`),await ot())},Ri=j=>{Xe(j),P(!0)},Di=()=>{P(!1),Xe(null)},jr=j=>{dt(j),te(!0)},qr=async j=>{if(!et)return;if(j.status!==et.status){const de=wi[et.status],Fe=wi[j.status];await jt("status_change",`Paczka "${j.name}" zmienia status z "${de}" na "${Fe}".`)}else await jt("update",`Zaktualizowano paczk: "${j.name}".`);const re={...j};await Mo(re),await ot(),te(!1)},oi=j=>{tr(j),X(!0)},es=async(j,re)=>{const de=i.find(Fe=>Fe.id===j);if(de){const Fe={...de,isScheduleApproved:!0,scheduleApprover:re,scheduleApprovedAt:new Date().toISOString()};await Mo(Fe),await jt("approve",`Harmonogram dla paczki "${de.name}" zosta zatwierdzony przez ${re}.`),await ot(),X(!1)}},ts=async j=>{const re=i.find(de=>de.id===j);if(re&&re.status==="ready"&&re.isScheduleApproved){const de={...re,status:"inProgress"};await Mo(de),await jt("start",`Rozpoczto realizacj paczki "${re.name}".`),await ot()}else alert("Bd: Nie mona rozpocz realizacji. Paczka musi by gotowa i mie zatwierdzony harmonogram.")},ns=async j=>{const re=i.find(de=>de.id===j);re&&window.confirm("Czy na pewno chcesz usun t paczk? Tej operacji nie mona cofn.")&&(await y2(j),await jt("delete",`Usunito paczk: "${re.name}".`),await ot())},rs=async j=>{if(j.id)await k2(j);else{const{id:re,...de}=j;await T2(de)}await ot()},ha=async j=>{try{if(j.internalId)await E2(j),await jt("update",`Zaktualizowano element w backlogu: "${j.description.substring(0,50)}...".`);else{const{internalId:re,...de}=j;await h0(de),await jt("create",`Dodano nowy element do backlogu: "${j.description.substring(0,50)}...".`)}await ot(),me(!1),Be(null)}catch(re){console.error("Failed to save backlog item:",re)}},is=j=>{Be(j),me(!0)},li=async j=>{const re=d.find(de=>de.internalId===j);re&&window.confirm("Czy na pewno chcesz usun ten wpis z backlogu?")&&(await zm(j),await jt("delete",`Usunito element z backlogu: "${re.description.substring(0,50)}...".`),await ot())},pa=j=>{on(j),ue(!0)},Pr=j=>{if(!Lt)return;const re={orderName:Lt.description,jira:Lt.ticketId,packageName:j};At(re),ue(!1),ye(!0)},Qs=async j=>{if(j.id?(await Vm(j),await jt("update",`Zaktualizowano zlecenie na roadmapie: "${j.orderName}".`)):(await bm(j),await jt("create",`Dodano nowe zlecenie na roadmapie: "${j.orderName}".`),Lt&&Lt.internalId&&(await zm(Lt.internalId),await jt("delete",`Przeniesiono z backlogu na roadmap: "${Lt.description.substring(0,50)}...".`),on(null))),j.packageName){const re=i.find(de=>de.name===j.packageName);if(re&&re.status==="todo"){const de={...re,status:"planning"};await Mo(de),await jt("status_change",`Paczka "${re.name}" automatycznie zmienia status na "W planowaniu".`)}}await ot(),ye(!1),At(null)},ui=j=>{At(j),ye(!0)},Pi=async j=>{const re=m.find(de=>de.id===j);re&&window.confirm("Czy na pewno chcesz usun ten wpis z roadmapy?")&&(await Hm(j),await jt("delete",`Usunito zlecenie z roadmapy: "${re.orderName}".`),await ot())},F=j=>{At(j),K(!0)},U=(j,re,de)=>{yt&&(yn({roadmapItem:yt,newEstimates:de,reason:j,justification:re}),K(!1),xe(!0))},M=j=>{const re=m.find(Fe=>Fe.id===j.roadmapItemId);if(!re){alert("Nie mona znale powizanego zlecenia.");return}const de={...re,...j.previousEstimates};yn({roadmapItem:de,newEstimates:j.newEstimates,historicalReEstimation:j}),xe(!0)},O=async j=>{if(!Bt||!Bt.reason)return;const{roadmapItem:re,newEstimates:de,reason:Fe,justification:Ie}=Bt,_e={...re,...de},je=_e.workLFHours||0;_e.devLFHours=Math.round(je*.8718),_e.stabilizationLFHours=Math.round(je*.1282);const xt=(_e.analysisHours||0)+(_e.devITHours||0)+(_e.testingHours||0)+(_e.deploymentHours||0);_e.totalITHoursWithBuffer=Math.round(xt*1.1),_e.totalHours=_e.totalITHoursWithBuffer+je,await Vm(_e);const ht=i.find(Mr=>Mr.name===re.packageName);if(ht){const Mr=re.totalITHoursWithBuffer||0,Kr=re.workLFHours||0,pr=_e.totalITHoursWithBuffer,tn=_e.workLFHours||0,ma=ac(Mr,pr),zt=ac(Kr,tn),_l=Math.max(ma,zt),Tl=new Date(ht.currentGoLiveDate);let kl=new Date(Tl),Jr=new Date(Tl),ga=Math.abs(_l);for(;ga>0;)Jr.setDate(Jr.getDate()+(_l>0?1:-1)),Jr.getDay()!==0&&Jr.getDay()!==6&&ga--;kl=Jr;const xa={...ht,currentGoLiveDate:kl.toISOString()};await Mo(xa)}const It={roadmapItemId:re.id,reason:Fe,justification:Ie,previousEstimates:{analysisHours:re.analysisHours,devITHours:re.devITHours,workLFHours:re.workLFHours,testingHours:re.testingHours,deploymentHours:re.deploymentHours},newEstimates:de,createdAt:new Date().toISOString(),approver:j};await A2(It),await jt("re_estimate",`Zatwierdzono reestymacj dla zlecenia "${re.orderName}" z powodu: ${Fe}. Zatwierdzi(a): ${j}.`),await ot(),xe(!1),yn(null),At(null)},z=j=>{nr(j),we(!0)},b=async j=>{if(!Xt)return;const re={ticketId:Xt.jira,description:Xt.orderName||"Brak opisu",status:"z roadmapy",comment:`Wycofane z paczki: ${Xt.packageName}. Powd: ${j}`};await h0(re);const de={roadmapItemId:Xt.id,roadmapItemName:Xt.orderName||"Brak nazwy",reason:j,createdAt:new Date().toISOString()};await F2(de),await jt("withdraw",`Wycofano zlecenie "${Xt.orderName}" z roadmapy. Powd: ${j}.`),await Hm(Xt.id),await ot(),we(!1),nr(null)},se=async(j,re)=>{En(!0),gt(null);try{const de=await BR(re,j);switch(j){case"releases":for(const Fe of de)await d0(Fe);break;case"roadmap":for(const Fe of de)await bm(Fe);break;case"backlog":for(const Fe of de)await h0(Fe);break}await jt("update",`Zaimportowano ${de.length} rekordw do sekcji ${j}.`),alert(`Pomylnie zaimportowano ${de.length} rekordw.`),Ce(!1),await ot()}catch(de){console.error("Import error:",de),gt(de.message||"Wystpi nieznany bd podczas importu.")}finally{En(!1)}},pe=j=>{try{switch(j){case"releases":I0({filename:"releases.xlsx",headers:[{key:"name",label:"name"},{key:"details",label:"details"}],data:n});break;case"roadmap":I0({filename:"roadmap.xlsx",headers:[{key:"jira",label:"jira"},{key:"orderName",label:"orderName"},{key:"packageName",label:"packageName"},{key:"analysisHours",label:"analysisHours"},{key:"devITHours",label:"devITHours"},{key:"devLFHours",label:"devLFHours"},{key:"testingHours",label:"testingHours"},{key:"deploymentHours",label:"deploymentHours"},{key:"stabilizationLFHours",label:"stabilizationLFHours"},{key:"totalITHoursWithBuffer",label:"totalITHoursWithBuffer"},{key:"workLFHours",label:"workLFHours"},{key:"totalHours",label:"totalHours"},{key:"comment",label:"comment"}],data:m});break;case"backlog":I0({filename:"backlog.xlsx",headers:[{key:"ticketId",label:"ticketId"},{key:"description",label:"description"},{key:"foz",label:"foz"},{key:"plannedDate",label:"plannedDate"},{key:"analyst",label:"analyst"},{key:"status",label:"status"},{key:"decision",label:"decision"},{key:"comment",label:"comment"}],data:d});break}Z(!1)}catch(re){console.error("Export failed:",re),alert("Eksport nie powid si. Sprawd konsol, aby uzyska wicej informacji.")}},ae=({targetView:j,children:re})=>y.jsx("button",{onClick:()=>t(j),className:`px-3 py-1.5 rounded-md font-medium text-sm transition-colors ${e===j?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-blue-600"}`,children:re}),ce=()=>{if(I)return y.jsx("div",{className:"flex items-center justify-center h-full",children:y.jsx("p",{className:"text-xl",children:"Wczytywanie danych..."})});switch(e){case"dashboard":return y.jsx(qR,{packages:i,releases:n,backlogItems:d,roadmapItems:m,alerts:E,setView:t});case"releases":return y.jsx(XR,{releases:n,packages:i,roadmapItems:m,onAddRelease:()=>R(!0),onEditRelease:fa,onDeleteRelease:Fi,onEditPackage:jr,onDeletePackage:ns,onAddPackage:Ri,onOpenApproveModal:oi,onStartRealization:ts});case"reviews":return y.jsx(m7,{packages:i,reviews:o,onSaveReview:rs,roadmapItems:m});case"backlog":return y.jsx(YR,{items:d,onAddItem:()=>{Be(null),me(!0)},onEditItem:is,onDeleteItem:li,onAddToRoadmap:pa});case"roadmap":return y.jsx(eD,{items:m,packages:i,onAddItem:()=>{At(null),ye(!0)},onEditItem:ui,onDeleteItem:Pi,onOpenReEstimationModal:F,onOpenWithdrawalModal:z});case"help":return y.jsx(g7,{});case"eventLog":return y.jsx(N7,{events:S});default:return null}};return y.jsxs("div",{className:"min-h-screen h-screen flex flex-col bg-gray-100 text-gray-800",children:[y.jsxs("header",{className:"bg-white shadow-sm p-4 flex justify-between items-center border-b border-gray-200 flex-shrink-0",children:[y.jsxs("div",{className:"flex items-center space-x-8",children:[y.jsx(_7,{className:"h-8"}),y.jsxs("nav",{className:"flex items-center space-x-2",children:[y.jsx(ae,{targetView:"dashboard",children:"Pulpit"}),y.jsx(ae,{targetView:"releases",children:"Wydania"}),y.jsx(ae,{targetView:"backlog",children:"Backlog"}),y.jsx(ae,{targetView:"roadmap",children:"Roadmapa"}),y.jsx(ae,{targetView:"reviews",children:"Przegldy"}),y.jsx(ae,{targetView:"eventLog",children:"Dziennik Zdarze"}),y.jsx(ae,{targetView:"help",children:"Pomoc"})]})]}),y.jsxs("div",{className:"flex items-center space-x-2",children:[y.jsx(qe,{onClick:()=>Ce(!0),variant:"secondary",size:"sm",children:" Importuj "}),y.jsx(qe,{onClick:()=>Z(!0),variant:"secondary",size:"sm",children:" Eksportuj "})]})]}),y.jsx("div",{className:"p-6",children:y.jsxs("div",{className:"text-sm text-gray-500",children:[y.jsx("span",{className:"text-blue-600 font-medium",children:"Meneder Releasw"})," / ",F7[e]]})}),y.jsx("main",{className:"flex-grow overflow-y-hidden px-6 pb-6",children:ce()}),y.jsx(HR,{isOpen:D,onClose:Di,onSave:Ot,releases:n,targetReleaseId:Ae}),y.jsx(WR,{isOpen:L,onClose:()=>R(!1),onSave:Qa}),y.jsx(GR,{isOpen:J,onClose:()=>V(!1),onSave:da,releaseToEdit:G}),y.jsx($R,{isOpen:ne,onClose:()=>te(!1),onSave:qr,packageToEdit:et,releases:n,roadmapItems:m}),y.jsx(tD,{isOpen:Q,onClose:()=>{me(!1),Be(null)},onSave:ha,itemToEdit:tt}),y.jsx(rD,{isOpen:Re,onClose:()=>{At(null),ye(!1)},onSave:Qs,itemToEdit:yt,packages:i,reEstimations:v,onViewHistory:M}),y.jsx(v7,{isOpen:De,onClose:()=>{Ce(!1),gt(null)},onImport:se,isLoading:Gt,error:Qe}),y.jsx(w7,{isOpen:ke,onClose:()=>Z(!1),onExport:pe}),y.jsx(T7,{isOpen:H,onClose:()=>ue(!1),onAssign:Pr,packages:i}),y.jsx(k7,{isOpen:B,onClose:()=>X(!1),onApprove:es,pkg:Dr,roadmapItems:m}),y.jsx(S7,{isOpen:q,onClose:()=>{K(!1),At(null)},onSave:U,itemToReEstimate:yt}),y.jsx(E7,{isOpen:le,onClose:()=>{xe(!1),yn(null)},onApprove:O,context:Bt,packages:i,isReadOnly:!!(Bt!=null&&Bt.historicalReEstimation)}),y.jsx(C7,{isOpen:ve,onClose:()=>{we(!1),nr(null)},onConfirm:b,itemToWithdraw:Xt})]})},vw=document.getElementById("root");if(!vw)throw new Error("Could not find root element to mount to");const D7=u2.createRoot(vw);D7.render(y.jsx(R0.StrictMode,{children:y.jsx(R7,{})}));
